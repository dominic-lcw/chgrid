var IM=Object.defineProperty,CM=Object.getOwnPropertyDescriptor,p=(t,e,i,o)=>{for(var s=o>1?void 0:o?CM(e,i):e,a=t.length-1,n;a>=0;a--)(n=t[a])&&(s=(o?n(e,i,s):n(s))||s);return o&&s&&IM(e,i,s),s};import{AgCharts as rr,VERSION as TM,_Scene as wM,_Theme as NM,_Util as PM,setupCommunityModules as EM}from"ag-charts-community";var _M=class{constructor(){this.ieCompatibility=!1}init(){this.ieCompatibility=this.md5("hello")!="5d41402abc4b2a76b9719d911017c592"}md5cycle(t,e){let i=t[0],o=t[1],s=t[2],a=t[3];i=this.ff(i,o,s,a,e[0],7,-680876936),a=this.ff(a,i,o,s,e[1],12,-389564586),s=this.ff(s,a,i,o,e[2],17,606105819),o=this.ff(o,s,a,i,e[3],22,-1044525330),i=this.ff(i,o,s,a,e[4],7,-176418897),a=this.ff(a,i,o,s,e[5],12,1200080426),s=this.ff(s,a,i,o,e[6],17,-1473231341),o=this.ff(o,s,a,i,e[7],22,-45705983),i=this.ff(i,o,s,a,e[8],7,1770035416),a=this.ff(a,i,o,s,e[9],12,-1958414417),s=this.ff(s,a,i,o,e[10],17,-42063),o=this.ff(o,s,a,i,e[11],22,-1990404162),i=this.ff(i,o,s,a,e[12],7,1804603682),a=this.ff(a,i,o,s,e[13],12,-40341101),s=this.ff(s,a,i,o,e[14],17,-1502002290),o=this.ff(o,s,a,i,e[15],22,1236535329),i=this.gg(i,o,s,a,e[1],5,-165796510),a=this.gg(a,i,o,s,e[6],9,-1069501632),s=this.gg(s,a,i,o,e[11],14,643717713),o=this.gg(o,s,a,i,e[0],20,-373897302),i=this.gg(i,o,s,a,e[5],5,-701558691),a=this.gg(a,i,o,s,e[10],9,38016083),s=this.gg(s,a,i,o,e[15],14,-660478335),o=this.gg(o,s,a,i,e[4],20,-405537848),i=this.gg(i,o,s,a,e[9],5,568446438),a=this.gg(a,i,o,s,e[14],9,-1019803690),s=this.gg(s,a,i,o,e[3],14,-187363961),o=this.gg(o,s,a,i,e[8],20,1163531501),i=this.gg(i,o,s,a,e[13],5,-1444681467),a=this.gg(a,i,o,s,e[2],9,-51403784),s=this.gg(s,a,i,o,e[7],14,1735328473),o=this.gg(o,s,a,i,e[12],20,-1926607734),i=this.hh(i,o,s,a,e[5],4,-378558),a=this.hh(a,i,o,s,e[8],11,-2022574463),s=this.hh(s,a,i,o,e[11],16,1839030562),o=this.hh(o,s,a,i,e[14],23,-35309556),i=this.hh(i,o,s,a,e[1],4,-1530992060),a=this.hh(a,i,o,s,e[4],11,1272893353),s=this.hh(s,a,i,o,e[7],16,-155497632),o=this.hh(o,s,a,i,e[10],23,-1094730640),i=this.hh(i,o,s,a,e[13],4,681279174),a=this.hh(a,i,o,s,e[0],11,-358537222),s=this.hh(s,a,i,o,e[3],16,-722521979),o=this.hh(o,s,a,i,e[6],23,76029189),i=this.hh(i,o,s,a,e[9],4,-640364487),a=this.hh(a,i,o,s,e[12],11,-421815835),s=this.hh(s,a,i,o,e[15],16,530742520),o=this.hh(o,s,a,i,e[2],23,-995338651),i=this.ii(i,o,s,a,e[0],6,-198630844),a=this.ii(a,i,o,s,e[7],10,1126891415),s=this.ii(s,a,i,o,e[14],15,-1416354905),o=this.ii(o,s,a,i,e[5],21,-57434055),i=this.ii(i,o,s,a,e[12],6,1700485571),a=this.ii(a,i,o,s,e[3],10,-1894986606),s=this.ii(s,a,i,o,e[10],15,-1051523),o=this.ii(o,s,a,i,e[1],21,-2054922799),i=this.ii(i,o,s,a,e[8],6,1873313359),a=this.ii(a,i,o,s,e[15],10,-30611744),s=this.ii(s,a,i,o,e[6],15,-1560198380),o=this.ii(o,s,a,i,e[13],21,1309151649),i=this.ii(i,o,s,a,e[4],6,-145523070),a=this.ii(a,i,o,s,e[11],10,-1120210379),s=this.ii(s,a,i,o,e[2],15,718787259),o=this.ii(o,s,a,i,e[9],21,-343485551),t[0]=this.add32(i,t[0]),t[1]=this.add32(o,t[1]),t[2]=this.add32(s,t[2]),t[3]=this.add32(a,t[3])}cmn(t,e,i,o,s,a){return e=this.add32(this.add32(e,t),this.add32(o,a)),this.add32(e<<s|e>>>32-s,i)}ff(t,e,i,o,s,a,n){return this.cmn(e&i|~e&o,t,e,s,a,n)}gg(t,e,i,o,s,a,n){return this.cmn(e&o|i&~o,t,e,s,a,n)}hh(t,e,i,o,s,a,n){return this.cmn(e^i^o,t,e,s,a,n)}ii(t,e,i,o,s,a,n){return this.cmn(i^(e|~o),t,e,s,a,n)}md51(t){const e=t.length,i=[1732584193,-271733879,-1732584194,271733878];let o;for(o=64;o<=t.length;o+=64)this.md5cycle(i,this.md5blk(t.substring(o-64,o)));t=t.substring(o-64);const s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(o=0;o<t.length;o++)s[o>>2]|=t.charCodeAt(o)<<(o%4<<3);if(s[o>>2]|=128<<(o%4<<3),o>55)for(this.md5cycle(i,s),o=0;o<16;o++)s[o]=0;return s[14]=e*8,this.md5cycle(i,s),i}md5blk(t){const e=[];for(let i=0;i<64;i+=4)e[i>>2]=t.charCodeAt(i)+(t.charCodeAt(i+1)<<8)+(t.charCodeAt(i+2)<<16)+(t.charCodeAt(i+3)<<24);return e}rhex(t){const e="0123456789abcdef".split("");let i="",o=0;for(;o<4;o++)i+=e[t>>o*8+4&15]+e[t>>o*8&15];return i}hex(t){for(let e=0;e<t.length;e++)t[e]=this.rhex(t[e]);return t.join("")}md5(t){return this.hex(this.md51(t))}add32(t,e){return this.ieCompatibility?this.add32Compat(t,e):this.add32Std(t,e)}add32Std(t,e){return t+e&4294967295}add32Compat(t,e){const i=(t&65535)+(e&65535);return(t>>16)+(e>>16)+(i>>16)<<16|i&65535}};function ah(t){return t==null||t.length===0}var lr={"01":"GRID","02":"CHARTS","0102":"BOTH"},Wu="https://www.ag-grid.com/charts/licensing/",nh=class Gt{constructor(e){this.watermarkMessage=void 0,this.totalMessageLength=124,this.document=e,this.md5=new _M,this.md5.init()}validateLicense(){const e=this.getLicenseDetails(Gt.licenseKey,Gt.gridContext),i=`AG ${e.currentLicenseType==="BOTH"?"Grid and ":""}Charts Enterprise`;let o="";if(e.suppliedLicenseType==="BOTH"?o="AG Grid and AG Charts Enterprise":e.suppliedLicenseType==="GRID"?o="AG Grid Enterprise":e.suppliedLicenseType!==void 0&&(o="AG Charts Enterprise"),e.missing)(!this.isWebsiteUrl()||this.isForceWatermark())&&this.outputMissingLicenseKey(i);else if(e.expired){const s=Gt.getChartsReleaseDate(),a=Gt.formatDate(s);this.outputExpiredKey(e.expiry,a,o)}else e.valid?e.isTrial&&e.trialExpired&&this.outputExpiredTrialKey(e.expiry,i,o):this.outputInvalidLicenseKey(!!e.incorrectLicenseType,i,o)}static extractExpiry(e){const i=e.substring(e.lastIndexOf("_")+1,e.length);return new Date(parseInt(Gt.decode(i),10))}static extractLicenseComponents(e){let i=e.replace(/[\u200B-\u200D\uFEFF]/g,"");if(i=i.replace(/\r?\n|\r/g,""),e.length<=32)return{md5:null,license:e,version:null,isTrial:null};const o=i.length-32,s=i.substring(o),a=i.substring(0,o),[n,r,l]=Gt.extractBracketedInformation(i);return{md5:s,license:a,version:n,isTrial:r,type:l}}getLicenseDetails(e,i=!1){const o="CHARTS";if(ah(e))return{licenseKey:e,valid:!1,missing:!0,currentLicenseType:o};const s=Gt.getChartsReleaseDate(),{md5:a,license:n,version:r,isTrial:l,type:c}=Gt.extractLicenseComponents(e);let h=a===this.md5.md5(n)&&e.indexOf("For_Trialing_ag-Grid_Only")===-1,d,u,g=null,y=!1,f;function x(){d=g<new Date,u=void 0}if(h&&(g=Gt.extractExpiry(n),h=!isNaN(g.getTime()),h))switch(u=s>g,r){case"legacy":case"2":{h=!1;break}case"3":ah(c)?h=!1:(f=c,c!==lr["02"]&&c!==lr["0102"]?(h=!1,y=!0):l&&x())}return h?{licenseKey:e,valid:h,expiry:Gt.formatDate(g),expired:u,version:r,isTrial:l,trialExpired:d,invalidLicenseTypeForCombo:i?f!=="BOTH":void 0,incorrectLicenseType:y,currentLicenseType:o,suppliedLicenseType:f}:{licenseKey:e,valid:h,incorrectLicenseType:y,currentLicenseType:o,suppliedLicenseType:f}}isDisplayWatermark(){return this.isForceWatermark()||!this.isLocalhost()&&!this.isE2ETest()&&!this.isWebsiteUrl()&&!ah(this.watermarkMessage)}getWatermarkMessage(){return this.watermarkMessage??""}getHostname(){if(!this.document)return"localhost";const e=this.document.defaultView??window;if(!e)return"localhost";const i=e.location,{hostname:o=""}=i;return o}isForceWatermark(){if(!this.document)return!1;const e=this.document?.defaultView??typeof window<"u"?window:void 0;if(!e)return!1;const{pathname:i}=e.location;return i?i.indexOf("forceWatermark")!==-1:!1}isWebsiteUrl(){const e=this.getHostname();return/^((?:[\w-]+\.)?ag-grid\.com)$/.exec(e)!==null}isLocalhost(){const e=this.getHostname();return/^(?:127\.0\.0\.1|localhost)$/.exec(e)!==null}isE2ETest(){const e=this.getHostname();return/^(?:172\.17\.0\.1|host\.docker\.internal)$/.exec(e)!==null}static formatDate(e){const i=["January","February","March","April","May","June","July","August","September","October","November","December"],o=e.getDate(),s=e.getMonth(),a=e.getFullYear();return o+" "+i[s]+" "+a}static getChartsReleaseDate(){return new Date(parseInt(Gt.decode(Gt.RELEASE_INFORMATION),10))}static decode(e){const i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let o="",s,a,n,r,l,c,h,d=0;const u=e.replace(/[^A-Za-z0-9+/=]/g,"");for(;d<u.length;)r=i.indexOf(u.charAt(d++)),l=i.indexOf(u.charAt(d++)),c=i.indexOf(u.charAt(d++)),h=i.indexOf(u.charAt(d++)),s=r<<2|l>>4,a=(l&15)<<4|c>>2,n=(c&3)<<6|h,o=o+String.fromCharCode(s),c!=64&&(o=o+String.fromCharCode(a)),h!=64&&(o=o+String.fromCharCode(n));return o=Gt.utf8_decode(o),o}static utf8_decode(e){e=e.replace(/rn/g,"n");let i="";for(let o=0;o<e.length;o++){const s=e.charCodeAt(o);s<128?i+=String.fromCharCode(s):s>127&&s<2048?(i+=String.fromCharCode(s>>6|192),i+=String.fromCharCode(s&63|128)):(i+=String.fromCharCode(s>>12|224),i+=String.fromCharCode(s>>6&63|128),i+=String.fromCharCode(s&63|128))}return i}static setGridContext(e=!1){Gt.gridContext=e}static setLicenseKey(e){Gt.licenseKey=e}static extractBracketedInformation(e){if(!e.includes("["))return["legacy",!1,void 0];const i=e.match(/\[(.*?)\]/g).map(r=>r.replace("[","").replace("]",""));if(!i||i.length===0)return["legacy",!1,void 0];const o=i.filter(r=>r==="TRIAL").length===1,s=i.filter(r=>r.startsWith("v"))[0],a=s?s.replace("v",""):"legacy",n=lr[i.filter(r=>lr[r])[0]];return[a,o,n]}centerPadAndOutput(e){const i=this.totalMessageLength-e.length;console.error(e.padStart(i/2+e.length,"*").padEnd(this.totalMessageLength,"*"))}padAndOutput(e,i="*",o=""){console.error(e.padEnd(this.totalMessageLength-o.length,i)+o)}outputInvalidLicenseKey(e,i,o){Gt.gridContext||(e?(this.centerPadAndOutput(""),this.centerPadAndOutput(` ${i} License `),this.centerPadAndOutput(" Incompatible License Key "),this.padAndOutput(`* Your license key is for ${o} only and does not cover you for ${i}.`," ","*"),this.padAndOutput(`* To troubleshoot your license key visit ${Wu}.`," ","*"),this.centerPadAndOutput(""),this.centerPadAndOutput("")):(this.centerPadAndOutput(""),this.centerPadAndOutput(` ${i} License `),this.centerPadAndOutput(" Invalid License Key "),this.padAndOutput("* Your license key is not valid."," ","*"),this.padAndOutput(`* To troubleshoot your license key visit ${Wu}.`," ","*"),this.centerPadAndOutput(""),this.centerPadAndOutput(""))),this.watermarkMessage="Invalid License"}outputExpiredTrialKey(e,i,o){Gt.gridContext||(this.centerPadAndOutput(""),this.centerPadAndOutput(` ${i} License `),this.centerPadAndOutput(" Trial Period Expired. "),this.padAndOutput(`* Your trial only license for ${o} expired on ${e}.`," ","*"),this.padAndOutput("* Please email info@ag-grid.com to purchase a license."," ","*"),this.centerPadAndOutput(""),this.centerPadAndOutput("")),this.watermarkMessage="Trial Period Expired"}outputMissingLicenseKey(e){Gt.gridContext||(this.centerPadAndOutput(""),this.centerPadAndOutput(` ${e} License `),this.centerPadAndOutput(" License Key Not Found "),this.padAndOutput(`* All ${e} features are unlocked for trial.`," ","*"),this.padAndOutput("* If you want to hide the watermark please email info@ag-grid.com for a trial license key."," ","*"),this.centerPadAndOutput(""),this.centerPadAndOutput("")),this.watermarkMessage="For Trial Use Only"}outputExpiredKey(e,i,o){Gt.gridContext||(this.centerPadAndOutput(""),this.centerPadAndOutput(` ${o} License `),this.centerPadAndOutput(" Incompatible Software Version "),this.padAndOutput(`* Your license key works with versions of ${o} released before ${e}.`," ","*"),this.padAndOutput(`* The version you are trying to use was released on ${i}.`," ","*"),this.padAndOutput("* Please contact info@ag-grid.com to renew your license key."," ","*"),this.centerPadAndOutput(""),this.centerPadAndOutput("")),this.watermarkMessage="License Expired"}};nh.RELEASE_INFORMATION="MTc1NzQ4ODExNDMxNQ==",nh.gridContext=!1;var ta=nh;import{VERSION as OM,_ModuleSupport as ea}from"ag-charts-community";import{_ModuleSupport as RM}from"ag-charts-community";import{isNumberEqual as Ku}from"ag-charts-core";function rh(t,e,i){const o=(a,n,r,l)=>{let c=t[0];for(let h=a;r>0?h<=n:h>n;h+=r){const d=t[h];if(l(c,d))return!0;c=d}return!1},s=Math.floor(t.length/2);return o(e,s,e,i)?!0:o(t.length-e,s,-e,i)}import{_ModuleSupport as BM}from"ag-charts-community";var{AxisInterval:zM,Property:FM}=BM,lh=class extends zM{};p([FM],lh.prototype,"minSpacing",2);import{_ModuleSupport as cr}from"ag-charts-community";import{countFractionDigits as VM,isArray as HM,isNumberEqual as ia,wrapText as GM,wrapTextSegments as WM}from"ag-charts-core";import{_ModuleSupport as $u}from"ag-charts-community";import{isNumberEqual as ju}from"ag-charts-core";import{_ModuleSupport as KM}from"ag-charts-community";import{createId as $M}from"ag-charts-core";var{BaseProperties:Yu,ChartAxisDirection:jM,Property:At,Group:ch,FONT_SIZE:YM}=KM,yi=class extends Yu{constructor(){super(...arguments),this.fontSize=YM.LARGE,this.fontFamily="Verdana, sans-serif",this.padding=5,this.color="rgba(87, 87, 87, 1)"}};p([At],yi.prototype,"enabled",2),p([At],yi.prototype,"text",2),p([At],yi.prototype,"fontStyle",2),p([At],yi.prototype,"fontWeight",2),p([At],yi.prototype,"fontSize",2),p([At],yi.prototype,"fontFamily",2),p([At],yi.prototype,"padding",2),p([At],yi.prototype,"color",2),p([At],yi.prototype,"parallel",2);var xe=class extends Yu{constructor(){super(...arguments),this.id=$M(this),this.defaultColorRange=[],this.shape="polygon",this.label=new yi,this.scale=void 0,this.clippedRange=[-1/0,1/0],this.gridLength=0,this.sideFlag=-1,this.parallelFlipRotation=0,this.regularFlipRotation=0,this.direction=jM.Angle,this.axisInnerRadius=0,this.axisOuterRadius=0,this.lineGroup=new ch({name:this.id}),this.rangeGroup=new ch({name:this.id}),this.labelGroup=new ch({name:this.id}),this._isRange=void 0}assignCrossLineGroup(t,e){t!==this._isRange&&(t?this.rangeGroup.appendChild(e):this.lineGroup.appendChild(e)),this._isRange=t}setSectorNodeProps(t){t.fill=this.fill,t.fillOpacity=this.fillOpacity??1,t.stroke=this.stroke,t.strokeOpacity=this.strokeOpacity??1,t.strokeWidth=this.strokeWidth??1,t.lineDash=this.lineDash}setLabelNodeProps(t,e,i,o,s){const{label:a}=this;t.x=e,t.y=i,t.text=a.text,t.textAlign="center",t.textBaseline=o,t.rotation=s,t.rotationCenterX=e,t.rotationCenterY=i,t.fill=a.color,t.fontFamily=a.fontFamily,t.fontSize=a.fontSize,t.fontStyle=a.fontStyle,t.visible=!0}};p([At],xe.prototype,"enabled",2),p([At],xe.prototype,"type",2),p([At],xe.prototype,"range",2),p([At],xe.prototype,"value",2),p([At],xe.prototype,"defaultColorRange",2),p([At],xe.prototype,"fill",2),p([At],xe.prototype,"fillOpacity",2),p([At],xe.prototype,"stroke",2),p([At],xe.prototype,"strokeWidth",2),p([At],xe.prototype,"strokeOpacity",2),p([At],xe.prototype,"lineDash",2),p([At],xe.prototype,"shape",2),p([At],xe.prototype,"label",2);var{ChartAxisDirection:UM,getCrossLineValue:XM,validateCrossLineValue:ZM,normalizeAngle360:hh,Group:qM,Path:Uu,Sector:QM,RotatableText:JM,ContinuousScale:tD}=$u,ph=class extends xe{constructor(){super(),this.direction=UM.Angle,this.polygonNode=new Uu,this.sectorNode=new QM,this.lineNode=new Uu,this.crossLineRange=new qM,this.labelNode=new JM,this.ticks=[],this.crossLineRange.append(this.polygonNode),this.crossLineRange.append(this.sectorNode),this.crossLineRange.append(this.lineNode),this.labelGroup.append(this.labelNode)}visibilityCheck(){if(!tD.is(this.scale))return!0;const[t,e]=this.scale.domain,i=XM(this);if(this.type==="range"){const[o,s]=i;return o>=t&&o<=e&&s>=o&&s<=e}else return i>=t&&i<=e}update(t){const{scale:e}=this;if(!e||!ZM(this,e)||!this.visibilityCheck()){this.rangeGroup.visible=!1,this.lineGroup.visible=!1,this.labelGroup.visible=!1;return}this.rangeGroup.visible=t,this.lineGroup.visible=t,this.labelGroup.visible=t,this.updateLineNode(t),this.updatePolygonNode(t),this.updateSectorNode(t),this.updateLabelNode(t)}updateLineNode(t){const{scale:e,type:i,value:o,lineNode:s}=this;if(!t||i!=="line"||!e){s.visible=!1;return}const a=e.convert(o);if(isNaN(a)){s.visible=!1;return}const{axisInnerRadius:n,axisOuterRadius:r}=this;s.visible=!0,s.stroke=this.stroke,s.strokeOpacity=this.strokeOpacity??1,s.strokeWidth=this.strokeWidth??1,s.fill=void 0,s.lineDash=this.lineDash;const l=r*Math.cos(a),c=r*Math.sin(a),h=n*Math.cos(a),d=n*Math.sin(a);s.path.clear(!0),s.path.moveTo(h,d),s.path.lineTo(l,c),this.assignCrossLineGroup(!1,this.crossLineRange)}updatePolygonNode(t){const{polygonNode:e,range:i,scale:o,shape:s,type:a,ticks:n}=this;if(!t||a!=="range"||s!=="polygon"||!o||!i){e.visible=!1;return}const{axisInnerRadius:r,axisOuterRadius:l}=this,c=n.indexOf(i[0]),h=n.indexOf(i[1]),u=(c<=h?n.slice(c,h+1):n.slice(c).concat(n.slice(0,h+1))).map(y=>o.convert(y));e.visible=!0,this.setSectorNodeProps(e);const{path:g}=e;g.clear(!0),u.forEach((y,f)=>{const x=l*Math.cos(y),S=l*Math.sin(y);f===0?g.moveTo(x,S):g.lineTo(x,S)}),r===0?g.lineTo(0,0):u.slice().reverse().forEach(y=>{const f=r*Math.cos(y),x=r*Math.sin(y);g.lineTo(f,x)}),e.path.closePath(),this.assignCrossLineGroup(!0,this.crossLineRange)}updateSectorNode(t){const{sectorNode:e,range:i,scale:o,shape:s,type:a}=this;if(!t||a!=="range"||s!=="circle"||!o||!i){e.visible=!1;return}const{axisInnerRadius:n,axisOuterRadius:r}=this,l=i.map(d=>o.convert(d)),c=o.step??0,h=o instanceof $u.BandScale?c/2:0;e.visible=!0,this.setSectorNodeProps(e),e.centerX=0,e.centerY=0,e.innerRadius=n,e.outerRadius=r,e.startAngle=l[0]-h,e.endAngle=l[1]+h,this.assignCrossLineGroup(!0,this.crossLineRange)}updateLabelNode(t){const{label:e,labelNode:i,range:o,scale:s,type:a,ticks:n}=this;if(!t||e.enabled===!1||!e.text||!s||a==="range"&&!o){i.visible=!1;return}i.visible=!0;const{axisInnerRadius:r,axisOuterRadius:l}=this;let c,h,d,u;if(a==="line"){const g=hh(s.convert(this.value)),y=1.5*Math.PI,f=ju(g,y)||g>y||g<Math.PI/2,x=(r+l)/2*Math.cos(g),S=(r+l)/2*Math.sin(g);c=x+e.padding*Math.cos(g+Math.PI/2),h=S+e.padding*Math.sin(g+Math.PI/2),u=f?"top":"bottom",d=f?g:g-Math.PI}else{const[g,y]=o.map(v=>hh(s.convert(v)));let f=(g+y)/2;g>y&&(f-=Math.PI),f=hh(f);const x=(ju(f,0)||f>0)&&f<Math.PI;let S;this.shape==="circle"||n.length<3?S=l-e.padding:S=l*Math.cos(Math.PI/n.length)-e.padding,c=S*Math.cos(f),h=S*Math.sin(f),u=x?"bottom":"top",d=x?f-Math.PI/2:f+Math.PI/2}this.setLabelNodeProps(i,c,h,u,d)}};ph.className="AngleCrossLine";var{ChartAxisDirection:eD,Property:dh,toRadians:on,normalizeAngle360:ko,normalizeAngle360Inclusive:iD,Path:oD,RotatableText:sD,Transformable:aD,BBox:nD,Selection:Xu,Line:Zu}=cr,uh=class extends cr.AxisLabel{constructor(){super(...arguments),this.orientation="fixed"}};p([dh],uh.prototype,"orientation",2);var sn=class extends cr.PolarAxis{constructor(t,e){super(t,e),this.startAngle=0,this.endAngle=void 0,this.tickLineGroupSelection=Xu.select(this.tickLineGroup,Zu,!1),this.gridLineGroupSelection=Xu.select(this.gridLineGroup,Zu,!1),this.labelData=[],this.tickData=[],this.radiusLineGroup=this.axisGroup.appendChild(new cr.TransformableGroup),this.radiusLine=this.radiusLineGroup.appendChild(new oD),this.includeInvisibleDomains=!0}get direction(){return eD.Angle}createLabel(){return new uh}calculateRotations(){const t=on(this.startAngle),e=ko(t),i=ko(t-Math.PI/2);return{rotation:t,parallelFlipRotation:e,regularFlipRotation:i}}calculateTickLayout(t){const{nice:e,scale:i}=this,o={nice:e,interval:void 0,tickCount:void 0,minTickCount:0,maxTickCount:1/0},s=e?i.niceDomain(o,t):t,a=this.generateAngleTicks(s);this.tickData=a;const n=a.map(l=>l.value),r=n.reduce((l,c)=>Math.max(typeof c=="number"?VM(c):0,l),0);return{niceDomain:s,tickDomain:s,ticks:n,rawTickCount:void 0,fractionDigits:r,timeInterval:void 0,bbox:this.getBBox()}}update(){super.update(),this.updateRadiusLine(),this.updateGridLines(),this.updateTickLines()}normalizedAngles(){const t=ko(-Math.PI/2+on(this.startAngle)),e=this.endAngle!=null?iD(on(this.endAngle)-on(this.startAngle)):2*Math.PI,i=t+e;return[t,i]}computeRange(){this.range=this.normalizedAngles()}updateSelections(){const t=this.tickData;this.gridLineGroupSelection.update(this.gridLength&&this.gridLine.enabled?t:[]),this.tickLineGroupSelection.update(this.tick.enabled?t:[]),this.tickLabelGroupSelection.update(this.label.enabled?t:[]),this.gridLineGroupSelection.cleanup(),this.tickLineGroupSelection.cleanup(),this.tickLabelGroupSelection.cleanup()}updatePosition(){super.updatePosition();const{translation:t,radiusLineGroup:e}=this,i=Math.floor(t.x),o=Math.floor(t.y);e.translationX=i,e.translationY=o}updateRadiusLine(){const t=this.radiusLine,{path:e}=t;e.clear(!0);const{points:i,closePath:o}=this.getAxisLinePoints();i.forEach(({x:s,y:a,moveTo:n,arc:r,radius:l=0,startAngle:c=0,endAngle:h=0})=>{r?e.arc(s,a,l,c,h):n?e.moveTo(s,a):e.lineTo(s,a)}),o&&e.closePath(),t.visible=this.line.enabled,t.stroke=this.line.stroke,t.strokeWidth=this.line.width,t.fill=void 0}getAxisLinePoints(){const{scale:t,shape:e,gridLength:i}=this,[o,s]=this.range,a=ia(s-o,2*Math.PI),n=[];if(e==="circle")a?n.push({x:i,y:0,moveTo:!0},{x:0,y:0,radius:i,startAngle:0,endAngle:2*Math.PI,arc:!0,moveTo:!1}):n.push({x:i*Math.cos(o),y:i*Math.sin(o),moveTo:!0},{x:0,y:0,radius:i,startAngle:ko(o),endAngle:ko(s),arc:!0,moveTo:!1});else if(e==="polygon"){const r=t.ticks({nice:this.nice,interval:void 0,tickCount:void 0,minTickCount:0,maxTickCount:1/0})?.ticks?.map(l=>t.convert(l));r&&r.length>2&&r.forEach((l,c)=>{const h=i*Math.cos(l),d=i*Math.sin(l),u=c===0;n.push({x:h,y:d,moveTo:u})})}return{points:n,closePath:a}}updateGridLines(){const{scale:t,gridLength:e,gridLine:{style:i,width:o},innerRadiusRatio:s}=this;if(!(i&&e>0))return;const a=e*s,n=i.length;this.gridLineGroupSelection.each((r,l,c)=>{const{value:h}=l,{stroke:d,lineDash:u}=i[c%n],g=t.convert(h);r.x1=a*Math.cos(g),r.y1=a*Math.sin(g),r.x2=e*Math.cos(g),r.y2=e*Math.sin(g),r.stroke=d,r.strokeWidth=o,r.lineDash=u,r.fill=void 0}),this.gridLineGroupSelection.cleanup()}updateLabels(){const{label:t,tickLabelGroupSelection:e}=this;e.each((i,o,s)=>{const a=this.labelData[s];if(!a||a.hidden){i.visible=!1;return}i.text=a.text,i.setFont(t),i.fill=t.color,i.x=a.x,i.y=a.y,i.setAlign(a),i.setBoxing(t),i.visible=!0,a.rotation?(i.rotation=a.rotation,i.rotationCenterX=a.x,i.rotationCenterY=a.y):i.rotation=0})}updateTickLines(){const{scale:t,gridLength:e,tick:i,tickLineGroupSelection:o}=this;o.each((s,a)=>{const{value:n}=a,r=t.convert(n),l=Math.cos(r),c=Math.sin(r);s.x1=e*l,s.y1=e*c,s.x2=(e+i.size)*l,s.y2=(e+i.size)*c,s.stroke=i.stroke,s.strokeWidth=i.width})}createLabelNodeData(t,e,i){const{label:o,gridLength:s,scale:a,tick:n}=this;if(!o.enabled)return[];const r=new sD,l=i.x-this.translation.x,c=i.x+i.width-this.translation.x,{fractionDigits:h}=this.layout.label,d=this.tickFormatter(this.scale.domain,this.tickData,!1,h),u=t.map((g,y)=>{const{value:f}=g,x=s+o.spacing+n.size,S=a.convert(f),v=Math.cos(S),m=Math.sin(S),b=x*v,M=x*m,{textAlign:k,textBaseline:A}=this.getLabelAlign(S),D=y===t.length-1&&f!==t[0]&&ia(ko(S),ko(a.convert(t[0]))),I=this.getLabelRotation(S);let L=d(f,y);r.text=L,r.x=b,r.y=M,r.setFont(o),r.textAlign=k,r.textBaseline=A,r.rotation=I,I&&(r.rotationCenterX=b,r.rotationCenterY=M);let C=I?aD.toCanvas(r):r.getBBox();if(C&&e.hideWhenNecessary&&!I){const w=l-C.x,P=C.x+C.width-c,E=1;if(w>E||P>E){const R={maxWidth:C.width-Math.max(w,P),font:o,textWrap:"never"};L=HM(L)?WM(L,R):GM(L,R),r.text=L,C=r.getBBox()}}return{text:L,x:b,y:M,textAlign:k,textBaseline:A,hidden:L===""||g.hidden||D,rotation:I,box:C}});return o.avoidCollisions&&this.avoidLabelCollisions(u),u}computeLabelsBBox(t,e){this.labelData=this.createLabelNodeData(this.tickData,t,e);const i=this.labelData.map(({box:o})=>o).filter(o=>o!=null);return!this.label.enabled||i.length===0?null:nD.merge(i)}getLabelOrientation(){const{label:t}=this;return t instanceof uh?t.orientation:"fixed"}getLabelRotation(t){let e=on(this.label.rotation??0);t=ko(t);const i=this.getLabelOrientation();return i==="parallel"?(e+=t,t>=0&&t<Math.PI?e-=Math.PI/2:e+=Math.PI/2):i==="perpendicular"&&(e+=t,t>=Math.PI/2&&t<1.5*Math.PI&&(e+=Math.PI)),e}getLabelAlign(t){const e=Math.cos(t),i=Math.sin(t);let o,s;const a=this.getLabelOrientation(),n=ia(e,0),r=ia(i,0),l=ia(e,1),c=ia(i,-1),h=e>0&&!n,d=i>0&&!r;return a==="parallel"?(o="center",s=l&&r||d?"top":"bottom"):a==="perpendicular"?(o=c||h?"left":"right",s="middle"):(o="right",n?o="center":h&&(o="left"),s="bottom",r?s="middle":d&&(s="top")),{textAlign:o,textBaseline:s}}updateCrossLines(){const{shape:t,gridLength:e,innerRadiusRatio:i}=this;this.crossLines.forEach(o=>{o instanceof ph&&(o.ticks=this.tickData.map(s=>s.value),o.shape=t,o.axisOuterRadius=e,o.axisInnerRadius=e*i)}),super.updateCrossLines()}};sn.CrossLineConstructor=ph,p([dh],sn.prototype,"startAngle",2),p([dh],sn.prototype,"endAngle",2);var{Property:gh,CategoryScale:rD}=RM,Ao=class extends sn{constructor(t){super(t,new rD),this.groupPaddingInner=0,this.paddingInner=0,this.interval=new lh}hasDefinedDomain(){return!1}generateAngleTicks(t){const{scale:e,gridLength:i}=this,{values:o,minSpacing:s}=this.interval,a={nice:this.nice,interval:void 0,tickCount:void 0,minTickCount:0,maxTickCount:1/0},n=o??e.ticks(a,t)?.ticks??[];if(n.length<2||s==null)return n.map(d=>({value:d,visible:!0}));const r=n[0],l=e.convert(r),c=i*Math.cos(l),h=i*Math.sin(l);for(let d=1;d<n.length-1;d++){const u=n[d],g=e.convert(u);if(g-l>Math.PI)break;const y=i*Math.cos(g),f=i*Math.sin(g);if(Math.sqrt((y-c)**2+(f-h)**2)>s){const S=new Set([r]);return rh(n,d,(v,m)=>{S.add(m)}),n.map(v=>{const m=S.has(v);return{value:v,visible:m}})}}return[{value:r,visible:!0}]}avoidLabelCollisions(t){const{minSpacing:e}=this.label;if(t.length<3)return;const i=(l,c)=>{if(l.hidden||c.hidden)return!1;if(e==null)return l.box.collidesBBox(c.box);const h=l.box.clone().grow(e/2),d=c.box.clone().grow(e/2);return h.collidesBBox(d)},o=t[0],s=t.at(-1),a=new Set([o]),n=Ku(o.x,s.x)&&Ku(o.y,s.y),r=Math.floor(t.length/2);for(let l=1;l<=r;l++){const c=n?t.slice(0,-1):t;if(!rh(c,l,i)){rh(c,l,(d,u)=>{a.add(u)});break}}t.forEach(l=>{a.has(l)||(l.hidden=!0,l.box=void 0)})}tickFormatParams(){return{type:"category"}}datumFormatParams(t,e){const{datum:i,seriesId:o,legendItemName:s,key:a,source:n,property:r,domain:l,boundSeries:c}=e;return{type:"category",value:t,datum:i,seriesId:o,legendItemName:s,key:a,source:n,property:r,domain:l,boundSeries:c}}};Ao.className="AngleCategoryAxis",Ao.type="angle-category",p([gh],Ao.prototype,"groupPaddingInner",2),p([gh],Ao.prototype,"paddingInner",2),p([gh],Ao.prototype,"interval",2);var lD={type:"axis",optionsKey:"axes[]",packageType:"enterprise",chartTypes:["polar"],identifier:"angle-category",moduleFactory:t=>new Ao(t)};import{_ModuleSupport as cD}from"ag-charts-community";import{isNumberEqual as qu}from"ag-charts-core";import{_ModuleSupport as hD}from"ag-charts-community";import{isNumberEqual as pD}from"ag-charts-core";var{range:Qu,isDenseInterval:dD,LinearScale:yh}=hD,Ju=class Vu extends yh{constructor(){super(...arguments),this.arcLength=0}static getNiceStepAndTickCount(e,i){const[o,s]=i;let a=yh.getTickStep(o,s,e);const n=isNaN(e.maxTickCount)?1/0:e.maxTickCount,r=Math.abs(s-o)/a;let l=Math.pow(2,Math.ceil(Math.log(r)/Math.log(2)));return l>n&&(l/=2,a*=2),{count:l,step:a}}ticks(e,i=this.domain){const{arcLength:o}=this;if(!i||i.length<2||i.some(c=>!isFinite(c))||o<=0)return{ticks:[],count:0};const{nice:s,interval:a}=e,[n,r]=i;if(a){const c=Math.abs(a),h=this.getPixelRange();if(!dD((r-n)/c,h))return Qu(n,r,c)}let l;if(s&&this.hasNiceRange()){const c=super.niceDomain(e,i);l=Vu.getNiceStepAndTickCount(e,c).step}else l=yh.getTickStep(n,r,e);return Qu(n,r,l)}hasNiceRange(){const e=this.range.slice().sort((o,s)=>o-s);return[Math.PI,2*Math.PI].some(o=>pD(o,e[1]-e[0]))}niceDomain(e,i=this.domain){const o=super.niceDomain(e,i);if(!this.hasNiceRange())return o;const s=o[0]>o[1],a=s?o[1]:o[0],{step:n,count:r}=Vu.getNiceStepAndTickCount(e,o),l=1/n,c=n>=1?Math.ceil(a/n+r)*n:Math.ceil((a+r*n)*l)/l;return s?[c,a]:[a,c]}getPixelRange(){return this.arcLength}},{Property:fh,angleBetween:uD,normalisedExtentWithMetadata:gD,findMinMax:yD}=cD,ns=class extends sn{constructor(t){super(t,new Ju),this.shape="circle",this.interval=new lh}hasDefinedDomain(){const{min:t,max:e}=this;return t!=null&&e!=null&&t<e}normaliseDataDomain(t){const{min:e,max:i}=this,{extent:o,clipped:s}=gD(t,e,i);return{domain:o,clipped:s}}updateScale(){super.updateScale(),this.scale.arcLength=this.getRangeArcLength()}getRangeArcLength(){const{range:t}=this,e=Math.min(...t),i=Math.max(...t),o=uD(e,i)||2*Math.PI,s=this.gridLength;return o*s}generateAngleTicks(t){const{scale:e,range:i,nice:o}=this,{values:s,step:a,minSpacing:n,maxSpacing:r}=this.interval;let l;if(s==null){const{arcLength:c}=e,h=r?Math.floor(c/r):1,d=n?Math.floor(c/n):1/0,u=Math.floor(4/Math.PI*Math.abs(i[0]-i[1])),g=Math.max(h,Math.min(d,u)),y={nice:o,interval:a,tickCount:g,minTickCount:h,maxTickCount:d};l=e.ticks(y,t)?.ticks??[]}else{const[c,h]=yD(t.map(Number));l=s.filter(d=>d>=c&&d<=h).sort((d,u)=>d-u)}return l.map(c=>({value:c,visible:!0}))}avoidLabelCollisions(t){const{minSpacing:e}=this.label,i=(a,n)=>{if(a.hidden||n.hidden)return!1;if(e==null)return a.box.collidesBBox(n.box);const r=a.box.clone().grow(e/2),l=n.box.clone().grow(e/2);return r.collidesBBox(l)},o=t[0],s=t.at(-1);o!==s&&qu(o.x,s.x)&&qu(o.y,s.y)&&(s.hidden=!0);for(let a=1;a<t.length;a*=2){let n=!1;for(let r=a;r<t.length;r+=a){const l=t[r],c=t[r-a];if(i(c,l)){n=!0;break}}if(!n){t.forEach((r,l)=>{l%a>0&&(r.hidden=!0,r.box=void 0)});return}}t.forEach((a,n)=>{n>0&&(a.hidden=!0,a.box=void 0)})}tickFormatParams(t,e,i){return{type:"number",fractionDigits:i}}datumFormatParams(t,e,i){const{datum:o,seriesId:s,legendItemName:a,key:n,source:r,property:l,domain:c,boundSeries:h}=e;return{type:"number",value:t,datum:o,seriesId:s,legendItemName:a,key:n,source:r,property:l,domain:c,boundSeries:h,fractionDigits:i}}};ns.className="AngleNumberAxis",ns.type="angle-number",p([fh],ns.prototype,"min",2),p([fh],ns.prototype,"max",2),p([fh],ns.prototype,"interval",2);var fD={type:"axis",optionsKey:"axes[]",packageType:"enterprise",chartTypes:["polar"],identifier:"angle-number",moduleFactory:t=>new ns(t)};import{_ModuleSupport as tg}from"ag-charts-community";var{OrdinalTimeScale:mD,Property:xD,TimeAxisParentLevel:SD,lowestGranularityUnitForTicks:bD,lowestGranularityUnitForValue:vD,minimumTimeAxisDatumGranularity:MD,dateTruncationForDomain:DD,intervalUnit:eg,intervalStep:ig,intervalEpoch:og,intervalMilliseconds:sg}=tg,an=class extends tg.DiscreteTimeAxis{constructor(t){super(t,new mD),this.parentLevel=new SD}get primaryLabel(){return this.parentLevel.enabled?this.parentLevel.label:void 0}get primaryTick(){return this.parentLevel.enabled?this.parentLevel.tick:void 0}processData(){super.processData();const{boundSeries:t,direction:e}=this;this.minimumTimeGranularity=MD(t,e,void 0,void 0)}tickFormatParams(t,e,i,o){o??(o=bD(e));const s=DD(t),a=eg(o),n=ig(o),r=og(o);return{type:"date",unit:a,step:n,epoch:r,truncateDate:s}}datumFormatParams(t,e,i,o,s){if(typeof t=="number"&&(t=new Date(t)),o==null){const{minimumTimeGranularity:x}=this,S=vD(t);x!=null&&sg(x)<sg(S)?o=x:o=S}const{datum:a,seriesId:n,legendItemName:r,key:l,source:c,property:h,domain:d,boundSeries:u}=e,g=eg(o),y=ig(o),f=og(o);return{type:"date",value:t,datum:a,seriesId:n,legendItemName:r,key:l,source:c,property:h,domain:d,boundSeries:u,unit:g,step:y,epoch:f,style:s}}};an.className="OrdinalTimeAxis",an.type="ordinal-time",p([xD],an.prototype,"parentLevel",2);var kD={type:"axis",optionsKey:"axes[]",packageType:"enterprise",chartTypes:["cartesian"],identifier:"ordinal-time",moduleFactory:t=>new an(t)};import{_ModuleSupport as AD}from"ag-charts-community";import{_ModuleSupport as hr}from"ag-charts-community";import{isNumberEqual as LD}from"ag-charts-core";import{_ModuleSupport as ag}from"ag-charts-community";import{clamp as ng,isNumberEqual as ID}from"ag-charts-core";var{ChartAxisDirection:CD,Property:TD,validateCrossLineValue:wD,normalizeAngle360FromDegrees:ND,Group:PD,Path:ED,Sector:_D,RotatableText:OD}=ag,rg=class extends yi{constructor(){super(...arguments),this.positionAngle=void 0}};p([TD],rg.prototype,"positionAngle",2);var mh=class extends xe{constructor(){super(),this.direction=CD.Radius,this.label=new rg,this.polygonNode=new ED,this.sectorNode=new _D,this.crossLineRange=new PD,this.labelNode=new OD,this.outerRadius=0,this.innerRadius=0,this.crossLineRange.append(this.polygonNode),this.crossLineRange.append(this.sectorNode),this.labelGroup.append(this.labelNode)}update(t){const{scale:e}=this;if(!e||!wD(this,e)){this.rangeGroup.visible=!1,this.lineGroup.visible=!1,this.labelGroup.visible=!1;return}this.updateRadii();const{innerRadius:i,outerRadius:o}=this;t&&(t=i>=this.axisInnerRadius&&o<=this.axisOuterRadius),this.rangeGroup.visible=t,this.lineGroup.visible=t,this.labelGroup.visible=t,this.updatePolygonNode(t),this.updateSectorNode(t),this.updateLabelNode(t),this.assignCrossLineGroup(this.type==="range",this.crossLineRange)}updateRadii(){const{range:t,scale:e,type:i,axisInnerRadius:o,axisOuterRadius:s}=this;if(!e)return{innerRadius:0,outerRadius:0};const a=l=>s+o-l;let n,r;if(i==="line")n=a(e.convert(this.value)),r=n;else{const l=Math.abs(e?.bandwidth??0),c=t.map(h=>e.convert(h));n=a(Math.max(...c)),r=a(Math.min(...c))+l}this.outerRadius=n,this.innerRadius=r}drawPolygon(t,e,i){e.forEach((o,s)=>{const a=t*Math.cos(o),n=t*Math.sin(o);s===0?i.path.moveTo(a,n):i.path.lineTo(a,n)}),i.path.closePath()}updatePolygonNode(t){const{gridAngles:e,polygonNode:i,scale:o,shape:s,type:a,innerRadius:n,outerRadius:r}=this;if(!t||s!=="polygon"||!o||!e){i.visible=!1;return}i.visible=!0;const l=this.getPadding();i.path.clear(!0),this.drawPolygon(r-l,e,i);const c=e.slice().reverse(),h=a==="line"?r-l:n+l;this.drawPolygon(h,c,i),this.setSectorNodeProps(i)}updateSectorNode(t){const{axisInnerRadius:e,axisOuterRadius:i,scale:o,sectorNode:s,shape:a,innerRadius:n,outerRadius:r}=this;if(!t||a!=="circle"||!o){s.visible=!1;return}s.visible=!0,s.startAngle=0,s.endAngle=2*Math.PI;const l=this.getPadding(),c=ng(e,n+l,i),h=ng(e,r-l,i);s.innerRadius=Math.min(c,h),s.outerRadius=Math.max(c,h),this.setSectorNodeProps(s)}updateLabelNode(t){const{innerRadius:e,label:i,labelNode:o,scale:s,shape:a,type:n}=this;if(!t||i.enabled===!1||!i.text||!s){o.visible=!1;return}const r=ND((i.positionAngle??0)-90),l=(ID(r,0)||r>0)&&r<Math.PI,c=l?r-Math.PI/2:r+Math.PI/2;let h;const d=this.gridAngles??[];n==="line"?h=e+i.padding:a==="circle"||d.length<3?h=e-i.padding:h=e*Math.cos(Math.PI/d.length)-i.padding;const u=h*Math.cos(r),g=h*Math.sin(r);let y;n==="line"?y=l?"top":"bottom":y=l?"bottom":"top",this.setLabelNodeProps(o,u,g,y,c)}getPadding(){const{scale:t}=this;if(!t)return 0;const e=Math.abs(t.bandwidth??0),i=Math.abs(t.step??0);return t instanceof ag.BandScale?(i-e)/2:0}};mh.className="RadiusCrossLine";var{ChartAxisDirection:RD,ZIndexMap:BD,Property:xh,normalizeAngle360:lg,toRadians:zD,Caption:FD,Group:VD,TransformableGroup:cg,Path:HD,Line:hg,Selection:pg,generateTicks:GD,AxisGroupZIndexMap:WD}=hr,Sh=class extends hr.AxisLabel{constructor(){super(...arguments),this.autoRotateAngle=335}};p([xh],Sh.prototype,"autoRotate",2),p([xh],Sh.prototype,"autoRotateAngle",2);var pr=class extends hr.PolarAxis{constructor(t,e){super(t,e),this.positionAngle=0,this.gridLineGroupSelection=pg.select(this.gridLineGroup,hg,!1),this.generatedTicks=void 0,this.headingLabelGroup=this.axisGroup.appendChild(new cg({name:`${this.id}-Axis-heading`})),this.lineNodeGroup=this.axisGroup.appendChild(new cg({name:`${this.id}-Axis-line`})),this.lineNode=this.lineNodeGroup.appendChild(new hg({name:`${this.id}-Axis-line`,zIndex:WD.AxisLine})),this.gridPathGroup=this.gridGroup.appendChild(new VD({name:`${this.id}-gridPaths`,zIndex:BD.AXIS_GRID})),this.gridPathSelection=pg.select(this.gridPathGroup,HD),this.headingLabelGroup.appendChild(this.title.caption.node),this.cleanup.register(this.title.caption.registerInteraction(this.moduleCtx,"afterend"))}get direction(){return RD.Radius}getAxisTransform(){const t=this.scale.range[0],{translation:e,positionAngle:i,innerRadiusRatio:o}=this,s=t*o,a=zD(i);return{translationX:e.x,translationY:e.y-t-s,rotation:a,rotationCenterX:0,rotationCenterY:t+s}}update(){super.update(),this.updateTitle(),this.updateGridLines();const{enabled:t,stroke:e,width:i}=this.line;this.lineNode.setProperties({stroke:e,strokeWidth:t?i:0,x1:0,y1:this.range[0],x2:0,y2:this.range[1]})}updatePosition(){super.updatePosition();const t=this.getAxisTransform();this.tickLineGroup.setProperties(t),this.tickLabelGroup.setProperties(t),this.lineNodeGroup.setProperties(t),this.headingLabelGroup.setProperties(t)}calculateRotations(){return{rotation:0,parallelFlipRotation:0,regularFlipRotation:-Math.PI/2}}calculateTickLayout(t,e,i){const o=[0,1],s=this.label.getSideFlag(),a=s*(this.getTickSize()+this.label.spacing+this.seriesAreaPadding),{range:n,reverse:r,defaultTickMinSpacing:l}=this,c=GD({scale:this.scale,label:this.label,interval:this.interval,tickFormatter:(...v)=>this.tickFormatter(...v),domain:t,range:n,reverse:r,niceMode:e,visibleRange:o,defaultTickMinSpacing:l,labelOffset:a,sideFlag:s,axisRotation:0,sizeLimit:void 0,primaryTickCount:void 0}),{tickData:h}=c,{ticks:d,rawTicks:u,rawTickCount:g,tickDomain:y,fractionDigits:f,niceDomain:x=t}=h,S=d.map(v=>this.getTickLabelProps(v,c));return this.generatedTicks={ticks:d,labels:S},{ticks:u,tickDomain:y,niceDomain:x,rawTickCount:g,fractionDigits:f,timeInterval:void 0}}updateSelections(){const{generatedTicks:t}=this;if(!t)return;const{ticks:e,labels:i}=t;this.gridLineGroupSelection.update(this.gridLength?e:[]),this.tickLabelGroupSelection.update(i),this.gridPathSelection.update(this.gridLine.enabled?this.prepareGridPathTickData(e):[]),this.gridLineGroupSelection.cleanup(),this.tickLabelGroupSelection.cleanup(),this.gridPathSelection.cleanup()}updateLabels(){if(!this.label.enabled)return;const t=hr.resetAxisLabelSelectionFn();this.tickLabelGroupSelection.each((e,i)=>{e.fill=i.color,e.text=i.text,e.textBaseline=i.textBaseline,e.textAlign=i.textAlign??"center",e.setFont(i),e.setBoxing(i),e.setProperties(t(e,i))})}updateGridLines(){const{gridLine:{style:t,width:e},shape:i,generatedTicks:o}=this;if(!t||!o)return;const s=t.length,a=(u,g)=>{const{stroke:y,lineDash:f}=t[g%s];u.stroke=y,u.strokeWidth=e,u.lineDash=f,u.fill=void 0},[n,r]=this.gridRange??[0,2*Math.PI],l=LD(r-n,2*Math.PI),d=i==="circle"?(u,g)=>{const{path:y}=u;y.clear(!0);const f=this.getTickRadius(g);l?(y.moveTo(f,0),y.arc(0,0,f,0,2*Math.PI)):(y.moveTo(f*Math.cos(n),f*Math.sin(n)),y.arc(0,0,f,lg(n),lg(r))),l&&y.closePath()}:(u,g)=>{const{path:y}=u,f=this.gridAngles;if(y.clear(!0),!f||f.length<3)return;const x=this.getTickRadius(g);f.forEach((S,v)=>{const m=x*Math.cos(S),b=x*Math.sin(S);v===0?y.moveTo(m,b):y.lineTo(m,b),f.forEach((M,k)=>{const A=x*Math.cos(M),D=x*Math.sin(M);k===0?y.moveTo(A,D):y.lineTo(A,D)}),y.closePath()}),y.closePath()};this.gridPathSelection.each((u,g,y)=>{a(u,y),d(u,g)})}updateTitle(){const t=n=>n.defaultValue,{title:e,range:i}=this,{formatter:o=t}=this.title;e.caption.enabled=e.enabled,e.caption.fontFamily=e.fontFamily,e.caption.fontSize=e.fontSize,e.caption.fontStyle=e.fontStyle,e.caption.fontWeight=e.fontWeight,e.caption.color=e.color,e.caption.wrapping=e.wrapping;let s=!1;const a=e.caption.node;e.enabled&&(s=!0,a.rotation=Math.PI/2,a.x=Math.floor((i[0]+i[1])/2),a.y=-FD.SMALL_PADDING,a.textAlign="center",a.textBaseline="bottom",a.text=this.cachedCallWithContext(o,this.getTitleFormatterParams(this.scale.domain))),a.visible=s}updateCrossLines(){this.crossLines.forEach(t=>{if(t instanceof mh){const{shape:e,gridAngles:i,range:o,innerRadiusRatio:s}=this,a=o[0];t.shape=e,t.gridAngles=i,t.axisOuterRadius=a,t.axisInnerRadius=a*s}}),super.updateCrossLines()}createLabel(){return new Sh}getTickLabelProps(t,e){const{label:i}=this,{rotation:o,textBaseline:s,textAlign:a}=e,n=this.scale.range,r=t.tickLabel??"",c=i.getSideFlag()*(this.getTickSize()+i.spacing+this.seriesAreaPadding),h=r!==""&&r!=null,d=o;return{...this.getLabelStyles({value:t.tick,formattedValue:t.tickLabel}),tickId:t.tickId,rotation:d,text:r,textAlign:a,textBaseline:s,visible:h,x:c,y:t.translation,rotationCenterX:c,rotationCenterY:t.translation,range:n}}};pr.CrossLineConstructor=mh,p([xh],pr.prototype,"positionAngle",2);var{ProxyPropertyOnWrite:dg,Property:bh,CategoryScale:ug}=AD,Lo=class extends pr{constructor(t){super(t,new ug),this.shape="circle",this.groupPaddingInner=0,this.paddingInner=0,this.paddingOuter=0}hasDefinedDomain(){return!1}normaliseDataDomain(t){return{domain:t,clipped:!1}}prepareGridPathTickData(t){return t.slice().reverse()}getTickRadius(t){const{scale:e,innerRadiusRatio:i}=this,o=e.range[0],s=o*i;if(ug.is(e)){const a=e.domain,n=a.length-1-a.indexOf(t.tick);return n===0?s:e.inset+e.step*(n-.5)+e.bandwidth/2}else{const a=(o-s)/e.domain.length;return o-t.translation+s-a/2}}tickFormatParams(){return{type:"category"}}datumFormatParams(t,e){const{datum:i,seriesId:o,legendItemName:s,key:a,source:n,property:r,domain:l,boundSeries:c}=e;return{type:"category",value:t,datum:i,seriesId:o,legendItemName:s,key:a,source:n,property:r,domain:l,boundSeries:c}}};Lo.className="RadiusCategoryAxis",Lo.type="radius-category",p([bh],Lo.prototype,"groupPaddingInner",2),p([dg("scale","paddingInner"),bh],Lo.prototype,"paddingInner",2),p([dg("scale","paddingOuter"),bh],Lo.prototype,"paddingOuter",2);var KD={type:"axis",optionsKey:"axes[]",packageType:"enterprise",chartTypes:["polar"],identifier:"radius-category",moduleFactory:t=>new Lo(t)};import{_ModuleSupport as $D}from"ag-charts-community";var{Property:gg,normalisedExtentWithMetadata:jD,LinearScale:YD}=$D,oa=class extends pr{constructor(t){super(t,new YD),this.shape="polygon"}hasDefinedDomain(){const{min:t,max:e}=this;return t!=null&&e!=null&&t<e}prepareGridPathTickData(t){const{scale:e}=this,i=e.domain[1];return t.filter(({tick:o})=>o!==i).sort((o,s)=>s.tick-o.tick)}getTickRadius(t){const{scale:e}=this,i=e.range[0],o=i*this.innerRadiusRatio;return i-t.translation+o}normaliseDataDomain(t){const{min:e,max:i}=this,{extent:o,clipped:s}=jD(t,e,i);return{domain:o,clipped:s}}tickFormatParams(t,e,i){return{type:"number",fractionDigits:i}}datumFormatParams(t,e,i){const{datum:o,seriesId:s,legendItemName:a,key:n,source:r,property:l,domain:c,boundSeries:h}=e;return{type:"number",value:t,datum:o,seriesId:s,legendItemName:a,key:n,source:r,property:l,domain:c,boundSeries:h,fractionDigits:i}}};oa.className="RadiusNumberAxis",oa.type="radius-number",p([gg],oa.prototype,"min",2),p([gg],oa.prototype,"max",2);var UD={type:"axis",optionsKey:"axes[]",packageType:"enterprise",chartTypes:["polar"],identifier:"radius-number",moduleFactory:t=>new oa(t)};import{_ModuleSupport as yg}from"ag-charts-community";var{ObserveChanges:vh,Property:Mh}=yg,dr=class extends yg.BaseModuleInstance{constructor(t){super(),this.ctx=t,this.enabled=!0,t.animationManager.skip(!1),this.cleanup.register(()=>{t.animationManager.skip(!0)})}};p([vh((t,e)=>{t.ctx.animationManager.skip(!e)}),Mh],dr.prototype,"enabled",2),p([vh((t,e)=>{t.ctx.animationManager.defaultDuration=e}),Mh],dr.prototype,"duration",2),p([vh((t,e)=>{t.ctx.animationManager.maxAnimatableItems=e??1/0}),Mh],dr.prototype,"maxAnimatableItems",2);var XD={type:"root",optionsKey:"animation",packageType:"enterprise",chartTypes:["cartesian","polar","topology","standalone"],moduleFactory:t=>new dr(t),themeTemplate:{animation:{enabled:!0,maxAnimatableItems:1e3}}};import{_ModuleSupport as ur}from"ag-charts-community";import{isValidDate as Dh}from"ag-charts-core";import{_ModuleSupport as kh}from"ag-charts-community";import{attachListener as ZD,setAttributes as qD}from"ag-charts-core";var QD='<div contenteditable="plaintext-only" class="ag-charts-text-input__textarea" tabindex="0"></div>',{focusCursorAtEnd:JD}=kh,fg="text-input",mg="canvas-overlay",tk=class extends kh.BaseModuleInstance{constructor(t){super(),this.ctx=t,this.layout={getTextInputCoords:()=>({x:0,y:0}),getTextPosition:()=>"center",alignment:"center",textAlign:"center"},this.visible=!1,this.element=t.domManager.addChild(mg,fg),this.element.classList.add("ag-charts-text-input"),this.cleanup.register(()=>t.domManager.removeChild(mg,fg))}setKeyDownHandler(t){this.cleanup.register(ZD(this.element,"keydown",t))}show(t){this.element.innerHTML=QD;const e=this.element.firstElementChild;qD(e,{role:"textbox","data-preventdefault":!1}),e.isContentEditable||(e.contentEditable="true"),e.setAttribute("placeholder",this.ctx.localeManager.t(t.placeholderText??"inputTextareaPlaceholder")),t.styles?.placeholderColor&&e.style.setProperty("--placeholder-text-color",t.styles?.placeholderColor),e.innerText=t.text??"",e.style.color=t.styles?.color??"inherit",e.style.fontFamily=t.styles?.fontFamily??"inherit",e.style.fontSize=t.styles?.fontSize?`${t.styles.fontSize}px`:"inherit",e.style.fontStyle=t.styles?.fontStyle??"inherit",e.style.fontWeight=typeof t.styles?.fontWeight=="number"?`${t.styles.fontWeight}`:t.styles?.fontWeight??"inherit",JD(e),e.addEventListener("input",()=>{this.updatePosition(),t.onChange?.(this.getValue(),this.getBBox())}),e.addEventListener("click",i=>{i.stopPropagation()}),t.layout&&(this.layout=t.layout,this.updatePosition()),t.onChange?.(this.getValue(),this.getBBox()),this.visible=!0}hide(){this.element.innerHTML="",this.layout={getTextInputCoords:()=>({x:0,y:0}),getTextPosition:()=>"center",alignment:"center",textAlign:"center"},this.visible=!1}isVisible(){return this.visible}updateColor(t){this.element.firstElementChild&&(this.element.firstElementChild.style.color=t)}updateFontSize(t){if(this.element.firstElementChild)return this.element.firstElementChild.style.fontSize=`${t}px`,this.updatePosition(),this.getBBox()}getValue(){if(this.element.firstElementChild)return this.element.firstElementChild.innerText.trim()}updatePosition(){const{element:t}=this,e=t.firstElementChild;if(!e)return;const i=this.ctx.domManager.getBoundingClientRect(),{width:o,getTextInputCoords:s,getTextPosition:a,alignment:n,textAlign:r}=this.layout;t.style.setProperty("width",o?`${o}px`:"unset");const l=e.getBoundingClientRect(),c=s(l.height);let h=c.x;n==="center"?h-=(o??l.width)/2:n==="right"&&(h-=o??l.width);const d=a();let u=c.y;d==="center"?u-=l.height/2:d==="bottom"&&(u-=l.height),t.style.setProperty("top",`${u}px`),t.style.setProperty("left",`${h}px`),t.style.setProperty("max-width",`${i.width-h}px`),t.style.setProperty("text-align",n),e.style.setProperty("text-align",r)}getBBox(){const{left:t,top:e,width:i,height:o}=this.element.getBoundingClientRect();return new kh.BBox(t,e,i,o)}};import{_ModuleSupport as ek}from"ag-charts-community";var{BaseProperties:ik,Property:xg}=ek,Ah=class extends ik{constructor(){super(...arguments),this.enabled=!1,this.axes="y"}};p([xg],Ah.prototype,"enabled",2),p([xg],Ah.prototype,"axes",2);import{_ModuleSupport as ok}from"ag-charts-community";var Lh=(t=>(t.Line="line",t.HorizontalLine="horizontal-line",t.VerticalLine="vertical-line",t.DisjointChannel="disjoint-channel",t.ParallelChannel="parallel-channel",t.FibonacciRetracement="fibonacci-retracement",t.FibonacciRetracementTrendBased="fibonacci-retracement-trend-based",t.Callout="callout",t.Comment="comment",t.Note="note",t.Text="text",t.Arrow="arrow",t.ArrowUp="arrow-up",t.ArrowDown="arrow-down",t.DateRange="date-range",t.PriceRange="price-range",t.DatePriceRange="date-price-range",t.QuickDatePriceRange="quick-date-price-range",t))(Lh||{}),sk=Object.values(Lh);function ak(t){for(const e of sk)if(e===t)return e}import{isObject as nk}from"ag-charts-core";import{_ModuleSupport as rk}from"ag-charts-community";import{isObject as lk}from"ag-charts-core";import{_ModuleSupport as ck}from"ag-charts-community";import{generateUUID as hk}from"ag-charts-core";var{BaseProperties:Io,FONT_SIZE:pk,Property:et}=ck,nn=class extends Io{};p([et],nn.prototype,"x",2),p([et],nn.prototype,"y",2);var dk=class extends he(qi(Mg(Io))){},Ih=class extends he(qi(Ni(wh(cs(Io))))){constructor(){super(...arguments),this.cornerRadius=2}};p([et],Ih.prototype,"enabled",2),p([et],Ih.prototype,"cornerRadius",2);var uk=class extends Ni(Io){},gk=class extends he(qi(Ni(Io))){},rs=class extends cs(Io){constructor(){super(...arguments),this.label="",this.position="top",this.alignment="left"}};p([et],rs.prototype,"label",2),p([et],rs.prototype,"position",2),p([et],rs.prototype,"alignment",2);var yk=class extends cs(Io){},rn=class extends cs(Io){constructor(){super(...arguments),this.label=""}};p([et],rn.prototype,"label",2),p([et],rn.prototype,"position",2),p([et],rn.prototype,"alignment",2);function ls(t){class e extends mk(Mg(t)){constructor(){super(...arguments),this.id=hk()}}return e}function Ch(t){class e extends t{constructor(){super(...arguments),this.start=new nn,this.end=new nn}}return p([et],e.prototype,"start",2),p([et],e.prototype,"end",2),e}function Sg(t){class e extends t{}return p([et],e.prototype,"x",2),p([et],e.prototype,"y",2),e}function bg(t){class e extends t{}return p([et],e.prototype,"value",2),e}function Th(t){class e extends t{constructor(){super(...arguments),this.background=new uk}}return p([et],e.prototype,"background",2),e}function Co(t){class e extends t{constructor(){super(...arguments),this.handle=new gk}}return p([et],e.prototype,"handle",2),e}function vg(t){class e extends t{constructor(){super(...arguments),this.axisLabel=new Ih}}return p([et],e.prototype,"axisLabel",2),e}function wh(t){class e extends t{constructor(){super(...arguments),this.padding=void 0,this.textAlign="center",this.formatter=void 0}}return p([et],e.prototype,"padding",2),p([et],e.prototype,"textAlign",2),p([et],e.prototype,"formatter",2),e}function fk(t){class e extends t{}return e}function Nh(t){class e extends t{}return p([et],e.prototype,"extendStart",2),p([et],e.prototype,"extendEnd",2),e}function mk(t){class e extends t{isWriteable(){return!this.locked&&!this.readOnly}isHoverable(){return!this.readOnly}}return p([et],e.prototype,"locked",2),p([et],e.prototype,"readOnly",2),e}function Ph(t){class e extends t{setLocaleManager(o){this.localeManager??(this.localeManager=o)}}return e}function Mg(t){class e extends t{}return p([et],e.prototype,"visible",2),e}function Ni(t){class e extends t{}return p([et],e.prototype,"fill",2),p([et],e.prototype,"fillOpacity",2),e}function he(t){class e extends t{}return p([et],e.prototype,"stroke",2),p([et],e.prototype,"strokeOpacity",2),p([et],e.prototype,"strokeWidth",2),e}function qi(t){class e extends t{constructor(){super(...arguments),this.lineCap=void 0,this.computedLineDash=void 0}}return p([et],e.prototype,"lineDash",2),p([et],e.prototype,"lineDashOffset",2),p([et],e.prototype,"lineStyle",2),e}function cs(t){class e extends t{constructor(){super(...arguments),this.fontSize=pk.SMALL,this.fontFamily="Verdana, sans-serif"}}return p([et],e.prototype,"fontStyle",2),p([et],e.prototype,"fontWeight",2),p([et],e.prototype,"fontSize",2),p([et],e.prototype,"fontFamily",2),p([et],e.prototype,"color",2),e}import{_ModuleSupport as xk}from"ag-charts-community";import{isDate as Sk,isNumber as bk,isString as vk}from"ag-charts-core";function Dg(t){return bk(t)||vk(t)||Sk(t)?{value:t,groupPercentage:0}:t??{value:void 0,groupPercentage:0}}function Bt(t){return Dg(t)?.value}function Se(t,e){if(t.start==null||t.end==null)return;const i=bt(t.start,e),o=bt(t.end,e);if(!(i==null||o==null))return{x1:i.x,y1:i.y,x2:o.x,y2:o.y}}function bt(t,e){const i=Qi(t.x,e.xAxis),o=Qi(t.y,e.yAxis);return{x:i,y:o}}function Qi(t,e){if(t==null)return 0;const{value:i,groupPercentage:o}=Dg(t),{scale:s,snapToGroup:a}=e,n=s.bandwidth===0?s.step??0:s.bandwidth??0,r=a?n/2:n*o;return s.convert(i)+r}function be(t,e){const i=gr(t.x,e.xAxis),o=gr(t.y,e.yAxis);return{x:i,y:o}}function gr(t,e){const{scale:i}=e;if(e.continuous&&i.step==null)return e.scaleInvert(t);const o=e.scaleInvertNearest(t),s=i.bandwidth===0?i.step:i.bandwidth??0,a=i.convert(o),n=a+s,r=a===n?0:(t-a)/(n-a);return{value:o,groupPercentage:r}}import{_ModuleSupport as Mk}from"ag-charts-community";var{BaseProperties:Dk}=Mk,Eh=class extends ls(Ch(Co(Dk))){constructor(){super(...arguments),this.snapToAngle=45}getDefaultColor(t){}getDefaultOpacity(t){}},{Property:kk}=xk,kg=class extends Ph(wh(cs(Eh))){constructor(){super(...arguments),this.text="",this.position="top",this.alignment="left",this.placement="inside",this.placeholderText="inputTextareaPlaceholder"}getDefaultColor(t){return this.color}getDefaultOpacity(t){}getPlaceholderColor(){}getPadding(){const{padding:t=0}=this;return{top:t,right:t,bottom:t,left:t}}getText(){const t=this.text.length==0;let e=this.text;return t&&(e=this.placeholderText??"",this.localeManager&&(e=this.localeManager.t(e))),{text:e,isPlaceholder:t}}getTextInputCoords(t,e){return bt(this.end,t)}getTextPosition(){return this.position}};p([kk],kg.prototype,"text",2);var{Property:Ak,Color:Ag}=rk,Lk={top:6,right:12,bottom:9,left:12},fi=class extends Ni(he(kg)){constructor(){super(...arguments),this.type="callout",this.position="bottom",this.alignment="left"}static is(t){return lk(t)&&t.type==="callout"}getDefaultColor(t){switch(t){case"fill-color":return this.fill;case"line-color":return this.stroke;case"text-color":default:return this.color}}getDefaultOpacity(t){switch(t){case"fill-color":return this.fillOpacity;case"line-color":return this.strokeOpacity;case"text-color":default:return}}getPlaceholderColor(){const{r:t,g:e,b:i}=Ag.fromString(this.color??"#888888");return new Ag(t,e,i,.66).toString()}getPadding(){const{padding:t}=this;return t==null?{...Lk}:{top:t,right:t,bottom:t,left:t}}getTextInputCoords(t,e){const i=super.getTextInputCoords(t,e),o=this.getPadding(),s=o.left??0,a=o.bottom??0;return{x:i.x+s,y:i.y-a}}};p([Ak],fi.prototype,"type",2);import{_ModuleSupport as Ik}from"ag-charts-community";import{isObject as Ck}from"ag-charts-core";import{_ModuleSupport as Tk}from"ag-charts-community";var{BaseProperties:wk,Property:Nk}=Tk,yr=class extends ls(Sg(Co(wh(cs(wk))))){constructor(){super(...arguments),this.text="",this.position="top",this.alignment="left",this.placement="inside",this.placeholderText="inputTextareaPlaceholder"}getDefaultColor(t){return this.color}getDefaultOpacity(t){}getPlaceholderColor(){}getPadding(){const{padding:t=0}=this;return{top:t,right:t,bottom:t,left:t}}getText(){const t=this.text.length==0;return{text:t?this.placeholderText??"":this.text,isPlaceholder:t}}getTextInputCoords(t,e){return bt(this,t)}getTextPosition(){return this.position}};p([Nk],yr.prototype,"text",2);var{Property:Pk,Color:Lg}=Ik,fr={top:8,right:14,bottom:8,left:14},Pi=class extends Ni(he(yr)){constructor(){super(...arguments),this.type="comment",this.position="bottom",this.alignment="left"}static is(t){return Ck(t)&&t.type==="comment"}getDefaultColor(t){switch(t){case"fill-color":return this.fill;case"line-color":return this.stroke;case"text-color":default:return this.color}}getDefaultOpacity(t){switch(t){case"fill-color":return this.fillOpacity;case"line-color":return this.strokeOpacity;case"text-color":default:return}}getPlaceholderColor(){const{r:t,g:e,b:i}=Lg.fromString(this.color??"#888888");return new Lg(t,e,i,.66).toString()}getPadding(){const{padding:t,fontSize:e}=this;return t==null?{top:Math.max(e*.4,fr.top),bottom:Math.max(e*.4,fr.bottom),left:Math.max(e*.8,fr.left),right:Math.max(e*.8,fr.right)}:{top:t,right:t,bottom:t,left:t}}getTextInputCoords(t,e){const i=super.getTextInputCoords(t,e),o=this.getPadding();return{x:i.x+o.left,y:i.y-o.bottom}}};p([Pk],Pi.prototype,"type",2);import{_ModuleSupport as Ek}from"ag-charts-community";import{isObject as mr}from"ag-charts-core";import{_ModuleSupport as _k}from"ag-charts-community";var{Vec2:hs}=_k;function ln(t,e){return t?"dashed":e??"solid"}function Ig(t,e){switch(e){case"solid":return[];case"dashed":return[t*4,t*2];case"dotted":return[0,t*2]}}function sa(t,e,i,o){const s=ln(t,i);return e??t??Ig(o??1,s)}function aa(t,e,i){const o=ln(e,i);return t??o==="dotted"?"round":void 0}function Ok(t,e){const[i,o]=hs.from(t),s=e.height,a=hs.gradient(o,i,s),n=hs.intercept(o,a,s),r=[{x:i.x,y:s??0},{x:i.x,y:s==null?e.height:s-e.height}];if(a===1/0)return r;let l=[hs.intersectAtY(a,n,0,s),hs.intersectAtY(a,n,e.height,s),hs.intersectAtX(a,n,0,s),hs.intersectAtX(a,n,e.width,s)];return l=l.filter(c=>c.x>=e.x&&c.x<=e.width&&c.y>=e.y&&c.y<=e.height).sort((c,h)=>c.x===h.x?0:c.x<h.x?-1:1),l.length!==2?r:l}var{BaseProperties:_h,Property:Ie}=Ek,Rk=class extends he(_h){},Oh=class extends cs(Ni(he(_h))){constructor(){super(...arguments),this.divider=new Rk}};p([Ie],Oh.prototype,"divider",2);var Rh=class extends Ni(he(Co(_h))){constructor(){super(...arguments),this.statistics=new Oh}};p([Ie],Rh.prototype,"statistics",2);var na=class extends Ph(Th(he(qi(Eh)))){constructor(){super(...arguments),this.direction="both",this.hasDateRange=!1,this.hasPriceRange=!1,this.statistics=new Oh,this.getVolume=()=>{},this.text=new rs}getDefaultColor(t){switch(t){case"fill-color":return this.background.fill;case"line-color":return this.stroke;case"text-color":return this.text.color}}getDefaultOpacity(t){switch(t){case"fill-color":return this.background.fillOpacity;case"line-color":return this.strokeOpacity}}getLineDash(){return sa(this.lineDash,this.computedLineDash,this.lineStyle,this.strokeWidth)}getLineCap(){return aa(this.lineCap,this.lineDash,this.lineStyle)}};p([Ie],na.prototype,"statistics",2),p([Ie],na.prototype,"text",2);function Bh(t){class e extends t{constructor(){super(...arguments),this.hasDateRange=!0}}return e}function zh(t){class e extends t{constructor(){super(...arguments),this.hasPriceRange=!0}}return e}var Ze=class extends Bh(na){constructor(){super(...arguments),this.type="date-range",this.direction="horizontal"}static is(t){return mr(t)&&t.type==="date-range"}};p([Ie],Ze.prototype,"type",2),p([Ie],Ze.prototype,"extendAbove",2),p([Ie],Ze.prototype,"extendBelow",2);var qe=class extends zh(na){constructor(){super(...arguments),this.type="price-range",this.direction="vertical"}static is(t){return mr(t)&&t.type==="price-range"}};p([Ie],qe.prototype,"type",2),p([Ie],qe.prototype,"extendLeft",2),p([Ie],qe.prototype,"extendRight",2);var Ji=class extends Bh(zh(na)){constructor(){super(...arguments),this.type="date-price-range",this.direction="both"}static is(t){return mr(t)&&t.type==="date-price-range"}};p([Ie],Ji.prototype,"type",2);var Be=class extends Bh(zh(na)){constructor(){super(...arguments),this.type="quick-date-price-range",this.up=new Rh,this.down=new Rh,this.direction="both"}static is(t){return mr(t)&&t.type==="quick-date-price-range"}};p([Ie],Be.prototype,"type",2),p([Ie],Be.prototype,"up",2),p([Ie],Be.prototype,"down",2);import{_ModuleSupport as Bk}from"ag-charts-community";import{clamp as zk,isObject as Fk}from"ag-charts-core";import{_ModuleSupport as Vk}from"ag-charts-community";import{cachedTextMeasurer as Hk,calcLineHeight as Cg,wrapText as Gk}from"ag-charts-core";var{BBox:Wk}=Vk,xr=1.38;function Sr(t,e,i){return i?Gk(e,{maxWidth:i,font:t,textWrap:"always",avoidOrphans:!1}):e}function Kk(t,e){const{lineMetrics:i,width:o}=Hk(t).measureLines(e),s=i.length*Cg(t.fontSize,xr);return{width:o,height:s}}function Fh(t,e,i,o){let s=o?.width??0,a=o?.height??0;if(!o){const n=t.width!=null?Sr(t,e,t.width):e;({width:s,height:a}=Kk(t,n))}return new Wk(i.x,i.y,s,a)}function Tg(t,e,i,o,{x:s,y:a},n){const{visible:r=!0,fontFamily:l,fontSize:c=14,fontStyle:h,fontWeight:d,textAlign:u}=o,g=Cg(c,xr);n??(n=o.position=="center"?"middle":o.position);const y=i?o.getPlaceholderColor():o.color;t.setProperties({x:s,y:a,visible:r,text:e,fill:y,fontFamily:l,fontSize:c,fontStyle:h,fontWeight:d,textAlign:u,lineHeight:g,textBaseline:n})}var{BaseProperties:$k,Property:wg}=Bk,jk=10,Yk=11,Ng=20,Uk=22,Xk=10,Pg=Ng+Xk,Eg=34,Zk=class extends Ni(he($k)){},Ce=class extends Ni(he(yr)){constructor(){super(...arguments),this.type="note",this.background=new Zk,this.position="bottom",this.alignment="center",this.width=200}static is(t){return Fk(t)&&t.type==="note"}getDefaultColor(t){switch(t){case"line-color":return this.fill;case"text-color":return this.color}}getDefaultOpacity(t){switch(t){case"line-color":return this.fillOpacity;case"text-color":return}}getPadding(){const t=this.padding??jk;return{top:t,right:t,bottom:t,left:t}}getTextInputCoords(t,e){const{width:i,text:o}=this,s=super.getTextInputCoords(t,e),a=this.getPadding().top,n=Fh(this,o,s);n.x=zk(i/2,n.x,t.seriesRect.width-i/2);const r=n.y-Pg-a*2,l=n.y+Yk+a*2,c=Math.max(n.height,e);return r-c-Eg<0?(n.y=l,this.position="top"):(n.y=r+a,this.position="bottom"),{x:n.x,y:n.y}}isHoverable(){return!0}};p([wg],Ce.prototype,"type",2),p([wg],Ce.prototype,"background",2);import{_ModuleSupport as qk}from"ag-charts-community";var{BaseProperties:Qk}=qk,Jk=class extends ls(Sg(Co(Qk))){getDefaultColor(t){}getDefaultOpacity(t){}},Vh=class DM extends Ni(Jk){constructor(){super(...arguments),this.size=32}static is(e){return e instanceof DM}getDefaultColor(e){return e==="fill-color"?this.fill:void 0}getDefaultOpacity(e){return e==="fill-color"?this.fillOpacity:void 0}};import{_ModuleSupport as t0}from"ag-charts-community";import{isObject as _g}from"ag-charts-core";var{BaseProperties:Og,Property:br}=t0,pe=class extends ls(bg(Co(vg(he(qi(Og)))))){constructor(){super(...arguments),this.direction="horizontal",this.type="horizontal-line",this.text=new rs}static is(t){return _g(t)&&t.type==="horizontal-line"}getDefaultColor(){return this.stroke}getDefaultOpacity(){return this.strokeOpacity}getLineDash(){return sa(this.lineDash,this.computedLineDash,this.lineStyle,this.strokeWidth)}getLineCap(){return aa(this.lineCap,this.lineDash,this.lineStyle)}};p([br],pe.prototype,"type",2),p([br],pe.prototype,"text",2);var Ei=class extends ls(bg(Co(vg(he(qi(Og)))))){constructor(){super(...arguments),this.direction="vertical",this.type="vertical-line",this.text=new rs}static is(t){return _g(t)&&t.type==="vertical-line"}getDefaultColor(){return this.stroke}getDefaultOpacity(){return this.strokeOpacity}getLineDash(){return sa(this.lineDash,this.computedLineDash,this.lineStyle,this.strokeWidth)}getLineCap(){return aa(this.lineCap,this.lineDash,this.lineStyle)}};p([br],Ei.prototype,"type",2),p([br],Ei.prototype,"text",2);import{_ModuleSupport as e0}from"ag-charts-community";import{Logger as i0,isObject as o0}from"ag-charts-core";var{BaseProperties:s0,Property:vr}=e0,Qe=class extends ls(Th(Ch(Co(Nh(he(qi(s0))))))){constructor(){super(...arguments),this.type="disjoint-channel",this.text=new rn,this.snapToAngle=45}static is(t){return o0(t)&&t.type==="disjoint-channel"}get bottom(){const t={start:{x:this.start.x,y:this.start.y},end:{x:this.end.x,y:this.end.y}};return typeof t.start.y=="number"&&typeof t.end.y=="number"?(t.start.y-=this.startHeight,t.end.y-=this.endHeight):i0.warnOnce(`Annotation [${this.type}] can only be used with a numeric y-axis.`),t}getDefaultColor(t){switch(t){case"fill-color":return this.background.fill;case"line-color":return this.stroke;case"text-color":return this.text.color}}getDefaultOpacity(t){switch(t){case"fill-color":return this.background.fillOpacity;case"line-color":return this.strokeOpacity}}getLineDash(){return sa(this.lineDash,this.computedLineDash,this.lineStyle,this.strokeWidth)}getLineCap(){return aa(this.lineCap,this.lineDash,this.lineStyle)}};p([vr],Qe.prototype,"type",2),p([vr],Qe.prototype,"startHeight",2),p([vr],Qe.prototype,"endHeight",2),p([vr],Qe.prototype,"text",2);import{_ModuleSupport as a0}from"ag-charts-community";import{isObject as n0}from"ag-charts-core";import{_ModuleSupport as r0}from"ag-charts-community";import{_ModuleSupport as l0}from"ag-charts-community";import{isObject as Rg}from"ag-charts-core";var{Property:Hh}=l0,Mr=class extends Ph(fk(Nh(he(qi(Eh))))){constructor(){super(...arguments),this.text=new rs}getDefaultColor(t){switch(t){case"line-color":return this.stroke;case"text-color":return this.text.color}}getDefaultOpacity(){return this.strokeOpacity}getLineDash(){return sa(this.lineDash,this.computedLineDash,this.lineStyle,this.strokeWidth)}getLineCap(){return aa(this.lineCap,this.lineDash,this.lineStyle)}};p([Hh],Mr.prototype,"text",2);var to=class extends Mr{constructor(){super(...arguments),this.type="arrow",this.endCap="arrow"}static is(t){return Rg(t)&&t.type==="arrow"}};p([Hh],to.prototype,"type",2);var eo=class extends Mr{constructor(){super(...arguments),this.type="line"}static is(t){return Rg(t)&&t.type==="line"}};p([Hh],eo.prototype,"type",2);var{Property:ps}=r0,io=class extends Mr{constructor(){super(...arguments),this.label=new yk,this.reverse=!1,this.showFill=!0,this.isMultiColor=!0,this.strokes=[],this.bands=10}getDefaultColor(t){switch(t){case"line-color":return this.rangeStroke??this.stroke;case"text-color":return this.text.color}}};p([ps],io.prototype,"label",2),p([ps],io.prototype,"reverse",2),p([ps],io.prototype,"showFill",2),p([ps],io.prototype,"isMultiColor",2),p([ps],io.prototype,"strokes",2),p([ps],io.prototype,"rangeStroke",2),p([ps],io.prototype,"bands",2);var{Property:Bg}=a0,_i=class extends io{constructor(){super(...arguments),this.type="fibonacci-retracement-trend-based",this.endRetracement=new nn}static is(t){return n0(t)&&t.type==="fibonacci-retracement-trend-based"}};p([Bg],_i.prototype,"type",2),p([Bg],_i.prototype,"endRetracement",2);import{_ModuleSupport as c0}from"ag-charts-community";import{isObject as h0}from"ag-charts-core";var{Property:p0}=c0,oo=class extends io{constructor(){super(...arguments),this.type="fibonacci-retracement"}static is(t){return h0(t)&&t.type==="fibonacci-retracement"}};p([p0],oo.prototype,"type",2);import{_ModuleSupport as d0}from"ag-charts-community";import{Logger as u0,isObject as g0}from"ag-charts-core";var{BaseProperties:y0,Property:Dr}=d0,Je=class extends ls(Th(Ch(Co(Nh(he(qi(y0))))))){constructor(){super(...arguments),this.type="parallel-channel",this.middle=new dk,this.text=new rn,this.snapToAngle=45}static is(t){return g0(t)&&t.type==="parallel-channel"}get bottom(){const t={start:{x:this.start.x,y:this.start.y},end:{x:this.end.x,y:this.end.y}};return typeof t.start.y=="number"&&typeof t.end.y=="number"?(t.start.y-=this.height,t.end.y-=this.height):u0.warnOnce(`Annotation [${this.type}] can only be used with a numeric y-axis.`),t}getDefaultColor(t){switch(t){case"fill-color":return this.background.fill;case"line-color":return this.stroke;case"text-color":return this.text.color}}getDefaultOpacity(t){switch(t){case"fill-color":return this.background.fillOpacity;case"line-color":return this.strokeOpacity}}getLineDash(){return sa(this.lineDash,this.computedLineDash,this.lineStyle,this.strokeWidth)}getLineCap(){return aa(this.lineCap,this.lineDash,this.lineStyle)}};p([Dr],Je.prototype,"type",2),p([Dr],Je.prototype,"height",2),p([Dr],Je.prototype,"middle",2),p([Dr],Je.prototype,"text",2);import{_ModuleSupport as f0}from"ag-charts-community";import{isObject as m0}from"ag-charts-core";var{Property:x0}=f0,so=class extends yr{constructor(){super(...arguments),this.type="text",this.position="bottom"}static is(t){return m0(t)&&t.type==="text"}};p([x0],so.prototype,"type",2);function To(t){return Be.is(t)}function kr(t){return eo.is(t)||pe.is(t)||Ei.is(t)||to.is(t)||zg(t)}function ao(t){return Qe.is(t)||Je.is(t)}function zg(t){return oo.is(t)||_i.is(t)}function Oi(t){return fi.is(t)||Pi.is(t)||Ce.is(t)||so.is(t)}function cn(t){return Ze.is(t)||qe.is(t)||Ji.is(t)||Be.is(t)}function Gh(t){return Oi(t)&&!Ce.is(t)}function wo(t){return kr(t)||ao(t)||cn(t)&&!Be.is(t)}function S0(t){return kr(t)||ao(t)||cn(t)||fi.is(t)||Ce.is(t)}function b0(t){return Ce.is(t)}function v0(t){return ao(t)||cn(t)||fi.is(t)||Pi.is(t)||Vh.is(t)}function M0(t){return Oi(t)&&!Ce.is(t)}function ra(t){return(kr(t)||ao(t)||cn(t))&&!To(t)&&nk(t.text)}function D0(t,e){"fontSize"in t&&(t.fontSize=e),ra(t)&&(t.text.fontSize=e)}function Fg(t,e){const i=e?.strokeWidth??t.strokeWidth??1,o=e?.type??t.lineStyle,s=o??ln(t.lineDash,o),a=Ig(i,s);t.strokeWidth=i,t.computedLineDash=a,t.lineStyle=s,t.lineCap=s==="dotted"?"round":void 0}function Ar(t,e,i,o,s,a){switch(e){case"fill-color":{"fill"in t&&(t.fill=o),"fillOpacity"in t&&(t.fillOpacity=s),"background"in t&&(t.background.fill=o,t.background.fillOpacity=s);break}case"line-color":{"axisLabel"in t&&(t.axisLabel.fill=o,t.axisLabel.fillOpacity=s,t.axisLabel.stroke=o,t.axisLabel.strokeOpacity=s),"fill"in t&&"fillOpacity"in t&&b0(t)?(t.fill=o,t.fillOpacity=s):("strokeOpacity"in t&&(t.strokeOpacity=s),"isMultiColor"in t&&"rangeStroke"in t?(t.isMultiColor=a,t.rangeStroke=o):"stroke"in t&&(t.stroke=o));break}case"text-color":{"color"in t&&(t.color=i),ra(t)&&(t.text.color=o);break}}}var{deepClone:ti}=ok,k0=class{constructor(){this.mementoOriginatorKey="annotation-defaults",this.colors=new Map(Object.values(Lh).map(t=>[t,new Map([["line-color",void 0],["fill-color",void 0],["text-color",void 0]])])),this.fontSizes=new Map([["callout",void 0],["comment",void 0],["text",void 0],["arrow",void 0],["line",void 0],["disjoint-channel",void 0],["parallel-channel",void 0],["date-range",void 0],["price-range",void 0],["date-price-range",void 0]]),this.lineStyles=new Map([["line",void 0],["horizontal-line",void 0],["vertical-line",void 0],["disjoint-channel",void 0],["parallel-channel",void 0],["arrow",void 0],["date-range",void 0],["price-range",void 0],["date-price-range",void 0]]),this.lineTextAlignments=new Map([["line",void 0],["horizontal-line",void 0],["vertical-line",void 0],["disjoint-channel",void 0],["parallel-channel",void 0],["arrow",void 0],["date-range",void 0],["price-range",void 0],["date-price-range",void 0]]),this.lineTextPositions=new Map([["line",void 0],["horizontal-line",void 0],["vertical-line",void 0],["disjoint-channel",void 0],["parallel-channel",void 0],["arrow",void 0],["date-range",void 0],["price-range",void 0],["date-price-range",void 0]]),this.fibonacciOptions=new Map([["fibonacci-retracement",{bands:void 0,reverse:void 0,showFill:void 0}],["fibonacci-retracement-trend-based",{bands:void 0,reverse:void 0,showFill:void 0}]])}createMemento(){return{colors:ti(this.colors),fontSizes:ti(this.fontSizes),lineStyles:ti(this.lineStyles),lineTextAlignments:ti(this.lineTextAlignments),lineTextPositions:ti(this.lineTextPositions),fibonacciOptions:ti(this.fibonacciOptions)}}guardMemento(t){return!0}restoreMemento(t,e,i){this.colors=ti(i.colors),this.fontSizes=ti(i.fontSizes),this.lineStyles=ti(i.lineStyles),this.lineTextAlignments=ti(i.lineTextAlignments),this.lineTextPositions=ti(i.lineTextPositions),this.fibonacciOptions=ti(i.fibonacciOptions)}setDefaultColor(t,e,i,o,s,a){this.colors.get(t)?.set(e,[i,o,s,a])}setDefaultFontSize(t,e){this.fontSizes.set(t,e)}setDefaultLineStyleType(t,e){const i=this.lineStyles.get(t);i?i.type=e:this.lineStyles.set(t,{type:e})}setDefaultLineStyleWidth(t,e){const i=this.lineStyles.get(t);i?i.strokeWidth=e:this.lineStyles.set(t,{strokeWidth:e})}setDefaultLineTextAlignment(t,e){this.lineTextAlignments.set(t,e)}setDefaultLineTextPosition(t,e){this.lineTextPositions.set(t,e)}setDefaultFibonacciOptions(t,e,i){if(t!="fibonacci-retracement"&&t!="fibonacci-retracement-trend-based")return;const o=this.fibonacciOptions.get(t);o[e]=i,this.fibonacciOptions.set(t,o)}applyDefaults(t){for(const[e,i]of this.colors)if(t.type===e)for(const[o,[s,a,n,r]=[]]of i)s&&a&&n!=null&&r!=null&&Ar(t,o,s,a,n,r);for(const[e,i]of this.fontSizes)t.type!==e||i==null||D0(t,i);for(const[e,i]of this.lineStyles)t.type!==e||i==null||Fg(t,i);for(const[e,i]of this.lineTextPositions)t.type!==e||i==null||(t.text.position=i);for(const[e,i]of this.lineTextAlignments)t.type!==e||i==null||(t.text.alignment=i);for(const[e,i]of this.fibonacciOptions)t.type!==e||i==null||Object.keys(i).forEach(o=>{const s=i[o];s!=null&&t.set({[o]:s})})}};import{_ModuleSupport as Vg}from"ag-charts-community";import{CleanupRegistry as A0,EventEmitter as L0}from"ag-charts-core";import{_ModuleSupport as Hg}from"ag-charts-community";import{attachListener as I0,clamp as Lr,createElement as C0,getWindow as Gg}from"ag-charts-core";var T0='<div class="ag-charts-color-picker__palette" role="slider" tabindex="0"></div><div class="ag-charts-color-picker__color-row" role="presentation"><button class="ag-charts-color-picker__multi-color-button" tabindex="0" type="button" role="switch"></button> <input class="ag-charts-color-picker__hue-input" tabindex="0" type="range" min="0" max="360" value="0"></div><input class="ag-charts-color-picker__alpha-input" tabindex="0" type="range" min="0" max="1" value="1" step="0.01"> <label class="ag-charts-color-picker__color-field" role="presentation"><span class="ag-charts-color-picker__color-label" aria-hidden="true"></span> <input class="ag-charts-color-picker__color-input" tabindex="0" value="#000"></label>',{Color:Wh}=Hg,Wg=t=>{try{const e=Wh.fromString(t),[i,o,s]=e.toHSB();return[i,o,s,e.a]}catch{return}},Kg=class extends Hg.AnchoredPopover{constructor(t,e){super(t,"color-picker",e),this.hasChanged=!1,this.hideFns.push(()=>{this.i18nUpdater=void 0,this.hasChanged&&this.onChangeHide?.()}),this.cleanup.register(this.ctx.eventsHub.on("locale:change",()=>this.i18nUpdater?.()))}show(t){this.hasChanged=!1,this.onChangeHide=t.onChangeHide;const{element:e,initialFocus:i}=this.createColorPicker(t),o=this.showWithChildren([e],{initialFocus:i,...t});o.classList.add("ag-charts-color-picker"),o.setAttribute("role","dialog")}createColorPicker(t){const{localeManager:e}=this.ctx;let i=t.isMultiColor??!1,[o,s,a,n]=Wg(t.color??"#f00")??[0,1,.5,1];n=t.opacity??n;const r=C0("div","ag-charts-color-picker__content");r.innerHTML=T0,r.ariaLabel=this.ctx.localeManager.t("ariaLabelColorPicker");const l=r.querySelector(".ag-charts-color-picker__palette"),c=r.querySelector(".ag-charts-color-picker__hue-input"),h=r.querySelector(".ag-charts-color-picker__multi-color-button"),d=r.querySelector(".ag-charts-color-picker__alpha-input"),u=r.querySelector(".ag-charts-color-picker__color-input"),g=r.querySelector(".ag-charts-color-picker__color-label"),y=m=>{const b={s:"ariaValueColorPalette",v:"ariaValueColorPaletteFirstV"}[m];l.ariaValueText=e.t(b,{s,v:a})};this.i18nUpdater=()=>{l.ariaRoleDescription=e.t("ariaRoleDescription2DSlider"),l.ariaLabel=e.t("ariaLabelColorPickerPalette"),c.ariaLabel=e.t("ariaLabelColorPickerHue"),h.ariaLabel=e.t("ariaLabelColorPickerMultiColor"),d.ariaLabel=e.t("ariaLabelColorPickerAlpha"),u.ariaLabel=e.t("ariaLabelColor"),y("s")},this.i18nUpdater(),h.classList.toggle("ag-charts-color-picker__multi-color-button--hidden",!t.hasMultiColorOption);const f=(m=!0)=>{const M=Wh.fromHSB(o,s,a,n).toHexString();if(r.style.setProperty("--h",`${o}`),r.style.setProperty("--s",`${s}`),r.style.setProperty("--v",`${a}`),r.style.setProperty("--a",`${n}`),r.style.setProperty("--color",M.slice(0,7)),r.style.setProperty("--color-a",M),c.value=`${o}`,d.value=`${n}`,d.classList.toggle("ag-charts-color-picker__alpha-input--opaque",n===1),h.classList.toggle("ag-charts-color-picker__multi-color-button--active",i),g.classList.toggle("ag-charts-color-picker__color-label--multi-color",i),document.activeElement!==u&&(h.ariaChecked=i.toString(),u.value=i?e.t("ariaLabelColorPickerMultiColor"):M.toUpperCase()),m||t.color==null){const k=Wh.fromHSB(o,s,a,1).toHexString();t.onChange?.(M,k,n,i)}m&&(this.hasChanged=!0)};f(!1);const x=m=>m.preventDefault(),S=m=>m.stopPropagation(),v=m=>{m.preventDefault();const b=m.currentTarget;b.focus();const M=b.getBoundingClientRect(),k=({clientX:D,clientY:I})=>{i=!1,s=Math.min(Math.max((D-M.left)/M.width,0),1),a=1-Math.min(Math.max((I-M.top)/M.height,0),1),f(),y("s")};k(m);const A=I0(Gg(),"pointermove",k);Gg().addEventListener("pointerup",A,{once:!0})};return r.addEventListener("mousedown",S),r.addEventListener("touchstart",S),r.addEventListener("touchmove",S),r.addEventListener("keydown",m=>{switch(m.stopPropagation(),m.key){case"Enter":case"Escape":this.hide();break;default:return}m.preventDefault()}),l.addEventListener("pointerdown",v),l.addEventListener("touchstart",x,{passive:!1}),l.addEventListener("touchmove",x,{passive:!1}),l.addEventListener("keydown",m=>{if(m.key==="ArrowLeft")s=Lr(0,s-.01,1),y("s");else if(m.key==="ArrowRight")s=Lr(0,s+.01,1),y("s");else if(m.key==="ArrowUp")a=Lr(0,a+.01,1),y("v");else if(m.key==="ArrowDown")a=Lr(0,a-.01,1),y("v");else return;m.preventDefault(),f()}),l.addEventListener("focus",()=>{y("s")}),h.addEventListener("click",()=>{i=!i,f()}),c.addEventListener("input",m=>{i=!1,o=m.currentTarget.valueAsNumber??0,f()}),d.addEventListener("input",m=>{i=!1,n=m.currentTarget.valueAsNumber??0,f()}),u.addEventListener("input",m=>{i=!1;const b=Wg(m.currentTarget.value);b!=null&&([o,s,a,n]=b,f())}),u.addEventListener("blur",()=>f()),u.addEventListener("keydown",m=>{m.key==="Enter"&&(m.currentTarget.blur(),f())}),{element:r,initialFocus:l}}};import{_ModuleSupport as $g}from"ag-charts-community";function jg(t){return!(t instanceof $g.LogScale)&&!(t instanceof $g.BandScale)}var w0=[{label:"toolbarAnnotationsTrendLine",icon:"trend-line-drawing",value:"line"},{label:"toolbarAnnotationsHorizontalLine",icon:"horizontal-line-drawing",value:"horizontal-line"},{label:"toolbarAnnotationsVerticalLine",icon:"vertical-line-drawing",value:"vertical-line"},{label:"toolbarAnnotationsParallelChannel",icon:"parallel-channel-drawing",value:"parallel-channel",visible:jg},{label:"toolbarAnnotationsDisjointChannel",icon:"disjoint-channel-drawing",value:"disjoint-channel",visible:jg}],N0=[{label:"toolbarAnnotationsFibonacciRetracement",icon:"fibonacci-retracement-drawing",value:"fibonacci-retracement"},{label:"toolbarAnnotationsFibonacciRetracementTrendBased",icon:"fibonacci-retracement-trend-based-drawing",value:"fibonacci-retracement-trend-based"}],P0=[{label:"Fibonacci - Extended",value:10},{label:"Fibonacci - 6 Band",value:6},{label:"Fibonacci - 4 Band",value:4}],E0=[{label:"toolbarAnnotationsText",icon:"text-annotation",value:"text"},{label:"toolbarAnnotationsComment",icon:"comment-annotation",value:"comment"},{label:"toolbarAnnotationsCallout",icon:"callout-annotation",value:"callout"},{label:"toolbarAnnotationsNote",icon:"note-annotation",value:"note"}],_0=[{label:"toolbarAnnotationsArrow",icon:"arrow-drawing",value:"arrow"},{label:"toolbarAnnotationsArrowUp",icon:"arrow-up-drawing",value:"arrow-up"},{label:"toolbarAnnotationsArrowDown",icon:"arrow-down-drawing",value:"arrow-down"}],O0=[{label:"toolbarAnnotationsQuickDatePriceRange",icon:"measurer-drawing",value:"quick-date-price-range"},{label:"toolbarAnnotationsDateRange",icon:"date-range-drawing",value:"date-range"},{label:"toolbarAnnotationsPriceRange",icon:"price-range-drawing",value:"price-range"},{label:"toolbarAnnotationsDatePriceRange",icon:"date-price-range-drawing",value:"date-price-range"}],Yg=[{strokeWidth:1,label:"1",value:1},{strokeWidth:2,label:"2",value:2},{strokeWidth:3,label:"3",value:3},{strokeWidth:4,label:"4",value:4},{strokeWidth:8,label:"8",value:8}],hn=[{icon:"line-style-solid",altText:"iconAltTextLineStyleSolid",value:"solid"},{icon:"line-style-dashed",altText:"iconAltTextLineStyleDashed",value:"dashed"},{icon:"line-style-dotted",altText:"iconAltTextLineStyleDotted",value:"dotted"}],Ug=[{label:"10",value:10},{label:"12",value:12},{label:"14",value:14},{label:"16",value:16},{label:"18",value:18},{label:"22",value:22},{label:"28",value:28},{label:"36",value:36},{label:"46",value:46}],{Color:Xg,FloatingToolbar:R0,Menu:Kh,PropertiesArray:B0,ToolbarButtonProperties:Zg,ToolbarButtonWidget:z0,Property:ds}=Vg,la=class extends Zg{constructor(){super(...arguments),this.checkedOverrides=new Zg}};p([ds],la.prototype,"value",2),p([ds],la.prototype,"checkedOverrides",2),p([ds],la.prototype,"color",2),p([ds],la.prototype,"strokeWidth",2),p([ds],la.prototype,"isMultiColor",2);var F0=class extends z0{update(t){super.update(t),t.value==="line-stroke-width"&&this.updateLineStrokeWidth(t),(t.value==="fill-color"||t.value==="line-color"||t.value==="text-color")&&this.updateFillColor(t)}updateFillColor(t){const e=this.getElement();e.classList.add("ag-charts-annotations__color-picker-button"),e.classList.toggle("ag-charts-annotations__color-picker-button--multi-color",t.isMultiColor),e.style.setProperty("--color",t.color??null)}updateLineStrokeWidth(t){const e=this.getElement();e.classList.add("ag-charts-annotations__stroke-width-button"),e.style.setProperty("--stroke-width",`${t.strokeWidth}px`)}},V0=class extends R0{createButtonWidget(){return new F0(this.localeManager)}},$h=class extends Vg.BaseProperties{constructor(t,e){super(),this.ctx=t,this.getActiveDatum=e,this.enabled=!0,this.buttons=new B0(la),this.cleanup=new A0,this.events=new L0,this.visibleButtons=[],this.toolbar=new V0(this.ctx,"ariaLabelAnnotationOptionsToolbar","annotation-options"),this.colorPicker=new Kg(this.ctx),this.textSizeMenu=new Kh(this.ctx,"text-size"),this.lineStyleTypeMenu=new Kh(this.ctx,"annotations-line-style-type"),this.lineStrokeWidthMenu=new Kh(this.ctx,"annotations-line-stroke-width"),this.cleanup.register(this.toolbar.addToolbarListener("button-pressed",this.onButtonPress.bind(this)),this.toolbar.addToolbarListener("toolbar-moved",this.onToolbarMoved.bind(this)),t.widgets.seriesWidget.addListener("drag-start",this.onDragStart.bind(this)),t.widgets.seriesWidget.addListener("drag-end",this.onDragEnd.bind(this)),()=>{this.colorPicker.destroy(),this.toolbar.destroy()})}onDragStart(){this.toolbar.ignorePointerEvents()}onDragEnd(){this.toolbar.capturePointerEvents()}destroy(){this.cleanup.flush()}show(){this.enabled&&this.toolbar.show()}hide(){this.toolbar.hide()}updateButtons(t){if(!this.enabled)return;const e={"line-style-type":wo(t),"line-stroke-width":wo(t),"line-color":S0(t),"text-color":M0(t),"fill-color":v0(t),"text-size":Gh(t),settings:ra(t),lock:!0,delete:!0};this.visibleButtons=this.buttons.filter(i=>e[i.value]),this.toolbar.clearButtons(),this.toolbar.updateButtons(this.visibleButtons),this.refreshButtons(t)}setAnchorScene(t){this.toolbar.hasBeenDragged()||this.toolbar.setAnchor(t.getAnchor())}hideOverlays(){this.toolbar.clearActiveButton(),this.colorPicker.hide({lastFocus:null}),this.textSizeMenu.hide(),this.lineStyleTypeMenu.hide(),this.lineStrokeWidthMenu.hide(),this.events.emit("hid-overlays",null)}clearActiveButton(){this.toolbar.clearActiveButton()}updateColors(t){this.updateColorPickerColor("line-color",t.getDefaultColor("line-color"),t.getDefaultOpacity("line-color"),"isMultiColor"in t&&t?.isMultiColor),this.updateColorPickerColor("fill-color",t.getDefaultColor("fill-color"),t.getDefaultOpacity("fill-color"),"isMultiColor"in t&&t?.isMultiColor),this.updateColorPickerColor("text-color",t.getDefaultColor("text-color"),t.getDefaultOpacity("text-color"),"isMultiColor"in t&&t?.isMultiColor)}updateColorPickerColor(t,e,i,o){if(e!=null&&i!=null){const{r:s,g:a,b:n}=Xg.fromString(e);e=Xg.fromArray([s,a,n,i]).toHexString()}this.updateButtonByValue(t,{color:e,isMultiColor:o})}updateFontSize(t){this.updateButtonByValue("text-size",{label:t!=null?String(t):void 0})}updateLineStyleType(t){this.updateButtonByValue("line-style-type",{icon:t.icon})}updateStrokeWidth(t){this.updateButtonByValue("line-stroke-width",{label:t.label,strokeWidth:t.value})}onButtonPress({event:t,button:e,buttonWidget:i}){const o=this.getActiveDatum();if(o)switch(this.hideOverlays(),e.value){case"line-style-type":{const s=wo(o)?ln(o.lineDash,o.lineStyle):void 0;this.lineStyleTypeMenu.show(i,{items:hn,ariaLabel:this.ctx.localeManager.t("toolbarAnnotationsLineStyle"),value:s,onPress:a=>this.onLineStyleTypeMenuPress(a,o),class:"ag-charts-annotations__line-style-type-menu"});break}case"line-stroke-width":{const s=wo(o)?o.strokeWidth:void 0;this.lineStrokeWidthMenu.show(i,{items:Yg,ariaLabel:this.ctx.localeManager.t("toolbarAnnotationsLineStrokeWidth"),value:s,onPress:a=>this.onLineStrokeWidthMenuPress(a,o),class:"ag-charts-annotations__line-stroke-width-menu"});break}case"line-color":case"fill-color":case"text-color":{this.toolbar.toggleActiveButtonByIndex(e.index),this.colorPicker.show({color:o?.getDefaultColor(e.value),opacity:o?.getDefaultOpacity(e.value),sourceEvent:t.sourceEvent,hasMultiColorOption:"isMultiColor"in o,isMultiColor:"isMultiColor"in o&&o?.isMultiColor,onChange:o!=null?this.onColorPickerChange.bind(this,e.value,o):void 0,onChangeHide:(s=>{this.events.emit("saved-color",{type:o.type,colorPickerType:e.value,color:o.getDefaultColor(s)})}).bind(this,e.value)});break}case"text-size":{const s=Oi(o)?o.fontSize:void 0;this.textSizeMenu.show(i,{items:Ug,ariaLabel:this.ctx.localeManager.t("toolbarAnnotationsTextSize"),value:s,onPress:a=>this.onTextSizeMenuPress(a,o),class:"ag-charts-annotations__text-size-menu"});break}case"delete":{this.events.emit("pressed-delete",null);break}case"lock":{o.locked=!o.locked,this.refreshButtons(o),this.events.emit("pressed-lock",{locked:o.locked});break}case"settings":{this.toolbar.toggleActiveButtonByIndex(e.index),this.events.emit("pressed-settings",t);break}}}onToolbarMoved(t){const{buttonBounds:e,popoverBounds:i}=t,o={x:i.x,y:i.y+i.height+4},s={y:i.y-4};this.colorPicker.setAnchor(o,s);for(const[a,n]of e.entries()){const r=this.visibleButtons.at(a);if(!r)continue;const l={x:n.x,y:n.y+n.height-1},c={y:n.y};switch(r.value){case"line-stroke-width":this.lineStrokeWidthMenu.setAnchor(l,c);break;case"line-style-type":this.lineStyleTypeMenu.setAnchor(l,c);break;case"text-size":this.textSizeMenu.setAnchor(l,c);break}}}onColorPickerChange(t,e,i,o,s,a){this.events.emit("updated-color",{type:e.type,colorPickerType:t,colorOpacity:i,color:o,opacity:s,isMultiColor:a}),this.updateColorPickerColor(t,i,s,a)}onTextSizeMenuPress(t,e){if(!Gh(e))return;const i=t.value;this.events.emit("updated-font-size",{type:e.type,fontSize:i}),this.textSizeMenu.hide(),this.updateFontSize(i)}onLineStyleTypeMenuPress(t,e){if(!wo(e))return;const i=t.value;this.events.emit("updated-line-style",{type:e.type,lineStyleType:i}),this.lineStyleTypeMenu.hide(),this.updateLineStyleType(t)}onLineStrokeWidthMenuPress(t,e){if(!wo(e))return;const i=t.value;this.events.emit("updated-line-width",{type:e.type,strokeWidth:i}),this.lineStrokeWidthMenu.hide(),this.updateStrokeWidth(t)}refreshButtons(t){const e=t.locked??!1;for(const[i,o]of this.visibleButtons.entries())o&&(o.value==="lock"?(this.toolbar.toggleSwitchCheckedByIndex(i,e),this.updateButtonByIndex(i,e?o.checkedOverrides.toJson():o.toJson())):this.toolbar.toggleButtonEnabledByIndex(i,!e));Gh(t)&&this.updateFontSize(t.fontSize),this.updateColors(t),this.updateLineStyles(t)}updateLineStyles(t){if(!wo(t))return;const e=t.strokeWidth??1,i=ln(t.lineDash,t.lineStyle);this.updateStrokeWidth({strokeWidth:e,value:e,label:String(e)}),this.updateLineStyleType(hn.find(o=>o.value===i)??hn[0])}updateButtonByValue(t,e){const i=this.visibleButtons.findIndex(o=>o.value===t);i!==-1&&this.updateButtonByIndex(i,e)}updateButtonByIndex(t,e){const i=this.visibleButtons.at(t);i&&this.toolbar.updateButtonByIndex(t,{...i.toJson(),...e,value:e.value??i.value})}};p([ds],$h.prototype,"enabled",2),p([ds],$h.prototype,"buttons",2);import{_ModuleSupport as H0}from"ag-charts-community";var{StateMachine:qg,StateMachineProperty:jh,Vec2:Qg,Debug:G0}=H0,wt=class extends qg{constructor(t){const e=({context:i})=>{this.node?.drag(this.datum,this.offset,i,this.snapping),t.update()};super("idle",{idle:{dragStart:{target:"dragging",action:({offset:i,context:o})=>{this.hasMoved=!1,this.dragStart=i,this.offset=i,this.node?.dragStart(this.datum,i,o)}}},dragging:{keyDown:e,keyUp:e,drag:({offset:i,context:o})=>{this.hasMoved=Qg.lengthSquared(Qg.sub(i,this.dragStart))>0,this.offset=i,this.node?.drag(this.datum,i,o,this.snapping),t.update()},dragEnd:{target:qg.parent,action:()=>{this.node?.stopDragging(),this.hasMoved&&t.recordAction("Move annotation"),t.update()}}}}),this.debug=G0.create(!0,"annotations"),this.hasMoved=!1,this.snapping=!1}};p([jh()],wt.prototype,"snapping",2),p([jh()],wt.prototype,"datum",2),p([jh()],wt.prototype,"node",2);import{_ModuleSupport as W0}from"ag-charts-community";import{isObject as K0}from"ag-charts-core";var{Property:$0}=W0,No=class extends Vh{constructor(){super(...arguments),this.type="arrow-down"}static is(t){return K0(t)&&t.type==="arrow-down"}};p([$0],No.prototype,"type",2);import{_ModuleSupport as j0}from"ag-charts-community";import{_ModuleSupport as Y0}from"ag-charts-community";import{_ModuleSupport as Ir}from"ag-charts-community";import{isObject as U0}from"ag-charts-core";import{_ModuleSupport as Yh}from"ag-charts-community";import{_ModuleSupport as X0}from"ag-charts-community";var ca=class extends X0.Marker{isPointInPath(t,e){return this.updatePathIfDirty(),this.path.closedPath&&this.path.isPointInPath(t,e)}},Jg=class kM extends Yh.Group{constructor(){super(...arguments),this.active=!1,this.locked=!1,this.visible=!1,this.zIndex=1}drag(e){const{handle:i,locked:o}=this;return o?{point:{x:i.x,y:i.y},offset:{x:0,y:0}}:{point:e,offset:{x:e.x-i.x,y:e.y-i.y}}}toggleActive(e){this.active=e,e||(this.handle.strokeWidth=kM.INACTIVE_STROKE_WIDTH)}toggleHovered(e){this.glow.visible=!this.locked&&e,this.glow.dirtyPath=!0}toggleDragging(e){this.locked||(this.handle.visible=!e,this.glow.visible=this.glow.visible&&!e,this.handle.dirtyPath=!0,this.glow.dirtyPath=!0)}toggleLocked(e){this.locked=e}getCursor(){}containsPoint(e,i){return this.handle.containsPoint(e,i)}};Jg.INACTIVE_STROKE_WIDTH=2;var Po=Jg,Uh=class AM extends Po{constructor(){super(),this.handle=new ca({shape:"circle"}),this.glow=new ca({shape:"circle"}),this.append([this.handle]),this.handle.size=AM.HANDLE_SIZE,this.handle.strokeWidth=Po.INACTIVE_STROKE_WIDTH,this.handle.zIndex=2}update(e){this.handle.setProperties({...e,strokeWidth:Po.INACTIVE_STROKE_WIDTH})}drag(e){return{point:e,offset:{x:0,y:0}}}};Uh.HANDLE_SIZE=7,Uh.GLOW_SIZE=9;var Eo=Uh,Cr=class Oe extends Po{constructor(){super(),this.handle=new Yh.Rect,this.glow=new Yh.Rect,this.gradient="horizontal",this.append([this.glow,this.handle]),this.handle.cornerRadius=Oe.CORNER_RADIUS,this.handle.width=Oe.HANDLE_SIZE,this.handle.height=Oe.HANDLE_SIZE,this.handle.strokeWidth=Po.INACTIVE_STROKE_WIDTH,this.handle.zIndex=2,this.glow.cornerRadius=Oe.CORNER_RADIUS,this.glow.width=Oe.GLOW_SIZE,this.glow.height=Oe.GLOW_SIZE,this.glow.strokeWidth=0,this.glow.fillOpacity=.2,this.glow.zIndex=1,this.glow.visible=!1}toggleLocked(e){if(super.toggleLocked(e),e){const i=(Oe.HANDLE_SIZE-Eo.HANDLE_SIZE)/2;this.handle.cornerRadius=1,this.handle.fill=this.handle.stroke,this.handle.strokeWidth=0,this.handle.x+=i,this.handle.y+=i,this.handle.width=Eo.HANDLE_SIZE,this.handle.height=Eo.HANDLE_SIZE,this.glow.width=Eo.GLOW_SIZE,this.glow.height=Eo.GLOW_SIZE}else this.handle.cornerRadius=Oe.CORNER_RADIUS,this.handle.width=Oe.HANDLE_SIZE,this.handle.height=Oe.HANDLE_SIZE,this.glow.width=Oe.GLOW_SIZE,this.glow.height=Oe.GLOW_SIZE,this.cachedStyles&&this.handle.setProperties(this.cachedStyles)}update(e){if(this.cachedStyles={...e},this.active||delete e.strokeWidth,this.locked){delete e.fill,delete e.strokeWidth;const i=(Oe.HANDLE_SIZE-Eo.HANDLE_SIZE)/2;e.x-=i,e.y-=i,this.cachedStyles.x-=i,this.cachedStyles.y-=i}this.handle.setProperties(e),this.glow.setProperties({...e,x:(e.x??this.glow.x)-2,y:(e.y??this.glow.y)-2,strokeWidth:0,fill:e.stroke})}drag(e){return this.locked?{point:e,offset:{x:0,y:0}}:this.gradient==="vertical"?{point:{x:e.x,y:this.handle.y},offset:{x:e.x-this.handle.x,y:0}}:{point:{x:this.handle.x,y:e.y},offset:{x:0,y:e.y-this.handle.y}}}getCursor(){if(!this.locked)return this.gradient==="vertical"?"col-resize":"row-resize"}};Cr.HANDLE_SIZE=12,Cr.GLOW_SIZE=16,Cr.CORNER_RADIUS=4;var ha=Cr,Xh=class sr extends Po{constructor(){super(),this.handle=new ca({shape:"circle"}),this.glow=new ca({shape:"circle"}),this.append([this.glow,this.handle]),this.handle.size=sr.HANDLE_SIZE,this.handle.strokeWidth=Po.INACTIVE_STROKE_WIDTH,this.handle.zIndex=2,this.glow.size=sr.GLOW_SIZE,this.glow.strokeWidth=0,this.glow.fillOpacity=.2,this.glow.zIndex=1,this.glow.visible=!1}toggleLocked(e){super.toggleLocked(e),e?(this.handle.fill=this.handle.stroke,this.handle.strokeWidth=0,this.handle.size=Eo.HANDLE_SIZE,this.glow.size=Eo.GLOW_SIZE):(this.handle.size=sr.HANDLE_SIZE,this.glow.size=sr.GLOW_SIZE,this.cachedStyles&&this.handle.setProperties(this.cachedStyles))}update(e){this.cachedStyles={...e},this.active||delete e.strokeWidth,this.locked&&(delete e.fill,delete e.strokeWidth),this.handle.setProperties(e),this.glow.setProperties({...e,strokeWidth:0,fill:e.stroke})}getCursor(){return"pointer"}};Xh.HANDLE_SIZE=11,Xh.GLOW_SIZE=17;var vt=Xh,{ZIndexMap:Z0}=Ir,Yt=class extends Ir.Group{constructor(){super(...arguments),this.name="AnnotationScene",this.zIndex=Z0.CHART_ANNOTATION}static isCheck(t,e){return U0(t)&&Object.hasOwn(t,"type")&&t.type===e}toggleHovered(t,e,i){i!==!0&&this.toggleHandles(t||e)}computeBBoxWithoutHandles(){return Ir.Transformable.toCanvas(this,Ir.Group.computeChildrenBBox(this.excludeChildren({instance:Po})))}updateNode(t,e,i){if(!i&&e){this.removeChild(e);return}return i&&e==null&&(e=new t,this.appendChild(e)),e}};import{_ModuleSupport as q0}from"ag-charts-community";import{_ModuleSupport as Q0}from"ag-charts-community";import{entries as J0}from"ag-charts-core";var{ContinuousScale:tA,Vec2:ei,toRadians:eA}=Q0;function pn(t,e,i=!1,o,s=1){if(!i)return be(t,e);const a=o?bt(o,e):ei.origin();return be(Tr(t,a,s),e)}function Tr(t,e,i){const o=ei.sub(t,e),s=eA(i),a=Math.round(ei.angle(o)/s)*s;return ei.rotate(o,a,e)}function wr(t,e){const i={};for(const[o,s]of J0(t))i[o]=bt(s,e);return i}function no(t,e,i,o={overflowContinuous:0,translateVectors:void 0,invertYVectors:void 0,snap:void 0}){const{xAxis:s,yAxis:a}=i,n=Object.keys(t),r=[],l=[],c=new Set(o.translateVectors??n),h=new Set(o.invertYVectors??[]),d=new Set([...c,...h]),u=ei.multiply(e,ei.from(1,-1));for(const S of n)d.has(S)&&(t[S]=ei.add(t[S],h.has(S)?u:e),o.snap&&(t[S]=Tr(t[S],o.snap.vectors[S],o.snap.angle))),r.push(s.getRangeOverflow(t[S].x)),l.push(a.getRangeOverflow(t[S].y));const g=(S,v)=>Math.abs(S)-Math.abs(v),y=(S,v,m)=>o.overflowContinuous===0||!tA.is(S)?m.toSorted(g).at(-1)??0:n.length===d.size?m.toSorted(g).at(-o.overflowContinuous-1)??0:m.filter(M=>M!==0).length<=o.overflowContinuous?0:m.filter((M,k)=>M!==0&&Math.abs(M)<=Math.abs(v)&&d.has(n[k])).toSorted(g).at(-1)??0,f=ei.from(y(s.scale,e.x,r),y(a.scale,e.y,l));if(!ei.equal(f,ei.origin()))for(const S of n)d.has(S)&&(t[S]=ei.round(ei.sub(t[S],f),4));const x={};for(const S of n)x[S]=be(t[S],i);return x}var{Vec2:iA}=q0,ty=class extends Yt{constructor(){super(...arguments),this.handle=new vt,this.anchor={x:0,y:0,position:"above"}}update(t,e){const i=bt(t,e);this.updateHandle(t,i),this.anchor=this.updateAnchor(t,i,e)}dragStart(t,e,i){this.dragState={offset:e,...wr({handle:t},i)}}drag(t,e,i){const{dragState:o}=this;if(!t.isWriteable()||!o)return;const{point:s}=no({point:o.handle},iA.sub(e,o.offset),i);t.x=s.x,t.y=s.y}translate(t,e,i){if(!t.isWriteable())return;const{point:o}=no({point:bt(t,i)},e,i);t.x=o.x,t.y=o.y}toggleHandles(t){this.handle.visible=!!t,this.handle.toggleHovered(this.activeHandle==="handle")}toggleActive(t){this.toggleHandles(t),this.handle.toggleActive(t)}stopDragging(){this.handle.toggleDragging(!1)}copy(t,e,i){const o=bt(t,i),s=be({x:o.x-30,y:o.y-30},i);return e.x=s.x,e.y=s.y,e}getAnchor(){return this.anchor}getCursor(){return"pointer"}containsPoint(t,e){const{handle:i}=this;return this.activeHandle=void 0,i.containsPoint(t,e)?(this.activeHandle="handle",!0):!1}getNodeAtCoords(t,e){if(this.handle.containsPoint(t,e))return"handle"}updateHandle(t,e,i){const{x:o,y:s}=this.getHandleCoords(t,e,i),a=this.getHandleStyles(t);this.handle.update({...a,x:o,y:s}),this.handle.toggleLocked(t.locked??!1)}updateAnchor(t,e,i){const o=this.getHandleCoords(t,e);return{x:o.x+i.seriesRect.x,y:o.y+i.seriesRect.y,position:this.anchor.position}}getHandleCoords(t,e,i){return{x:e.x,y:e.y}}getHandleStyles(t){return{fill:t.handle.fill,stroke:t.handle.stroke,strokeOpacity:t.handle.strokeOpacity,strokeWidth:t.handle.strokeWidth}}},ey=class extends ty{constructor(){super(),this.append([this.handle])}update(t,e){super.update(t,e);const i=bt(t,e);this.updateShape(t,i)}updateShape(t,e){this.updateShapeStyles(t),this.updateShapePath(t,e)}updateShapeStyles(t){const{shape:e}=this;e.fill=t.fill,e.fillOpacity=t.fillOpacity??1}updateShapePath(t,e){const{shape:i}=this;i.x=e.x,i.y=e.y,i.size=t.size}containsPoint(t,e){return super.containsPoint(t,e)||this.shape.containsPoint(t,e)}getNodeAtCoords(t,e){return this.shape.containsPoint(t,e)?"shape":super.getNodeAtCoords(t,e)}},iy=[[.5,0],[1,.5],[.75,.5],[.75,1],[.25,1],[.25,.5],[0,.5]];function oy(t){Y0.drawMarkerUnitPolygon(t,iy)}oy.anchor={x:.5,y:0};var Nr=class extends ey{constructor(){super(),this.type="arrow-up",this.shape=new ca({shape:oy}),this.append([this.shape])}static is(t){return Yt.isCheck(t,"arrow-up")}getHandleCoords(t,e){const i=vt.HANDLE_SIZE/2,o=super.getHandleCoords(t,e);return o.y-=i,o}},oA=iy.map(([t,e])=>[t,1-e]);function sy(t){j0.drawMarkerUnitPolygon(t,oA)}sy.anchor={x:.5,y:1};var Pr=class extends ey{constructor(){super(),this.type="arrow-down",this.shape=new ca({shape:sy}),this.append([this.shape])}static is(t){return Yt.isCheck(t,"arrow-down")}updateAnchor(t,e,i){const o=super.updateAnchor(t,e,i);return o.y-=t.size,o}getHandleCoords(t,e){const i=vt.HANDLE_SIZE/2,o=super.getHandleCoords(t,e);return o.y+=i,o}};import{_ModuleSupport as sA}from"ag-charts-community";var{StateMachine:Er,StateMachineProperty:aA,Debug:nA}=sA,Zh=class extends Er{constructor(t){const e=({point:o})=>{const s=this.createDatum();s.set({x:o.x,y:o.y}),t.create(s)},i=()=>{this.node?.toggleActive(!0),t.showAnnotationOptions(),t.update()};super("start",{start:{click:{target:"waiting-first-render",action:e},drag:{target:"waiting-first-render",action:e},cancel:Er.parent,reset:Er.parent},"waiting-first-render":{render:{target:Er.parent,action:i}}}),this.debug=nA.create(!0,"annotations")}};p([aA()],Zh.prototype,"node",2);var rA=class extends Zh{createDatum(){return new No}},ay={type:"arrow-down",datum:No,scene:Pr,isDatum:No.is,translate:(t,e,i,o)=>{No.is(e)&&Pr.is(t)&&t.translate(e,i,o)},copy:(t,e,i,o)=>{if(No.is(e)&&No.is(i)&&Pr.is(t))return t.copy(e,i,o)},update:(t,e,i)=>{No.is(e)&&Pr.is(t)&&t.update(e,i)},createState:(t,{createDatum:e})=>new rA({...t,create:e("arrow-down")}),dragState:t=>new wt(t)};import{_ModuleSupport as lA}from"ag-charts-community";import{isObject as cA}from"ag-charts-core";var{Property:hA}=lA,_o=class extends Vh{constructor(){super(...arguments),this.type="arrow-up"}static is(t){return cA(t)&&t.type==="arrow-up"}};p([hA],_o.prototype,"type",2);var pA=class extends Zh{createDatum(){return new _o}},ny={type:"arrow-up",datum:_o,scene:Nr,isDatum:_o.is,translate:(t,e,i,o)=>{_o.is(e)&&Nr.is(t)&&t.translate(e,i,o)},copy:(t,e,i,o)=>{if(_o.is(e)&&_o.is(i)&&Nr.is(t))return t.copy(e,i,o)},update:(t,e,i)=>{_o.is(e)&&Nr.is(t)&&t.update(e,i)},createState:(t,{createDatum:e})=>new pA({...t,create:e("arrow-up")}),dragState:t=>new wt(t)};import{_ModuleSupport as dA}from"ag-charts-community";import{_ModuleSupport as ry}from"ag-charts-community";import{_ModuleSupport as uA}from"ag-charts-community";import{entries as gA}from"ag-charts-core";import{_ModuleSupport as yA}from"ag-charts-community";var{Vec2:fA,Vec4:ly}=yA,cy=class extends Yt{constructor(){super(...arguments),this.overflowContinuous=0}extendLine({x1:t,y1:e,x2:i,y2:o},s,a){const n={x1:t,y1:e,x2:i,y2:o};if(!s.extendStart&&!s.extendEnd)return n;const[r,l]=Ok(n,a.yAxis.bounds),c=n.x2<n.x1,h=n.y1>=n.y2,d=n.x2===n.x1;return s.extendEnd&&(d?n.y2=h?l.y:r.y:(n.x2=c?r.x:l.x,n.y2=c?r.y:l.y)),s.extendStart&&(d?n.y1=h?r.y:l.y:(n.x1=c?l.x:r.x,n.y1=c?l.y:r.y)),n}dragStart(t,e,i){this.dragState={offset:e,...wr({start:t.start,end:t.end},i)}}drag(t,e,i,o){t.isWriteable()&&(this.activeHandle?this.dragHandle(t,e,i,o):this.dragAll(t,e,i))}dragAll(t,e,i){const{dragState:o}=this;o&&this.translatePoints(t,o.start,o.end,fA.sub(e,o.offset),i)}translate(t,e,i){t.isWriteable()&&this.translatePoints(t,bt(t.start,i),bt(t.end,i),e,i)}copy(t,e,i){const o=Se(t,i);if(!o)return;const s=this.computeBBoxWithoutHandles(),a={x:-s.width/2,y:-s.height/2};return this.translatePoints(e,ly.start(o),ly.end(o),a,i),e}translatePoints(t,e,i,o,s){const a=this.getTranslatePointsVectors(e,i),n=no(a,o,s,{overflowContinuous:this.overflowContinuous});t.start.x=n.start.x,t.end.x=n.end.x,t.start.y=n.start.y,t.end.y=n.end.y}getTranslatePointsVectors(t,e){return{start:t,end:e}}},{Vec2:mA,Vec4:hy}=uA,qh=class extends cy{constructor(){super(...arguments),this.start=new vt,this.end=new vt,this.anchor={x:0,y:0,position:"above"}}update(t,e){const i=Se(t,e);i!=null&&(this.updateHandles(t,i),this.updateAnchor(t,i,e))}toggleHandles(t){if(typeof t=="boolean")this.start.visible=t,this.end.visible=t;else for(const[e,i]of gA(t))this[e].visible=i;this.start.toggleHovered(this.activeHandle==="start"),this.end.toggleHovered(this.activeHandle==="end")}toggleActive(t){this.toggleHandles(t),this.start.toggleActive(t),this.end.toggleActive(t)}dragHandle(t,e,i,o){const{activeHandle:s,dragState:a}=this;if(!s||!a)return;this[s].toggleDragging(!0);const n=s==="start"?"end":"start",r=o?{vectors:{[s]:bt(t[n],i)},angle:t.snapToAngle}:void 0,{[s]:l}=no({[s]:a[s]},mA.sub(e,a.offset),i,{overflowContinuous:0,snap:r});t[s].x=l.x,t[s].y=l.y}stopDragging(){this.start.toggleDragging(!1),this.end.toggleDragging(!1)}getAnchor(){return this.anchor}getCursor(){return"pointer"}containsPoint(t,e){const{start:i,end:o}=this;return this.activeHandle=void 0,i.containsPoint(t,e)?(this.activeHandle="start",!0):o.containsPoint(t,e)?(this.activeHandle="end",!0):!1}getNodeAtCoords(t,e){if(this.start.containsPoint(t,e)||this.end.containsPoint(t,e))return"handle"}updateHandles(t,e,i){this.start.update({...this.getHandleStyles(t,"start"),...this.getHandleCoords(t,e,"start")}),this.end.update({...this.getHandleStyles(t,"end"),...this.getHandleCoords(t,e,"end",i)}),this.start.toggleLocked(t.locked??!1),this.end.toggleLocked(t.locked??!1)}updateAnchor(t,e,i,o){this.anchor={x:e.x1+i.seriesRect.x,y:e.y1+i.seriesRect.y,position:this.anchor.position}}getHandleCoords(t,e,i,o){return i==="start"?hy.start(e):hy.end(e)}getHandleStyles(t,e){return{fill:t.handle.fill,stroke:t.handle.stroke,strokeOpacity:t.handle.strokeOpacity,strokeWidth:t.handle.strokeWidth}}},{Vec4:py}=ry,xA=class extends qh{constructor(){super(...arguments),this.label=new ry.Text({zIndex:1}),this.anchor={x:0,y:0,position:"above-left"}}setTextInputBBox(t){this.textInputBBox=t,this.markDirty("TextualStartEndScene")}update(t,e){const i=Se(t,e);if(i==null)return;const o=this.getTextBBox(t,i);this.updateLabel(t,o,i),this.updateHandles(t,i,o),this.updateShape(t,o,i),this.updateAnchor(t,i,e,o)}containsPoint(t,e){return super.containsPoint(t,e)||this.label.containsPoint(t,e)}getNodeAtCoords(t,e){return this.label.containsPoint(t,e)?"text":super.getNodeAtCoords(t,e)}getTextBBox(t,e){const{text:i}=t.getText();return Fh(t,i,py.end(e),this.textInputBBox)}updateLabel(t,e,i){const{text:o,isPlaceholder:s}=t.getText();Tg(this.label,o,s,t,this.getLabelCoords(t,e,i))}updateShape(t,e,i){}getLabelCoords(t,e,i){return py.end(i)}getHandleStyles(t,e){return{...super.getHandleStyles(t,e),stroke:t.handle.stroke??t.color}}},{drawCorner:SA,Path:bA}=dA,_r=class extends xA{constructor(){super(),this.type="callout",this.shape=new bA,this.append([this.shape,this.label,this.start,this.end])}static is(t){return Yt.isCheck(t,"callout")}drag(t,e,i,o){t.isWriteable()&&(this.activeHandle==="end"?this.dragHandle(t,e,i,o):this.dragAll(t,e,i))}getLabelCoords(t,e,i){const o=t.getPadding(),{bodyBounds:s={x:0,y:0,width:0,height:0}}=this.getDimensions(t,e,i)??{};return{x:s.x+o.left,y:s.y-o.bottom}}getHandleStyles(t,e){return e==="start"?{fill:t.handle.fill,stroke:t.handle.stroke??t.stroke,strokeOpacity:t.handle.strokeOpacity,strokeWidth:t.handle.strokeWidth}:{fill:void 0,strokeWidth:0}}updateAnchor(t,e,i,o){const{bodyBounds:s}=this.getDimensions(t,o,e)??{},a=s??o;this.anchor={x:a.x+i.seriesRect.x,y:a.y+i.seriesRect.y-a.height,position:this.anchor.position}}updateShape(t,e,i){const{shape:o}=this;o.fill=t.fill,o.fillOpacity=t.fillOpacity??1,o.stroke=t.stroke,o.strokeWidth=t.strokeWidth??1,o.strokeOpacity=t.strokeOpacity??1;const{tailPoint:s,bodyBounds:a}=this.getDimensions(t,e,i)??{};!s||!a||this.updatePath(s,a)}updatePath(t,e){const{x:i,y:o}=t,{x:s,y:a,width:n,height:r}=e,l=a-r,c=s+n,h=this.calculateCalloutPlacement({x:i,y:o},e),d=8,u=[{coordinates:{x0:s,x1:s+d,y0:l+d,y1:l,cx:h==="topLeft"?i:s+d,cy:h==="topLeft"?o:l+d},type:h==="topLeft"?"calloutCorner":"corner"},{coordinates:{x0:s+d,x1:c-d,y0:l,y1:l,cx:i,cy:o},type:h==="top"?"calloutSide":"side"},{coordinates:{x0:c-d,x1:c,y0:l,y1:l+d,cx:h==="topRight"?i:c-d,cy:h==="topRight"?o:l+d},type:h==="topRight"?"calloutCorner":"corner"},{coordinates:{x0:c,x1:c,y0:l+d,y1:a-d,cx:i,cy:o},type:h==="right"?"calloutSide":"side"},{coordinates:{x0:c,x1:c-d,y0:a-d,y1:a,cx:h==="bottomRight"?i:c-d,cy:h==="bottomRight"?o:a-d},type:h==="bottomRight"?"calloutCorner":"corner"},{coordinates:{x0:c-d,x1:s+d,y0:a,y1:a,cx:i,cy:o},type:h==="bottom"?"calloutSide":"side"},{coordinates:{x0:s+d,x1:s,y0:a,y1:a-d,cx:h==="bottomLeft"?i:s+d,cy:h==="bottomLeft"?o:a-d},type:h==="bottomLeft"?"calloutCorner":"corner"},{coordinates:{x0:s,x1:s,y0:a-d,y1:l+d,cx:i,cy:o},type:h==="left"?"calloutSide":"side"}],{path:g}=this.shape;g.clear(),g.moveTo(s,l+d),u.forEach(({coordinates:y,type:f})=>{this.drawPath(g,y,d,f)}),g.closePath()}drawPath(t,{x0:e,y0:i,x1:o,y1:s,cx:a,cy:n},r,l){switch(l){case"calloutCorner":{t.lineTo(a,n),t.lineTo(o,s);break}case"corner":{SA(t,{x0:e,x1:o,y0:i,y1:s,cx:a,cy:n},r,!1);break}case"calloutSide":{if(e!==o){const h=e>o?-1:1,d=Math.min(e,o)+Math.abs(o-e)/2;t.lineTo(d-6*h,i),t.lineTo(a,n),t.lineTo(d+6*h,i),t.lineTo(o,s)}else{const h=i>s?-1:1,d=Math.min(i,s)+Math.abs(i-s)/2;t.lineTo(e,d-6*h),t.lineTo(a,n),t.lineTo(e,d+6*h),t.lineTo(o,s)}break}case"side":default:{t.lineTo(o,s);break}}}calculateCalloutPlacement(t,e){const i=e.x+e.width,o=e.y-e.height;let s,a;return t.x>i?s="right":t.x<e.x&&(s="left"),t.y>e.y?a="bottom":t.y<o&&(a="top"),s&&a?`${a}${s[0].toUpperCase()}${s.substring(1)}`:a??s}getDimensions(t,e,i){const{fontSize:o}=t,s=t.getPadding(),a=s.left+s.right,n=s.top+s.bottom,r=e.width+a,l=Math.max(e.height+n,o+n);return{tailPoint:{x:i.x1,y:i.y1},bodyBounds:{x:e.x,y:e.y,width:r,height:l}}}containsPoint(t,e){const{start:i,end:o,shape:s}=this;if(this.activeHandle=void 0,i.containsPoint(t,e))return this.activeHandle="start",!0;const a=o.containsPoint(t,e)||s.containsPoint(t,e);return a&&(this.activeHandle="end"),a}};import{_ModuleSupport as vA}from"ag-charts-community";function Qh({key:t}){return t==="Escape"}function Jh({key:t,shiftKey:e}){return!e&&t==="Enter"}var{StateMachine:mi,StateMachineProperty:dy,Debug:MA}=vA,tp=class extends mi{constructor(t){const e=({point:u})=>{const g=this.createDatum();g.set({start:u,end:u,visible:!0}),t.create(g)},i=()=>{const{node:u}=this;u?.toggleActive(!0),u?.toggleHandles({start:!0})},o=()=>{t.showTextInput(),this.datum&&(this.datum.visible=!1)},s=()=>{t.hideTextInput(),this.datum&&(this.datum.visible=!0),t.deselect()},a=u=>{this.node?.setTextInputBBox(u),t.update()},n=({point:u})=>{const{datum:g,node:y}=this;g?.set({end:u}),y?.toggleActive(!0),y?.toggleHandles({end:!1}),t.update()},r=()=>{t.showAnnotationOptions(),this.node?.toggleHandles({end:!0})},l=({colorPickerType:u,colorOpacity:g,color:y,opacity:f,isMultiColor:x})=>{const{datum:S}=this;S&&(u==="text-color"&&t.updateTextInputColor(y),Ar(S,u,g,y,f,x),t.update())},c=u=>{const{datum:g,node:y}=this;!g||!y||!Oi(g)||(g.fontSize=u,t.updateTextInputFontSize(u),t.update())},h=()=>{t.delete()},d=({textInputValue:u,bbox:g})=>{const{datum:y}=this;if(g!=null&&u!=null&&u.length>0){if(!Oi(y))return;const f=Sr(y,u,g.width);y?.set({text:f}),t.update(),t.recordAction(`Create ${y?.type} annotation`)}else t.delete()};super("start",{start:{click:{target:"waiting-first-render",action:e},dragStart:{target:"waiting-first-render",action:e},cancel:mi.parent,reset:mi.parent},"waiting-first-render":{render:{target:"end",action:i}},end:{hover:n,drag:n,click:{target:"edit",action:r},dragEnd:{target:"edit",action:r},reset:{target:mi.parent,action:h},cancel:{target:mi.parent,action:h}},edit:{onEnter:o,updateTextInputBBox:a,color:l,fontSize:c,textInput:[{guard:Qh,target:mi.parent,action:h},{guard:Jh,target:mi.parent,action:d}],click:{target:mi.parent,action:d},dragStart:{target:mi.parent,action:d},resize:{target:mi.parent,action:d},onExit:s,cancel:{target:mi.parent,action:h}}}),this.debug=MA.create(!0,"annotations")}};p([dy()],tp.prototype,"datum",2),p([dy()],tp.prototype,"node",2);var DA=class extends tp{createDatum(){return new fi}},uy={type:"callout",datum:fi,scene:_r,isDatum:fi.is,translate:(t,e,i,o)=>{if(fi.is(e)&&_r.is(t))return t.translate(e,i,o)},copy:(t,e,i,o)=>{if(fi.is(e)&&fi.is(i)&&_r.is(t))return t.copy(e,i,o)},update:(t,e,i)=>{fi.is(e)&&_r.is(t)&&t.update(e,i)},createState:(t,{createDatum:e})=>new DA({...t,create:e("callout")}),dragState:t=>new wt(t)};import{_ModuleSupport as gy}from"ag-charts-community";import{calcLineHeight as kA}from"ag-charts-core";import{_ModuleSupport as AA}from"ag-charts-community";var ep=class extends ty{constructor(){super(...arguments),this.label=new AA.Text({zIndex:1}),this.anchor={x:0,y:0,position:"above-left"}}setTextInputBBox(t){this.textInputBBox=t,this.markDirty("TextualPointScene")}update(t,e){const i=bt(t,e),o=this.getTextBBox(t,i,e);this.updateLabel(t,o),this.updateHandle(t,i,o),this.updateShape(t,o),this.anchor=this.updateAnchor(t,o,e)}copy(t,e,i){const o=bt(t,i),s=this.getTextBBox(t,o,i),a=t.getPadding(),n=a.left+a.right,r=a.top+a.bottom,l=(s.width+n)/2,c=s.height+r,h=be({x:o.x-l,y:o.y-c},i);return e.x=h.x,e.y=h.y,e}containsPoint(t,e){const{label:i}=this;return super.containsPoint(t,e)||i.visible&&i.containsPoint(t,e)}getNodeAtCoords(t,e){return this.label.visible&&this.label.containsPoint(t,e)?"text":super.getNodeAtCoords(t,e)}getTextBBox(t,e,i){const{text:o}=t.getText();return Fh(t,o,{x:e.x,y:e.y},this.textInputBBox)}updateLabel(t,e){const{text:i,isPlaceholder:o}=t.getText();Tg(this.label,i,o,t,this.getLabelCoords(t,e),this.getTextBaseline(t))}updateShape(t,e){}updateAnchor(t,e,i){return{x:e.x+i.seriesRect.x,y:e.y+i.seriesRect.y-e.height,position:this.anchor.position}}getLabelCoords(t,e){return e}getTextBaseline(t){return t.position=="center"?"middle":t.position}getHandleCoords(t,e,i){return i}getHandleStyles(t){const e=super.getHandleStyles(t);return e.stroke=t.handle.stroke??t.color,e}},{drawCorner:ip}=gy,Or=class extends ep{constructor(){super(),this.type="comment",this.shape=new gy.Path,this.append([this.shape,this.label,this.handle])}static is(t){return Yt.isCheck(t,"comment")}updateShape(t,e){const{shape:i}=this;i.fill=t.fill,i.fillOpacity=t.fillOpacity??1,i.stroke=t.stroke??"transparent",i.strokeWidth=t.strokeWidth??1,i.strokeOpacity=t.strokeOpacity??1,this.updatePath(t,e)}getLabelCoords(t,e){const i=t.getPadding();return{x:e.x+i.left,y:e.y-i.bottom}}getHandleStyles(t){return{fill:t.handle.fill,stroke:t.handle.stroke??t.stroke??t.fill,strokeOpacity:t.handle.strokeOpacity,strokeWidth:t.handle.strokeWidth}}updateAnchor(t,e,i){const o=super.updateAnchor(t,e,i),s=t.getPadding();return o.y-=s.bottom+s.top,o}updatePath(t,e){const i=t.getPadding(),{x:o,y:s}=e;let{width:a,height:n}=e;const{fontSize:r}=t,l=i.left+i.right,c=i.top+i.bottom;a=a+l,n=Math.max(n+c,r+c);const h=s-n,d=o+a,u=(kA(r,xr)+c)/2,{path:g}=this.shape;g.clear(),g.moveTo(o,s),g.lineTo(o,h+u),ip(g,{x0:o,x1:o+u,y0:h+u,y1:h,cx:o+u,cy:h+u},u,!1),g.lineTo(d-u,h),ip(g,{x0:d-u,x1:d,y0:h,y1:h+u,cx:d-u,cy:h+u},u,!1),g.lineTo(d,s-u),ip(g,{x0:d,x1:d-u,y0:s-u,y1:s,cx:d-u,cy:s-u},u,!1),g.closePath()}containsPoint(t,e){return super.containsPoint(t,e)||this.shape.containsPoint(t,e)}};import{_ModuleSupport as LA}from"ag-charts-community";var{StateMachine:ro,StateMachineProperty:yy,Debug:IA}=LA,dn=class extends ro{constructor(t){const e=({point:h})=>{const d=this.createDatum();d.set({x:h.x,y:h.y}),t.create(d)},i=()=>{this.node?.toggleActive(!0),t.showAnnotationOptions(),t.update()},o=()=>{t.showTextInput(),this.datum&&(this.datum.visible=!1)},s=()=>{t.hideTextInput(),this.datum&&(this.datum.visible=!0),t.deselect()},a=h=>{this.node?.setTextInputBBox(h),t.update()},n=({colorPickerType:h,colorOpacity:d,color:u,opacity:g,isMultiColor:y})=>{this.datum&&(h==="text-color"&&t.updateTextInputColor(u),Ar(this.datum,h,d,u,g,y),t.update())},r=h=>{const{datum:d,node:u}=this;!d||!u||!Oi(d)||(d.fontSize=h,t.updateTextInputFontSize(h),t.update())},l=()=>{t.delete()},c=({textInputValue:h,bbox:d})=>{if(d!=null&&h!=null&&h.length>0){const{datum:u}=this;if(!Oi(u))return;const g=Sr(u,h,d.width);u?.set({text:g}),t.update(),t.recordAction(`Create ${u?.type} annotation`)}else t.delete()};super("start",{start:{click:{target:"waiting-first-render",action:e},dragStart:{target:"waiting-first-render",action:e},cancel:ro.parent,reset:ro.parent},"waiting-first-render":{render:{target:"edit",action:i}},edit:{onEnter:o,updateTextInputBBox:a,color:n,fontSize:r,textInput:[{guard:Qh,target:ro.parent,action:l},{guard:Jh,target:ro.parent,action:c}],click:{target:ro.parent,action:c},dragStart:{target:ro.parent,action:c},resize:{target:ro.parent,action:c},onExit:s,cancel:{target:ro.parent,action:l}}}),this.debug=IA.create(!0,"annotations")}};p([yy()],dn.prototype,"datum",2),p([yy()],dn.prototype,"node",2);var CA=class extends dn{createDatum(){return new Pi}},fy={type:"comment",datum:Pi,scene:Or,isDatum:Pi.is,translate:(t,e,i,o)=>{Pi.is(e)&&Or.is(t)&&t.translate(e,i,o)},copy:(t,e,i,o)=>{if(Pi.is(e)&&Pi.is(i)&&Or.is(t))return t.copy(e,i,o)},update:(t,e,i)=>{Pi.is(e)&&Or.is(t)&&t.update(e,i)},createState:(t,{createDatum:e})=>new CA({...t,create:e("comment")}),dragState:t=>new wt(t)};import{_ModuleSupport as TA}from"ag-charts-community";import{_ModuleSupport as Rr}from"ag-charts-community";var{calculateLabelTranslation:wA}=Rr,my=class extends Rr.Group{constructor(){super({name:"AnnotationAxisLabelGroup"}),this.label=new Rr.Text({zIndex:1}),this.rect=new Rr.Rect;const{label:t}=this;t.fontSize=12,t.fontFamily="Verdana, sans-serif",t.fill="black",t.textBaseline="middle",t.textAlign="center",this.append([this.rect,this.label])}update(t){this.updateLabel(t),this.updateRect(t),this.updatePosition(t)}updateLabel({value:t,styles:e,context:i}){const{fontWeight:o,fontSize:s,fontStyle:a,fontFamily:n,textAlign:r,color:l="white",formatter:c}=e,h=c?c({value:t}):i.formatScaleValue(t,"annotation-label");this.label.setProperties({fontWeight:o,fontSize:s,fontStyle:a,fontFamily:n,textAlign:r,fill:l,text:h})}updateRect({styles:t}){const{rect:e}=this,{cornerRadius:i,fill:o,fillOpacity:s,stroke:a,strokeOpacity:n}=t;e.fill=o,e.fillOpacity=s??1,e.stroke=a,e.strokeOpacity=n??1,e.cornerRadius=i??0}updatePosition({x:t,y:e,context:i,styles:{padding:o}}){const{label:s,rect:a}=this,n=s.getBBox()?.clone(),r=o??8,l=o??4,{xTranslation:c,yTranslation:h}=wA({yDirection:!0,padding:i.labelPadding,position:i.position??"left",bbox:n});n.grow(r,"horizontal"),n.grow(l,"vertical");const d=t+c,u=e+h;s.x=d,s.y=u,a.y=u-Math.round(n.height/2),a.x=d-Math.round(n.width/2),a.height=n.height,a.width=n.width}};my.className="AxisLabel";import{_ModuleSupport as Br}from"ag-charts-community";var{Vec2:Ri}=Br,Te=class extends Br.Line{constructor(){super(...arguments),this.growCollisionBox=9,this.clipMask=new Map}setProperties(t){return super.setProperties(t),this.updateCollisionBBox(),this}updateCollisionBBox(){const{growCollisionBox:t,strokeWidth:e,x1:i,y1:o,x2:s,y2:a}=this;let n=e+t;n%2===0&&(n+=1);const r=Ri.from(i,o-Math.floor(n/2)),l=Ri.from(s,a),c=Ri.distance(r,l);this.collisionBBox=new Br.BBox(r.x,r.y,c,n)}isPointInPath(t,e){const{collisionBBox:i,x1:o,y1:s,x2:a,y2:n}=this;if(!i)return!1;const r=Ri.from(o,s),l=Ri.from(a,n),c=Ri.sub(Ri.from(t,e),r),h=Ri.sub(l,r),d=Ri.rotate(c,Ri.angle(c,h),r);return i.containsPoint(d.x,d.y)??!1}render(t){const{clipMask:e}=this,{ctx:i}=t;if(e.size===0){super.render(t);return}i.save();try{for(const o of this.clipMask.values()){const{x:s,y:a,radius:n}=o;i.beginPath(),i.rect(0,0,i.canvas.width,i.canvas.height),i.ellipse(s,a,n,n,0,Math.PI*2,0,!0),i.clip()}super.render(t)}finally{i.restore()}}setClipMask(t,e){const i=this.clipMask.get(t);Br.jsonDiff(i,e)!=null&&this.markDirty("CollidableLine"),e?this.clipMask.set(t,e):this.clipMask.delete(t)}};import{_ModuleSupport as NA}from"ag-charts-community";var us=class extends NA.TransformableText{constructor(){super(...arguments),this.growCollisionBox={top:4,right:4,bottom:4,left:4}}isPointInPath(t,e){const i=this.fromParentPoint(t,e),o=this.computeBBoxWithoutTransforms();return o?o.grow(this.growCollisionBox).containsPoint(i.x,i.y):!1}};import{_ModuleSupport as PA}from"ag-charts-community";var{Vec2:de}=PA;function pa(t,e,i,o,s,a,n){if(!a||!s||!o){e.setClipMask(t);return}const{alignment:r,position:l}=o,c=Sy(i,o.fontSize,n),{point:h,textBaseline:d}=by(c,l,r);vy(s,a,o,h,c.angle,d);const{x:u,y:g,width:y,height:f}=s.getBBox(),x=de.length(de.from(y,f)),S={x:u+y/2,y:g+f/2,radius:x/2+de.length(c.offset)};return l==="center"?e.setClipMask(t,S):e.setClipMask(t),{clipMask:S,numbers:c}}function xy(t,e,i,o,s,a,n){if(!n||!a)return;const{alignment:r,position:l}=o,[c,h]=e.y1<=i.y1?[e,i]:[i,e];let d=c;l==="bottom"?d=h:l==="inside"&&(d={x1:(c.x1+h.x1)/2,y1:(c.y1+h.y1)/2,x2:(c.x2+h.x2)/2,y2:(c.y2+h.y2)/2});const u=Sy(d,o.fontSize,s),{point:g,textBaseline:y}=by(u,l==="inside"?"center":l,r,t);vy(a,n,o,g,u.angle,y)}function Sy(t,e,i){let[o,s]=de.from(t);o.x>s.x&&([o,s]=[s,o]);const a=de.normalized(de.sub(s,o)),n=de.angle(a),r=de.multiply(a,vt.HANDLE_SIZE/2+(e??14)/2),l=de.multiply(a,(i??2)/2+(e??14)/3);return{left:o,right:s,normal:a,angle:n,inset:r,offset:l}}function by({left:t,right:e,normal:i,angle:o,inset:s,offset:a},n,r,l){let c;r==="right"?c=de.sub(e,s):r==="center"?c=de.add(t,de.multiply(i,de.distance(t,e)/2)):c=de.add(t,s);let h="bottom";return n==="bottom"?(c=de.rotate(a,o+Math.PI/2,c),h="top"):n==="center"&&!l?h="middle":c=de.rotate(a,o-Math.PI/2,c),{point:c,textBaseline:h}}function vy(t,e,i,o,s,a){t.setProperties({text:e,x:o.x,y:o.y,rotation:s,rotationCenterX:o.x,rotationCenterY:o.y,fill:i.color,fontFamily:i.fontFamily,fontSize:i.fontSize,fontStyle:i.fontStyle,fontWeight:i.fontWeight,textAlign:i.alignment,textBaseline:a})}var{ChartAxisDirection:EA,Vec2:gs,Vec4:op}=TA,Oo=class extends Yt{constructor(){super(),this.type="cross-line",this.line=new Te,this.middle=new ha,this.isHorizontal=!1,this.append([this.line,this.middle])}static is(t){return Yt.isCheck(t,"cross-line")}update(t,e){const{seriesRect:i}=e;this.seriesRect=i,this.isHorizontal=pe.is(t);const o=this.isHorizontal?e.yAxis:e.xAxis,s=this.convertCrossLine(t,o);if(s==null){this.visible=!1;return}this.visible=t.visible??!0,this.visible&&(this.updateLine(t,s),this.updateHandle(t,s),this.updateText(t,s),this.updateAxisLabel(t,o,s))}updateLine(t,e){const{line:i}=this,{lineDashOffset:o,stroke:s,strokeWidth:a,strokeOpacity:n}=t,{x1:r,y1:l,x2:c,y2:h}=e;i.setProperties({x1:r,y1:l,x2:c,y2:h,lineCap:t.getLineCap(),lineDash:t.getLineDash(),lineDashOffset:o,stroke:s,strokeWidth:a,strokeOpacity:n,fillOpacity:0})}updateHandle(t,e){const{middle:i}=this,{locked:o,stroke:s,strokeWidth:a,strokeOpacity:n}=t,r={fill:t.handle.fill,stroke:t.handle.stroke??s,strokeOpacity:t.handle.strokeOpacity??n,strokeWidth:t.handle.strokeWidth??a},l=gs.sub(op.center(e),gs.from(i.handle.width/2,i.handle.height/2));i.gradient=this.isHorizontal?"horizontal":"vertical",i.update({...r,...l}),i.toggleLocked(o??!1)}updateText(t,e){this.text=this.updateNode(us,this.text,!!t.text.label),pa(this.line.id,this.line,e,t.text,this.text,t.text.label,t.strokeWidth)}createAxisLabel(t){const e=new my;return t.attachLabel(e),e}updateAxisLabel(t,e,i){this.axisLabel??(this.axisLabel=this.createAxisLabel(e));const{axisLabel:o,seriesRect:s}=this,{direction:a,position:n}=e;if(t.axisLabel.enabled){o.visible=this.visible;const r=n==="left"||n==="top"?op.start(i):op.end(i),l=a===EA.X?r.x:r.y;if(!e.inRange(l)){o.visible=!1;return}const c=Bt(t.value);o.update({...gs.add(r,gs.required(s)),value:c,styles:t.axisLabel,context:e})}else o.visible=!1}setAxisLabelOpacity(t){this.axisLabel&&(this.axisLabel.opacity=t)}setAxisLabelVisible(t){this.axisLabel&&(this.axisLabel.visible=t)}toggleHandles(t){this.middle.visible=t,this.middle.toggleHovered(this.activeHandle==="middle")}destroy(){super.destroy(),this.axisLabel?.destroy()}toggleActive(t){this.toggleHandles(t),this.middle.toggleActive(t)}dragStart(t,e,i){const o=pe.is(t)?{x:e.x,y:Qi(t.value,i.yAxis)}:{x:Qi(t.value,i.xAxis),y:e.y};this.dragState={offset:e,middle:o}}drag(t,e,i){const{activeHandle:o,dragState:s}=this;!t.isWriteable()||!s||(o&&this[o].toggleDragging(!0),this.translatePoint(t,s.middle,gs.sub(e,s.offset),i))}translate(t,e,i){if(!t.isWriteable())return;const o=pe.is(t)?gs.from(0,Qi(t.value,i.yAxis)):gs.from(Qi(t.value,i.xAxis),0);this.translatePoint(t,o,e,i)}translatePoint(t,e,i,o){const s=pe.is(t);s?i.x=0:i.y=0;const{point:a}=no({point:e},i,o);t.value=s?a.y:a.x}stopDragging(){this.middle.toggleDragging(!1)}copy(t,e,i){const o=pe.is(t),s=this.isHorizontal?i.yAxis:i.xAxis,a=this.convertCrossLine(t,s);if(!a)return;const n=o?-30:0,r=o?0:-30,l=be({x:a.x1+r,y:a.y1+n},i);return e.set({value:o?l.y:l.x}),e}getCursor(){return this.activeHandle==null?"pointer":this[this.activeHandle].getCursor()}containsPoint(t,e){const{middle:i,line:o,text:s}=this;return this.activeHandle=void 0,i.containsPoint(t,e)?(this.activeHandle="middle",!0):o.isPointInPath(t,e)||!!s?.containsPoint(t,e)}getNodeAtCoords(t,e){if(this.text?.containsPoint(t,e))return"text";if(this.line.isPointInPath(t,e))return"line";if(this.middle.containsPoint(t,e))return"handle"}getAnchor(){const t=this.computeBBoxWithoutHandles();return this.isHorizontal?{x:t.x+t.width/2,y:t.y}:{x:t.x+t.width,y:t.y+t.height/2,position:"right"}}convertCrossLine(t,e){if(t.value==null)return;let i=0,o=0,s,a;const{bounds:n}=e,r=Qi(t.value,e);return pe.is(t)?(s=n.width,o=r,a=r):(i=r,s=r,a=n.height),{x1:i,y1:o,x2:s,y2:a}}};import{_ModuleSupport as _A}from"ag-charts-community";var{StateMachine:zr,StateMachineProperty:OA,Debug:RA}=_A,sp=class extends zr{constructor(t,e){const i=({point:s})=>{const a=t==="horizontal",n=a?new pe:new Ei;n.set({value:a?s.y:s.x}),e.create(n),e.recordAction(`Create ${a?"horizontal-line":"vertical-line"} annotation`)},o=()=>{this.node?.toggleActive(!0),e.showAnnotationOptions(),e.update()};super("start",{start:{click:{target:"waiting-first-render",action:i},drag:{target:"waiting-first-render",action:i},reset:zr.parent,cancel:zr.parent},"waiting-first-render":{render:{target:zr.parent,action:o}}}),this.debug=RA.create(!0,"annotations")}};p([OA()],sp.prototype,"node",2);var My={type:"horizontal-line",datum:pe,scene:Oo,isDatum:pe.is,translate:(t,e,i,o)=>{pe.is(e)&&Oo.is(t)&&t.translate(e,i,o)},copy:(t,e,i,o)=>{if(pe.is(e)&&pe.is(i)&&Oo.is(t))return t.copy(e,i,o)},update:(t,e,i)=>{pe.is(e)&&Oo.is(t)&&t.update(e,i)},createState:(t,{createDatum:e})=>new sp("horizontal",{...t,create:e("horizontal-line")}),dragState:t=>new wt(t)},Dy={type:"vertical-line",datum:Ei,scene:Oo,isDatum:Ei.is,translate:(t,e,i,o)=>{Ei.is(e)&&Oo.is(t)&&t.translate(e,i,o)},copy:(t,e,i,o)=>{if(Ei.is(e)&&Ei.is(i)&&Oo.is(t))return t.copy(e,i,o)},update:(t,e,i)=>{Ei.is(e)&&Oo.is(t)&&t.update(e,i)},createState:(t,{createDatum:e})=>new sp("vertical",{...t,create:e("vertical-line")}),dragState:t=>new wt(t)};import{_ModuleSupport as BA}from"ag-charts-community";import{_ModuleSupport as ky}from"ag-charts-community";import{_ModuleSupport as zA}from"ag-charts-community";var{Vec4:FA}=zA,Ay=class{static updateBackground(t,e,i,o){const{background:s}=this,{seriesRect:a}=o;s.path.clear(!0);const n=FA.from(0,0,a.width,a.height),r=this.getBackgroundPoints(t,e,i,n);for(let c=0;c<r.length;c++){const h=r[c];c===0?s.path.moveTo(h.x,h.y):s.path.lineTo(h.x,h.y)}s.path.closePath(),s.checkPathDirty();const l=this.getBackgroundStyles?.(t)??t.background;s.fill=l.fill,s.fillOpacity=l.fillOpacity??1}},Ly=class extends cy{constructor(){super(...arguments),this.handles={},this.overflowContinuous=2,this.topLine=new Te,this.bottomLine=new Te,this.background=new ky.Path({zIndex:-1}),this.anchor={x:0,y:0},this.updateBackground=Ay.updateBackground.bind(this)}update(t,e){const{locked:i,visible:o}=t,s=Se(t,e),a=Se(t.bottom,e);if(s==null||a==null){this.visible=!1;return}else this.visible=o??!0;const n=this.extendLine(s,t,e),r=this.extendLine(a,t,e);this.updateLines(t,n,r,e,s,a),this.updateHandles(t,s,a),this.updateText(t,s,a),this.updateBackground(t,n,r,e),this.updateAnchor(s,a);for(const l of Object.values(this.handles))l.toggleLocked(i??!1)}toggleHandles(t){const{handles:e}=this;if(typeof t=="boolean"){for(const[i,o]of Object.entries(e))o.visible=t,o.toggleHovered(this.activeHandle===i);return}for(const[i,o]of Object.entries(t)){const s=e[i];s.visible=o??!0,s.toggleHovered(this.activeHandle===i)}}toggleActive(t){this.toggleHandles(t);for(const e of Object.values(this.handles))e.toggleActive(t)}stopDragging(){const{activeHandle:t,handles:e}=this;t!=null&&e[t].toggleDragging(!1)}getAnchor(){return this.anchor}getCursor(){return this.activeHandle==null?"pointer":this.handles[this.activeHandle].getCursor()}containsPoint(t,e){const{handles:i,topLine:o,bottomLine:s,text:a}=this;this.activeHandle=void 0;for(const[n,r]of Object.entries(i))if(r.containsPoint(t,e))return this.activeHandle=n,!0;return o.containsPoint(t,e)||s.containsPoint(t,e)||!!a?.containsPoint(t,e)}getNodeAtCoords(t,e){if(this.text?.containsPoint(t,e))return"text";if(this.topLine.containsPoint(t,e)||this.bottomLine.containsPoint(t,e))return"line";for(const[i,o]of Object.entries(this.handles))if(o.containsPoint(t,e))return"handle"}updateAnchor(t,e){const{x:i,y:o}=ky.Transformable.toCanvasPoint(this.topLine,(t.x1+t.x2)/2,Math.min(t.y1,t.y2,e.y1,e.y2));this.anchor.x=i,this.anchor.y=o}},{Vec2:ii,Vec4:Ro}=BA,Fr=class extends Ly{constructor(){super(),this.type="disjoint-channel",this.handles={topLeft:new vt,topRight:new vt,bottomLeft:new vt,bottomRight:new ha},this.append([this.background,this.topLine,this.bottomLine,...Object.values(this.handles)])}static is(t){return Yt.isCheck(t,"disjoint-channel")}dragHandle(t,e,i,o){const{activeHandle:s,handles:a}=this;if(s==null)return;const{offset:n}=a[s].drag(e);a[s].toggleDragging(!0),s==="bottomRight"&&(n.x=0);let r=[],l=[],c=o;switch(s){case"topLeft":r=["topLeft"],l=["bottomLeft"];break;case"bottomLeft":r=["bottomLeft"],l=["topLeft"];break;case"topRight":r=["topRight"],l=["bottomRight"];break;case"bottomRight":r=["bottomLeft","bottomRight"],c=!1;break}const h=Se(t,i),d=Se(t.bottom,i);if(!h||!d)return;const u={topLeft:Ro.start(h),topRight:Ro.end(h),bottomLeft:Ro.start(d),bottomRight:Ro.end(d)},g={vectors:{topLeft:u.topRight,bottomLeft:u.bottomRight,topRight:u.topLeft,bottomRight:u.bottomLeft},angle:t.snapToAngle},y=no(u,n,i,{overflowContinuous:this.overflowContinuous,translateVectors:r,invertYVectors:l,snap:c?g:void 0});t.start.x=y.topLeft.x,t.start.y=y.topLeft.y,t.end.x=y.topRight.x,t.end.y=y.topRight.y,t.startHeight=y.topLeft.y-y.bottomLeft.y,t.endHeight=y.topRight.y-y.bottomRight.y}getTranslatePointsVectors(t,e){const{bottomLeft:i,bottomRight:o,topLeft:s,topRight:a}=this.handles,n=i.getBBox().y-s.getBBox().y,r=o.getBBox().y-a.getBBox().y,l=ii.add(t,ii.from(0,n)),c=ii.add(e,ii.from(0,r));return{start:t,end:e,bottomStart:l,bottomEnd:c}}updateLines(t,e,i){const{topLine:o,bottomLine:s}=this,{lineDashOffset:a,stroke:n,strokeOpacity:r,strokeWidth:l}=t,c={lineCap:t.getLineCap(),lineDash:t.getLineDash(),lineDashOffset:a,stroke:n,strokeOpacity:r,strokeWidth:l};o.setProperties({...e,...c}),s.setProperties({...i,...c})}updateHandles(t,e,i){const{handles:{topLeft:o,topRight:s,bottomLeft:a,bottomRight:n}}=this,r={fill:t.handle.fill,stroke:t.handle.stroke??t.stroke,strokeOpacity:t.handle.strokeOpacity??t.strokeOpacity,strokeWidth:t.handle.strokeWidth??t.strokeWidth};o.update({...r,...Ro.start(e)}),s.update({...r,...Ro.end(e)}),a.update({...r,...Ro.start(i)}),n.update({...r,...ii.sub(Ro.end(i),ii.from(n.handle.width/2,n.handle.height/2))})}updateText(t,e,i){this.text=this.updateNode(us,this.text,!!t.text.label),xy(!1,e,i,t.text,t.strokeWidth,this.text,t.text.label)}getBackgroundPoints(t,e,i,o){const s=e.x1>e.x2,a=e.y1>e.y2,n=a?o.y2:o.y1,r=a?o.y1:o.y2,l=ii.from(e);return t.extendEnd&&e.y2===r&&l.push(ii.from(s?o.x1:o.x2,a?o.y1:o.y2)),t.extendEnd&&i.y2===n&&l.push(ii.from(s?o.x1:o.x2,a?o.y2:o.y1)),l.push(...ii.from(i).reverse()),t.extendStart&&i.y1===r&&l.push(ii.from(s?o.x2:o.x1,a?o.y1:o.y2)),t.extendStart&&e.y1===n&&l.push(ii.from(s?o.x2:o.x1,a?o.y2:o.y1)),l}};import{_ModuleSupport as VA}from"ag-charts-community";import{isNumber as da}from"ag-charts-core";var{StateMachine:Bo,StateMachineProperty:ap,Debug:HA}=VA,Vr=class extends Bo{constructor(t){const e=({point:l})=>{const c=new Qe;c.set({start:l,end:l,startHeight:0,endHeight:0}),t.create(c)},i=()=>{const{node:l}=this;l?.toggleActive(!0),l?.toggleHandles({topLeft:!0,topRight:!1,bottomLeft:!1,bottomRight:!1})},o=({offset:l,context:c})=>{const{datum:h,snapping:d}=this;h&&(h.set({end:pn(l,c,d,h.start,h.snapToAngle)}),t.update())},s=()=>{this.node?.toggleHandles({topRight:!0}),t.update()},a=({point:l})=>{const{datum:c,node:h}=this,d=Bt(c?.end.y),u=Bt(c?.start.y),{y:g}=l;if(c==null||!da(u)||!da(d)||!da(g))return;const y=d-(g??0),f=(u-d)*2+y,x={x:c?.start.x,y:u-f},S={x:c?.end.x,y:l.y};h?.toggleHandles({bottomLeft:!0,bottomRight:!0}),!(!t.validatePoint(x,{overflowContinuous:!0})||!t.validatePoint(S,{overflowContinuous:!0}))&&(c.set({startHeight:f,endHeight:y}),t.update())},n=({point:l})=>{const{datum:c,node:h}=this,d=Bt(c?.end.y),u=Bt(c?.start.y),{y:g}=l;if(c==null||!da(u)||!da(d)||!da(g))return;const y=d-(g??0),f=(u-d)*2+y,x={x:c.start.x,y:u-y},S={x:c.end.x,y:l.y};h?.toggleHandles(!0),!(!t.validatePoint(x,{overflowContinuous:!0})||!t.validatePoint(S,{overflowContinuous:!0}))&&(c.set({startHeight:f,endHeight:y}),t.recordAction("Create disjoint-channel annotation"),t.showAnnotationOptions(),t.update())},r=()=>t.delete();super("start",{start:{click:{target:"waiting-first-render",action:e},drag:{target:"waiting-first-render",action:e},reset:Bo.parent},"waiting-first-render":{render:{target:"end",action:i}},end:{hover:o,drag:o,click:{target:"height",action:s},dragEnd:{target:"height",action:s},reset:{target:Bo.parent,action:r},cancel:{target:Bo.parent,action:r}},height:{hover:a,click:{target:Bo.parent,action:n},drag:{target:Bo.parent,action:n},reset:{target:Bo.parent,action:r},cancel:{target:Bo.parent,action:r}}}),this.debug=HA.create(!0,"annotations"),this.snapping=!1}};p([ap()],Vr.prototype,"datum",2),p([ap()],Vr.prototype,"node",2),p([ap()],Vr.prototype,"snapping",2);var Iy={type:"disjoint-channel",datum:Qe,scene:Fr,isDatum:Qe.is,translate:(t,e,i,o)=>{Qe.is(e)&&Fr.is(t)&&t.translate(e,i,o)},copy:(t,e,i,o)=>{if(Qe.is(e)&&Qe.is(i)&&Fr.is(t))return t.copy(e,i,o)},update:(t,e,i)=>{Qe.is(e)&&Fr.is(t)&&t.update(e,i)},createState:(t,{createDatum:e})=>new Vr({...t,create:e("disjoint-channel")}),dragState:t=>new wt(t)};import{_ModuleSupport as GA}from"ag-charts-community";import{entries as WA}from"ag-charts-core";import{_ModuleSupport as lo}from"ag-charts-community";var np=[0,23.6,38.2,50,61.8,78.6,100],KA=[161.8,261.8,361.8,423.6],$A=[...np,...KA],jA={10:$A,6:np,4:np.filter(t=>t!==78.6&&t!==23.6)},YA=10;function UA(t,e){const{x2:i,y1:o,y2:s}=t,a=o-s;return e==null?{x1:i,x2:i,y1:s-a,y2:s}:{x1:e.x1,x2:e.x2,y1:e.y2-a,y2:e.y2}}function Cy({x1:t,y1:e,x2:i,y2:o},s,a,n,r=10){const l=e-o,c=a?-1:1;let h=n;const d=[];return jA[r].forEach((u,g)=>{const y=n+l*(u/100)*c,f=s.yAxis.scaleInvert(y);d.push({id:g,x1:t,x2:i,y1:h,y2:y,tag:u==100?0:1,label:{x1:Math.min(t,i)-YA,x2:i,y1:y,y2:y,text:`${(u/100).toFixed(3)} (${f.toFixed(2)})`}}),h=y}),d}var{Vec2:XA,Vec4:Ty}=lo,wy=class extends Yt{constructor(){super(),this.trendLine=new Te,this.rangeFillsGroup=new lo.Group({name:`${this.id}-range-fills`}),this.rangeFillsGroupSelection=lo.Selection.select(this.rangeFillsGroup,lo.Range),this.rangeStrokesGroup=new lo.Group({name:`${this.id}-range-strokes`}),this.rangeStrokesGroupSelection=lo.Selection.select(this.rangeStrokesGroup,Te),this.labelsGroup=new lo.Group({name:`${this.id}-ranges-labels`}),this.labelsGroupSelection=lo.Selection.select(this.labelsGroup,us),this.anchor={x:0,y:0,position:"above"},this.append([this.trendLine,this.rangeFillsGroup,this.rangeStrokesGroup,this.labelsGroup])}update(t,e){let i=Se(t,e);if(i==null){this.visible=!1;return}if(i=Ty.round(i),this.visible=t.visible??!0,!this.visible)return;this.updateLine(t,i,this.trendLine),this.updateHandles(t,i),this.updateAnchor(t,i,e);const{reverse:o}=t,s=this.extendLine(i,t,e),a=o?s.y1:s.y2,n=o?s.y2:s.y1,r=Cy(s,e,t.reverse,a,t.bands);this.updateRanges(t,r,e);const l={...s,y1:n,y2:n};this.updateText(t,l)}extendLine({x1:t,y1:e,x2:i,y2:o},s,a){const n={x1:t,y1:e,x2:i,y2:o};if(!s.extendStart&&!s.extendEnd)return n;const{x:r,width:l}=a.xAxis.bounds;return s.extendEnd&&(n[t>i?"x1":"x2"]=r+l),s.extendStart&&(n[t>i?"x2":"x1"]=r),n}updateLine(t,e,i){if(!e||!i)return;const{lineDashOffset:o,strokeWidth:s,strokeOpacity:a,stroke:n}=t;i.setProperties({...e,lineCap:t.getLineCap(),lineDash:[3,4],lineDashOffset:o,strokeWidth:s,strokeOpacity:a,fillOpacity:0,stroke:n})}updateRangeStrokes(t){const{lineDashOffset:e,strokeWidth:i,strokeOpacity:o,strokes:s,rangeStroke:a,isMultiColor:n}=t;this.rangeStrokesGroupSelection.each((r,{x1:l,x2:c,y2:h,tag:d},u)=>{const g=h,y=n?s[u%s.length]:a;r.setProperties({x1:l,x2:c,y1:g,y2:g,stroke:y,strokeOpacity:o,strokeWidth:i,lineCap:t.getLineCap(),lineDash:t.getLineDash(),lineDashOffset:e,tag:d})})}updateRanges(t,e,i){const o=s=>s.id;this.rangeFillsGroupSelection.update(e,void 0,o),this.rangeStrokesGroupSelection.update(e,void 0,o),this.labelsGroupSelection.update(e,void 0,o),this.updateRangeFills(t),this.updateRangeStrokes(t),this.updateRangeLabels(t,i)}updateRangeFills(t){const{lineDashOffset:e,strokeWidth:i,strokeOpacity:o,strokes:s,rangeStroke:a,showFill:n,isMultiColor:r}=t;this.rangeFillsGroupSelection.each((l,{x1:c,x2:h,y1:d,y2:u},g)=>{const y=r?s[g%s.length]:a;if(!n){l.visible=!1;return}l.setProperties({x1:c,x2:h,y1:d,y2:u,startLine:!1,endLine:!1,stroke:y,strokeOpacity:o,fill:y,fillOpacity:(o??1)*.15,strokeWidth:i,lineCap:t.getLineCap(),lineDash:t.getLineDash(),lineDashOffset:e,visible:!0})})}updateRangeLabels(t,{xAxis:e}){const{rangeStrokesGroupSelection:i}=this,{strokes:o,strokeWidth:s,rangeStroke:a,isMultiColor:n,label:{fontFamily:r,fontSize:l,fontStyle:c,fontWeight:h,color:d}}=t,u={fontFamily:r,fontSize:l,fontStyle:c,fontWeight:h},g=this.checkWithinBounds(e,u,this.labelsGroupSelection.at(0));this.labelsGroupSelection.each((y,f,x)=>{const S=d??(n?o[x%o.length]:a),v=i.at(x);if(!v)return;const{text:m,...b}=f.label;if(g)y.setProperties({...u,text:m,x:b.x1,y:b.y1,textBaseline:"middle",textAlign:"end",fill:S}),pa(y.id,v,b);else{const M={...u,label:m,position:"center",alignment:"left",color:S};pa(y.id,v,b,M,y,m,s)}})}checkWithinBounds(t,e,i){if(!i)return!1;const{text:o,...s}=i.datum.label;i.setProperties({...e,text:o,x:s.x1,y:s.y1,textBaseline:"middle",textAlign:"end"});const{x:a}=i.getBBox();return a>=t.bounds.x&&a<=t.bounds.x+t.bounds.width}updateText(t,e){const i=this.rangeStrokesGroupSelection.selectByTag(0)[0];if(!i)return;const{text:o,strokeWidth:s}=t;this.text=this.updateNode(us,this.text,!!o.label),pa(i.id,i,e,o,this.text,o.label,s)}updateAnchor(t,e,i,o){const s=Ty.topCenter(e);XA.apply(this.anchor,lo.Transformable.toCanvasPoint(this.trendLine,s.x,s.y))}containsPoint(t,e){const{trendLine:i,rangeStrokesGroupSelection:o,text:s}=this;let a=!1;return o.each(n=>a||(a=n.isPointInPath(t,e))),a||i.isPointInPath(t,e)||!!s?.containsPoint(t,e)}getNodeAtCoords(t,e){if(this.text?.containsPoint(t,e))return"text";if(this.trendLine.isPointInPath(t,e))return"line"}getHandleStyles(t){return{fill:t.handle.fill,stroke:t.handle.stroke??t.stroke,strokeOpacity:t.handle.strokeOpacity??t.strokeOpacity,strokeWidth:t.handle.strokeWidth??t.strokeWidth}}drag(t,e,i,o){t.isWriteable()&&(this.activeHandle?this.dragHandle(t,e,i,o):this.dragAll(t,e,i))}getAnchor(){return this.anchor}getCursor(){return"pointer"}};import{_ModuleSupport as ZA}from"ag-charts-community";import{Logger as Ny}from"ag-charts-core";var{ContinuousScale:Py}=ZA;function Hr(t,e,i={overflowContinuous:!1},o){if(e.x==null||e.y==null)return o&&Ny.warnOnce(`${o}requires both an [x] and [y] property, ignoring.`),!1;const{xAxis:s,yAxis:a}=t,n=i.overflowContinuous&&Py.is(s.scale),r=i.overflowContinuous&&Py.is(a.scale),l=n||Ey(e.x,s),c=r||Ey(e.y,a);if(l&&c)return!0;if(o){let h="x & y domains";l&&(h="y domain"),c&&(h="x domain");const d=Bt(e.x),u=Bt(e.y);Ny.warnOnce(`${o}is outside the ${h}, ignoring. - x: [${d}], y: ${u}]`)}return!1}function Ey(t,e){const{domain:i}=e.scale,o=Bt(t);return i&&o!=null&&e.continuous?o>=i[0]&&o<=i.at(-1):!0}var{Vec2:qA,Vec4:ys}=GA,Gr=class extends wy{constructor(){super(),this.type="fibonacci-retracement-trend-based",this.endRetracementLine=new Te,this.start=new vt,this.end=new vt,this.endRetracement=new vt,this.append([this.endRetracementLine,this.start,this.end,this.endRetracement])}static is(t){return Yt.isCheck(t,"fibonacci-retracement-trend-based")}update(t,e){let{coords1:i,coords2:o}=this.getCoords(t,e);if(i==null||o==null){this.visible=!1;return}if(i=ys.round(i),o=ys.round(o),this.visible=t.visible??!0,!this.visible)return;(t.endRetracement.x==null||t.endRetracement.y==null)&&(o=void 0),this.updateLine(t,i,this.trendLine),this.updateLine(t,o,this.endRetracementLine),this.updateHandles(t,i,o),this.updateAnchor(t,o??i,e);const{reverse:s,bands:a}=t,n=UA(i,o),r=this.extendLine(n,t,e),l=r.y2,c=r.y1,h=o?Cy(r,e,s,l,a):[];this.updateRanges(t,h,e);const d={...r,y1:c,y2:c};this.updateText(t,d)}containsPoint(t,e){const{start:i,end:o,endRetracement:s,endRetracementLine:a}=this;return this.activeHandle=void 0,i.containsPoint(t,e)?(this.activeHandle="start",!0):o.containsPoint(t,e)?(this.activeHandle="end",!0):s.containsPoint(t,e)?(this.activeHandle="endRetracement",!0):a.isPointInPath(t,e)||super.containsPoint(t,e)}getNodeAtCoords(t,e){return this.start.containsPoint(t,e)||this.end.containsPoint(t,e)||this.endRetracement.containsPoint(t,e)?"handle":this.endRetracementLine.isPointInPath(t,e)?"line":super.getNodeAtCoords(t,e)}dragStart(t,e,i){this.dragState={offset:e,...wr({start:t.start,end:t.end,endRetracement:t.endRetracement},i)}}stopDragging(){this.start.toggleDragging(!1),this.end.toggleDragging(!1),this.endRetracement.toggleDragging(!1)}dragAll(t,e,i){const{dragState:o}=this;o&&this.translatePoints({datum:t,start:o.start,end:o.end,endRetracement:o.endRetracement,translation:qA.sub(e,o.offset),context:i})}dragHandle(t,e,i,o){const{activeHandle:s,dragState:a}=this;if(!s||!a)return;this[s].toggleDragging(!0);const n=o?this.snapToAngle(t,e,i):be(this[s].drag(e).point,i);!n||!Hr(i,n)||(t[s].x=n.x,t[s].y=n.y)}snapToAngle(t,e,i){const{activeHandle:o}=this,s=["start","end","endRetracement"];if(!o)return;const a=(s.indexOf(o)+1)%s.length,n=s[a];this[o].toggleDragging(!0);const r=bt(t[n],i);return be(Tr(e,r,t.snapToAngle),i)}translatePoints({datum:t,start:e,end:i,endRetracement:o,translation:s,context:a}){const n=no({start:e,end:i,endRetracement:o},s,a,{overflowContinuous:2});t.start.x=n.start.x,t.end.x=n.end.x,t.endRetracement.x=n.endRetracement.x,t.start.y=n.start.y,t.end.y=n.end.y,t.endRetracement.y=n.endRetracement.y}translate(t,e,i){this.translatePoints({datum:t,start:bt(t.start,i),end:bt(t.end,i),endRetracement:bt(t.endRetracement,i),translation:e,context:i})}copy(t,e,i){const{coords1:o,coords2:s}=this.getCoords(t,i);if(!o||!s)return;const a=this.computeBBoxWithoutHandles();return this.translatePoints({datum:e,start:ys.start(o),end:ys.end(o),endRetracement:ys.end(s),translation:{x:-a.width/2,y:-a.height/2},context:i}),e}getCoords(t,e){return{coords1:Se(t,e),coords2:Se({start:t.end,end:t.endRetracement},e)}}toggleHandles(t){if(typeof t=="boolean")this.start.visible=t,this.end.visible=t,this.endRetracement.visible=t;else for(const[e,i]of WA(t))this[e].visible=i;this.start.toggleHovered(this.activeHandle==="start"),this.end.toggleHovered(this.activeHandle==="end"),this.endRetracement.toggleHovered(this.activeHandle==="endRetracement")}toggleActive(t){this.toggleHandles(t),this.start.toggleActive(t),this.end.toggleActive(t),this.endRetracement.toggleActive(t)}updateHandles(t,e,i,o){this.start.update({...this.getHandleStyles(t),...this.getHandleCoords(t,e,"start")}),this.end.update({...this.getHandleStyles(t),...this.getHandleCoords(t,e,"end",o)}),i&&this.endRetracement.update({...this.getHandleStyles(t),...this.getHandleCoords(t,i,"endRetracement",o)}),this.start.toggleLocked(t.locked??!1),this.end.toggleLocked(t.locked??!1),this.endRetracement.toggleLocked(t.locked??!1)}getHandleCoords(t,e,i,o){return i==="start"?ys.start(e):ys.end(e)}};import{_ModuleSupport as QA}from"ag-charts-community";var{StateMachine:zo,StateMachineProperty:rp,Debug:JA}=QA,Wr=class extends zo{constructor(t){const e=({point:c})=>{const h=this.createDatum();h.set({start:c,end:c}),t.create(h)},i=()=>{const{node:c}=this;c?.toggleActive(!0),c?.toggleHandles({start:!0,end:!1,endRetracement:!1})},o=({offset:c,context:h})=>{const{datum:d,snapping:u}=this;d&&(d.set({end:pn(c,h,u,d.start,d.snapToAngle)}),t.update())},s=()=>{const{datum:c}=this;c&&(c.endRetracement.x=c.end.x,c.endRetracement.y=c.end.y,this.node?.toggleHandles({end:!0}),t.update())},a=({offset:c,context:h})=>{const{datum:d,snapping:u}=this;d&&(d.set({endRetracement:pn(c,h,u,d.end,d.snapToAngle)}),t.update())},n=()=>{this.node?.toggleHandles({endRetracement:!0}),t.update()},r=()=>t.delete(),l=()=>{t.showAnnotationOptions(),t.recordAction(`Create ${this.datum?.type} annotation`)};super("start",{start:{click:{target:"waiting-first-render",action:e},drag:{target:"waiting-first-render",action:e},reset:zo.parent},"waiting-first-render":{render:{target:"end",action:i}},end:{hover:o,click:{target:"endRetracement",action:s},drag:o,dragEnd:{target:"endRetracement",action:s},reset:{target:zo.parent,action:r},cancel:{target:zo.parent,action:r},onExit:l},endRetracement:{hover:a,click:{target:zo.parent,action:n},drag:{target:zo.parent,action:n},reset:{target:zo.parent,action:r},cancel:{target:zo.parent,action:r}}}),this.debug=JA.create(!0,"annotations"),this.snapping=!1}createDatum(){return new _i}};p([rp()],Wr.prototype,"datum",2),p([rp()],Wr.prototype,"node",2),p([rp()],Wr.prototype,"snapping",2);var _y={type:"fibonacci-retracement-trend-based",datum:_i,scene:Gr,isDatum:_i.is,translate:(t,e,i,o)=>{_i.is(e)&&Gr.is(t)&&t.translate(e,i,o)},copy:(t,e,i,o)=>{if(_i.is(e)&&_i.is(i)&&Gr.is(t))return t.copy(e,i,o)},update:(t,e,i)=>{_i.is(e)&&Gr.is(t)&&t.update(e,i)},createState:(t,{createDatum:e})=>new Wr({...t,create:e("fibonacci-retracement-trend-based")}),dragState:t=>new wt(t)};import{_ModuleSupport as t2}from"ag-charts-community";import{entries as e2}from"ag-charts-core";var{Vec2:i2,Vec4:Oy}=t2,Kr=class extends wy{constructor(){super(),this.type="fibonacci-retracement",this.start=new vt,this.end=new vt,this.append([this.start,this.end])}static is(t){return Yt.isCheck(t,"fibonacci-retracement")}containsPoint(t,e){const{start:i,end:o}=this;return this.activeHandle=void 0,i.containsPoint(t,e)?(this.activeHandle="start",!0):o.containsPoint(t,e)?(this.activeHandle="end",!0):super.containsPoint(t,e)}getNodeAtCoords(t,e){return this.start.containsPoint(t,e)||this.end.containsPoint(t,e)?"handle":super.getNodeAtCoords(t,e)}dragStart(t,e,i){this.dragState={offset:e,...wr({start:t.start,end:t.end},i)}}stopDragging(){this.start.toggleDragging(!1),this.end.toggleDragging(!1)}dragAll(t,e,i){const{dragState:o}=this;o&&this.translatePoints({datum:t,start:o.start,end:o.end,translation:i2.sub(e,o.offset),context:i})}dragHandle(t,e,i,o){const{activeHandle:s,dragState:a}=this;if(!s||!a)return;this[s].toggleDragging(!0);const n=o?this.snapToAngle(t,e,i):be(this[s].drag(e).point,i);!n||!Hr(i,n)||(t[s].x=n.x,t[s].y=n.y)}snapToAngle(t,e,i){const{activeHandle:o}=this,a=["start","end"].find(r=>r!==o);if(!o||!a)return;this[o].toggleDragging(!0);const n=bt(t[a],i);return be(Tr(e,n,t.snapToAngle),i)}translatePoints({datum:t,start:e,end:i,translation:o,context:s}){const a=no({start:e,end:i},o,s,{overflowContinuous:1});t.start.x=a.start.x,t.end.x=a.end.x,t.start.y=a.start.y,t.end.y=a.end.y}translate(t,e,i){this.translatePoints({datum:t,start:bt(t.start,i),end:bt(t.end,i),translation:e,context:i})}copy(t,e,i){const o=Se(t,i);if(!o)return;const s=this.computeBBoxWithoutHandles();return this.translatePoints({datum:e,start:{x:o.x1,y:o.y1},end:{x:o.x2,y:o.y2},translation:{x:-s.width/2,y:-s.height/2},context:i}),e}toggleHandles(t){if(typeof t=="boolean")this.start.visible=t,this.end.visible=t;else for(const[e,i]of e2(t))this[e].visible=i;this.start.toggleHovered(this.activeHandle==="start"),this.end.toggleHovered(this.activeHandle==="end")}toggleActive(t){this.toggleHandles(t),this.start.toggleActive(t),this.end.toggleActive(t)}updateHandles(t,e,i,o){this.start.update({...this.getHandleStyles(t),...this.getHandleCoords(t,e,"start")}),this.end.update({...this.getHandleStyles(t),...this.getHandleCoords(t,e,"end",o)}),this.start.toggleLocked(t.locked??!1),this.end.toggleLocked(t.locked??!1)}getHandleCoords(t,e,i,o){return i==="start"?Oy.start(e):Oy.end(e)}};import{_ModuleSupport as o2}from"ag-charts-community";var{StateMachine:ua,StateMachineProperty:lp,Debug:s2}=o2,ga=class extends ua{constructor(t){const e=({point:r})=>{const l=this.createDatum();l.set({start:r,end:r}),t.create(l)},i=()=>{const{node:r}=this;r?.toggleActive(!0),r?.toggleHandles({start:!0,end:!1})},o=({offset:r,context:l})=>{const{datum:c,snapping:h}=this;c&&(c.set({end:pn(r,l,h,c.start,c.snapToAngle)}),t.update())},s=()=>{this.node?.toggleHandles({end:!0}),t.update()},a=()=>t.delete(),n=()=>{t.showAnnotationOptions(),t.recordAction(`Create ${this.datum?.type} annotation`)};super("start",{start:{click:{target:"waiting-first-render",action:e},drag:{target:"waiting-first-render",action:e},reset:ua.parent},"waiting-first-render":{render:{target:"end",action:i}},end:{hover:o,click:{target:ua.parent,action:s},drag:o,dragEnd:{target:ua.parent,action:s},reset:{target:ua.parent,action:a},cancel:{target:ua.parent,action:a},onExit:n}}),this.debug=s2.create(!0,"annotations"),this.snapping=!1}};p([lp()],ga.prototype,"datum",2),p([lp()],ga.prototype,"node",2),p([lp()],ga.prototype,"snapping",2);var a2=class extends ga{createDatum(){return new to}},n2=class extends ga{createDatum(){return new eo}},r2=class extends ga{createDatum(){return new oo}},Ry={type:"fibonacci-retracement",datum:oo,scene:Kr,isDatum:oo.is,translate:(t,e,i,o)=>{oo.is(e)&&Kr.is(t)&&t.translate(e,i,o)},copy:(t,e,i,o)=>{if(oo.is(e)&&oo.is(i)&&Kr.is(t))return t.copy(e,i,o)},update:(t,e,i)=>{oo.is(e)&&Kr.is(t)&&t.update(e,i)},createState:(t,{createDatum:e})=>new r2({...t,create:e("fibonacci-retracement")}),dragState:t=>new wt(t)};import{_ModuleSupport as By}from"ag-charts-community";import{_ModuleSupport as cp}from"ag-charts-community";var{Vec2:un}=cp,l2=class extends cp.Group{},$r=class extends l2{constructor(){super(),this.type="arrow",this.path=new cp.Path,this.armLength=6,this.append([this.path])}update(t){const{path:e}=this,{x:i,y:o,angle:s,...a}=t,n=un.from(i,o),r=3*Math.PI/4,l=this.armLength+(t.strokeWidth??0)*2,c=un.rotate(un.from(0,l),s+r,n),h=un.rotate(un.from(l,0),s-r,n);e.setProperties(a),e.fillOpacity=0,e.path.clear(),e.path.moveTo(c.x,c.y),e.path.lineTo(n.x,n.y),e.path.lineTo(h.x,h.y)}},{Vec2:xi,Vec4:zy}=By,Fo=class extends qh{constructor(){super(),this.type="line",this.line=new Te,this.append([this.line,this.start,this.end])}static is(t){return Yt.isCheck(t,"line")}update(t,e){let i=Se(t,e);if(i==null){this.visible=!1;return}i=zy.round(i),this.visible=t.visible??!0,this.visible&&(this.updateLine(t,i,e),this.updateHandles(t,i),this.updateText(t,i),this.updateCaps(t,i),this.updateAnchor(t,i,e))}updateLine(t,e,i){const{line:o}=this,{lineDashOffset:s,stroke:a,strokeWidth:n,strokeOpacity:r}=t,l=this.extendLine(e,t,i);o.setProperties({...l,lineCap:t.getLineCap(),lineDash:t.getLineDash(),lineDashOffset:s,stroke:a,strokeWidth:n,strokeOpacity:r,fillOpacity:0})}updateText(t,e){this.text=this.updateNode(us,this.text,!!t.text.label),pa(this.line.id,this.line,e,t.text,this.text,t.text.label,t.strokeWidth)}updateCaps(t,e){if(!t.startCap&&this.startCap&&(this.removeChild(this.startCap),this.startCap=void 0),!t.endCap&&this.endCap&&(this.removeChild(this.endCap),this.endCap=void 0),!t.startCap&&!t.endCap)return;const{stroke:i,strokeWidth:o,strokeOpacity:s}=t,[a,n]=xi.from(e),r=xi.angle(xi.sub(n,a));t.startCap&&(this.startCap&&this.startCap.type!==t.startCap&&(this.removeChild(this.startCap),this.startCap=void 0),this.startCap==null&&(this.startCap=new $r,this.append([this.startCap])),this.startCap.update({x:a.x,y:a.y,angle:r-Math.PI,stroke:i,strokeWidth:o,strokeOpacity:s})),t.endCap&&(this.endCap&&this.endCap.type!==t.endCap&&(this.removeChild(this.endCap),this.endCap=void 0),this.endCap==null&&(this.endCap=new $r,this.append([this.endCap])),this.endCap.update({x:n.x,y:n.y,angle:r,stroke:i,strokeWidth:o,strokeOpacity:s}))}updateAnchor(t,e,i,o){const s=zy.topCenter(e);xi.apply(this.anchor,By.Transformable.toCanvasPoint(this.line,s.x,s.y))}containsPoint(t,e){const{line:i,text:o}=this;return super.containsPoint(t,e)||i.isPointInPath(t,e)||!!o?.containsPoint(t,e)}getNodeAtCoords(t,e){return this.text?.containsPoint(t,e)?"text":this.line.isPointInPath(t,e)?"line":super.getNodeAtCoords(t,e)}getHandleCoords(t,e,i,o){const{startCap:s,endCap:a}=this;let[n,r]=xi.from(e);const l=xi.angle(xi.sub(r,n));return s&&(n=xi.rotate(xi.from(0,-vt.HANDLE_SIZE/2),l,n)),a&&(r=xi.rotate(xi.from(0,vt.HANDLE_SIZE/2),l,r)),i==="start"?n:r}getHandleStyles(t){return{fill:t.handle.fill,stroke:t.handle.stroke??t.stroke,strokeOpacity:t.handle.strokeOpacity??t.strokeOpacity,strokeWidth:t.handle.strokeWidth??t.strokeWidth}}},Fy={type:"line",datum:eo,scene:Fo,isDatum:eo.is,translate:(t,e,i,o)=>{eo.is(e)&&Fo.is(t)&&t.translate(e,i,o)},copy:(t,e,i,o)=>{if(eo.is(e)&&eo.is(i)&&Fo.is(t))return t.copy(e,i,o)},update:(t,e,i)=>{eo.is(e)&&Fo.is(t)&&t.update(e,i)},createState:(t,{createDatum:e})=>new n2({...t,create:e("line")}),dragState:t=>new wt(t)},Vy={type:"arrow",datum:to,scene:Fo,isDatum:to.is,translate:(t,e,i,o)=>{to.is(e)&&Fo.is(t)&&t.translate(e,i,o)},copy:(t,e,i,o)=>{if(to.is(e)&&to.is(i)&&Fo.is(t))return t.copy(e,i,o)},update:(t,e,i)=>{to.is(e)&&Fo.is(t)&&t.update(e,i)},createState:(t,{createDatum:e})=>new a2({...t,create:e("arrow")}),dragState:t=>new wt(t)};import{_ModuleSupport as hp}from"ag-charts-community";import{isDate as Hy,isNumber as jr}from"ag-charts-core";import{_ModuleSupport as ze}from"ag-charts-community";import{_ModuleSupport as Gy}from"ag-charts-community";function Wy(t,e=0,i=0){let o=e;for(const s of t)if(Array.isArray(s)){for(const a of s)Ky(a,o);o+=Gy.Group.computeChildrenBBox(s).width+i}else Ky(s,o),o+=s.getBBox().width+i}function c2(t,e=0,i=0){let o=e;for(const s of t)if(Array.isArray(s)){for(const a of s)$y(a,o);o+=Gy.Group.computeChildrenBBox(s).height+i}else $y(s,o),o+=s.getBBox().height+i}function Ky(t,e){"x1"in t?(t.x2=e+(t.x2-t.x1),t.x1=e):t.x=e}function $y(t,e){"y1"in t?(t.y2=e+(t.y2-t.y1),t.y1=e):t.y=e}function jy(t,e){"x1"in t?(t.x1+=e,t.x2+=e):t.x+=e}function Yy(t,e){"y1"in t?(t.y1+=e,t.y2+=e):t.y+=e}var{Vec4:pp}=ze,Uy=class extends ze.Group{constructor(){super(),this.name="MeasurerStatisticsScene",this.background=new ze.Rect,this.dateRangeBarsText=new ze.Text,this.dateRangeDivider=new ze.Line,this.dateRangeValueText=new ze.Text,this.priceRangeValueText=new ze.Text,this.priceRangeDivider=new ze.Line,this.priceRangePercentageText=new ze.Text,this.volumeText=new ze.Text,this.volumeFormatter=new Intl.NumberFormat("en-US",{notation:"compact",minimumFractionDigits:2,maximumFractionDigits:2}),this.append([this.background,this.dateRangeBarsText,this.dateRangeDivider,this.dateRangeValueText,this.priceRangeValueText,this.priceRangeDivider,this.priceRangePercentageText,this.volumeText])}update(t,e,i,o,s,a,n){this.verticalDirection=a;const r=this.updateStatistics(t,e,i,n),l=ze.Group.computeChildrenBBox(r.flat()),c=10;l.grow(c),this.updateBackground(t,l,c),this.reposition(r,c,s),this.checkVisibility(t,s,o)}checkVisibility(t,e,i){const o=pp.from(new ze.BBox(0,0,e.seriesRect.width,e.seriesRect.height));pp.collides(i,o)?this.visible=t.visible??!0:this.visible=!1}updateStatistics(t,e,i,o){const{dateRangeBarsText:s,dateRangeDivider:a,dateRangeValueText:n,priceRangeValueText:r,priceRangeDivider:l,priceRangePercentageText:c,volumeText:h}=this,d=8,u=6,g=t.statistics.fontSize+3,y=-2,f=this.getTextStyles(t),x={...this.getDividerStyles(t),x1:0,y1:0,x2:0,y2:g},S=[s,a,n],v=[r,l,c],m=[];return e.priceRange&&(r.setProperties({...f,text:this.formatPriceRangeValue(e.priceRange.value,o)}),l.setProperties(x),c.setProperties({...f,text:this.formatPriceRangePercentage(e.priceRange.percentage,o)}),Wy(v,i.x,d),m.push(v)),e.dateRange&&(s.setProperties({...f,text:this.formatDateRangeBars(e.dateRange.bars,o)}),a.setProperties(x),n.setProperties({...f,text:this.formatDateRangeValue(e.dateRange.value)}),Wy(S,i.x,d),m.push(S)),e.volume!=null?(h.setProperties({...f,x:i.x,text:this.formatVolume(e.volume,o),visible:!0}),m.push(h)):h.visible=!1,c2(m,i.y,u),l.y1+=y,l.y2+=y,a.y1+=y,a.y2+=y,m}updateBackground(t,e,i){const o=this.getBackgroundStyles(t);this.background.setProperties({...o,...e,x:e.x-e.width/2+i,y:e.y})}reposition(t,e,i){const{width:o,height:s}=i.seriesRect,a=pp.from(this.background.getBBox());let n=0;a.x1<0&&(n=-a.x1),a.x2>o&&(n=o-a.x2);const r=Math.min(e,s-a.y2);for(const l of t)if(Array.isArray(l)){const c=ze.Group.computeChildrenBBox(l).width;for(const h of l)jy(h,n-c/2),Yy(h,r)}else jy(l,n-l.getBBox().width/2),Yy(l,r);this.background.x+=n,this.background.y+=r}getTextStyles(t){return{fill:t.statistics.color,fontFamily:t.statistics.fontFamily,fontSize:t.statistics.fontSize,fontStyle:t.statistics.fontStyle,fontWeight:t.statistics.fontWeight,textBaseline:"top"}}getDividerStyles(t){return{stroke:t.statistics.divider.stroke,strokeOpacity:t.statistics.divider.strokeOpacity,strokeWidth:t.statistics.divider.strokeWidth}}getBackgroundStyles(t){return{fill:t.statistics.fill,stroke:t.statistics.stroke,strokeOpacity:t.statistics.strokeOpacity,strokeWidth:t.statistics.strokeWidth,cornerRadius:4}}formatDateRangeBars(t,e){return e?.t("measurerDateRangeBars",{value:t})??`${t}`}formatDateRangeValue(t){const e=[],i=t>=0?"":"-";t=Math.abs(t);const o=1e3*60,s=o*60,a=s*24,n=Math.floor(t/o),r=Math.floor(t/s),l=Math.floor(t/a),c=r%(a/s),h=n%(s/o);return l>=1&&e.push(`${l}d`),r>=1&&(t<a||c!==0)&&e.push(`${c}h`),(t<s||h!==0)&&e.push(`${h}m`),e[0]=`${i}${e[0]}`,e.join(" ")}formatPriceRangeValue(t,e){return e?.t("measurerPriceRangeValue",{value:Number(t.toFixed(2))})??`${t}`}formatPriceRangePercentage(t,e){return e?.t("measurerPriceRangePercent",{value:t})??`${t}`}formatVolume(t,e){const i=isNaN(t)?"":this.volumeFormatter.format(t);return e?.t("measurerVolume",{value:i})??i}},h2=class extends Uy{getDirectionStyles(t){return this.verticalDirection==="down"?t.down.statistics:t.up.statistics}getTextStyles(t){const e=this.getDirectionStyles(t);return{...super.getTextStyles(t),fill:e.color,fontFamily:e.fontFamily,fontSize:e.fontSize,fontStyle:e.fontStyle,fontWeight:e.fontWeight}}getDividerStyles(t){const e=this.getDirectionStyles(t);return{stroke:e.divider.stroke,strokeOpacity:e.divider.strokeOpacity,strokeWidth:e.divider.strokeWidth}}getBackgroundStyles(t){const e=this.getDirectionStyles(t);return{...super.getBackgroundStyles(t),fill:e.fill,stroke:e.stroke,strokeOpacity:e.strokeOpacity,strokeWidth:e.strokeWidth}}},{Vec2:Bi,Vec4:fs}=hp,Fe=class extends qh{constructor(){super(),this.type="measurer",this.horizontalLine=new Te,this.verticalLine=new Te,this.horizontalStartLine=new Te,this.horizontalEndLine=new Te,this.verticalStartLine=new Te,this.verticalEndLine=new Te,this.horizontalEndCap=new $r,this.verticalEndCap=new $r,this.background=new hp.Path({zIndex:-1}),this.updateBackground=Ay.updateBackground.bind(this),this.statistics=this.createStatisticsScene(),this.statistics.zIndex=1,this.append([this.background,this.verticalStartLine,this.verticalEndLine,this.horizontalStartLine,this.horizontalEndLine,this.horizontalLine,this.verticalLine,this.horizontalEndCap,this.verticalEndCap,this.start,this.end,this.statistics])}static is(t){return Yt.isCheck(t,"measurer")}createStatisticsScene(){return new Uy}update(t,e){const i=Se(t,e);if(i==null){this.visible=!1;return}if(this.visible=t.visible??!0,!this.visible)return;const o=this.extendPerpendicular(i,t,e),s={...o,y2:o.y1},a={...o,y1:o.y2};this.verticalDirection=i.y1<i.y2?"down":"up",this.updateVisibilities(t),this.updateLines(t,i),this.updateHandles(t,i),this.updateText(t,i),this.updateCaps(t,i),this.updateBoundingLines(t,o),this.updateBackground(t,s,a,e),this.updateStatistics(t,i,e),this.updateAnchor(t,i,e)}extendPerpendicular(t,e,i){const o={x1:Math.min(t.x1,t.x2),x2:Math.max(t.x1,t.x2),y1:Math.min(t.y1,t.y2),y2:Math.max(t.y1,t.y2)},[s,a]=Bi.from(i.yAxis.bounds);return Ze.is(e)?(e.extendAbove&&(o.y1=s.y),e.extendBelow&&(o.y2=a.y)):qe.is(e)&&(e.extendLeft&&(o.x1=s.x),e.extendRight&&(o.x2=a.x)),o}updateVisibilities(t){const{horizontalStartLine:e,horizontalEndLine:i,horizontalEndCap:o,verticalStartLine:s,verticalEndLine:a,verticalEndCap:n}=this,{direction:r}=t;s.visible=r!=="vertical",a.visible=r!=="vertical",o.visible=r!=="vertical",e.visible=r!=="horizontal",i.visible=r!=="horizontal",n.visible=r!=="horizontal"}updateLines(t,e){const{horizontalLine:i,verticalLine:o}=this,{direction:s}=t,{x1:a,y1:n,x2:r,y2:l}=e,c=Bi.round(fs.center(e),0),h=this.getLineStyles(t);s!=="vertical"&&i.setProperties({...h,x1:a,x2:r,y1:c.y,y2:c.y}),s!=="horizontal"&&o.setProperties({...h,x1:c.x,x2:c.x,y1:n,y2:l})}updateText(t,e){const{direction:i}=t,o=Bi.round(fs.center(e),0);let s;const a={...e};i==="vertical"?(s=this.verticalLine,a.x1=o.x,a.x2=o.x):(s=this.horizontalLine,a.y1=o.y,a.y2=o.y),this.text=this.updateNode(us,this.text,!!t.text.label);const{id:n}=s,r=pa(n,s,a,t.text,this.text,t.text.label,t.strokeWidth);let l;if(i==="both"&&r&&this.text){const c=fs.from(this.text.getBBox()),{offset:h}=r.numbers;c.x1<=o.x+h.x&&c.x2>=o.x-h.x&&(l={x:o.x,y:r.clipMask.y,radius:this.text.getBBox().height/2+Bi.length(h)})}this.verticalLine.setClipMask(n,l)}updateCaps(t,e){const{horizontalEndCap:i,verticalEndCap:o}=this,{direction:s}=t,{x1:a,y1:n,x2:r,y2:l}=e,c=Bi.round(fs.center(e),0),{stroke:h,strokeWidth:d,strokeOpacity:u}=this.getLineStyles(t),g={stroke:h,strokeWidth:d,strokeOpacity:u};if(s!=="vertical"){const y=a<=r?0:Math.PI;let f=r;s==="horizontal"&&(f+=a<=r?-2:2),i.update({...g,x:f,y:c.y,angle:y})}if(s!=="horizontal"){const y=n<=l?Math.PI/2:Math.PI/-2;let f=l;s==="vertical"&&(f+=n<=l?-2:2),o.update({...g,x:c.x,y:f,angle:y})}}updateBoundingLines(t,e){const{verticalStartLine:i,verticalEndLine:o,horizontalStartLine:s,horizontalEndLine:a}=this,{direction:n}=t,{x1:r,y1:l,x2:c,y2:h}=e,d=this.getLineStyles(t);n==="horizontal"&&(i.setProperties({...d,x1:r,y1:l,x2:r,y2:h}),o.setProperties({...d,x1:c,y1:l,x2:c,y2:h})),n==="vertical"&&(s.setProperties({...d,x1:r,y1:l,x2:c,y2:l}),a.setProperties({...d,x1:r,y1:h,x2:c,y2:h}))}updateStatistics(t,e,i){const o=Bi.add(fs.bottomCenter(e),Bi.from(0,10)),s={volume:this.getVolume(t)};t.hasPriceRange&&(s.priceRange={percentage:this.getPriceRangePercentage(t),value:this.getPriceRangeValue(t)}),t.hasDateRange&&(s.dateRange={bars:this.getDateRangeBars(e,i),value:this.getDateRangeValue(t)}),this.statistics.update(t,s,o,e,i,this.verticalDirection,t.localeManager)}updateAnchor(t,e,i,o){const s=fs.topCenter(e);Bi.apply(this.anchor,hp.Transformable.toCanvasPoint(this.horizontalLine,s.x,s.y))}getBackgroundPoints(t,e,i,o){const[s,a]=Bi.from(e),[n,r]=Bi.from(i);return[s,a,r,n]}getLineStyles(t){const{lineDashOffset:e,stroke:i,strokeWidth:o,strokeOpacity:s}=t;return{lineCap:t.getLineCap(),lineDash:t.getLineDash(),lineDashOffset:e,stroke:i,strokeWidth:o,strokeOpacity:s,fillOpacity:0}}getBackgroundStyles(t){const{background:e}=t;return{fill:e.fill,fillOpacity:e.fillOpacity}}getHandleStyles(t){return{fill:t.handle.fill,stroke:t.handle.stroke??t.stroke,strokeOpacity:t.handle.strokeOpacity??t.strokeOpacity,strokeWidth:t.handle.strokeWidth??t.strokeWidth}}containsPoint(t,e){const{horizontalLine:i,text:o,verticalLine:s,horizontalStartLine:a,horizontalEndLine:n,verticalStartLine:r,verticalEndLine:l}=this;return super.containsPoint(t,e)||i.isPointInPath(t,e)||s.isPointInPath(t,e)||a.visible&&a.isPointInPath(t,e)||n.visible&&n.isPointInPath(t,e)||r.visible&&r.isPointInPath(t,e)||l.visible&&l.isPointInPath(t,e)||!!o?.containsPoint(t,e)}getNodeAtCoords(t,e){return this.text?.containsPoint(t,e)?"text":this.start.containsPoint(t,e)||this.end.containsPoint(t,e)?"handle":"line"}getDateRangeBars(t,e){const{step:i}=e.xAxis.scale,o=t.x1<=t.x2?1:-1;return i?Math.round(fs.width(t)/i)*o:0}getDateRangeValue(t){const e=Bt(t.start.x),i=Bt(t.end.x);if(!Hy(e)||!Hy(i))throw new Error("Can not create a date range measurement of non-date x-axis.");return i.getTime()-e.getTime()}getPriceRangePercentage(t){if(t.start.y==null||t.end.y==null)throw new Error("Can not create a price range measurement of a non-numeric y-axis");const e=Bt(t.end.y),i=Bt(t.start.y);if(!jr(e)||!jr(i))throw new Error("Can not create a price range measurement of a non-numeric y-axis");return(e-i)/i}getPriceRangeValue(t){if(t.start.y==null||t.end.y==null)throw new Error("Can not create a price range measurement of a non-numeric y-axis");const e=Bt(t.end.y),i=Bt(t.start.y);if(!jr(e)||!jr(i))throw new Error("Can not create a price range measurement of a non-numeric y-axis");return e-i}getVolume(t){return t.getVolume(t.start.x,t.end.x)}},Yr=class extends Fe{constructor(){super(...arguments),this.type="quick-measurer"}static is(t){return Yt.isCheck(t,"quick-measurer")}createStatisticsScene(){return new h2}getDirectionStyles(t){return this.verticalDirection==="down"?t.down:t.up}getLineStyles(t){const e=this.getDirectionStyles(t);return{...super.getLineStyles(t),stroke:e.stroke,strokeWidth:e.strokeWidth,strokeOpacity:e.strokeOpacity}}getBackgroundStyles(t){const e=this.getDirectionStyles(t);return{fill:e.fill,fillOpacity:e.fillOpacity}}getHandleStyles(t){const e=this.getDirectionStyles(t);return{fill:e.handle.fill,stroke:e.handle.stroke??e.stroke,strokeOpacity:e.handle.strokeOpacity??e.strokeOpacity,strokeWidth:e.handle.strokeWidth??e.strokeWidth}}};import{_ModuleSupport as p2}from"ag-charts-community";var{StateMachine:ya,StateMachineProperty:Xy,Debug:d2}=p2,fa=class extends ya{constructor(t){const e=({point:n})=>{const r=this.createDatum();r.set({start:n,end:n}),t.create(r)},i=({point:n})=>{const{datum:r,node:l}=this;r?.set({end:n}),l?.toggleActive(!0),l?.toggleHandles({end:!1}),t.update()},o=()=>{this.node?.toggleHandles({end:!0})},s=()=>t.delete(),a=()=>{t.showAnnotationOptions(),!To(this.datum)&&t.recordAction(`Create ${this.node?.type} annotation`)};super("start",{start:{reset:ya.parent,click:{target:"end",action:e},drag:{target:"end",action:e}},end:{hover:i,drag:i,click:{target:ya.parent,action:o},dragEnd:{target:ya.parent,action:o},reset:{target:ya.parent,action:s},cancel:{target:ya.parent,action:s},onExit:a}}),this.debug=d2.create(!0,"annotations")}};p([Xy()],fa.prototype,"datum",2),p([Xy()],fa.prototype,"node",2);var u2=class extends fa{createDatum(){return new Ze}},g2=class extends fa{createDatum(){return new qe}},y2=class extends fa{createDatum(){return new Ji}},f2=class extends fa{createDatum(){return new Be}},Zy={type:"date-range",datum:Ze,scene:Fe,isDatum:Ze.is,translate:(t,e,i,o)=>{Ze.is(e)&&Fe.is(t)&&t.translate(e,i,o)},copy:(t,e,i,o)=>{if(Ze.is(e)&&Ze.is(i)&&Fe.is(t))return t.copy(e,i,o)},update:(t,e,i)=>{Ze.is(e)&&Fe.is(t)&&t.update(e,i)},createState:(t,{createDatum:e})=>new u2({...t,create:e("date-range")}),dragState:t=>new wt(t)},qy={type:"price-range",datum:qe,scene:Fe,isDatum:qe.is,translate:(t,e,i,o)=>{qe.is(e)&&Fe.is(t)&&t.translate(e,i,o)},copy:(t,e,i,o)=>{if(qe.is(e)&&qe.is(i)&&Fe.is(t))return t.copy(e,i,o)},update:(t,e,i)=>{qe.is(e)&&Fe.is(t)&&t.update(e,i)},createState:(t,{createDatum:e})=>new g2({...t,create:e("date-range")}),dragState:t=>new wt(t)},Qy={type:"date-price-range",datum:Ji,scene:Fe,isDatum:Ji.is,translate:(t,e,i,o)=>{Ji.is(e)&&Fe.is(t)&&t.translate(e,i,o)},copy:(t,e,i,o)=>{if(Ji.is(e)&&Ji.is(i)&&Fe.is(t))return t.copy(e,i,o)},update:(t,e,i)=>{Ji.is(e)&&Fe.is(t)&&t.update(e,i)},createState:(t,{createDatum:e})=>new y2({...t,create:e("date-range")}),dragState:t=>new wt(t)},Jy={type:"quick-date-price-range",datum:Be,scene:Yr,isDatum:Be.is,translate:(t,e,i,o)=>{Be.is(e)&&Yr.is(t)&&t.translate(e,i,o)},copy:(t,e,i,o)=>{if(Be.is(e)&&Be.is(i)&&Yr.is(t))return t.copy(e,i,o)},update:(t,e,i)=>{Be.is(e)&&Yr.is(t)&&t.update(e,i)},createState:(t,{createDatum:e})=>new f2({...t,create:e("quick-date-price-range")}),dragState:t=>new wt(t)};import{_ModuleSupport as gn}from"ag-charts-community";import{calcLineHeight as m2,clamp as x2,wrapText as S2}from"ag-charts-core";var{ZIndexMap:tf}=gn,Ur=class extends ep{constructor(){super(),this.type="note",this.shape=new gn.Rect,this.iconBackground=new gn.TranslatableSvgPath("M22 1.83333C22 0.820811 21.1792 0 20.1667 0H1.83333C0.820811 0 0 0.82081 0 1.83333V13.9868C0 14.9994 0.820811 15.8202 1.83333 15.8202L5.88971 15.8202C6.44575 15.8202 6.97175 16.0725 7.31971 16.5062L9.57006 19.3112C10.304 20.2259 11.6962 20.2259 12.4301 19.3112L14.6804 16.5062C15.0284 16.0725 15.5544 15.8202 16.1104 15.8202L20.1667 15.8202C21.1792 15.8202 22 14.9994 22 13.9868V1.83333Z"),this.iconLines=new gn.TranslatableSvgPath("M17.1114 5.75C17.1114 6.16421 16.7756 6.5 16.3614 6.5H5.63916C5.22495 6.5 4.88916 6.16421 4.88916 5.75V5.75C4.88916 5.33579 5.22495 5 5.63916 5H16.3614C16.7756 5 17.1114 5.33579 17.1114 5.75V5.75ZM17.1114 9.25C17.1114 9.66421 16.7756 10 16.3614 10H5.63916C5.22495 10 4.88916 9.66421 4.88916 9.25V9.25C4.88916 8.83579 5.22495 8.5 5.63916 8.5H16.3614C16.7756 8.5 17.1114 8.83579 17.1114 9.25V9.25Z"),this.active=!1,this.shape.visible=!1,this.label.visible=!1,this.iconBackground.fillShadow=new gn.DropShadow,this.append([this.shape,this.label,this.iconBackground,this.iconLines,this.handle])}static is(t){return Yt.isCheck(t,"note")}update(t,e){this.updateIcon(t,e),super.update(t,e)}getTextBBox(t,e,i){const o=super.getTextBBox(t,e,i);o.x-=t.width/2,o.x=x2(0,o.x,i.seriesRect.width-t.width);const s=t.getPadding().top,a=o.y-Pg-s*2,n=o.y+vt.HANDLE_SIZE+s*2;return a-o.height-Eg<0?(o.y=n,t.position="top"):(o.y=a+s,t.position="bottom"),o}updateLabel(t,e){const i=t.visible===!1?!1:this.label.visible;super.updateLabel(t,e),this.label.visible=i,this.label.text=S2(t.text,{maxWidth:200,font:t,textWrap:"always",avoidOrphans:!1})}updateShape(t,e){const{shape:i}=this;i.fill=t.background.fill,i.fillOpacity=t.background.fillOpacity??1,i.stroke=t.background.stroke,i.strokeOpacity=t.background.strokeOpacity??1,i.strokeWidth=t.background.strokeWidth??1,i.cornerRadius=4;const o=t.getPadding().top,s=t.position==="top";i.x=e.x-o,i.width=t.width+o*2,i.height=e.height+o*2,i.y=e.y+(s?0:-e.height)-o}updateIcon(t,e){const{active:i,iconBackground:o,iconLines:s}=this,{x:a,y:n}=bt(t,e);o.translationX=a-Uk/2,o.translationY=n-Ng,s.translationX=o.translationX,s.translationY=o.translationY,o.fill=t.fill,o.fillOpacity=t.fillOpacity??1,o.stroke=t.stroke,o.strokeOpacity=t.strokeOpacity??1,o.strokeWidth=t.strokeWidth??1,s.fill=t.stroke,i?o.fillShadow.color=t.fill??"rgba(0, 0, 0, 0.22)":o.fillShadow.color="rgba(0, 0, 0, 0.22)"}updateAnchor(t,e,i){const o=t.getPadding().top,s=t.position==="top",a=s?1:-1;return{x:e.x+i.seriesRect.x+t.width/2,y:e.y+i.seriesRect.y+a*(e.height+o),position:s?"below":"above"}}getLabelCoords(t,e){const i=t.position==="top",o=t.getPadding().top+m2(t.fontSize,xr)/2;return{x:e.x,y:e.y+(i?o/2:0)}}getTextBaseline(t){return t.position==="top"?"middle":t.position}getHandleCoords(t,e,i){return{x:e.x,y:e.y+vt.HANDLE_SIZE/2+4}}getHandleStyles(t){return{fill:t.handle.fill,stroke:t.handle.stroke??t.fill,strokeOpacity:t.handle.strokeOpacity,strokeWidth:t.handle.strokeWidth}}toggleHovered(t,e,i){super.toggleHovered(t,e,i);const o=t||e&&!i;this.label.visible=o,this.shape.visible=o,this.zIndex=o?tf.CHART_ANNOTATION_FOCUSED:tf.CHART_ANNOTATION}toggleActive(t){super.toggleActive(t),this.label.visible=t,this.shape.visible=t,this.active=t}containsPoint(t,e){return this.shape.visible&&this.shape.containsPoint(t,e)||this.iconBackground.containsPoint(t,e)?!0:super.containsPoint(t,e)}},b2=class extends dn{createDatum(){return new Ce}},ef={type:"note",datum:Ce,scene:Ur,isDatum:Ce.is,translate:(t,e,i,o)=>{Ce.is(e)&&Ur.is(t)&&t.translate(e,i,o)},copy:(t,e,i,o)=>{if(Ce.is(e)&&Ce.is(i)&&Ur.is(t))return t.copy(e,i,o)},update:(t,e,i)=>{Ce.is(e)&&Ur.is(t)&&t.update(e,i)},createState:(t,{createDatum:e})=>new b2({...t,create:e("note")}),dragState:t=>new wt(t)};import{_ModuleSupport as v2}from"ag-charts-community";var{Vec2:oi,Vec4:zi}=v2,Xr=class extends Ly{constructor(){super(),this.type="parallel-channel",this.handles={topLeft:new vt,topMiddle:new ha,topRight:new vt,bottomLeft:new vt,bottomMiddle:new ha,bottomRight:new vt},this.middleLine=new Te,this.append([this.background,this.topLine,this.middleLine,this.bottomLine,...Object.values(this.handles)])}static is(t){return Yt.isCheck(t,"parallel-channel")}dragHandle(t,e,i,o){const{activeHandle:s,handles:a}=this;if(s==null)return;const{offset:n}=a[s].drag(e);a[s].toggleDragging(!0),(s==="topMiddle"||s==="bottomMiddle")&&(n.x=0);let r=[],l=o;switch(s){case"topLeft":case"bottomLeft":r=["topLeft","bottomLeft"];break;case"topMiddle":r=["topLeft","topRight"],n.y-=ha.HANDLE_SIZE/2,l=!1;break;case"topRight":case"bottomRight":r=["topRight","bottomRight"];break;case"bottomMiddle":r=["bottomLeft","bottomRight"],n.y-=ha.HANDLE_SIZE/2,l=!1;break}const c=Se(t,i),h=Se(t.bottom,i);if(!c||!h)return;const d={topLeft:zi.start(c),topRight:zi.end(c),bottomLeft:zi.start(h),bottomRight:zi.end(h)},u={vectors:{topLeft:d.topRight,bottomLeft:d.bottomRight,topRight:d.topLeft,bottomRight:d.bottomLeft},angle:t.snapToAngle},g=no(d,n,i,{overflowContinuous:this.overflowContinuous,translateVectors:r,snap:l?u:void 0});t.start.x=g.topLeft.x,t.start.y=g.topLeft.y,t.end.x=g.topRight.x,t.end.y=g.topRight.y,t.height=g.topLeft.y-g.bottomLeft.y}getTranslatePointsVectors(t,e){const{bottomLeft:i,topLeft:o}=this.handles,s=i.getBBox().y-o.getBBox().y,a=oi.add(t,oi.from(0,s)),n=oi.add(e,oi.from(0,s));return{start:t,end:e,bottomStart:a,bottomEnd:n}}containsPoint(t,e){return super.containsPoint(t,e)||this.middleLine.visible&&this.middleLine.strokeWidth>0&&this.middleLine.containsPoint(t,e)}getNodeAtCoords(t,e){return this.middleLine.visible&&this.middleLine.strokeWidth>0&&this.middleLine.containsPoint(t,e)?"line":super.getNodeAtCoords(t,e)}updateLines(t,e,i,o,s,a){const{topLine:n,middleLine:r,bottomLine:l}=this,{lineDashOffset:c,stroke:h,strokeOpacity:d,strokeWidth:u}=t,g=t.getLineDash(),y={lineCap:t.getLineCap(),lineDash:g,lineDashOffset:c,stroke:h,strokeOpacity:d,strokeWidth:u};n.setProperties({...e,...y}),l.setProperties({...i,...y});const f=this.extendLine({x1:s.x1,y1:a.y1+(s.y1-a.y1)/2,x2:s.x2,y2:a.y2+(s.y2-a.y2)/2},t,o);r.setProperties({...f,lineDash:t.middle.lineDash??g,lineDashOffset:t.middle.lineDashOffset??c,stroke:t.middle.stroke??h,strokeOpacity:t.middle.strokeOpacity??d,strokeWidth:t.middle.strokeWidth??u,visible:t.middle.visible??!0})}updateHandles(t,e,i){const{handles:{topLeft:o,topMiddle:s,topRight:a,bottomLeft:n,bottomMiddle:r,bottomRight:l}}=this,c={fill:t.handle.fill,stroke:t.handle.stroke??t.stroke,strokeOpacity:t.handle.strokeOpacity??t.strokeOpacity,strokeWidth:t.handle.strokeWidth??t.strokeWidth};o.update({...c,...zi.start(e)}),a.update({...c,...zi.end(e)}),n.update({...c,...zi.start(i)}),l.update({...c,...zi.end(i)}),s.update({...c,...oi.sub(zi.center(e),oi.from(s.handle.width/2,s.handle.height/2))}),r.update({...c,...oi.sub(zi.center(i),oi.from(r.handle.width/2,r.handle.height/2))})}updateText(t,e,i){this.text=this.updateNode(us,this.text,!!t.text.label),xy(!0,e,i,t.text,t.strokeWidth,this.text,t.text.label)}getBackgroundPoints(t,e,i,o){const s=e.x1>e.x2,a=e.y1>e.y2,n=e.x1!==i.x1&&e.y1!==i.y1,r=e.x2!==i.x2&&e.y2!==i.y2,l=oi.from(e);return t.extendEnd&&r&&l.push(oi.from(s?o.x1:o.x2,a?o.y1:o.y2)),l.push(...oi.from(i).reverse()),t.extendStart&&n&&l.push(oi.from(s?o.x2:o.x1,a?o.y2:o.y1)),l}};import{_ModuleSupport as M2}from"ag-charts-community";import{isNumber as ma}from"ag-charts-core";var{StateMachine:Vo,StateMachineProperty:dp,Debug:D2}=M2,Zr=class extends Vo{constructor(t){const e=({point:l})=>{const c=new Je;c.set({start:l,end:l,height:0}),t.create(c)},i=()=>{const{node:l}=this;l?.toggleActive(!0),l?.toggleHandles({topLeft:!0,topMiddle:!1,topRight:!1,bottomLeft:!1,bottomMiddle:!1,bottomRight:!1})},o=({offset:l,context:c})=>{const{datum:h,snapping:d}=this;h&&(h.set({end:pn(l,c,d,h.start,h.snapToAngle)}),t.update())},s=()=>{this.node?.toggleHandles({topRight:!0}),t.update()},a=({point:l})=>{const{datum:c,node:h}=this,d=Bt(c?.end.y),u=Bt(c?.start.y),{y:g}=l;if(c==null||!ma(u)||!ma(d)||!ma(g))return;const y=d-(g??0),f=u-y;h?.toggleHandles({bottomLeft:!0,bottomRight:!0}),!(!t.validatePoint({x:c.start.x,y:f},{overflowContinuous:!0})||!t.validatePoint({x:c.end.x,y:l.y},{overflowContinuous:!0}))&&(c.set({height:y}),t.update())},n=({point:l})=>{const{datum:c,node:h}=this,d=Bt(c?.end.y),u=Bt(c?.start.y),{y:g}=l;if(c==null||!ma(u)||!ma(d)||!ma(g))return;const y=d-(g??0),f=u-y;h?.toggleHandles(!0),!(!t.validatePoint({x:c.start.x,y:f},{overflowContinuous:!0})||!t.validatePoint({x:c.end.x,y:l.y},{overflowContinuous:!0}))&&(c.set({height:y}),t.recordAction("Create parallel-channel annotation"),t.showAnnotationOptions(),t.update())},r=()=>t.delete();super("start",{start:{click:{target:"waiting-first-render",action:e},drag:{target:"waiting-first-render",action:e},reset:Vo.parent},"waiting-first-render":{render:{target:"end",action:i}},end:{hover:o,drag:o,click:{target:"height",action:s},dragEnd:{target:"height",action:s},reset:{target:Vo.parent,action:r},cancel:{target:Vo.parent,action:r}},height:{hover:a,click:{target:Vo.parent,action:n},drag:{target:Vo.parent,action:n},reset:{target:Vo.parent,action:r},cancel:{target:Vo.parent,action:r}}}),this.debug=D2.create(!0,"annotations"),this.snapping=!1}};p([dp()],Zr.prototype,"datum",2),p([dp()],Zr.prototype,"node",2),p([dp()],Zr.prototype,"snapping",2);var of={type:"parallel-channel",datum:Je,scene:Xr,isDatum:Je.is,translate:(t,e,i,o)=>{Je.is(e)&&Xr.is(t)&&t.translate(e,i,o)},copy:(t,e,i,o)=>{if(Je.is(e)&&Je.is(i)&&Xr.is(t))return t.copy(e,i,o)},update:(t,e,i)=>{Je.is(e)&&Xr.is(t)&&t.update(e,i)},createState:(t,{createDatum:e})=>new Zr({...t,create:e("parallel-channel")}),dragState:t=>new wt(t)},qr=class extends ep{constructor(){super(),this.type="text",this.append([this.label,this.handle])}static is(t){return Yt.isCheck(t,"text")}getHandleCoords(t,e){const i=vt.HANDLE_SIZE/2;return{x:e.x+i,y:e.y+2+i}}},k2=class extends dn{createDatum(){return new so}},sf={type:"text",datum:so,scene:qr,isDatum:so.is,translate:(t,e,i,o)=>{so.is(e)&&qr.is(t)&&t.translate(e,i,o)},copy:(t,e,i,o)=>{if(so.is(e)&&so.is(i)&&qr.is(t))return t.copy(e,i,o)},update:(t,e,i)=>{so.is(e)&&qr.is(t)&&t.update(e,i)},createState:(t,{createDatum:e})=>new k2({...t,create:e("text")}),dragState:t=>new wt(t)},Ve={[Fy.type]:Fy,[My.type]:My,[Dy.type]:Dy,[of.type]:of,[Iy.type]:Iy,[Ry.type]:Ry,[_y.type]:_y,[uy.type]:uy,[fy.type]:fy,[ef.type]:ef,[sf.type]:sf,[Vy.type]:Vy,[ny.type]:ny,[ay.type]:ay,[Zy.type]:Zy,[qy.type]:qy,[Qy.type]:Qy,[Jy.type]:Jy};function ms(t){for(const{isDatum:e}of Object.values(Ve))if(e(t))return t}import{_ModuleSupport as A2}from"ag-charts-community";var{ActionOnSet:L2,ParallelStateMachine:I2,StateMachine:up,StateMachineProperty:Fi,Debug:C2}=A2,Qr=class extends I2{constructor(t){super(new T2(e=>{this.snapping=e}),new w2(()=>{this.node=this.active==null?void 0:t.node(this.active)}),new Ho(t,e=>{this.active=e,this.datum=this.active==null?void 0:t.datum(this.active),this.node=this.active==null?void 0:t.node(this.active)})),this.snapping=!1}getActive(){return this.active}isActive(t){return t===this.active}};p([Fi()],Qr.prototype,"snapping",2),p([Fi()],Qr.prototype,"datum",2),p([Fi()],Qr.prototype,"node",2);var T2=class extends up{constructor(t){super("idle",{idle:{hover:({shiftKey:e})=>t(e),keyDown:({shiftKey:e})=>t(e),keyUp:({shiftKey:e})=>t(e),click:({shiftKey:e})=>t(e),drag:({shiftKey:e})=>t(e)},dragging:{},translating:{},"text-input":{}})}},w2=class extends up{constructor(t){super("idle",{idle:{onEnter:t,render:t},dragging:{onEnter:t,render:t},translating:{onEnter:t,render:t},"text-input":{render:t}})}},Ho=class extends up{constructor(t,e){const i=m=>b=>{t.create(m,b),this.active=t.selectLast()},o=()=>{this.active!=null&&t.delete(this.active),this.active=void 0,t.select()},s={createDatum:i},a={...t,delete:o,showTextInput:()=>{this.active!=null&&t.showTextInput(this.active)},deselect:()=>{const m=this.active;this.active=void 0,this.hovered=void 0,t.select(this.active,m)},showAnnotationOptions:()=>{this.active!=null&&t.showAnnotationOptions(this.active)}},n=Object.fromEntries(Object.entries(Ve).map(([m,b])=>[m,b.createState(a,s)])),r=Object.fromEntries(Object.entries(Ve).map(([m,b])=>[m,b.dragState(t,s)])),l=({colorPickerType:m,colorOpacity:b,color:M,opacity:k,isMultiColor:A})=>{this.datum&&(m==="text-color"&&t.updateTextInputColor(M),Ar(this.datum,m,b,M,k,A),t.update())},c=m=>{const{datum:b,node:M}=this;!b||!M||(Oi(b)?(b.fontSize=m,t.updateTextInputFontSize(m)):ra(b)&&(b.text.fontSize=m),t.update())},h=m=>{const{datum:b,node:M}=this;!b||!M||!wo(b)||(Fg(b,m),t.update())},d=m=>{const{node:b}=this;!b||!("setTextInputBBox"in b)||(b.setTextInputBBox(m),t.update())},u=({textInputValue:m,bbox:b})=>{const{datum:M}=this;if(b!=null&&m!=null&&m.length>0){if(!Oi(M))return;const k=Sr(M,m,b.width);M.set({text:k}),t.update(),t.recordAction(`Change ${M.type} annotation text`)}else t.delete(this.active),t.recordAction(`Delete ${M?.type} annotation`)},g=()=>{t.updateTextInputBBox(void 0)},y=()=>this.active!=null,f=()=>this.copied!=null,x=()=>{const{active:m,datum:b}=this;return m==null||!b?!1:ra(b)&&b.isWriteable()},S=()=>this.active!=null&&!To(this.datum),v=()=>this.hovered!=null;super("idle",{idle:{onEnter:()=>{t.select(this.active,this.active),this.hoverCoords&&(this.hovered=t.hoverAtCoords(this.hoverCoords,this.active,this.hovered))},hover:({offset:m})=>{this.hovered=t.hoverAtCoords(m,this.active,this.hovered),this.hoverCoords=m},translate:{guard:y,target:"translating",action:({translation:m})=>{t.startInteracting(),t.translate(this.active,m),t.update()}},copy:{guard:S,action:()=>{this.copied=t.copy(this.active)}},cut:{guard:S,action:()=>{this.copied=t.copy(this.active),o()}},paste:{guard:f,action:()=>{t.paste(this.copied)}},selectLast:()=>{const m=this.active;this.active=t.selectLast(),t.select(this.active,m)},click:[{guard:()=>{const{active:m,hovered:b,datum:M}=this;return m==null||b!==m||!M?!1:Oi(M)&&M.isWriteable()},target:"text-input"},{action:()=>{const m=this.active;this.active=this.hovered,t.select(this.active,m)}}],dblclick:{guard:x,action:({offset:m})=>{const b=t.getNodeAtCoords(m,this.active)==="text"?"text":"line";t.showAnnotationSettings(this.active,void 0,b)}},dragStart:[{guard:v,target:"dragging",action:()=>{const m=this.active;this.active=this.hovered,t.select(this.active,m),t.startInteracting()}},{action:()=>{const m=this.active;this.active=this.hovered,t.select(this.active,m)}}],color:{guard:y,action:l},fontSize:{guard:y,action:c},lineProps:{guard:y,action:m=>{const b=ms(this.datum);b?.set(m),t.update(),t.recordAction(`Change ${b?.type} ${Object.entries(m).map(([M,k])=>`${M} to ${k}`).join(", ")}`)}},lineStyle:{guard:y,action:h},lineText:{guard:y,action:m=>{const b=ms(this.datum);ra(b)&&(ao(b)&&m.position==="center"&&(m.position="inside"),b.text.set(m),t.update())}},updateTextInputBBox:{guard:y,action:d},toolbarPressSettings:{guard:x,action:m=>{t.showAnnotationSettings(this.active,m)}},reset:()=>{this.active!=null&&this.node?.toggleActive(!1),this.hovered=void 0,this.active=void 0,t.select(this.active,this.active),t.resetToIdle()},delete:()=>{this.active!=null&&(t.delete(this.active),!To(this.datum)&&t.recordAction(`Delete ${this.datum?.type} annotation`))},deleteAll:()=>{t.deleteAll()},...n},dragging:{onEnter:(m,b)=>{if(this.active==null)return;const M=t.getAnnotationType(this.active);M&&(this.transitionRoot(M),this.transitionRoot("dragStart",b))},...r},translating:{onEnter:()=>{},translate:{guard:y,target:"translating",action:({translation:m})=>{t.startInteracting(),t.translate(this.active,m),t.update()}},translateEnd:{guard:y,target:"idle"},onExit:()=>{t.stopInteracting(),t.update(),t.recordAction("Translate annotation")}},"text-input":{onEnter:()=>{if(this.active==null)return;const m=ms(this.datum);!m||!("getTextInputCoords"in m)||(t.startInteracting(),t.showTextInput(this.active),m.visible=!1,t.update())},updateTextInputBBox:{guard:y,action:d},resize:{target:"idle",action:u},click:{target:"idle",action:u},drag:{target:"idle",action:u},textInput:[{guard:Qh,target:"idle",action:g},{guard:Jh,target:"idle",action:u}],color:{guard:y,action:l},fontSize:{guard:y,action:c},cancel:{target:"idle",action:g},onExit:()=>{t.stopInteracting(),t.hideTextInput();const m=this.active;if(this.active=this.hovered=void 0,t.select(this.active,m),m==null)return;const b=t.datum(m),M=t.node(m);!b||!M||(b.visible=!0)}}}),this.setActive=e,this.debug=C2.create(!0,"annotations"),this.snapping=!1}};p([L2({changeValue(t){this.setActive(t)}}),Fi()],Ho.prototype,"active",2),p([Fi()],Ho.prototype,"hovered",2),p([Fi()],Ho.prototype,"hoverCoords",2),p([Fi()],Ho.prototype,"copied",2),p([Fi()],Ho.prototype,"snapping",2),p([Fi()],Ho.prototype,"datum",2),p([Fi()],Ho.prototype,"node",2);import{_ModuleSupport as af}from"ag-charts-community";import{CleanupRegistry as N2,EventEmitter as P2}from"ag-charts-core";var{ActionOnSet:E2,LayoutElement:_2,Menu:O2,PropertiesArray:R2,ToolbarButtonProperties:B2,Property:Jr,ChartAxisDirection:z2}=af,nf=class extends B2{};p([Jr],nf.prototype,"value",2);var tl=class extends af.BaseProperties{constructor(t){super(),this.ctx=t,this.enabled=!0,this.padding=20,this.buttons=new R2(nf),this.events=new P2,this.annotationMenu=new O2(this.ctx,"annotations"),this.cleanup=new N2,this.toolbar=t.sharedToolbar.getSharedToolbar("annotations");const e=this.onKeyDown.bind(this);this.toolbar.addListener("keydown",e),this.cleanup.register(this.toolbar.addToolbarListener("button-pressed",this.onToolbarButtonPress.bind(this)),t.layoutManager.registerElement(_2.ToolbarLeft,this.onLayoutStart.bind(this)),()=>{this.toolbar.removeListener("keydown",e),this.toolbar.destroy()})}destroy(){this.cleanup.flush()}toggleClearButtonEnabled(t){const e=this.buttons.findIndex(i=>i.value==="clear");this.toolbar.toggleButtonEnabledByIndex(e,t)}resetButtonIcons(){for(const[t,e]of this.buttons.entries())switch(e.value){case"line-menu":this.updateButtonByIndex(t,{icon:"trend-line-drawing",value:"line-menu"});break;case"fibonacci-menu":this.updateButtonByIndex(t,{icon:"fibonacci-retracement-drawing",value:"fibonacci-menu"});break;case"text-menu":this.updateButtonByIndex(t,{icon:"text-annotation",value:"text-menu"});break;case"shape-menu":this.updateButtonByIndex(t,{icon:"arrow-drawing",value:"shape-menu"});break;case"measurer-menu":this.updateButtonByIndex(t,{icon:"measurer-drawing",value:"measurer-menu"});break}}hideOverlays(){this.annotationMenu.hide()}clearActiveButton(){this.toolbar.clearActiveButton()}onLayoutStart(t){this.enabled&&(this.toolbar.updateButtons(this.buttons),this.toolbar.layout(t.layoutBox,this.padding))}refreshButtonsEnabled(t){for(const[e,i]of this.buttons.entries())i&&this.toolbar.toggleButtonEnabledByIndex(e,t)}onToolbarButtonPress({event:t,button:e,buttonBounds:i,buttonWidget:o}){const s=this.ctx.axisManager.getAxisContext(z2.Y)[0].scale;switch(e.value){case"clear":this.events.emit("pressed-clear",null);break;case"line-menu":this.onToolbarButtonPressShowMenu(t,i,o,e.value,"toolbarAnnotationsLineAnnotations",w0.filter(a=>a.visible?a.visible(s):!0));break;case"fibonacci-menu":this.onToolbarButtonPressShowMenu(t,i,o,e.value,"toolbarAnnotationsFibonacciAnnotations",N0);break;case"text-menu":this.onToolbarButtonPressShowMenu(t,i,o,e.value,"toolbarAnnotationsTextAnnotations",E0);break;case"shape-menu":this.onToolbarButtonPressShowMenu(t,i,o,e.value,"toolbarAnnotationsShapeAnnotations",_0);break;case"measurer-menu":this.onToolbarButtonPressShowMenu(t,i,o,e.value,"toolbarAnnotationsMeasurerAnnotations",O0);break}}onToolbarButtonPressShowMenu(t,e,i,o,s,a){this.events.emit("pressed-show-menu",null);const n=this.buttons.findIndex(r=>r.value===o);this.toolbar.toggleActiveButtonByIndex(n),this.annotationMenu.setAnchor({x:e.x+e.width+6,y:e.y}),this.annotationMenu.show(i,{items:a,ariaLabel:this.ctx.localeManager.t(s),class:"ag-charts-annotations__toolbar-menu",sourceEvent:t.sourceEvent,onPress:this.onButtonPressMenuCreateAnnotation.bind(this,o)})}onButtonPressMenuCreateAnnotation(t,e){const i=this.buttons.findIndex(o=>o.value===t);this.updateButtonByIndex(i,{icon:e.icon}),this.events.emit("pressed-create-annotation",{annotation:e.value}),this.annotationMenu.hide()}onKeyDown({sourceEvent:t}){t.key==="Escape"&&this.events.emit("cancel-create-annotation",null)}updateButtonByIndex(t,e){const i=this.buttons.at(t);i&&(i.set({...i.toJson(),...e,value:e.value??i.value}),this.toolbar.updateButtonByIndex(t,{...i.toJson()}))}};p([Jr,E2({changeValue(t){this.toolbar?.setHidden(!t)}})],tl.prototype,"enabled",2),p([Jr],tl.prototype,"padding",2),p([Jr],tl.prototype,"buttons",2);import{_ModuleSupport as F2,_Widget as V2}from"ag-charts-community";var{BaseModuleInstance:H2,InteractionState:yn,Property:G2,ChartAxisDirection:W2,getIconClassNames:K2}=F2,fn="ag-charts-annotations__axis-button",rf=class extends H2{constructor(t,e,i,o){super(),this.ctx=t,this.axisCtx=e,this.onButtonClick=i,this.seriesRect=o,this.enabled=!0,this.snap=!1,this.padding=0,this.button=this.setup(),this.toggleVisibility(!1),this.updateButtonElement(),this.snap=!!e.scale.bandwidth,t.domManager.addEventListener("focusin",({target:s})=>{const a=s instanceof HTMLElement?s:void 0;!(a&&t.domManager.contains(a,"series-area"))&&a!==this.button.getElement()&&this.hide()}),this.cleanup.register(t.widgets.seriesWidget.addListener("drag-move",s=>this.onMouseDrag(s)),t.widgets.seriesWidget.addListener("mousemove",s=>this.onMouseMove(s)),t.widgets.seriesWidget.addListener("mouseleave",()=>this.onMouseLeave()),t.widgets.seriesDragInterpreter?.events.on("click",s=>this.onClick(s)),t.eventsHub.on("series:focus-change",()=>this.onKeyPress()),t.eventsHub.on("zoom:pan-start",()=>this.hide()),t.eventsHub.on("zoom:change",()=>this.hide()),()=>this.destroyElements(),()=>this.button.destroy())}update(t,e){this.seriesRect=t,this.padding=e}setup(){const t=new V2.ButtonWidget;return t.addClass(fn),t.setTabIndex(-1),t.setAriaLabel(this.ctx.localeManager.t("ariaLabelAddHorizontalLine")),this.ctx.widgets.seriesWidget.getElement().appendChild(t.getElement()),t}destroyElements(){this.ctx.domManager.removeChild("canvas-overlay",fn)}onMouseMove(t){this.ctx.interactionManager.isState(yn.Clickable)&&this.show(t)}onMouseDrag(t){this.ctx.interactionManager.isState(yn.AnnotationsMoveable)&&this.show(t)}onMouseLeave(){this.ctx.interactionManager.isState(yn.Clickable)&&this.hide()}onClick(t){this.ctx.interactionManager.isState(yn.Clickable)&&t.device==="touch"&&this.show(t)}show(t){const{sourceEvent:e,currentX:i,currentY:o}=t;if(!(this.enabled&&this.ctx.widgets.seriesWidget.getElement().contains(e.target))){this.hide();return}this.toggleVisibility(!0);const s=this.getButtonCoordinates({x:i,y:o});this.coords={x:s.x+this.button.clientWidth/2,y:s.y+this.button.clientHeight/2},this.updatePosition(s)}hide(){this.toggleVisibility(!1)}onKeyPress(){this.snap&&this.ctx.interactionManager.isState(yn.Default)||this.hide()}getButtonCoordinates({x:t,y:e}){const{axisCtx:{direction:i,position:o},seriesRect:s,snap:a,axisCtx:n,padding:r}=this,{clientWidth:l,clientHeight:c}=this.button,[h,d]=[0,s.height],[u,g]=[0,s.width];if(a&&(t=Qi(gr(t-s.x,n),n)+s.x,e=Qi(gr(e-s.y,n),n)+s.y),i===W2.X){const f=c-Math.max(0,r-5);t=t-l/2,e=o==="top"?h-c+f:d-f}else{const f=l-Math.max(0,r-9);t=o==="left"?u-l+f:g-f,e=e-c/2}return{x:t,y:e}}toggleVisibility(t){const{button:e}=this;if(e==null)return;const i=this.enabled&&t;this.toggleClass("-hidden",!i)}toggleClass(t,e){this.button.toggleClass(`${fn}-${t}`,e)}updatePosition({x:t,y:e}){this.button.getElement().style.transform=`translate(${Math.round(t)}px, ${Math.round(e)}px)`}updateButtonElement(){const{button:t}=this;t.addListener("click",()=>this.onButtonClick(this.coords)),t.addListener("touchend",()=>this.onButtonClick(this.coords)),t.addListener("drag-start",()=>{}),t.setInnerHTML(`<span class="${K2("zoom-in")} ${fn}-icon"></span>`)}};p([G2],rf.prototype,"enabled",2);import{_ModuleSupport as $2}from"ag-charts-community";import{EventEmitter as j2}from"ag-charts-core";import{_ModuleSupport as Y2}from"ag-charts-community";import{createElement as co,createElementId as gp,entries as lf,getWindow as U2,setAttribute as cf,setAttributes as yp}from"ag-charts-core";var{Color:hf,DraggablePopover:X2,NativeWidget:fp,Vec2:zt,createButton:el,createCheckbox:Z2,createSelect:q2,createTextArea:Q2,initRovingTabIndex:pf,getIconClassNames:J2,mapValues:mp}=Y2,df=class Hu extends X2{constructor(e,i){super(e,i),this.dragHandleDraggingClass="ag-charts-dialog__drag-handle--dragging",this.colorPicker=new Kg(this.ctx,{detached:!0}),this.cleanup.register(e.eventsHub.on("layout:complete",this.onLayoutComplete.bind(this)))}showWithChildren(e,i){const o=super.showWithChildren(e,i);return o.classList.add("ag-charts-dialog"),o.setAttribute("role","dialog"),o.addEventListener("mousedown",s=>{s.target.classList?.contains("ag-charts-dialog__color-picker-button")||this.colorPicker.hide()}),o.addEventListener("keydown",this.onKeyDown.bind(this)),U2().requestAnimationFrame(()=>this.reposition()),this.colorPicker.attachTo(this),o}updatePosition(e){super.updatePosition(e);const{anchor:i,fallbackAnchor:o}=this.getColorPickerAnchors()??{};i&&this.colorPicker.setAnchor(i,o)}createTabs(e,i,o){const s=co("div","ag-charts-dialog__tabs"),a=mp(o,()=>gp()),n=mp(o,()=>gp());for(const[g,y]of lf(o))yp(y.panel,{id:n[g],role:"tabpanel","aria-labelledby":a[g]});const r=g=>{for(const[y,f]of lf(o))f.panel.classList.toggle("ag-charts-dialog__tab-panel--active",y===g),h[y].classList.toggle("ag-charts-dialog__tab-button--active",y===g),cf(h[y],"aria-selected",y===g),y===g&&f.onShow?.()},l=new fp(co("div","ag-charts-dialog__header"));l.addListener("drag-start",g=>{const{sourceEvent:y}=g;y.target instanceof Element&&y.target.classList.contains("ag-charts-dialog__header")&&this.onDragStart(g)}),l.addListener("drag-move",g=>this.onDragMove(g)),l.addListener("drag-end",()=>this.onDragEnd());const c=new eL;this.setDragHandle(c);const h=mp(o,(g,y)=>el({label:this.ctx.localeManager.t(g.label),onPress:()=>r(y)},{id:a[y],class:"ag-charts-dialog__tab-button",role:"tab","aria-controls":n[y]})),d=co("div","ag-charts-dialog__tab-list");yp(d,{role:"tablist","aria-label":this.ctx.localeManager.t(e)}),d.append(...Object.values(h));const u=this.createHeaderCloseButton();return l.getElement().append(c.getElement(),d,u),s.append(l.getElement(),...Object.values(o).map(g=>g.panel)),r(i),pf({orientation:"horizontal",buttons:Object.values(h)}),{tabs:s,initialFocus:h[i]}}createTabPanel(){return co("div","ag-charts-dialog__tab-panel")}createInputGroupLine(){return co("div","ag-charts-dialog__input-group-line")}createRadioGroup({label:e,options:i,value:o,onChange:s}){const a=this.createInputGroup(e);yp(a,{role:"radiogroup",tabindex:-1,"aria-label":this.ctx.localeManager.t(e)});const n="ag-charts-dialog__button--active",r=[];for(const l of i){const{icon:c,altText:h}=l,d=this.ctx.localeManager.t(h),u=el({icon:c,altText:d,onPress:()=>{for(const g of Array.from(a.children))g.classList.remove(n),g.ariaChecked="false";u.classList.add(n),u.ariaChecked="true",s(l.value)}},{"aria-checked":l.value===o,class:"ag-charts-dialog__button",role:"radio",title:d});l.value===o&&u.classList.add(n),a.appendChild(u),r.push(u)}return pf({orientation:"horizontal",buttons:r}),a}createSelect({altText:e,label:i,options:o,value:s,onChange:a}){const n=this.createInputGroup(i),r=this.ctx.localeManager.t(e),l=q2({value:s,options:o,onChange:a},{class:"ag-charts-dialog__select","aria-label":r,title:r});return n.append(l),n}createTextArea({placeholder:e,value:i,onChange:o}){const s=e?this.ctx.localeManager.t(e):void 0;return Q2({value:i,onChange:o},{placeholder:s})}createCheckbox({label:e,checked:i,onChange:o}){const s=gp(),a=this.createInputGroup(e,{for:s}),n=Z2({checked:i,onChange:o},{class:"ag-charts-dialog__checkbox",role:"switch",id:s});return a.append(n),a}createColorPicker({color:e,opacity:i,label:o,altText:s,onChange:a,onChangeHide:n,isMultiColor:r,hasMultiColorOption:l}){const c=this.createInputGroup(o),h=this.ctx.localeManager.t(s),d=el({label:h,onPress:u=>{const{anchor:g,fallbackAnchor:y}=this.getColorPickerAnchors(d)??{};this.colorPicker.show({anchor:g,fallbackAnchor:y,color:e,opacity:i,isMultiColor:r,hasMultiColorOption:l,sourceEvent:u,onChange:(f,x,S,v)=>{d.style.setProperty("--color",f),d.classList.toggle("ag-charts-dialog__color-picker-button--multi-color",v),a(f,x,S,v)},onChangeHide:n})}},{"aria-label":h,tabindex:0,class:"ag-charts-dialog__color-picker-button",title:h});if(r)d.classList.toggle("ag-charts-dialog__color-picker-button--multi-color");else if(e){const u=hf.fromString(e),g=new hf(u.r,u.g,u.b,i);d.style.setProperty("--color",g.toHexString())}return c.append(d),this.hideFns.push(()=>{this.colorPicker.hide()}),c}createHeaderCloseButton(){return el({icon:"close",altText:this.ctx.localeManager.t("iconAltTextClose"),onPress:()=>this.hide()},{class:"ag-charts-dialog__close-button"})}createInputGroup(e,i){const o=co("div","ag-charts-dialog__input-group"),s=co("label","ag-charts-dialog__input-group-label");return s.innerText=this.ctx.localeManager.t(e),cf(s,"for",i?.for),o.appendChild(s),o}onLayoutComplete(e){this.seriesRect=e.series.paddedRect,this.reposition()}onKeyDown(e){e.altKey||e.ctrlKey||e.metaKey||e.isComposing||e.key!=="Escape"||this.hide()}reposition(){const{seriesRect:e,ctx:i}=this,o=i.domManager.getBoundingClientRect(),s=this.getPopoverElement();if(!e||!s)return;const a=zt.from(0,e.y),n=zt.from(o.width,e.height),r=zt.from(s),l=zt.from(.5,1);let c;if(e.width>1e3){const h=zt.sub(zt.add(a,zt.multiply(n,l)),zt.multiply(r,l));c=zt.sub(h,zt.from(0,Hu.offset))}else{const h=zt.sub(zt.add(a,n),r);c=zt.sub(h,Hu.offset)}this.updatePosition(c)}getColorPickerAnchors(e){if(e&&(this.colorPickerAnchorElement=e),!this.colorPickerAnchorElement)return;const i=this.colorPickerAnchorElement.getBoundingClientRect(),o=this.ctx.domManager.getBoundingClientRect(),s=zt.sub(zt.from(i.x,i.y),zt.from(o.left,o.top)),a=zt.add(s,zt.from(0,i.height+5)),n=zt.sub(s,zt.from(0,5));return{anchor:a,fallbackAnchor:n}}};df.offset=60;var tL=df,eL=class extends fp{constructor(){super(co("div","ag-charts-dialog__drag-handle"));const t=new fp(co("span",J2("drag-handle")));t.setAriaHidden(!0),this.addChild(t)}},{focusCursorAtEnd:iL}=$2,oL=class extends tL{constructor(t){super(t,"settings"),this.events=new j2,this.hideFns.push(()=>this.events.emit("hidden",null))}show(t,e){const i=this.createLinearLineTab(t,e),o=this.createLinearTextTab(t,e);let s="dialogHeaderLine";ao(t)?s="dialogHeaderChannel":zg(t)?s="dialogHeaderFibonacciRange":t.type==="date-range"?s="dialogHeaderDateRange":t.type==="price-range"?s="dialogHeaderPriceRange":t.type==="date-price-range"&&(s="dialogHeaderDatePriceRange");const{tabs:a,initialFocus:n}=this.createTabs("ariaLabelSettingsTabBar",e.initialSelectedTab,{line:{label:s,panel:i},text:{label:"dialogHeaderText",panel:o.panel,onShow:o.onShow}});e.initialFocus=n,this.showWithChildren([a],e).classList.add("ag-charts-dialog--annotation-settings")}createLinearLineTab(t,e){const i=this.createTabPanel(),o=this.createInputGroupLine(),s=this.createInputGroupLine(),a="isMultiColor"in t,n=this.createColorPickerInput("line-color",t.getDefaultColor("line-color"),t.getDefaultOpacity("line-color"),a?t.isMultiColor:!1,a,e.onChangeLineColor,e.onChangeHideLineColor),r=this.createStrokeWidthSelect(t.strokeWidth??2,e.onChangeLineStyleWidth),l=this.createLineStyleRadioGroup(t.lineStyle??"solid",e.onChangeLineStyleType);if(o.append(n),"background"in t){const c=this.createColorPickerInput("fill-color",t.getDefaultColor("fill-color"),t.getDefaultOpacity("fill-color"),!1,!1,e.onChangeFillColor,e.onChangeHideFillColor);o.append(c),s.append(r)}else"showFill"in t?(o.append(this.createCheckbox({label:"dialogInputShowFill",checked:t.showFill??!0,onChange:c=>e.onChangeLine({showFill:c})})),s.append(r)):o.append(r);return s.append(l),i.append(o,s),"bands"in t&&i.append(this.createFibonacciRatioSelect(t.bands??10,c=>e.onChangeLine({bands:c}))),"extendStart"in t&&"extendEnd"in t&&i.append(this.createCheckbox({label:ao(t)?"dialogInputExtendChannelStart":"dialogInputExtendLineStart",checked:t.extendStart??!1,onChange:c=>e.onChangeLine({extendStart:c})}),this.createCheckbox({label:ao(t)?"dialogInputExtendChannelEnd":"dialogInputExtendLineEnd",checked:t.extendEnd??!1,onChange:c=>e.onChangeLine({extendEnd:c})})),"extendAbove"in t&&"extendBelow"in t&&i.append(this.createCheckbox({label:"dialogInputExtendAbove",checked:t.extendAbove??!1,onChange:c=>e.onChangeLine({extendAbove:c})}),this.createCheckbox({label:"dialogInputExtendBelow",checked:t.extendBelow??!1,onChange:c=>e.onChangeLine({extendBelow:c})})),"extendLeft"in t&&"extendRight"in t&&i.append(this.createCheckbox({label:"dialogInputExtendLeft",checked:t.extendLeft??!1,onChange:c=>e.onChangeLine({extendLeft:c})}),this.createCheckbox({label:"dialogInputExtendRight",checked:t.extendRight??!1,onChange:c=>e.onChangeLine({extendRight:c})})),"reverse"in t&&"showFill"in t&&i.append(this.createCheckbox({label:"dialogInputReverse",checked:t.reverse??!1,onChange:c=>e.onChangeLine({reverse:c})})),i}createLinearTextTab(t,e){const i=this.createTabPanel(),o=this.createTextArea({placeholder:"inputTextareaPlaceholder",value:t.text.label,onChange:h=>e.onChangeText({label:h})}),s=this.createFontSizeSelect(t.text.fontSize,e.onChangeTextFontSize),a=this.createColorPickerInput("text-color",t.text.color,1,!1,!1,e.onChangeTextColor,e.onChangeHideTextColor),n=t.text.position==="inside"?"center":t.text.position,r=this.createPositionRadioGroup(n??"top",h=>e.onChangeText({position:h})),l=this.createAlignmentRadioGroup(t.text.alignment??"center",h=>e.onChangeText({alignment:h})),c=this.createInputGroupLine();return c.append(s,a,r,l),i.append(o,c),{panel:i,onShow:()=>iL(o)}}createColorPickerInput(t,e,i,o,s,a,n){const r=t==="fill-color"?"dialogInputFillColorPicker":"dialogInputColorPicker",l=t==="fill-color"?"dialogInputFillColorPickerAltText":"dialogInputColorPickerAltText";return this.createColorPicker({label:r,altText:l,color:e,opacity:i,isMultiColor:o,hasMultiColorOption:s,onChange:a,onChangeHide:n})}createStrokeWidthSelect(t,e){return this.createSelect({label:"dialogInputStrokeWidth",altText:"dialogInputStrokeWidthAltText",options:Yg.map(({label:i,value:o})=>({label:i,value:`${o}`})),value:String(t),onChange:i=>e(Number(i))})}createFibonacciRatioSelect(t,e){return this.createSelect({label:"dialogInputFibonacciBands",altText:"dialogInputFibonacciBandsAltText",options:P0.map(({label:i,value:o})=>({label:i,value:`${o}`})),value:String(t),onChange:i=>e(Number(i))})}createLineStyleRadioGroup(t,e){return this.createRadioGroup({label:"dialogInputLineStyle",options:[{icon:"line-style-solid",altText:"iconAltTextLineStyleSolid",value:"solid"},{icon:"line-style-dashed",altText:"iconAltTextLineStyleDashed",value:"dashed"},{icon:"line-style-dotted",altText:"iconAltTextLineStyleDotted",value:"dotted"}],value:t,onChange:e})}createFontSizeSelect(t,e){return this.createSelect({label:"dialogInputFontSize",altText:"dialogInputFontSizeAltText",options:Ug.map(({label:i,value:o})=>({label:i,value:String(o)})),value:String(t),onChange:i=>e(Number(i))})}createPositionRadioGroup(t,e){return this.createRadioGroup({label:"dialogInputPosition",options:[{icon:"position-top",altText:"iconAltTextPositionTop",value:"top"},{icon:"position-center",altText:"iconAltTextPositionCenter",value:"center"},{icon:"position-bottom",altText:"iconAltTextPositionBottom",value:"bottom"}],value:t,onChange:e})}createAlignmentRadioGroup(t,e){return this.createRadioGroup({label:"dialogInputAlign",options:[{icon:"align-left",altText:"iconAltTextAlignLeft",value:"left"},{icon:"align-center",altText:"iconAltTextAlignCenter",value:"center"},{icon:"align-right",altText:"iconAltTextAlignRight",value:"right"}],value:t,onChange:e})}};function xp(t){return t.gridPadding+t.seriesAreaPadding+t.tickSize+t.label.spacing}function sL(t,e,i){for(const{update:o}of Object.values(Ve))o(t,e,i)}var{ChartUpdateType:aL,InteractionState:we,PropertiesArray:nL,Property:mn,ChartAxisDirection:rL,keyProperty:lL,valueProperty:cL,Vec2:xs,Selection:hL,BBox:pL}=ur,xa=class LM extends ur.BaseModuleInstance{constructor(e){super(),this.ctx=e,this.enabled=!0,this.toolbar=new tl(this.ctx),this.optionsToolbar=new $h(this.ctx,()=>{const i=this.state.getActive();if(i!=null)return ms(this.annotationData.at(i))}),this.axesButtons=new Ah,this.snap=!1,this.data=void 0,this.xKey=void 0,this.volumeKey=void 0,this.annotationData=new nL(LM.createAnnotationDatum),this.defaults=new k0,this.container=new ur.Group({name:"static-annotations"}),this.annotations=new hL(this.container,this.createAnnotationScene.bind(this)),this.settingsDialog=new oL(this.ctx),this.textInput=new tk(this.ctx),this.postUpdateFns=[],this.state=this.setupStateMachine(),this.setupListeners(),this.setupDOM(),this.ctx.historyManager.addMementoOriginator(e.annotationManager),this.ctx.historyManager.addMementoOriginator(this.defaults),this.textInput.setKeyDownHandler(this.onTextInput.bind(this)),this.cleanup.register(()=>{this.clear(),this.xAxis?.button?.destroy(),this.yAxis?.button?.destroy()})}setupStateMachine(){const{ctx:e}=this;return new Qr({resetToIdle:()=>{e.domManager.updateCursor("annotations"),this.popAnnotationState(we.Annotations),this.hideOverlays(),this.optionsToolbar.hide(),this.deleteEphemeralAnnotations(),this.update()},hoverAtCoords:(i,o,s)=>{let a;return this.annotations.each((n,r,l)=>{if(!r.isHoverable())return;const c=n.containsPoint(i.x,i.y);c&&(a??(a=l)),n.toggleHovered(c,o===l,r.readOnly)}),a!=null?e.tooltipManager.suppressTooltip("annotations"):this.isAnnotationState()||e.tooltipManager.unsuppressTooltip("annotations"),(a==null||!this.annotationData.at(a)?.readOnly)&&this.ctx.domManager.updateCursor("annotations",a==null?void 0:this.annotations.at(a)?.getCursor()),a!==s&&this.update(),a},getNodeAtCoords:(i,o)=>{const s=this.annotations.at(o);if(s)return s.getNodeAtCoords(i.x,i.y)},translate:(i,o)=>{const s=this.annotations.at(i),a=ms(this.annotationData.at(i));if(!(!s||!a))return this.translateNode(s,a,o)},copy:i=>{const o=this.annotations.at(i),s=ms(this.annotationData.at(i));if(!(!o||!s))return this.createAnnotationDatumCopy(o,s)},paste:i=>{this.createAnnotation(i.type,i,!1),this.postUpdateFns.push(()=>{this.state.transitionAsync("selectLast"),this.state.transitionAsync("copy")})},select:(i,o)=>{const{annotations:s,optionsToolbar:a,toolbar:n}=this;this.hideOverlays(),n.clearActiveButton(),n.resetButtonIcons();const r=i!=null?s.at(i):null,l=o!=null?s.at(o):null,c=i!=null?this.annotationData.at(i):null;l===r&&r!=null||(l?.toggleActive(!1),a.hide(),r&&!c?.readOnly?(this.pushAnnotationState(we.AnnotationsSelected),r.toggleActive(!0),a.updateButtons(this.annotationData.at(i)),this.postUpdateFns.push(()=>{a.show(),a.setAnchorScene(r)})):(this.popAnnotationState(we.AnnotationsSelected),this.popAnnotationState(we.Annotations)),this.deleteEphemeralAnnotations(),this.update())},selectLast:()=>(this.pushAnnotationState(we.AnnotationsSelected),this.annotationData.length-1),startInteracting:()=>{this.pushAnnotationState(we.Annotations)},stopInteracting:()=>{this.popAnnotationState(we.Annotations)},create:(i,o)=>{this.createAnnotation(i,o)},delete:i=>{this.annotationData.splice(i,1)},deleteAll:()=>{const i=this.annotationData.filter(o=>{if(o.readOnly===!0)return o});this.annotationData.splice(0,this.annotationData.length);for(const o of i)this.annotationData.push(o)},validatePoint:(i,o)=>{const s=this.getAnnotationContext();return s?Hr(s,i,o):!0},getAnnotationType:i=>ak(this.annotationData[i].type),datum:i=>this.annotationData.at(i),node:i=>this.annotations.at(i),recordAction:i=>{this.recordActionAfterNextUpdate(i)},update:()=>{this.postUpdateFns.push(()=>{const i=this.state.getActive(),o=i!=null?this.annotations.at(i):null;o!=null&&this.optionsToolbar.setAnchorScene(o)}),this.update()},showTextInput:i=>{const o=ms(this.annotationData.at(i));if(!this.annotations.at(i)||!o||!("getTextInputCoords"in o)||!("getTextPosition"in o))return;const a={color:o.color,fontFamily:o.fontFamily,fontSize:o.fontSize,fontStyle:o.fontStyle,fontWeight:o.fontWeight,placeholderColor:o.getPlaceholderColor()},n=this.getAnnotationContext(),r=c=>xs.add(o.getTextInputCoords(n,c),xs.required(this.seriesRect)),l=()=>o.getTextPosition();this.textInput.show({styles:a,layout:{getTextInputCoords:r,getTextPosition:l,alignment:o.alignment,textAlign:o.textAlign,width:o.width},text:o.text,placeholderText:o.placeholderText,onChange:(c,h)=>{this.state.transition("updateTextInputBBox",h)}}),this.ctx.domManager.updateCursor("annotations")},hideTextInput:()=>{this.textInput.hide()},updateTextInputColor:i=>{this.textInput.updateColor(i)},updateTextInputFontSize:i=>{const o=this.textInput.updateFontSize(i);this.state.transition("updateTextInputBBox",o)},updateTextInputBBox:i=>{this.state.transition("updateTextInputBBox",i)},showAnnotationOptions:i=>{const o=this.annotations.at(i);!o||To(this.annotationData.at(i))||(this.optionsToolbar.updateButtons(this.annotationData.at(i)),this.optionsToolbar.show(),this.optionsToolbar.setAnchorScene(o))},showAnnotationSettings:(i,o,s="line")=>{const a=this.annotationData.at(i);if(!kr(a)&&!ao(a)&&!cn(a)||To(a))return;const n=c=>(h,d,u,g)=>{this.setColorAndDefault(a.type,c,h,d,u,g),this.optionsToolbar.updateColorPickerColor(c,d,u,g)},r=c=>()=>{this.recordActionAfterNextUpdate(`Change ${a.type} ${c} to ${a.getDefaultColor(c)}`,["annotations","defaults"]),this.update()},l={initialSelectedTab:s,ariaLabel:this.ctx.localeManager.t("ariaLabelAnnotationSettingsDialog"),sourceEvent:o,onChangeLine:c=>{this.state.transition("lineProps",c),c.bands!=null&&this.defaults.setDefaultFibonacciOptions(a.type,"bands",c.bands),c.reverse!=null&&this.defaults.setDefaultFibonacciOptions(a.type,"reverse",c.reverse),c.showFill!=null&&this.defaults.setDefaultFibonacciOptions(a.type,"showFill",c.showFill)},onChangeText:c=>{this.state.transition("lineText",c),c.alignment&&this.defaults.setDefaultLineTextAlignment(a.type,c.alignment),c.position&&this.defaults.setDefaultLineTextPosition(a.type,c.position),this.recordActionAfterNextUpdate(`Change ${a.type} text ${Object.keys(c).map(h=>`${h} to ${c[h]}`).join(", ")}`)},onChangeFillColor:n("fill-color"),onChangeHideFillColor:r("fill-color"),onChangeLineColor:n("line-color"),onChangeHideLineColor:r("line-color"),onChangeLineStyleType:c=>{this.setLineStyleTypeAndDefault(a.type,c),this.optionsToolbar.updateLineStyleType(hn.find(h=>h.value===c)??hn[0])},onChangeLineStyleWidth:c=>{this.setLineStyleWidthAndDefault(a.type,c),this.optionsToolbar.updateStrokeWidth({strokeWidth:c,value:c,label:String(c)})},onChangeTextColor:n("text-color"),onChangeHideTextColor:r("text-color"),onChangeTextFontSize:c=>{this.setFontSizeAndDefault(a.type,c)}};this.settingsDialog.show(a,l)}})}setupListeners(){const{ctx:e,optionsToolbar:i,settingsDialog:o,toolbar:s}=this,{seriesWidget:a,seriesDragInterpreter:n,chartWidget:r}=e.widgets;n&&this.cleanup.register(n.events.on("click",this.hoverTouchPreHandler.bind(this)),n.events.on("drag-start",this.hoverTouchPreHandler.bind(this)),n.events.on("drag-move",this.dragMoveTouchPreHandler.bind(this)),n.events.on("mousemove",this.onHover.bind(this)),n.events.on("click",this.onClick.bind(this)),n.events.on("dblclick",this.onDoubleClick.bind(this)),n.events.on("drag-start",this.onDragStart.bind(this)),n.events.on("drag-move",this.onDrag.bind(this)),n.events.on("drag-end",this.onDragEnd.bind(this))),this.cleanup.register(a.addListener("keydown",this.onKeyDown.bind(this)),a.addListener("keyup",this.onKeyUp.bind(this)),r.addListener("click",this.onCancel.bind(this)),e.eventsHub.on("annotations:restore",this.onRestoreAnnotations.bind(this)),e.eventsHub.on("layout:complete",this.onLayoutComplete.bind(this)),e.updateService.addListener("pre-scene-render",this.onPreRender.bind(this)),e.eventsHub.on("zoom:change",()=>this.onResize()),e.eventsHub.on("dom:resize",()=>this.onResize()),s.events.on("cancel-create-annotation",()=>{this.cancel(),this.reset(),this.update()}),s.events.on("pressed-create-annotation",({annotation:l})=>{this.cancel(),this.pushAnnotationState(we.Annotations),this.state.transition(l),this.update()}),s.events.on("pressed-clear",()=>{this.clear(),this.recordActionAfterNextUpdate("Clear all")}),s.events.on("pressed-show-menu",()=>{this.cancel(),this.reset()}),s.events.on("pressed-unrelated",()=>{this.reset()}),i.events.on("pressed-delete",()=>{this.cancel(),this.delete(),this.reset()}),i.events.on("pressed-settings",({sourceEvent:l})=>{this.state.transition("toolbarPressSettings",l)}),i.events.on("pressed-lock",({locked:l})=>{this.recordActionAfterNextUpdate(l?"Locked":"Unlocked"),this.update()}),i.events.on("hid-overlays",()=>{this.settingsDialog.hide()}),i.events.on("saved-color",({type:l,colorPickerType:c,color:h})=>{this.recordActionAfterNextUpdate(`Change ${l} ${c} to ${h}`,["annotations","defaults"])}),i.events.on("updated-color",({type:l,colorPickerType:c,colorOpacity:h,color:d,opacity:u,isMultiColor:g})=>{this.setColorAndDefault(l,c,h,d,u,g)}),i.events.on("updated-font-size",({type:l,fontSize:c})=>{this.setFontSizeAndDefault(l,c)}),i.events.on("updated-line-style",({type:l,lineStyleType:c})=>{this.setLineStyleTypeAndDefault(l,c)}),i.events.on("updated-line-width",({type:l,strokeWidth:c})=>{this.setLineStyleWidthAndDefault(l,c)}),o.events.on("hidden",()=>{this.optionsToolbar.clearActiveButton()}))}setupDOM(){const{ctx:e,toolbar:i,optionsToolbar:o}=this;this.cleanup.register(e.annotationManager.attachNode(this.container),()=>{e.domManager.removeStyles(fn),i.destroy(),o.destroy()})}async processData(e){if(!this.enabled||this.data==null||this.xKey==null||this.volumeKey==null)return;const i=[lL(this.xKey,void 0,{id:"date"}),cL(this.volumeKey,"number",{id:"volume"})],{dataModel:o,processedData:s}=await e.request("annotations",[...this.data],{props:i});this.dataModel=o,this.processedData=s}createAnnotationScene(e){if(e.type in Ve)return new Ve[e.type].scene;throw new Error(`AG Charts - Cannot create annotation scene of type [${e.type}], expected one of [${Object.keys(Ve)}], ignoring.`)}static createAnnotationDatum(e){if(e.type in Ve)return new Ve[e.type].datum().set(e);throw new Error(`AG Charts - Cannot create annotation datum of unknown type [${e.type}], expected one of [${Object.keys(Ve)}], ignoring.`)}createAnnotation(e,i,o=!0){if(this.annotationData.push(i),o){const s=this.ctx.annotationManager.getAnnotationTypeStyles(e);s&&i.set(s),this.defaults.applyDefaults(i)}this.injectDatumDependencies(i),this.update()}injectDatumDependencies(e){"setLocaleManager"in e&&e.setLocaleManager(this.ctx.localeManager),"getVolume"in e&&(e.getVolume=this.getDatumRangeVolume.bind(this))}getDatumRangeVolume(e,i){const{dataModel:o,processedData:s}=this;let a=Bt(e),n=Bt(i);if(!Dh(a)||!Dh(n)||!o||!s||this.volumeKey==null)return;a>n&&([a,n]=[n,a]);const r=o.resolveKeysById({id:"annotations"},"date",s),l=o.resolveColumnById({id:"annotations"},"volume",s);let c=0;for(let h=0;h<s.input.count;h++){const d=r[h];Dh(d)&&d>=a&&d<=n&&(c+=l[h])}return c}translateNode(e,i,o){const s=this.getAnnotationConfig(i),a=this.getAnnotationContext();a&&s.translate(e,i,o,a)}createAnnotationDatumCopy(e,i){const o=this.getAnnotationConfig(i),s=new o.datum;s.set(i.toJson());const a=this.getAnnotationContext();if(a)return o.copy(e,i,s,a)}getAnnotationConfig(e){if(e.type in Ve)return Ve[e.type];throw new Error(`AG Charts - Cannot get annotation config of unknown type [${e.type}], expected one of [${Object.keys(Ve)}], ignoring.`)}onRestoreAnnotations(e){this.enabled&&(this.clear(),this.annotationData.set(e.annotations),this.postUpdateFns.push(()=>{this.ctx.annotationManager.fireChangedEvent()}),this.update())}onLayoutComplete(e){const i=e.series.paddedRect;this.seriesRect=i,this.container.setClipRect(i);for(const o of e.axes??[])o.direction===ur.ChartAxisDirection.X?this.xAxis=this.getAxis(o,i,this.xAxis?.button):this.yAxis=this.getAxis(o,i,this.yAxis?.button);this.showAnnotations()?this.animateAnnotations({from:0,to:1,phase:"trailing"}):this.animateAnnotations({from:1,to:0,phase:"remove"})}showAnnotations(){if(!this.yAxis||!this.xAxis)return!1;const e=this.ctx.chartService.series.some(s=>s.hasData),o=this.yAxis.context.seriesIds().some(s=>this.ctx.chartService.series.find(n=>n.id===s)?.visible);return e&&o}animateAnnotations({from:e,to:i,phase:o}){const{annotations:s}=this;this.ctx.animationManager?.animate({from:e,to:i,id:"chart-annotations",phase:o,groupId:"opacity",onUpdate(a){s.each(n=>{n.opacity=a,"setAxisLabelOpacity"in n&&n.setAxisLabelOpacity(a)})},onStop(){s.each(a=>{a.opacity=i,"setAxisLabelOpacity"in a&&a.setAxisLabelOpacity(i)})}})}onPreRender(){this.updateAnnotations(),this.state.transition("render")}getAxis(e,i,o){const s=this.ctx.axisManager.getAxisContext(e.direction)[0],{position:a="bottom",direction:n}=s,r=e.gridPadding+e.seriesAreaPadding,l=new pL(0,0,i.width,i.height).grow(r,a),c=n===rL.X?"vertical":"horizontal",{axesButtons:h,snap:d}=this;if(this.enabled&&h.enabled&&(h.axes==="xy"||h.axes===n)){o??(o=new rf(this.ctx,{...s,snapToGroup:d},y=>this.onAxisButtonClick(y,c),i));const g=xp(e);o.update(i,g)}else o?.destroy(),o=void 0;return{layout:e,context:s,bounds:l,button:o}}recordActionAfterNextUpdate(e,i=["annotations"]){const{defaults:o,ctx:{annotationManager:s,historyManager:a}}=this,n=i.map(r=>r==="defaults"?o:s);this.postUpdateFns.push(()=>{a.record(e,...n),s.fireChangedEvent()})}setColorAndDefault(e,i,o,s,a,n){this.state.transition("color",{colorPickerType:i,colorOpacity:o,color:s,opacity:a,isMultiColor:n}),this.defaults.setDefaultColor(e,i,o,s,a,n)}setFontSizeAndDefault(e,i){this.state.transition("fontSize",i),this.defaults.setDefaultFontSize(e,i),this.recordActionAfterNextUpdate(`Change ${e} font size to ${i}`,["annotations","defaults"])}setLineStyleTypeAndDefault(e,i){this.state.transition("lineStyle",{type:i}),this.defaults.setDefaultLineStyleType(e,i),this.recordActionAfterNextUpdate(`Change ${e} line style to ${i}`,["annotations","defaults"])}setLineStyleWidthAndDefault(e,i){this.state.transition("lineStyle",{strokeWidth:i}),this.defaults.setDefaultLineStyleWidth(e,i),this.recordActionAfterNextUpdate(`Change ${e} stroke width to ${i}`,["annotations","defaults"])}updateAnnotations(){const{annotationData:e,annotations:i,seriesRect:o,ctx:{annotationManager:s}}=this,a=this.getAnnotationContext();if(!o||!a)return;s.updateData(e.toJson().filter(r=>!To(r)));const n=this.showAnnotations();this.toolbar.refreshButtonsEnabled(n),this.toolbar.toggleClearButtonEnabled(e.length>0&&n),i.update(e??[],void 0,r=>r.id).each((r,l)=>{if(!n){r.visible=!1,"setAxisLabelVisible"in r&&r.setAxisLabelVisible(!1);return}"setAxisLabelVisible"in r&&r.setAxisLabelVisible(!0),this.injectDatumDependencies(l),sL(r,l,a)}),this.postUpdateFns.forEach(r=>r()),this.postUpdateFns=[]}getAnnotationContext(){const{seriesRect:e,xAxis:i,yAxis:o,snap:s}=this;if(e&&i&&o)return{seriesRect:e,xAxis:{...i.context,bounds:i.bounds,labelPadding:xp(i.layout),snapToGroup:s},yAxis:{...o.context,bounds:o.bounds,labelPadding:xp(i.layout),snapToGroup:s}}}onHover(e){const{state:i}=this,o=this.getAnnotationContext();if(!o)return;const s=e.sourceEvent.shiftKey,a=xs.from(e),n=be(a,o);i.transition("hover",{offset:a,point:n,shiftKey:s,context:o})}onClick(e){const{state:i}=this,o=this.getAnnotationContext();if(!o)return;const s=e.sourceEvent.shiftKey,a=be(xs.from(e),o),n=this.textInput.getValue(),r=this.textInput.getBBox();i.transition("click",{point:a,shiftKey:s,textInputValue:n,bbox:r})}onDoubleClick(e){const{state:i}=this;if(!this.getAnnotationContext())return;const s=xs.from(e);i.transition("dblclick",{offset:s})}onAxisButtonClick(e,i){this.cancel(),this.reset();const o=this.getAnnotationContext();if(!this.annotationData||!o)return;const{state:s}=this;this.pushAnnotationState(we.Annotations);const a=i==="horizontal";if(s.transition(a?"horizontal-line":"vertical-line"),this.optionsToolbar.hide(),!e)return;const n=be(e,o);Hr(o,n)&&(s.transition("click",{point:n,shiftKey:!1}),this.update())}onResize(){const e=this.textInput.getValue(),i=this.textInput.getBBox();this.state.transition("resize",{textInputValue:e,bbox:i})}hoverTouchPreHandler(e){e.device==="touch"&&this.onHover(e)}dragMoveTouchPreHandler(e){e.device==="touch"&&this.ctx.interactionManager.isState(we.AnnotationsSelected)&&e.sourceEvent.preventDefault()}onDragStart(e){if(!this.ctx.interactionManager.isState(we.AnnotationsDraggable))return;const i=this.getAnnotationContext();if(!i)return;const o=xs.from(e),s=be(o,i),a=this.textInput.getValue(),n=this.textInput.getBBox();this.state.transition("dragStart",{context:i,offset:o,point:s,textInputValue:a,bbox:n})}onDrag(e){if(!this.ctx.interactionManager.isState(we.AnnotationsDraggable))return;const i=this.getAnnotationContext();if(!i)return;const o=xs.from(e),s=be(o,i),a=e.sourceEvent.shiftKey,n=this.textInput.getValue(),r=this.textInput.getBBox();this.state.transition("drag",{context:i,offset:o,point:s,shiftKey:a,textInputValue:n,bbox:r})}onDragEnd(){this.state.transition("dragEnd")}onCancel(e){const{sourceEvent:i}=e??{};i?.currentTarget===i?.target&&(this.cancel(),this.reset())}onDelete(){this.textInput.isVisible()||(this.cancel(),this.delete(),this.reset(),this.update())}onTextInput(e){const{state:i}=this,o=this.getAnnotationContext();if(!o)return;const{key:s,shiftKey:a}=e,n=this.textInput.getValue(),r=this.textInput.getBBox();i.transition("textInput",{key:s,shiftKey:a,textInputValue:n,bbox:r,context:o})}onKeyDown(e){const{state:i}=this,o=this.getAnnotationContext();if(!o)return;const{sourceEvent:s}=e,{shiftKey:a,ctrlKey:n,metaKey:r}=s,l=n||r,c=n||a;i.transition("keyDown",{shiftKey:a,context:o});const h={x:0,y:0},d=Math.max(o?.xAxis.scale.bandwidth??0,c?10:1),u=Math.max(o?.yAxis.scale.bandwidth??0,c?10:1);switch(s.key){case"ArrowDown":h.y=u;break;case"ArrowUp":h.y=-u;break;case"ArrowLeft":h.x=-d;break;case"ArrowRight":h.x=d;break;case"Escape":this.onCancel();return;case"Backspace":case"Delete":this.onDelete();return}if((h.x||h.y)&&(i.transition("translate",{translation:h}),s.stopPropagation(),s.preventDefault()),!!l)switch(s.key){case"c":i.transition("copy");return;case"x":i.transition("cut"),this.recordActionAfterNextUpdate("Cut annotation");return;case"v":i.transition("paste"),this.recordActionAfterNextUpdate("Paste annotation");return}}onKeyUp(e){const{shiftKey:i}=e.sourceEvent,o=this.getAnnotationContext();o&&(this.state.transition("keyUp",{shiftKey:i,context:o}),this.state.transition("translateEnd"))}clear(){this.cancel(),this.deleteAll(),this.reset()}reset(){this.state.transition("reset")}cancel(){this.state.transition("cancel")}delete(){this.state.transition("delete")}deleteAll(){this.state.transition("deleteAll")}deleteEphemeralAnnotations(){for(const[e,i]of this.annotationData.entries())To(i)&&this.annotationData.splice(e,1)}hideOverlays(){this.settingsDialog.hide(),this.toolbar.hideOverlays(),this.optionsToolbar.hideOverlays()}pushAnnotationState(e){this.ctx.interactionManager.pushState(e),this.ctx.tooltipManager.suppressTooltip("annotations")}popAnnotationState(e){this.ctx.interactionManager.popState(e),this.ctx.tooltipManager.unsuppressTooltip("annotations")}isAnnotationState(){return this.ctx.interactionManager.isState(we.Annotations)||this.ctx.interactionManager.isState(we.AnnotationsSelected)}update(e=aL.PRE_SCENE_RENDER){this.ctx.updateService.update(e)}};p([mn],xa.prototype,"enabled",2),p([mn],xa.prototype,"toolbar",2),p([mn],xa.prototype,"optionsToolbar",2),p([mn],xa.prototype,"axesButtons",2),p([mn],xa.prototype,"snap",2);var dL=xa;import{_ModuleSupport as uL}from"ag-charts-community";var{FONT_SIZE_RATIO:Sp,ThemeSymbols:ee}=uL,si={stroke:{$ref:"foregroundColor"},strokeOpacity:1,strokeWidth:2},ie={fill:ee.DEFAULT_ANNOTATION_HANDLE_FILL,strokeOpacity:1,strokeWidth:2},Ss={color:{$ref:"chartBackgroundColor"},fontSize:{$rem:Sp.LARGE},fontFamily:{$ref:"fontFamily"}},uf={...Ss,enabled:!0,fill:{$ref:"foregroundColor"},fontSize:{$ref:"fontSize"}},il={...Ss,textAlign:"left"},bs={...Ss,position:"top",alignment:"center",color:{$ref:"textColor"}},gf={...Ss,position:"top",alignment:"center",color:{$ref:"textColor"}},bp={...Ss,fontSize:{$ref:"fontSize"},color:ee.DEFAULT_ANNOTATION_STATISTICS_COLOR,fill:ee.DEFAULT_ANNOTATION_STATISTICS_FILL,stroke:ee.DEFAULT_ANNOTATION_STATISTICS_STROKE,strokeWidth:1,divider:{stroke:ee.DEFAULT_ANNOTATION_STATISTICS_DIVIDER_STROKE,strokeWidth:1,strokeOpacity:.5}},vp={...si,background:{fill:{$ref:"foregroundColor"},fillOpacity:.075},handle:{...ie},text:{...bs},statistics:{...bp}},gL={buttons:[{icon:"text-annotation",tooltip:"toolbarAnnotationsTextAnnotations",value:"text-menu"},{icon:"trend-line-drawing",tooltip:"toolbarAnnotationsLineAnnotations",value:"line-menu"},{icon:"arrow-drawing",tooltip:"toolbarAnnotationsShapeAnnotations",value:"shape-menu"},{icon:"delete",tooltip:"toolbarAnnotationsClearAll",value:"clear"}],padding:{$ref:"chartPadding"}},yL={buttons:[{icon:"text-annotation",tooltip:"toolbarAnnotationsTextColor",value:"text-color"},{icon:"line-color",tooltip:"toolbarAnnotationsLineColor",value:"line-color"},{icon:"fill-color",tooltip:"toolbarAnnotationsFillColor",value:"fill-color"},{tooltip:"toolbarAnnotationsTextSize",value:"text-size"},{tooltip:"toolbarAnnotationsLineStrokeWidth",value:"line-stroke-width"},{icon:"line-style-solid",tooltip:"toolbarAnnotationsLineStyle",value:"line-style-type"},{icon:"settings",tooltip:"toolbarAnnotationsSettings",value:"settings"},{icon:"unlocked",tooltip:"toolbarAnnotationsLock",ariaLabel:"toolbarAnnotationsLock",checkedOverrides:{icon:"locked",tooltip:"toolbarAnnotationsUnlock"},value:"lock"},{icon:"delete",tooltip:"toolbarAnnotationsDelete",value:"delete"}]},fL={enabled:!1,line:{...si,handle:{...ie},text:{...bs}},"horizontal-line":{...si,handle:{...ie},axisLabel:{...uf},text:{...bs}},"vertical-line":{...si,handle:{...ie},axisLabel:{...uf},text:{...bs}},"disjoint-channel":{...si,background:{fill:{$ref:"foregroundColor"},fillOpacity:.075},handle:{...ie},text:{...gf}},"parallel-channel":{...si,middle:{lineDash:[6,5],strokeWidth:1},background:{fill:{$ref:"foregroundColor"},fillOpacity:.075},handle:{...ie},text:{...gf}},"fibonacci-retracement":{...si,strokes:ee.DEFAULT_FIBONACCI_STROKES,rangeStroke:{$ref:"foregroundColor"},handle:{...ie},text:{...bs,position:"center"},label:{...Ss,color:void 0,fontSize:{$rem:Sp.SMALLER}}},"fibonacci-retracement-trend-based":{...si,strokes:ee.DEFAULT_FIBONACCI_STROKES,rangeStroke:{$ref:"foregroundColor"},handle:{...ie},text:{...bs,position:"center"},label:{...Ss,color:void 0,fontSize:{$rem:Sp.SMALLER}}},callout:{...si,...il,color:{$ref:"textColor"},handle:{...ie},fill:{$ref:"foregroundColor"},fillOpacity:.075},comment:{...il,fontWeight:700,handle:{...ie},fill:{$ref:"foregroundColor"}},note:{...il,color:ee.DEFAULT_TEXTBOX_COLOR,fill:ee.DEFAULT_FINANCIAL_CHARTS_ANNOTATION_COLOR,stroke:{$ref:"chartBackgroundColor"},strokeWidth:1,strokeOpacity:1,handle:{...ie},background:{fill:ee.DEFAULT_TEXTBOX_FILL,stroke:ee.DEFAULT_TEXTBOX_STROKE,strokeWidth:1}},text:{...il,color:{$ref:"textColor"},handle:{...ie}},arrow:{...si,handle:{...ie},text:{...bs}},"arrow-up":{fill:{$palette:"up.fill"},handle:{...ie,stroke:{$ref:"foregroundColor"}}},"arrow-down":{fill:{$palette:"down.fill"},handle:{...ie,stroke:{$ref:"foregroundColor"}}},"date-range":{...vp},"price-range":{...vp},"date-price-range":{...vp},"quick-date-price-range":{up:{...si,fill:ee.DEFAULT_FINANCIAL_CHARTS_ANNOTATION_BACKGROUND_FILL,fillOpacity:.2,handle:{...ie},statistics:{...bp,color:"#fff",fill:ee.DEFAULT_FINANCIAL_CHARTS_ANNOTATION_BACKGROUND_FILL,strokeWidth:0,divider:{stroke:"#fff",strokeWidth:1,strokeOpacity:.5}}},down:{...si,stroke:ee.DEFAULT_ANNOTATION_STATISTICS_DOWN_STROKE,fill:ee.DEFAULT_ANNOTATION_STATISTICS_DOWN_FILL,fillOpacity:.2,handle:{...ie,stroke:ee.DEFAULT_ANNOTATION_STATISTICS_DOWN_STROKE},statistics:{...bp,color:"#fff",fill:ee.DEFAULT_ANNOTATION_STATISTICS_DOWN_FILL,strokeWidth:0,divider:{stroke:"#fff",strokeWidth:1,strokeOpacity:.5}}}},axesButtons:{},toolbar:gL,optionsToolbar:yL},mL={type:"root",optionsKey:"annotations",packageType:"enterprise",chartTypes:["cartesian"],moduleFactory:t=>new dL(t),themeTemplate:{annotations:fL}};import{_ModuleSupport as Mp}from"ag-charts-community";import{_ModuleSupport as yf}from"ag-charts-community";import{createElement as xL}from"ag-charts-core";var{BaseProperties:SL,ObserveChanges:bL,ProxyProperty:vL,Property:vs,calculatePlacement:ML}=yf,Vi=class extends SL{constructor(){super(),this.opacity=1,this.loadedSynchronously=!0,this.containerWidth=0,this.containerHeight=0,this.onLoad=void 0,this.onImageLoad=()=>{this.loadedSynchronously||(this.node.visible=!1,this.performLayout(this.containerWidth,this.containerHeight),this.onLoad?.())},this.imageElement=xL("img"),this.imageElement.onload=this.onImageLoad,this.node=new yf.Image(this.imageElement)}get complete(){return this.imageElement.width>0&&this.imageElement.height>0}performLayout(t,e){this.containerWidth=t,this.containerHeight=e;const i={width:t,height:e},o=ML(this.imageElement.width,this.imageElement.height,i,this);return this.node.setProperties(this.complete?{visible:!0,opacity:this.opacity,...o}:{visible:!1}),o}};p([vs],Vi.prototype,"top",2),p([vs],Vi.prototype,"right",2),p([vs],Vi.prototype,"bottom",2),p([vs],Vi.prototype,"left",2),p([vs],Vi.prototype,"width",2),p([vs],Vi.prototype,"height",2),p([vs],Vi.prototype,"opacity",2),p([vL("imageElement.src"),bL(t=>t.loadedSynchronously=t.complete)],Vi.prototype,"url",2);var{ActionOnSet:DL,Property:kL}=Mp,ff=class extends Mp.Background{constructor(){super(...arguments),this.image=new Vi}onLayoutComplete(t){if(super.onLayoutComplete(t),this.image){const{width:e,height:i}=t.chart;this.image.performLayout(e,i)}}onImageLoad(){this.ctx.updateService.update(Mp.ChartUpdateType.SCENE_RENDER)}};p([kL,DL({newValue(t){this.node.appendChild(t.node),t.onLoad=()=>this.onImageLoad()},oldValue(t){this.node.removeChild(t.node),t.onLoad=void 0}})],ff.prototype,"image",2);var AL={type:"root",optionsKey:"background",packageType:"enterprise",chartTypes:["cartesian","polar","topology","standalone"],moduleFactory:t=>new ff(t)};import{_ModuleSupport as ol}from"ag-charts-community";import{createId as LL}from"ag-charts-core";var{Range:IL,TranslatableGroup:CL,BBox:TL,Property:Si,ZIndexMap:wL,ChartAxisDirection:NL,FillGradientDefaults:PL,FillImageDefaults:EL,FillPatternDefaults:_L,getShapeFill:OL,InteractionState:sl}=ol,ai=class extends ol.BaseModuleInstance{constructor(t){super(),this.ctx=t,this.id=LL(this),this.enabled=!1,this.stroke="rgb(195, 195, 195)",this.lineDash=[6,3],this.lineDashOffset=0,this.strokeWidth=1,this.strokeOpacity=1,this.fill="#c16068",this.fillOpacity=1,this.fillGradientDefaults=new PL,this.fillPatternDefaults=new _L,this.fillImageDefaults=new EL,this.bounds=new TL(0,0,0,0),this.bandHighlightGroup=new CL({name:"bandHighlight",zIndex:wL.AXIS_BAND_HIGHLIGHT}),this.rangeNode=this.bandHighlightGroup.appendChild(new IL),this.activeAxisHighlight=void 0,this.axisCtx=t.parent,this.hideBand(),t.domManager.addEventListener("focusin",({target:a})=>{const n=a instanceof HTMLElement&&t.domManager.contains(a,"series-area");this.bandHighlightGroup.visible&&!n&&(this.hideBand(),this.ctx.updateService.update(ol.ChartUpdateType.PERFORM_LAYOUT))});const{widgets:{seriesWidget:e,seriesDragInterpreter:i},animationManager:o,eventsHub:s}=t;this.cleanup.register(t.scene.attachNode(this.bandHighlightGroup),e.addListener("mousemove",a=>this.onHoverLikeEvent(a)),e.addListener("mouseleave",()=>this.clearAllHighlight()),o.addListener("animation-start",()=>this.clearAllHighlight()),s.on("layout:complete",a=>this.layout(a)),s.on("series:focus-change",()=>this.onKeyPress()),s.on("zoom:pan-start",()=>this.clearAllHighlight()),s.on("zoom:change",()=>this.clearAllHighlight()),s.on("dom:resize",()=>this.clearAllHighlight()),s.on("axis:change",()=>this.axisChange())),i&&this.cleanup.register(i.events.on("drag-move",a=>this.onHoverLikeEvent(a)),i.events.on("click",a=>this.onClick(a)))}axisChange(){this.onHighlightChange()}isHover(t){return t.type==="mousemove"||t.type==="click"||t.device==="touch"&&this.ctx.chartService.touch.dragAction==="hover"}onClick(t){t.device==="touch"&&this.onHoverLikeEvent(t)}clearAllHighlight(){this.ctx.interactionManager.isState(sl.Clickable)&&this.onHighlightChange()}onKeyPress(){this.ctx.interactionManager.isState(sl.Default)&&this.onHighlightChange()}onHoverLikeEvent(t){const e=this.isHover(t)?sl.Clickable:sl.AnnotationsMoveable;this.ctx.interactionManager.isState(e)&&this.handleHoverHighlight(t)}handleHoverHighlight(t){if(!t)return;const{currentX:e,currentY:i}=t;this.onHighlightChange(this.axisCtx.pickBand({x:e,y:i}))}layout({series:{rect:t,visible:e},axes:i}){if(!e||!i||!this.enabled)return;const{position:o="left",axisId:s}=this.axisCtx,a=i.find(l=>l.id===s);if(!a)return;this.axisLayout=a,this.bounds=t.clone().grow(a.gridPadding,o);const{bandHighlightGroup:n,bounds:r}=this;n.translationX=Math.round(r.x),n.translationY=Math.round(r.y),this.updateBand()}updateBand(){const{rangeNode:t,stroke:e,strokeWidth:i,strokeOpacity:o,lineDash:s,fill:a,fillOpacity:n,fillGradientDefaults:r,fillPatternDefaults:l,fillImageDefaults:c,lineDashOffset:h,axisLayout:d}=this;d&&(t.stroke=e,t.strokeWidth=i,t.strokeOpacity=o,t.lineDash=s,t.lineDashOffset=h,t.fill=OL(a,r,l,c),t.fillOpacity=n,t.startLine=!0,t.endLine=!0)}isVertical(){return this.axisCtx.direction===NL.X}onHighlightChange(t){this.enabled&&(this.activeAxisHighlight=t,this.activeAxisHighlight?this.showBand():this.hideBand(),this.ctx.updateService.update(ol.ChartUpdateType.SCENE_RENDER))}updateBandPosition(){const{rangeNode:t,bounds:e}=this,{band:i}=this.activeAxisHighlight??{};if(i==null){this.hideBand();return}let o=Math.min(...i),s=Math.max(...i);if(s-o<1){const a=(o+s)/2;o=a-.5,s=a+.5}this.isVertical()?(t.y1=0,t.y2=e.height,t.x1=o,t.x2=s,t.horizontal=!0):(t.y1=o,t.y2=s,t.x1=0,t.x2=e.width,t.horizontal=!1)}showBand(){this.updateBandPosition(),this.bandHighlightGroup.visible=!0}hideBand(){this.bandHighlightGroup.visible=!1}};p([Si],ai.prototype,"enabled",2),p([Si],ai.prototype,"stroke",2),p([Si],ai.prototype,"lineDash",2),p([Si],ai.prototype,"lineDashOffset",2),p([Si],ai.prototype,"strokeWidth",2),p([Si],ai.prototype,"strokeOpacity",2),p([Si],ai.prototype,"fill",2),p([Si],ai.prototype,"fillOpacity",2),p([Si],ai.prototype,"fillGradientDefaults",2),p([Si],ai.prototype,"fillPatternDefaults",2),p([Si],ai.prototype,"fillImageDefaults",2);var RL={type:"axis-option",optionsKey:"bandHighlight",packageType:"enterprise",chartTypes:["cartesian"],axisTypes:["category","ordinal-time","unit-time","grouped-category"],moduleFactory:t=>new ai(t),themeTemplate:{bandHighlight:{enabled:!1,strokeWidth:0,lineDash:[],fill:{$foregroundBackgroundMix:.05}}}};import{_ModuleSupport as mf}from"ag-charts-community";import{Logger as BL}from"ag-charts-core";var{ActionOnSet:zL,LayoutElement:FL,Menu:VL,Property:HL}=mf,Dp=[{label:"toolbarSeriesTypeOHLC",icon:"ohlc-series",value:"ohlc"},{label:"toolbarSeriesTypeCandles",icon:"candlestick-series",value:"candlestick"},{label:"toolbarSeriesTypeHollowCandles",icon:"hollow-candlestick-series",value:"hollow-candlestick"},{label:"toolbarSeriesTypeLine",icon:"line-series",value:"line"},{label:"toolbarSeriesTypeStepLine",icon:"step-line-series",value:"step-line"},{label:"toolbarSeriesTypeHLC",icon:"hlc-series",value:"hlc"},{label:"toolbarSeriesTypeHighLow",icon:"high-low-series",value:"high-low"}],xf=class extends mf.BaseModuleInstance{constructor(t){super(),this.ctx=t,this.enabled=!1,this.menu=new VL(this.ctx,"chart-toolbar"),this.toolbar=t.sharedToolbar.getSharedToolbar("chartToolbar"),this.cleanup.register(this.toolbar.addToolbarListener("button-pressed",this.onButtonPressed.bind(this)),t.layoutManager.registerElement(FL.ToolbarLeft,this.onLayoutStart.bind(this)),()=>this.toolbar.destroy())}onLayoutStart(t){this.enabled&&(this.updateButton(),this.toolbar.layout(t.layoutBox))}onButtonPressed({event:t,buttonBounds:e,buttonWidget:i}){this.menu.setAnchor({x:e.x+e.width+6,y:e.y}),this.menu.show(i,{items:Dp,menuItemRole:"menuitemradio",ariaLabel:this.ctx.localeManager.t("toolbarSeriesTypeDropdown"),class:"ag-charts-chart-toolbar__menu",value:this.getChartType(),sourceEvent:t.sourceEvent,onPress:o=>{this.setChartType(o.value),this.hidePopover()},onHide:()=>{this.toolbar.clearActiveButton()}}),this.toolbar.toggleActiveButtonByIndex(0)}updateButton(){const t=this.getChartType(),e=Dp.find(i=>i.value===t)?.icon;e!=null&&this.toolbar.updateButtons([{icon:e,tooltip:"toolbarSeriesTypeDropdown",value:"menu"}])}hidePopover(){this.toolbar.clearActiveButton(),this.menu.hide()}setChartType(t){const e={chartType:t};this.ctx.chartService.publicApi?.updateDelta(e).catch(i=>BL.error(i))}getChartType(){const t=this.ctx.chartService.publicApi?.getOptions()?.chartType;return t==null||!Dp.some(e=>e.value===t)?"candlestick":t}};p([HL,zL({changeValue(t){this.toolbar?.setHidden(!t)}})],xf.prototype,"enabled",2);var GL={type:"root",optionsKey:"chartToolbar",packageType:"enterprise",chartTypes:["cartesian"],moduleFactory:t=>new xf(t)};import{_ModuleSupport as WL}from"ag-charts-community";import{_ModuleSupport as al,_Widget as Sf}from"ag-charts-community";import{Logger as kp,clamp as bf,createElement as xn}from"ag-charts-core";import{isKeyOf as KL}from"ag-charts-core";function $L(t,e){return t==="always"?!0:t==="series-area"?e==="series-area"||e==="series-node":t===e}function vf(t,e,i){let o=!0;if(e.type==="separator"){const s=i.at(i.length-1);o=s!==void 0&&s.type!=="separator"}if(o&&(o=$L(e.showOn??"always",t)),o){const s=new YL(e);return i.push(s),s}}function Mf(t,e,i,o){e.isVisible(i)&&vf(t,e.builtins.items[i],o)}function jL(t,e,i,o){const{builtins:s}=e;if(KL(i,s.lists))for(const a of s.lists[i])Mf(t,e,a,o);else Mf(t,e,i,o)}function Df(t,e,i,o){for(const s of i)if(typeof s=="string")jL(t,e,s,o);else{const a=vf(t,s,o);s.items&&a&&s.items.length>0&&Df(t,e,s.items,a.items)}o[o.length-1]?.type==="separator"&&o.pop()}var YL=class{constructor(t){this.type="action",this.showOn="always",this.label="",this.iconUrl=void 0,this.enabled=!0,this.items=[],this.action=void 0,t&&this.setOptions(t),this.items=[]}setField(t,e,i){e[t]=i}setOptions(t){let e;for(e in t)t[e]!==void 0&&this.setField(e,this,t[e])}},ho="ag-charts-context-menu",{Property:Ap,ContextMenuRegistry:Sn,callWithContext:nl,getIconClassNames:UL}=al,Lp="context-menu",rl=class extends al.BaseModuleInstance{constructor(t){if(super(),this.ctx=t,this.enabled=!0,this.darkTheme=!1,this.items=["defaults"],this.pickedNode=void 0,this.showEvent=void 0,this.x=0,this.y=0,this.collapsingSubMenus=0,this.menuWidget=new Sf.MenuWidget,this.interactionManager=t.interactionManager,this.element=t.domManager.addChild("canvas-overlay",Lp),this.element.classList.add(ho),this.element.style.display="none",this.element.addEventListener("contextmenu",e=>e.preventDefault()),this.element.addEventListener("focusout",({relatedTarget:e})=>{this.collapsingSubMenus>0||(e==null||e instanceof Node&&!this.element.contains(e))&&this.hide()}),this.cleanup.register(()=>this.element.parentNode?.removeChild(this.element),()=>this.menuWidget.destroy(),t.eventsHub.on("dom:hidden",()=>this.hide()),this.menuWidget.addListener("collapse-widget",()=>this.onCollapse())),this.menuWidget.addClass(`${ho}__menu`),typeof MutationObserver<"u"){const e=new MutationObserver(()=>{this.element.contains(this.menuWidget.getElement())&&this.reposition()});e.observe(this.element,{childList:!0}),this.mutationObserver=e,this.cleanup.register(()=>e.disconnect())}this.ctx.contextMenuRegistry.builtins.items.download.action=()=>{const e=t.chartService.title;let i="image";e?.enabled&&(i=e.node.getPlainText().replace(/\.+/,"")),this.ctx.chartService.publicApi?.download({fileName:i}).catch(o=>{kp.error("Unable to download chart",o)})},this.cleanup.register(this.ctx.eventsHub.on("context-menu:complete",e=>this.onContext(e)))}expandItemsOptions(t){const e=[];return Df(t,this.ctx.contextMenuRegistry,this.items,e),e}onContext(t){if(!this.enabled)return;t.widgetEvent.sourceEvent.preventDefault(),this.showEvent=t.widgetEvent.sourceEvent,this.x=t.x,this.y=t.y,this.pickedNode=void 0,this.pickedLegendItem=void 0,Sn.check("series-node",t)?this.pickedNode=t.context.pickedNode:Sn.check("legend-item",t)&&(this.pickedLegendItem=t.context.legendItem);const e=this.expandItemsOptions(t.showOn);e.length!==0&&this.show(t.widgetEvent,e)}show(t,e){const{sourceEvent:i}=t;this.interactionManager.pushState(al.InteractionState.ContextMenu),this.element.style.display="block";const o=i.pointerType==="touch"?!1:void 0;o!==void 0&&this.ctx.chartService.overrideFocusVisible(o),this.createMenu(e),this.element.appendChild(this.menuWidget.getElement()),this.menuWidget.expand({sourceEvent:i,overrideFocusVisible:o})}hide(){this.menuWidget.collapse()}onCollapse(){this.interactionManager.popState(al.InteractionState.ContextMenu),this.element.removeChild(this.menuWidget.getElement()),this.element.style.display="none"}onSubMenuExpand(t,e){const i=t.getBounds();t.setFocusOverride(!0),t.getElement().insertAdjacentElement("afterend",e.getElement()),e.getElement().style.position="absolute";const o=this.ctx.domManager.getBoundingClientRect(),s=t.getBoundingClientRect(),a=o.right-s.right,n=s.left-o.left,{offsetWidth:r,offsetHeight:l}=e.getElement();let c=i.y;if(o.height>l){const h=o.bottom-s.top;h<l&&(c-=l-h)}if(a>=r)e.setBounds({x:i.x+i.width,y:c});else{const h=i.x-r,d=n+h;d>=0?e.setBounds({x:h,y:c}):e.setBounds({x:h-d,y:c})}}onSubMenuCollapse(t,e){t.setFocusOverride(void 0),this.collapsingSubMenus++,e.remove(),this.collapsingSubMenus--}createMenu(t){const{menuWidget:e}=this;e.clear(),e.setTabIndex(-1),this.createMenuItems(e,t)}createMenuItems(t,e){for(const i of e)switch(i.type){case"separator":{t.addSeparator().classList.add(`${ho}__divider`);break}case"action":{if(i.items.length===0){const o=new Sf.MenuItemWidget;this.initButtonElement(o,i),t.addChild(o)}else{const{subMenuButton:o,subMenu:s}=t.addSubMenu();s.addClass(`${ho}__menu`),s.addListener("expand-widget",()=>this.onSubMenuExpand(o,s)),s.addListener("collapse-widget",()=>this.onSubMenuCollapse(o,s)),this.initButtonElement(o,i),this.createMenuItems(s,i.items)}break}default:throw new Error("unhandled case")}}createButtonOnClick(t,e){return Sn.checkCallback("legend-item",t,e)?i=>{const o=i.sourceEvent;if(this.pickedLegendItem){const{seriesId:s,itemId:a,label:n}=this.pickedLegendItem,{chartService:r}=this.ctx,c=[r.series.find(d=>d.id===s)?.properties,r],h={type:"contextmenu",seriesId:s,itemId:a,text:n.text,event:o};nl(c,e,h),this.hide()}else kp.error("legend item not found")}:Sn.checkCallback("series-area",t,e)?()=>{const i=this.ctx.chartService,o={type:"seriesContextMenuAction",event:this.showEvent};nl(i,e,o),this.hide()}:Sn.checkCallback("series-node",t,e)?()=>{const{showEvent:i}=this,{chartService:o}=this.ctx,s=this.pickedNode,a=[s?.series.properties,o],n=s?.series.createNodeContextMenuActionEvent(i,s);n?nl(a,e,n):kp.error("series node not found"),this.hide()}:()=>{const i=this.ctx.chartService,o={type:"contextMenuEvent",event:this.showEvent};nl(i,e,o),this.hide()}}initTableCells(t){const e=xn("div"),i=xn("div"),o=xn("div");return e.classList.toggle(`${ho}__icon`,!0),i.classList.toggle(`${ho}__cell`,!0),o.classList.toggle(`${ho}__cell`,!0),e.ariaHidden="true",i.role="presentation",o.ariaHidden="true",t.append(e,i,o),{cellIcon:e,cellLabel:i,cellArrow:o}}initButtonElement(t,e){t.addClass(`${ho}__item`),t.setEnabled(e.enabled);const i=this.ctx.localeManager.t(e.label),o=`${ho}__cellpadding`,{cellIcon:s,cellLabel:a,cellArrow:n}=this.initTableCells(t.getElement());if(a.textContent=i,a.classList.add(o),e.iconUrl!=null){const c=xn("img");c.src=e.iconUrl,s.append(c),s.classList.add(o)}if(e.items.length>0){const c=xn("span",UL("chevron-right"));n.append(c),n.classList.add(o)}const{showOn:r,action:l}=e;l!=null&&t.addListener("click",this.createButtonOnClick(r,l)),e.items.length===0&&(t.addListener("mouseleave",()=>t.setFocusOverride(!1)),t.addListener("focus",()=>t.setFocusOverride(void 0)))}reposition(){let{x:t,y:e}=this;this.element.style.top="unset",this.element.style.bottom="unset";const i=this.ctx.domManager.getBoundingClientRect(),{offsetWidth:o,offsetHeight:s}=this.element;t=bf(0,t,i.width-o),e=bf(0,e,i.height-s),this.element.style.left=`${t}px`,this.element.style.top=`calc(${e}px - 0.5em)`}destroy(){super.destroy(),this.mutationObserver?.disconnect(),this.ctx.domManager.removeStyles(Lp),this.ctx.domManager.removeChild("canvas-overlay",Lp)}};p([Ap],rl.prototype,"enabled",2),p([Ap],rl.prototype,"darkTheme",2),p([Ap],rl.prototype,"items",2);var XL={type:"root",packageType:"enterprise",chartTypes:["cartesian","polar","topology","standalone"],optionsKey:"contextMenu",moduleFactory:t=>new rl(t),themeTemplate:{contextMenu:{enabled:!0,darkTheme:WL.ThemeSymbols.IS_DARK_THEME}}};import{_ModuleSupport as Sa}from"ag-charts-community";import{createId as ZL}from"ag-charts-core";function bn(t){return typeof t?.datum=="object"?t.datum:null}import{_ModuleSupport as kf}from"ag-charts-community";import{createId as qL,setAttribute as QL}from"ag-charts-core";var{FormatManager:JL,BaseProperties:tI,Property:ba}=kf,eI="ag-charts-crosshair-label",Go=class extends tI{constructor(){super(...arguments),this.enabled=!0,this.xOffset=0,this.yOffset=0,this.format=void 0,this.renderer=void 0,this._cachedFormatter=void 0}formatValue(t,e,i,o){const{formatter:s,format:a}=this,{domain:n,boundSeries:r}=o;let l;if(s!=null){const c=o.type==="number"?o.fractionDigits:void 0,h=o.type==="date"?o.unit:void 0,d=o.type==="date"?o.step:void 0;l=t(s,{value:i,domain:n,fractionDigits:c,unit:h,step:d,boundSeries:r})}if(a!=null){let c=this._cachedFormatter;(c==null||c.type!==e||c.format!==a)&&(c={type:e,format:a,formatter:JL.getFormatter(e,a)},this._cachedFormatter=c),l??(l=c.formatter?.(i))}return l!=null?String(l):void 0}};p([ba],Go.prototype,"enabled",2),p([ba],Go.prototype,"xOffset",2),p([ba],Go.prototype,"yOffset",2),p([ba],Go.prototype,"formatter",2),p([ba],Go.prototype,"format",2),p([ba],Go.prototype,"renderer",2);var iI=class extends Go{constructor(t,e,i){super(),this.domManager=t,this.id=qL(this),this.element=t.addChild("canvas-overlay",`crosshair-label-${this.id}`),this.element.classList.add(eI),QL(this.element,"aria-hidden",!0),this.element.setAttribute("data-key",e),this.element.setAttribute("data-axis-id",i)}show(t){const{element:e}=this,i=t.x+this.xOffset,o=t.y+this.yOffset;e.style.top=`${Math.round(o)}px`,e.style.left=`${Math.round(i)}px`,this.toggle(!0)}setLabelHtml({html:t,styles:e}){if(t!==void 0&&(this.element.innerHTML=t),e!==void 0){const i=this.element.children[0]??this.element;Object.assign(i.style,e)}}getBBox(){const{element:t}=this;return new kf.BBox(t.clientLeft,t.clientTop,t.clientWidth,t.clientHeight)}toggle(t){this.element.classList.toggle("ag-charts-crosshair-label--hidden",!t)}destroy(){this.domManager.removeChild("canvas-overlay",`crosshair-label-${this.id}`)}toLabelHtml(t,e){if(typeof t=="string")return{html:t,styles:{}};e=e??{};const{text:i=e.text??"",color:o=e.color,backgroundColor:s=e.backgroundColor,opacity:a=e.opacity??1}=t,n={opacity:a,"background-color":s?.toLowerCase(),color:o};return{html:`<div class="ag-charts-crosshair-label-content">
                    <span>${i}</span>
                </div>`,styles:n}}},{Group:oI,TranslatableGroup:sI,Line:aI,BBox:Af,InteractionState:ll,Property:Wo,ZIndexMap:Lf,ChartAxisDirection:If}=Sa,po=class extends Sa.BaseModuleInstance{constructor(t){super(),this.ctx=t,this.id=ZL(this),this.enabled=!1,this.stroke="rgb(195, 195, 195)",this.lineDash=[6,3],this.lineDashOffset=0,this.strokeWidth=1,this.strokeOpacity=1,this.snap=!0,this.label=new Go,this.seriesRect=new Af(0,0,0,0),this.bounds=new Af(0,0,0,0),this.crosshairGroup=new sI({name:"crosshairs",zIndex:Lf.SERIES_CROSSHAIR}),this.lineGroup=this.crosshairGroup.appendChild(new oI({name:`${this.id}-crosshair-lines`,zIndex:Lf.SERIES_CROSSHAIR})),this.lineGroupSelection=Sa.Selection.select(this.lineGroup,aI,!1),this.activeHighlight=void 0,this.axisCtx=t.parent,this.labels={},this.hideCrosshairs(),t.domManager.addEventListener("focusin",({target:i})=>{const o=i instanceof HTMLElement&&t.domManager.contains(i,"series-area");this.crosshairGroup.visible&&!o&&(this.hideCrosshairs(),this.ctx.updateService.update(Sa.ChartUpdateType.PERFORM_LAYOUT))});const{seriesDragInterpreter:e}=t.widgets;this.cleanup.register(t.scene.attachNode(this.crosshairGroup),t.widgets.seriesWidget.addListener("mousemove",i=>this.onMouseHoverLike(i)),t.widgets.seriesWidget.addListener("mouseleave",()=>this.onMouseOut()),t.eventsHub.on("series:focus-change",()=>this.onKeyPress()),t.eventsHub.on("zoom:pan-start",()=>this.onMouseOut()),t.eventsHub.on("zoom:change",()=>this.onMouseOut()),t.eventsHub.on("highlight:change",i=>this.onHighlightChange(i)),t.eventsHub.on("layout:complete",i=>this.layout(i)),()=>Object.values(this.labels).forEach(i=>i.destroy())),e&&this.cleanup.register(e.events.on("drag-move",i=>this.onMouseHoverLike(i)),e.events.on("click",i=>this.onClick(i)))}layout({series:{rect:t,visible:e},axes:i}){if(!e||!i||!this.enabled)return;this.seriesRect=t;const{position:o="left",axisId:s}=this.axisCtx,a=i.find(c=>c.id===s);if(!a)return;this.axisLayout=a,this.bounds=t.clone().grow(a.gridPadding+a.seriesAreaPadding,o);const{crosshairGroup:n,bounds:r}=this;n.translationX=Math.round(r.x),n.translationY=Math.round(r.y);const l=["pointer",...this.axisCtx.seriesKeyProperties()];this.updateSelections(l),this.updateLines(),this.updateLabels(l)}updateSelections(t){this.lineGroupSelection.update(t,void 0,e=>e)}updateLabels(t){const{labels:e,ctx:i}=this;for(const o of t)this.label.enabled&&(e[o]??(e[o]=new iI(i.domManager,o,this.axisCtx.axisId))),e[o]&&this.updateLabel(e[o])}updateLabel(t){const{enabled:e,xOffset:i,yOffset:o,format:s,renderer:a}=this.label;t.enabled=e,t.xOffset=i,t.yOffset=o,t.format=s,t.renderer=a}updateLines(){const{lineGroupSelection:t,bounds:e,stroke:i,strokeWidth:o,strokeOpacity:s,lineDash:a,lineDashOffset:n,axisLayout:r}=this;if(!r)return;const l=this.isVertical();t.each(c=>{c.stroke=i,c.strokeWidth=o,c.strokeOpacity=s,c.lineDash=a,c.lineDashOffset=n,c.y1=0,c.y2=l?e.height:0,c.x1=0,c.x2=l?0:e.width})}isVertical(){return this.axisCtx.direction===If.X}isHover(t){return t.type==="mousemove"||t.type==="click"||t.device==="touch"&&this.ctx.chartService.touch.dragAction==="hover"}formatValue(t){return this.axisCtx.formatScaleValue(t,"crosshair",this.label)}onClick(t){t.device==="touch"&&this.onMouseHoverLike(t)}onMouseHoverLike(t){if(!this.enabled||this.snap)return;const e=this.isHover(t)?ll.Clickable:ll.AnnotationsMoveable;this.ctx.interactionManager.isState(e)&&(this.updatePositions(this.getData(t)),this.crosshairGroup.visible=!0,this.ctx.updateService.update(Sa.ChartUpdateType.SCENE_RENDER))}onMouseOut(){this.ctx.interactionManager.isState(ll.Clickable)&&(this.hideCrosshairs(),this.ctx.updateService.update(Sa.ChartUpdateType.SCENE_RENDER))}onKeyPress(){this.enabled&&!this.snap&&this.ctx.interactionManager.isState(ll.Default)&&this.hideCrosshairs()}onHighlightChange(t){if(!this.enabled)return;const{crosshairGroup:e,axisCtx:i}=this,{datum:o,series:s}=t.currentHighlight??{},a=o&&(s?.axes.x?.id===i.axisId||s?.axes.y?.id===i.axisId);if(this.activeHighlight=a?t.currentHighlight:void 0,!this.activeHighlight)this.hideCrosshairs();else if(this.snap){const n=this.getActiveHighlightData(this.activeHighlight);this.updatePositions(n),e.visible=!0}}isInRange(t){return this.axisCtx.inRange(t)}updatePositions(t){const{seriesRect:e,lineGroupSelection:i}=this;i.each((o,s)=>{const a=t[s];if(!a){o.visible=!1,this.hideLabel(s);return}o.visible=!0;const{value:n,position:r}=a;let l=0,c=0;this.isVertical()?(l=r,o.x=Math.round(l)):(c=r,o.y=Math.round(c)),this.label.enabled?this.showLabel(l+e.x,c+e.y,n,s):this.hideLabel(s)})}getData(t){const{axisCtx:e}=this,i="pointer",{xKey:o="",yKey:s=""}=this.activeHighlight??{},{currentX:a,currentY:n}=t,r=bn(this.activeHighlight),l=this.isVertical(),c=l?a:n;let h=r?.[l?o:s]??"";return e.continuous&&(h=e.scaleInvert(c)),{[i]:{position:c,value:h}}}getActiveHighlightData(t){const{axisCtx:e}=this,{series:i,xKey:o="",aggregatedValue:s,cumulativeValue:a,midPoint:n}=t,r=bn(t),l=i.getKeyProperties(e.direction),c=(e.scale.bandwidth??0)/2,h=i.axes[e.direction]?.id===e.axisId,d=l.indexOf("yKey")>-1&&h,u=l.indexOf("xKey")>-1&&h,g=s??a;if(d&&g!==void 0){const f=e.scale.convert(g)+c;return this.isInRange(f)?{yKey:{value:g,position:f}}:{}}if(u){const f=(this.isVertical()?n?.x:n?.y)??0,x=e.continuous?e.scaleInvert(f):r?.[o];return this.isInRange(f)?{xKey:{value:x,position:f}}:{}}const y={};return l.forEach(f=>{const x=i.properties[f],S=r?.[x],v=e.scale.convert(S)+c;this.isInRange(v)&&(y[f]={value:S,position:v})}),y}getLabelHtml(t,e){const i=this.axisLayout?.label?.fractionDigits??0,o={text:this.formatValue(t)};return this.label.renderer?e.toLabelHtml(this.label.renderer({value:t,fractionDigits:i}),o):e.toLabelHtml(o)}showLabel(t,e,i,o){if(!this.axisLayout)return;const{bounds:s}=this,a=this.labels[o],n=this.getLabelHtml(i,a);a.setLabelHtml(n);const{width:r,height:l}=a.getBBox(),c=this.axisCtx.position;let h=this.axisLayout.label.spacing+this.axisLayout.tickSize;this.axisCtx.direction===If.X?(h-=4,a.show({x:t-r/2,y:c==="bottom"?s.y+s.height+h:s.y-l-h})):(h-=8,a.show({x:c==="right"?s.x+s.width+h:s.x-r-h,y:e-l/2}))}hideCrosshairs(){this.crosshairGroup.visible=!1;for(const t of Object.keys(this.labels))this.hideLabel(t)}hideLabel(t){this.labels[t]?.toggle(!1)}};p([Wo],po.prototype,"enabled",2),p([Wo],po.prototype,"stroke",2),p([Wo],po.prototype,"lineDash",2),p([Wo],po.prototype,"lineDashOffset",2),p([Wo],po.prototype,"strokeWidth",2),p([Wo],po.prototype,"strokeOpacity",2),p([Wo],po.prototype,"snap",2),p([Wo],po.prototype,"label",2);var nI={type:"axis-option",optionsKey:"crosshair",packageType:"enterprise",chartTypes:["cartesian"],axisTypes:["category","time","unit-time","ordinal-time","number","log"],moduleFactory:t=>new po(t),themeTemplate:{crosshair:{snap:!0,stroke:{$ref:"subtleTextColor"},strokeWidth:1,strokeOpacity:1,lineDash:[5,6],lineDashOffset:0,label:{enabled:!0}}}};import{_ModuleSupport as Cf}from"ag-charts-community";var{ActionOnSet:vn,Property:Tf}=Cf,va=class extends Cf.BaseModuleInstance{constructor(t){super(),this.enabled=!1,this.getData=()=>Promise.resolve(),this.dataService=t.dataService}updateCallback(t,e){this.dataService&&(t&&e!=null?this.dataService.updateCallback(e):this.dataService.clearCallback())}};p([vn({newValue(t){this.updateCallback(t,this.getData)}}),Tf],va.prototype,"enabled",2),p([vn({newValue(t){this.updateCallback(this.enabled,t)}}),Tf],va.prototype,"getData",2),p([vn({newValue(t){this.dataService.requestThrottle=t}})],va.prototype,"requestThrottle",2),p([vn({newValue(t){this.dataService.dispatchThrottle=t}})],va.prototype,"updateThrottle",2),p([vn({newValue(t){this.dataService.dispatchOnlyLatest=!t}})],va.prototype,"updateDuringInteraction",2);var rI={type:"root",optionsKey:"dataSource",packageType:"enterprise",chartTypes:["cartesian","polar","topology","standalone"],moduleFactory:t=>new va(t),themeTemplate:{dataSource:{enabled:!1}}};import{AgErrorBarSupportedSeriesTypes as lI}from"ag-charts-community";import{AgErrorBarSupportedSeriesTypes as wf,_ModuleSupport as Ip}from"ag-charts-community";import{Logger as cI,isDefined as Ne}from"ag-charts-core";import{_ModuleSupport as Mn}from"ag-charts-community";var{nearestSquared:hI,nearestSquaredInContainer:pI,partialAssign:dI,mergeDefaults:Nf,BBox:Ko}=Mn,uI=class{constructor(t){this.components=t,this.union=Ko.merge(t)}containsPoint(t,e){if(!this.union.containsPoint(t,e))return!1;for(const i of this.components)if(i.containsPoint(t,e))return!0;return!1}},gI=class extends Mn.Group{constructor(){super(),this.capLength=NaN,this._datum=void 0,this.whiskerPath=new Mn.Path,this.capsPath=new Mn.Path,this.bboxes=new uI([]),this.append([this.whiskerPath,this.capsPath])}get datum(){return this._datum}set datum(t){this._datum=t}calculateCapLength(t,e){const{lengthRatio:i=1,length:o}=t,{lengthRatioMultiplier:s,lengthMax:a}=e,n=o??i*s;return Math.min(n,a)}getItemStylerParams(t,e,i,o){const{datum:s}=this;if(s==null||t.itemStyler==null)return;const{xLowerKey:a,xUpperKey:n,yLowerKey:r,yUpperKey:l}=t;return{...e,datum:s.datum,seriesId:s.series.id,xKey:s.xKey,yKey:s.yKey,xLowerKey:a,xUpperKey:n,yLowerKey:r,yUpperKey:l,highlighted:i,highlightState:o}}formatStyles(t,e,i,o,s){let{cap:a,...n}=t;const r=this.getItemStylerParams(e,t,o,s);if(r!=null&&e.itemStyler!=null){const l=i.callWithContext(e.itemStyler,r);n=Nf(l,n),a=Nf(l?.cap,l,a)}return{whiskerStyle:n,capsStyle:a}}applyStyling(t,e){dI(["visible","stroke","strokeWidth","strokeOpacity","lineDash","lineDashOffset"],t,e)}update(t,e,i,o,s){if(this.datum===void 0)return;const{whiskerStyle:a,capsStyle:n}=this.formatStyles(t,e,i,o,s),{xBar:r,yBar:l,capDefaults:c}=this.datum,h=this.whiskerPath;this.applyStyling(h,a),h.path.clear(!0),l!==void 0&&(h.path.moveTo(l.lowerPoint.x,l.lowerPoint.y),h.path.lineTo(l.upperPoint.x,l.upperPoint.y)),r!==void 0&&(h.path.moveTo(r.lowerPoint.x,r.lowerPoint.y),h.path.lineTo(r.upperPoint.x,r.upperPoint.y)),h.path.closePath(),this.capLength=this.calculateCapLength(n??{},c);const d=this.capLength/2,u=this.capsPath;this.applyStyling(u,n),u.path.clear(!0),l!==void 0&&(u.path.moveTo(l.lowerPoint.x-d,l.lowerPoint.y),u.path.lineTo(l.lowerPoint.x+d,l.lowerPoint.y),u.path.moveTo(l.upperPoint.x-d,l.upperPoint.y),u.path.lineTo(l.upperPoint.x+d,l.upperPoint.y)),r!==void 0&&(u.path.moveTo(r.lowerPoint.x,r.lowerPoint.y-d),u.path.lineTo(r.lowerPoint.x,r.lowerPoint.y+d),u.path.moveTo(r.upperPoint.x,r.upperPoint.y-d),u.path.lineTo(r.upperPoint.x,r.upperPoint.y+d)),u.path.closePath()}updateBBoxes(){const{capLength:t,whiskerPath:e,capsPath:i}=this,{yBar:o,xBar:s}=this.datum??{},a=t/2,n=[];if(o!==void 0){const r=o.lowerPoint.y-o.upperPoint.y;n.push(new Ko(o.lowerPoint.x,o.upperPoint.y,e.strokeWidth,r),new Ko(o.lowerPoint.x-a,o.lowerPoint.y,t,i.strokeWidth),new Ko(o.upperPoint.x-a,o.upperPoint.y,t,i.strokeWidth))}if(s!==void 0){const r=s.upperPoint.x-s.lowerPoint.x;n.push(new Ko(s.lowerPoint.x,s.upperPoint.y,r,e.strokeWidth),new Ko(s.lowerPoint.x,s.lowerPoint.y-a,i.strokeWidth,t),new Ko(s.upperPoint.x,s.upperPoint.y-a,i.strokeWidth,t))}this.bboxes.components=n,this.bboxes.union=Ko.merge(n)}containsPoint(t,e){return this.bboxes.containsPoint(t,e)}pickNode(t,e){return this.containsPoint(t,e)?this:void 0}nearestSquared(t,e,i){const{bboxes:o}=this;if(o.union.distanceSquared(t,e)>i)return{nearest:void 0,distanceSquared:1/0};const{distanceSquared:s}=hI(t,e,o.components);return{nearest:this,distanceSquared:s}}},yI=class extends Mn.Group{nearestSquared(t,e){const{nearest:i,distanceSquared:o}=pI(t,e,{children:this.children()});if(i!==void 0&&!isNaN(o))return{datum:i.datum,distanceSquared:o}}};import{_ModuleSupport as fI}from"ag-charts-community";var{BaseProperties:Pf,Property:xt}=fI,uo=class extends Pf{};p([xt],uo.prototype,"visible",2),p([xt],uo.prototype,"stroke",2),p([xt],uo.prototype,"strokeWidth",2),p([xt],uo.prototype,"strokeOpacity",2),p([xt],uo.prototype,"lineDash",2),p([xt],uo.prototype,"lineDashOffset",2),p([xt],uo.prototype,"length",2),p([xt],uo.prototype,"lengthRatio",2);var oe=class extends Pf{constructor(){super(...arguments),this.visible=!0,this.stroke="black",this.strokeWidth=1,this.strokeOpacity=1,this.cap=new uo}};p([xt],oe.prototype,"yLowerKey",2),p([xt],oe.prototype,"yLowerName",2),p([xt],oe.prototype,"yUpperKey",2),p([xt],oe.prototype,"yUpperName",2),p([xt],oe.prototype,"xLowerKey",2),p([xt],oe.prototype,"xLowerName",2),p([xt],oe.prototype,"xUpperKey",2),p([xt],oe.prototype,"xUpperName",2),p([xt],oe.prototype,"visible",2),p([xt],oe.prototype,"stroke",2),p([xt],oe.prototype,"strokeWidth",2),p([xt],oe.prototype,"strokeOpacity",2),p([xt],oe.prototype,"lineDash",2),p([xt],oe.prototype,"lineDashOffset",2),p([xt],oe.prototype,"itemStyler",2),p([xt],oe.prototype,"cap",2);var{fixNumericExtent:mI,groupAccumulativeValueProperty:xI,mergeDefaults:SI,valueProperty:cl,ChartAxisDirection:Dn}=Ip;function bI(t){for(const e of wf)if(e===t.series.type)return t.series;throw new Error(`AG Charts - unsupported series type '${t.series.type}', error bars supported series types: ${wf.join(", ")}`)}var vI=class ar extends Ip.BaseModuleInstance{constructor(e){super(),this.properties=new oe;const i=bI(e),{annotationGroup:o,annotationSelections:s}=i;this.cartesianSeries=i,this.groupNode=new yI({name:`${o.id}-errorBars`}),o.appendChild(this.groupNode),this.selection=Ip.Selection.select(this.groupNode,()=>this.errorBarFactory()),s.add(this.selection),i.addEventListener("seriesVisibilityChange",a=>this.onToggleSeriesItem(a)),this.cleanup.register(i.events.on("data-processed",a=>this.onDataProcessed(a)),i.events.on("data-update",a=>this.onDataUpdate(a)),e.eventsHub.on("highlight:change",a=>this.onHighlightChange(a)),()=>o.removeChild(this.groupNode),()=>s.delete(this.selection))}hasErrorBars(){const{xLowerKey:e,xUpperKey:i,yLowerKey:o,yUpperKey:s}=this.properties;return Ne(e)&&Ne(i)||Ne(o)&&Ne(s)}isStacked(){const e=this.cartesianSeries.seriesGrouping?.stackCount;return e==null?!1:e>0}getUnstackPropertyDefinition(e){const i=[],{xLowerKey:o,xUpperKey:s,yLowerKey:a,yUpperKey:n,xErrorsID:r,yErrorsID:l}=this.getMaybeFlippedKeys(),{xScaleType:c,yScaleType:h}=e;return a!=null&&n!=null&&i.push(cl(a,h,{id:`${l}-lower`}),cl(n,h,{id:`${l}-upper`})),o!=null&&s!=null&&i.push(cl(o,c,{id:`${r}-lower`}),cl(s,c,{id:`${r}-upper`})),i}getStackPropertyDefinition(e){const i=[],{cartesianSeries:o}=this,{xLowerKey:s,xUpperKey:a,yLowerKey:n,yUpperKey:r,xErrorsID:l,yErrorsID:c}=this.getMaybeFlippedKeys(),{xScaleType:h,yScaleType:d}=e,u=o.seriesGrouping?.groupIndex??o.id,g={invalidValue:null,missingValue:0,separateNegative:!0,...o.visible?{}:{forceValue:0}},y=(x,S,v,m)=>xI(x,"normal","current",{id:`${S}-${v}`,groupId:`errorGroup-${u}-${v}`,...g},m),f=(x,S,v,m)=>{i.push(...y(x,v,"lower",m),...y(S,v,"upper",m))};return n!=null&&r!=null&&f(n,r,c,d),s!=null&&a!=null&&f(s,a,l,h),i}getPropertyDefinitions(e){return this.isStacked()?this.getStackPropertyDefinition(e):this.getUnstackPropertyDefinition(e)}onDataProcessed(e){this.dataModel=e.dataModel,this.processedData=e.processedData}getDomain(e){const{xLowerKey:i,xUpperKey:o,xErrorsID:s,yLowerKey:a,yUpperKey:n,yErrorsID:r}=this.getMaybeFlippedKeys();if(e===Dn.X?Ne(i)&&Ne(o):Ne(a)&&Ne(n)){const{dataModel:c,processedData:h,cartesianSeries:d}=this;if(c!=null&&h!=null){const u={x:s,y:r}[e],g=c.getDomain(d,`${u}-lower`,"value",h),y=c.getDomain(d,`${u}-upper`,"value",h),f=[Math.min(...g,...y),Math.max(...g,...y)];return mI(f)}}return[]}onDataUpdate(e){this.dataModel=e.dataModel,this.processedData=e.processedData,Ne(e.dataModel)&&Ne(e.processedData)&&(this.createNodeData(),this.update())}getNodeData(){return this.hasErrorBars()?this.cartesianSeries.contextNodeData?.nodeData:void 0}createNodeData(){const e=this.getNodeData(),i=this.cartesianSeries.axes[Dn.X]?.scale,o=this.cartesianSeries.axes[Dn.Y]?.scale;if(!(!i||!o||!e))for(let s=0;s<e.length;s++){const{midPoint:a,xLower:n,xUpper:r,yLower:l,yUpper:c}=this.getDatum(e,s);if(a!=null){let h,d;Ne(n)&&Ne(r)&&(h={lowerPoint:{x:this.convert(i,n),y:a.y},upperPoint:{x:this.convert(i,r),y:a.y}}),Ne(l)&&Ne(c)&&(d={lowerPoint:{x:a.x,y:this.convert(o,l)},upperPoint:{x:a.x,y:this.convert(o,c)}}),e[s].xBar=h,e[s].yBar=d}}}getMaybeFlippedKeys(){let{xLowerKey:e,xUpperKey:i,yLowerKey:o,yUpperKey:s}=this.properties,[a,n]=["xValue-errors","yValue-errors"];return this.cartesianSeries.shouldFlipXY()&&([e,o]=[o,e],[i,s]=[s,i],[a,n]=[n,a]),{xLowerKey:e,xUpperKey:i,xErrorsID:a,yLowerKey:o,yUpperKey:s,yErrorsID:n}}static getDatumKey(e,i,o){if(i==null)return;const a=bn(e)?.[i];if(a!=null){if(typeof a!="number"){cI.warnOnce(`Found [${i}] error value of type ${typeof a}. Expected number type`);return}return a+o}}getDatum(e,i){const{xLowerKey:o,xUpperKey:s,yLowerKey:a,yUpperKey:n}=this.getMaybeFlippedKeys(),r=e[i],l=r.cumulativeValue==null||!this.isStacked()?0:r.cumulativeValue-r.yValue,[c,h]=this.cartesianSeries.shouldFlipXY()?[l,0]:[0,l];return{midPoint:r.midPoint,xLower:ar.getDatumKey(r,o,c),xUpper:ar.getDatumKey(r,s,c),yLower:ar.getDatumKey(r,a,h),yUpper:ar.getDatumKey(r,n,h)}}convert(e,i){const o=(e.bandwidth??0)/2;return e.convert(i)+o}update(){const e=this.getNodeData();e!=null&&(this.selection.update(e),this.selection.each((i,o,s)=>this.updateNode(i,o,s)))}updateNode(e,i,o){e.datum=i,e.update(this.getDefaultStyle(),this.properties,this.cartesianSeries,!1,"none"),e.updateBBoxes()}pickNodeExact(e){const{x:i,y:o}=e,s=this.groupNode.pickNode(i,o);if(s!=null)return{datum:s.datum,distanceSquared:0}}pickNodeNearest(e){return this.groupNode.nearestSquared(e.x,e.y)}pickNodeMainAxisFirst(e,i){let o,s=[1/0,1/0];const a=[e.x,e.y];i===Dn.Y&&a.reverse();for(const n of this.groupNode.children()){const r=n.getBBox(),l=[r.x+r.width/2,r.y+r.height/2];i===Dn.Y&&l.reverse();const c=[];for(let h=0;h<a.length;h++)c.push(Math.abs(a[h]-l[h]));(c[0]<s[0]||c[0]==s[0]&&c[1]<s[1])&&(o=n.datum,s=c)}if(o)return{datum:o,distanceSquared:Math.pow(s[0],2)+Math.pow(s[1],2)}}getTooltipParams(){const{xLowerKey:e,xUpperKey:i,yLowerKey:o,yUpperKey:s,xLowerName:a=e,xUpperName:n=i,yLowerName:r=o,yUpperName:l=s}=this.properties;return{xLowerKey:e,xLowerName:a,xUpperKey:i,xUpperName:n,yLowerKey:o,yLowerName:r,yUpperKey:s,yUpperName:l}}onToggleSeriesItem(e){this.groupNode.visible=e.visible}makeStyle(e){return{visible:e.visible,lineDash:e.lineDash,lineDashOffset:e.lineDashOffset,stroke:e.stroke,strokeWidth:e.strokeWidth,strokeOpacity:e.strokeOpacity,cap:SI(this.properties.cap,e)}}getDefaultStyle(){return this.makeStyle(this.getWhiskerProperties())}getHighlightStyle(){return this.makeStyle(this.getWhiskerProperties())}restyleHighlightChange(e,i,o){const s=this.getNodeData();if(s!=null){for(let a=0;a<s.length;a++)if(e===s[a]){this.selection.at(a)?.update(i,this.properties,this.cartesianSeries,o,o?"highlighted-item":"unhighlighted-item");break}}}onHighlightChange(e){const{previousHighlight:i,currentHighlight:o}=e;o?.series===this.cartesianSeries&&this.restyleHighlightChange(o,this.getHighlightStyle(),!0),i?.series===this.cartesianSeries&&this.restyleHighlightChange(i,this.getDefaultStyle(),!1),this.groupNode.opacity=this.cartesianSeries.getOpacity()}errorBarFactory(){return new gI}getWhiskerProperties(){const{stroke:e,strokeWidth:i,visible:o,strokeOpacity:s,lineDash:a,lineDashOffset:n}=this.properties;return{stroke:e,strokeWidth:i,visible:o,strokeOpacity:s,lineDash:a,lineDashOffset:n}}},MI={series:{errorBar:{visible:!0,stroke:{$ref:"foregroundColor"},strokeWidth:1,strokeOpacity:1,cap:{length:void 0,lengthRatio:void 0}}}},DI={type:"series-option",identifier:"error-bars",optionsKey:"errorBar",packageType:"enterprise",chartTypes:["cartesian"],seriesTypes:lI,moduleFactory:t=>new vI(t),themeTemplate:MI};import{_ModuleSupport as hl}from"ag-charts-community";var{ZIndexMap:kI,ActionOnSet:AI,Property:Cp,ProxyPropertyOnWrite:Ef}=hl,pl=class extends hl.Background{constructor(){super(...arguments),this.image=new Vi,this.fill="transparent",this.fillOpacity=void 0}createNode(){return new hl.Group({name:"foreground",zIndex:kI.FOREGROUND})}onLayoutComplete(t){super.onLayoutComplete(t);const{width:e,height:i}=t.chart;let o={x:0,y:0,width:e,height:i};this.image&&(o=this.image.performLayout(e,i)),this.text&&this.updateTextNode(o)}onImageLoad(){this.ctx.updateService.update(hl.ChartUpdateType.SCENE_RENDER)}updateTextNode(t){const{textNode:e}=this;e.fontWeight="bold",e.fontFamily="Impact, sans-serif",e.fontSize=19,e.opacity=.7,e.fill="#9b9b9b",e.textBaseline="top";const i=this.textNode.getBBox(),o=10;e.x=t.x+t.width/2-i.width/2,e.y=t.y+t.height+o}};p([Cp,AI({newValue(t){this.node.appendChild(t.node),t.onLoad=()=>this.onImageLoad()},oldValue(t){this.node.removeChild(t.node),t.onLoad=void 0}})],pl.prototype,"image",2),p([Cp,Ef("rectNode","fill")],pl.prototype,"fill",2),p([Cp,Ef("rectNode","fillOpacity")],pl.prototype,"fillOpacity",2);var LI={type:"root",optionsKey:"foreground",packageType:"enterprise",chartTypes:["cartesian","polar","topology","standalone"],moduleFactory:t=>new pl(t)};import{_ModuleSupport as Tp}from"ag-charts-community";import{Logger as II,clamp as wp}from"ag-charts-core";import{_ModuleSupport as _f}from"ag-charts-community";import{Logger as Of,calcLineHeight as CI}from"ag-charts-core";import{_ModuleSupport as TI}from"ag-charts-community";var{TranslatableGroup:wI,SceneChangeDetection:Rf}=TI,Np=class extends wI{constructor(){super(...arguments),this.inset=0,this.cornerRadius=0}applyClip(t,e){const{cornerRadius:i,inset:o}=this,{x:s,y:a,width:n,height:r}=e,l=new Path2D;l.roundRect(s+o,a+o,n-2*o,r-2*o,i),t.clip(l)}};p([Rf()],Np.prototype,"inset",2),p([Rf()],Np.prototype,"cornerRadius",2);var{Property:Pp,ZIndexMap:Ms,ActionOnSet:Bf,CategoryAxis:NI,Padding:PI,Group:Ds,BBox:zf,ProxyProperty:Ff,stackCartesianSeries:EI}=_f,Ep=class{constructor(){this.top=0,this.bottom=0}};p([Pp],Ep.prototype,"top",2),p([Pp],Ep.prototype,"bottom",2);var Ma=class extends _f.BaseModuleInstance{constructor(t){super(),this.ctx=t,this.enabled=!1,this.padding=new Ep,this.root=new Ds({name:"root"}),this.seriesRoot=this.root.appendChild(new Np({name:"Series-root",zIndex:Ms.SERIES_LAYER,renderToOffscreenCanvas:!0})),this.axisGridGroup=this.root.appendChild(new Ds({name:"Axes-Grids",zIndex:Ms.AXIS_GRID})),this.axisGroup=this.root.appendChild(new Ds({name:"Axes-Grids",zIndex:Ms.AXIS_GRID})),this.axisLabelGroup=this.root.appendChild(new Ds({name:"Axes-Labels",zIndex:Ms.SERIES_LABEL})),this.axisCrosslineRangeGroup=this.root.appendChild(new Ds({name:"Axes-Crosslines-Range",zIndex:Ms.SERIES_CROSSLINE_RANGE})),this.axisCrosslineLineGroup=this.root.appendChild(new Ds({name:"Axes-Crosslines-Line",zIndex:Ms.SERIES_CROSSLINE_LINE})),this.axisCrosslineLabelGroup=this.root.appendChild(new Ds({name:"Axes-Crosslines-Label",zIndex:Ms.SERIES_LABEL})),this.data=[],this._destroyed=!1,this.miniChartAnimationPhase="initial",this.seriesRect=void 0,this.axes=[],this.series=[]}destroy(){this._destroyed||(this.destroySeries(this.series),this.axes.forEach(t=>t.destroy()),this.axes=[],this._destroyed=!0)}onSeriesChange(t,e){const i=e?.filter(o=>!t.includes(o))??[];this.destroySeries(i);for(const o of t){if(e?.includes(o))continue;o.attachSeries(this.seriesRoot,this.seriesRoot,void 0);const s=this;o.chart={get mode(){return"standalone"},get isMiniChart(){return!0},get seriesRect(){return s.seriesRect}},o.resetAnimation(this.miniChartAnimationPhase==="initial"?"initial":"disabled")}this.seriesRect=void 0}destroySeries(t){t?.forEach(e=>{e.destroy(),e.detachSeries(this.seriesRoot,this.seriesRoot,void 0),e.chart=void 0})}assignSeriesToAxes(){this.axes.forEach(t=>{t.boundSeries=this.series.filter(e=>e.axes[t.direction]===t)})}assignAxesToSeries(){const t={};this.axes.forEach(e=>{const i=e.direction;(t[i]??(t[i]=[])).push(e)}),this.series.forEach(e=>{e.directions.forEach(i=>{const o=t[i];if(!o){Of.warnOnce(`no available axis for direction [${i}]; check series and axes configuration.`);return}const s=e.getKeys(i),a=this.findMatchingAxis(o,s);if(!a){Of.warnOnce(`no matching axis for direction [${i}] and keys [${s}]; check series and axes configuration.`);return}e.axes[i]=a})})}findMatchingAxis(t,e){for(const i of t){if(!i.keys.length)return i;if(e){for(const o of e)if(i.keys.includes(o))return i}}}updateData(t){this.series.forEach(e=>e.setChartData(t)),this.miniChartAnimationPhase==="initial"&&this.ctx.animationManager.onBatchStop(()=>{this.miniChartAnimationPhase="ready",this.series.forEach(e=>e.resetAnimation("disabled"))})}async processData(t){this.series.some(e=>e.canHaveAxes)&&(this.assignAxesToSeries(),this.assignSeriesToAxes()),await Promise.all(this.series.map(e=>(e.resetDatumCallbackCache(),e.processData(t))));for(const e of this.axes)e.processData()}computeAxisPadding(){const t=new PI;return this.enabled&&this.axes.forEach(({position:e,thickness:i,line:o,label:s})=>{if(e==null)return;let a;i?a=i:a=(o.enabled?o.width:0)+(s.enabled?CI(s.fontSize??0)+s.spacing:0),t[e]=Math.ceil(a)}),t}async layout(t,e){const{padding:i}=this,o=this.seriesRect!=null,s=new zf(0,0,t,e-(i.top+i.bottom)),a=this.seriesRect==null||this.seriesRect.width!==t||this.seriesRect.height!==e;this.seriesRect=s,this.seriesRoot.translationY=i.top,this.seriesRoot.setClipRectCanvasSpace(new zf(0,-i.top,t,e)),this.axes.forEach(n=>{const{position:r="left"}=n;switch(r){case"top":case"bottom":n.range=[0,s.width],n.gridLength=s.height;break;case"right":case"left":{const l=n instanceof NI;n.range=l?[0,s.height]:[s.height,0],n.gridLength=s.width;break}}n.gridPadding=0,n.translation.x=0,n.translation.y=0,r==="right"?n.translation.x=t:r==="bottom"&&(n.translation.y=e),o||n.resetAnimation("initial"),n.calculateLayout(),n.update()}),a&&EI(this.series),await Promise.all(this.series.map(n=>n.update({seriesRect:s})))}};p([Pp],Ma.prototype,"enabled",2),p([Ff(["seriesRoot","inset"])],Ma.prototype,"inset",2),p([Ff(["seriesRoot","cornerRadius"])],Ma.prototype,"cornerRadius",2),p([Bf({changeValue(t,e=[]){const i={axisNode:this.axisGroup,gridNode:this.axisGridGroup,labelNode:this.axisLabelGroup,crossLineLineNode:this.axisCrosslineLineGroup,crossLineRangeNode:this.axisCrosslineRangeGroup,crossLineLabelNode:this.axisCrosslineLabelGroup};for(const o of e)t.includes(o)||(o.detachAxis(i),o.destroy());for(const o of t)e?.includes(o)||o.attachAxis(i)}})],Ma.prototype,"axes",2),p([Bf({changeValue(t,e){this.onSeriesChange(t,e)}})],Ma.prototype,"series",2);import{_ModuleSupport as _I}from"ag-charts-community";import{clamp as OI}from"ag-charts-core";var{SliderWidget:Vf}=_I,RI=class{constructor(t,e){this.ctx=t,this.sliderHandlers=e,this._min=0,this._max=1,this.minRange=.001,this.dragStartX=0,this.ctx=t,this.toolbar=t.proxyInteractionService.createProxyContainer({type:"toolbar",domManagerId:"navigator-toolbar",classList:["ag-charts-proxy-navigator-toolbar"],orientation:"vertical",ariaLabel:{id:"ariaLabelNavigator"}}),this.sliders=[t.proxyInteractionService.createProxyElement({type:"slider",domIndex:1,ariaLabel:{id:"ariaLabelNavigatorMinimum"},parent:this.toolbar,cursor:"ew-resize"}),t.proxyInteractionService.createProxyElement({type:"slider",domIndex:-1/0,ariaLabel:{id:"ariaLabelNavigatorRange"},parent:this.toolbar,cursor:"grab"}),t.proxyInteractionService.createProxyElement({type:"slider",domIndex:2,ariaLabel:{id:"ariaLabelNavigatorMaximum"},parent:this.toolbar,cursor:"ew-resize"})];for(const[i,o]of["min","pan","max"].entries()){const s=this.sliders[i];s.step=Vf.STEP_HUNDRETH,s.keyboardStep=Vf.STEP_ONE,s.orientation="horizontal",s.setPreventsDefault(!1),s.addListener("drag-start",a=>this.onDragStart(i,a,o)),s.addListener("drag-move",a=>this.onDrag(s,a,o)),s.addListener("drag-end",()=>this.updateSliderRatios()),s.addListener("contextmenu",a=>this.onContextMenu(s,a))}this.sliders[0].addListener("change",()=>this.onMinSliderChange()),this.sliders[1].addListener("change",()=>this.onPanSliderChange()),this.sliders[2].addListener("change",()=>this.onMaxSliderChange()),this.updateSliderRatios(),this.updateVisibility(!1)}destroy(){this.toolbar.destroy()}updateVisibility(t){this.toolbar.setHidden(!t)}updateZoom(){const{_min:t,_max:e}=this;if(!(t==null||e==null))return this.ctx.zoomManager.updateZoom("navigator",{x:{min:t,max:e}})}updateBounds(t){this.toolbar.setBounds(t)}updateSliderBounds(t,e){this.sliders[t].setBounds(e)}updateMinMax(t,e){this._min=t,this._max=e,this.updateSliderRatios()}updateSliderRatios(){let{_min:t,_max:e}=this;t=Math.round(t*100)/100,e=Math.round(e*100)/100;const i=this.ctx.localeManager.t("ariaValuePanRange",{min:t,max:e});this.sliders[0].setValueRatio(t),this.sliders[1].setValueRatio(t,{ariaValueText:i}),this.sliders[2].setValueRatio(e)}toCanvasOffsets(t){return{offsetX:this.dragStartX+t.originDeltaX}}moveToFront(t){if(t===1)return;const e=this.sliders[t],i=this.sliders[2-t];this.toolbar.moveChild(i,e.domIndex-1)}onDragStart(t,e,i){const o=this.sliders[t],s=this.toolbar.cssLeft(),a=o.cssLeft();this.dragStartX=s+a+e.offsetX,this.moveToFront(t),e.sourceEvent.preventDefault(),this.sliderHandlers.onDragStart(i,this.toCanvasOffsets(e))}onDrag(t,e,i){e.sourceEvent.preventDefault(),this.sliderHandlers.onDrag(i,this.toCanvasOffsets(e))}onContextMenu(t,e){const{offsetX:i,offsetY:o}=e,{x:s,y:a}=this.toolbar.getBounds(),{x:n,y:r}=t.getBounds(),l=i+s+n,c=o+a+r;this.ctx.contextMenuRegistry.dispatchContext("always",{widgetEvent:e,canvasX:l,canvasY:c},void 0)}onPanSliderChange(){const t=this.sliders[1].getValueRatio(),e=this._max-this._min;this._min=OI(0,t,1-e),this._max=this._min+e,this.updateZoom()}onMinSliderChange(){this._min=this.sliders[0].clampValueRatio(0,this._max-this.minRange),this.updateZoom()}onMaxSliderChange(){this._max=this.sliders[2].clampValueRatio(this._min+this.minRange,1),this.updateZoom()}};import{_ModuleSupport as Hf}from"ag-charts-community";var{Property:dl,SceneChangeDetection:ul,BBox:BI,ExtendedPath2D:zI}=Hf,$o=class extends Hf.Path{constructor(){super(...arguments),this.zIndex=3,this.centerX=0,this.centerY=0,this.width=8,this.height=16,this.cornerRadius=4,this.grip=!0,this.gripPath=new zI}setCenter(t,e){this.dirtyPath=!0,(this.centerX!==t||this.centerY!==e)&&(this.centerX=t,this.centerY=e,this.markDirty("center"))}static align(t,e,i,o,s,a,n,r,l){const c=t.align(i+s*n)+l,h=c+t.align(i+s*n,s*(r-n))-2*l,d=t.align(o+a/2);t.setCenter(c,d),e.setCenter(h,d)}computeBBox(){const{centerX:t,centerY:e,width:i,height:o}=this,s=t-i/2,a=e-o/2;return new BI(s,a,i,o)}isPointInPath(t,e){return this.getBBox().containsPoint(t,e)}updatePath(){const{centerX:t,centerY:e,path:i,gripPath:o,strokeWidth:s,cornerRadius:a,grip:n}=this,r=s/2,l=this.layerManager?.canvas?.pixelRatio??1;i.clear(),o.clear();const c=Math.floor(this.width/2*l)/l,h=Math.floor(this.height/2*l)/l;i.roundRect(t-c+r,e-h+r,2*(c-r),2*(h-r),a);const d=3;if(n)for(let u=-.5;u<=.5;u+=1)for(let g=-1;g<=1;g+=1)o.arc(t+u*d,e+g*d,1,0,2*Math.PI),o.closePath()}renderFill(t,e){const{stroke:i}=this;super.renderFill(t,e),t.fillStyle=typeof i=="string"?i:"black",t.fill(this.gripPath.getPath2D())}};$o.className="RangeHandle",p([dl,ul()],$o.prototype,"width",2),p([dl,ul()],$o.prototype,"height",2),p([dl,ul()],$o.prototype,"cornerRadius",2),p([dl,ul()],$o.prototype,"grip",2);import{_ModuleSupport as FI}from"ag-charts-community";var{Path:VI,BBox:_p,ExtendedPath2D:HI,clippedRoundRect:GI,Property:WI,SceneChangeDetection:KI}=FI,Op=class extends VI{constructor(){super(...arguments),this.cornerRadius=4,this.zIndex=2,this.x=0,this.y=0,this.width=200,this.height=30,this.min=0,this.max=1,this.visiblePath=new HI}layout(t,e,i,o,s,a){s=isNaN(s)?this.min:s,a=isNaN(a)?this.max:a,(t!==this.x||e!==this.y||i!==this.width||this.height!==o||s!==this.min||a!==this.max)&&(this.x=t,this.y=e,this.width=i,this.height=o,this.min=s,this.max=a,this.dirtyPath=!0,this.markDirty("RangeMask.layout"))}computeBBox(){const{x:t,y:e,width:i,height:o}=this;return new _p(t,e,i,o)}computeVisibleRangeBBox(){const{x:t,y:e,width:i,height:o,min:s,max:a}=this,n=t+i*s,r=t+i*a;return new _p(n,e,r-n,o)}updatePath(){const{path:t,visiblePath:e,x:i,y:o,width:s,height:a,min:n,max:r,strokeWidth:l,cornerRadius:c}=this,h=l/2;t.clear(),e.clear();const d=this.align(i)+h,u=this.align(o)+h,g=this.align(i,s)-2*h,y=this.align(o,a)-2*h,f=this.align(i+s*n)+h,x=f+this.align(i+s*n,s*(r-n))-2*h,S={topLeft:c,topRight:c,bottomRight:c,bottomLeft:c},v=(m,b,M)=>{if(M-b<1)return;const k=new _p(b,u,M-b,y);GI(m,d,u,g,y,S,k)};v(t,d,f),v(t,x,g+d),v(e,f,x)}renderStroke(t,e){super.renderStroke(t,e),super.renderStroke(t,this.visiblePath.getPath2D())}};Op.className="RangeMask",p([WI,KI()],Op.prototype,"cornerRadius",2);import{_ModuleSupport as gl}from"ag-charts-community";var $I=class extends gl.Group{constructor(t){super({name:"rangeSelectorGroup",zIndex:gl.ZIndexMap.NAVIGATOR}),this.x=0,this.y=0,this.width=200,this.height=30,this.lOffset=0,this.rOffset=0,this.background=this.appendChild(new gl.TranslatableGroup({name:"navigator-background",zIndex:1})),this.append(t)}layout(t,e,i,o,s,a){this.x=t,this.y=e,this.width=i,this.height=o,this.lOffset=s,this.rOffset=a,this.background.translationX=t,this.background.translationY=e,this.markDirty("RangeSelector")}updateBackground(t,e){t!=null&&this.background.removeChild(t),e!=null&&this.background.appendChild(e),this.markDirty("RangeSelector")}computeBBox(){const{x:t,y:e,width:i,height:o,lOffset:s,rOffset:a}=this;return new gl.BBox(t-s,e,i+(s+a),o)}},{BaseModuleInstance:jI,ObserveChanges:Rp,Property:yl}=Tp,Da=class extends jI{constructor(t){super(),this.ctx=t,this.enabled=!1,this.mask=new Op,this.minHandle=new $o,this.maxHandle=new $o,this.maskVisibleRange={id:"navigator-mask-visible-range",getBBox:()=>this.mask.computeVisibleRangeBBox(),toCanvasBBox:()=>this.mask.computeVisibleRangeBBox(),fromCanvasPoint:(e,i)=>({x:e,y:i})},this.height=30,this.cornerRadius=0,this.spacing=10,this.x=0,this.y=0,this.width=0,this.rangeSelector=new $I([this.mask,this.minHandle,this.maxHandle]),this.cleanup.register(t.scene.attachNode(this.rangeSelector),t.eventsHub.on("locale:change",()=>this.updateZoom()),t.layoutManager.registerElement(Tp.LayoutElement.Navigator,e=>this.onLayoutStart(e)),t.eventsHub.on("layout:complete",e=>this.onLayoutComplete(e)),t.eventsHub.on("zoom:change",e=>this.onZoomChange(e))),this.domProxy=new RI(t,this),this.updateGroupVisibility(),this.miniChart=new Ma(t)}updateBackground(t,e){this.rangeSelector?.updateBackground(t,e)}updateGroupVisibility(){const{enabled:t}=this;this.rangeSelector==null||t===this.rangeSelector.visible||(this.rangeSelector.visible=t,this.domProxy.updateVisibility(t),t?this.updateZoom():this.ctx.zoomManager.updateZoom("navigator"))}onLayoutStart(t){if(this.enabled){const{layoutBox:e}=t,i=this.height+this.spacing;e.shrink(i,"bottom"),this.y=e.y+e.height+this.spacing}else this.y=0;if(this.enabled&&this.miniChart){const{top:e,bottom:i}=this.miniChart.computeAxisPadding();t.layoutBox.shrink(e+i,"bottom"),this.y-=i,this.miniChart.inset=this.mask.strokeWidth/2,this.miniChart.cornerRadius=this.mask.cornerRadius}}onLayoutComplete(t){const{x:e,width:i}=t.series.rect,{y:o,height:s}=this;if(this.domProxy.updateVisibility(this.enabled),this.enabled){const{_min:a,_max:n}=this.domProxy;this.layoutNodes(e,o,i,s,a,n),this.domProxy.updateBounds({x:e,y:o,width:i,height:s})}this.x=e,this.width=i,this.miniChart?.layout(i,s).catch(a=>II.error(a))}canDrag(){return this.enabled&&this.ctx.interactionManager.isState(Tp.InteractionState.ZoomDraggable)}onDragStart(t,{offsetX:e}){this.canDrag()&&(t==="pan"&&(this.panStart=(e-this.x)/this.width-this.domProxy._min),this.ctx.zoomManager.fireZoomPanStartEvent("navigator"))}onDrag(t,{offsetX:e}){if(!this.canDrag())return;const{panStart:i,x:o,width:s}=this,{minRange:a}=this.domProxy;let{_min:n,_max:r}=this.domProxy;const l=(e-o)/s;if(t==="min")n=wp(0,l,r-a);else if(t==="max")r=wp(n+a,l,1);else if(t==="pan"&&i!=null){const c=r-n;n=wp(0,l-i,1-c),r=n+c}this.domProxy._min=n,this.domProxy._max=r,this.updateZoom()}onZoomChange(t){const{x:e}=t;if(!e)return;const{x:i,y:o,width:s,height:a}=this,{min:n,max:r}=e;this.domProxy.updateMinMax(n,r),this.layoutNodes(i,o,s,a,n,r)}layoutNodes(t,e,i,o,s,a){const{rangeSelector:n,mask:r,minHandle:l,maxHandle:c}=this;r.layout(t,e,i,o,s,a),n.layout(t,e,i,o,l.width/2,c.width/2),$o.align(l,c,t,e,i,o,s,a,r.strokeWidth/2),s+(a-s)/2<.5?(l.zIndex=3,c.zIndex=4):(l.zIndex=4,c.zIndex=3),[l,this.maskVisibleRange,c].forEach((h,d)=>{const u=h.getBBox(),g={x:u.x-t,y:u.y-e,height:u.height,width:u.width};this.domProxy.updateSliderBounds(d,g)})}updateZoom(){this.enabled&&this.domProxy.updateZoom()}updateData(t){return this.miniChart?.updateData(t)}async processData(t){if(this.miniChart)return this.miniChart?.processData(t)}};p([Rp((t,e,i)=>{t.updateBackground(i?.root,e?.root)})],Da.prototype,"miniChart",2),p([yl,Rp((t,e)=>{t.ctx.zoomManager.setNavigatorEnabled(!!e),t.updateGroupVisibility()})],Da.prototype,"enabled",2),p([yl],Da.prototype,"height",2),p([yl,Rp((t,e)=>{t.mask.cornerRadius=e})],Da.prototype,"cornerRadius",2),p([yl],Da.prototype,"spacing",2);import{_ModuleSupport as YI}from"ag-charts-community";import{_ModuleSupport as UI}from"ag-charts-community";import{array as XI,arrayOfDefs as ZI,boolean as kn,callback as qI,color as fl,fontOptionsDef as QI,number as Gf,positiveNumber as ni,ratio as JI,typeUnion as tC}from"ag-charts-core";import{_ModuleSupport as Wf}from"ag-charts-community";import{_ModuleSupport as ml}from"ag-charts-community";function eC(t){return{from:t?{scalingX:1,scalingY:0}:{scalingX:0,scalingY:1},to:{scalingX:1,scalingY:1}}}function iC(t){return(e,i)=>t?{scalingCenterY:i.scaledValues.medianValue}:{scalingCenterX:i.scaledValues.medianValue}}import{_ModuleSupport as oC}from"ag-charts-community";var{Path:sC,Scalable:aC,ExtendedPath2D:nC,SceneChangeDetection:ue,SceneArrayChangeDetection:rC,BBox:ks,clippedRoundRect:Kf}=oC,Ut=class extends aC(sC){constructor(){super(...arguments),this.wickPath=new nC,this.horizontal=!1,this.center=0,this.thickness=0,this.min=0,this.q1=0,this.median=0,this.q3=0,this.max=0,this.cornerRadius=0,this.crisp=!1,this.strokeAlignment=0,this.wickStroke=void 0,this.wickStrokeWidth=void 0,this.wickStrokeOpacity=void 0,this.capLengthRatio=1}computeBBox(){const{horizontal:t,center:e,thickness:i,min:o,max:s}=this;return t?new ks(Math.min(o,s),e-i/2,Math.abs(s-o),i):new ks(e-i/2,Math.min(o,s),i,Math.abs(s-o))}computeDefaultGradientFillBBox(){const{horizontal:t,center:e,thickness:i,q1:o,q3:s}=this;return t?new ks(Math.min(o,s),e-i/2,Math.abs(s-o),i):new ks(e-i/2,Math.min(o,s),i,Math.abs(s-o))}isPointInPath(t,e){return this.getBBox().containsPoint(t,e)}distanceSquared(t,e){return this.getBBox().distanceSquared(t,e)}get midPoint(){return this.horizontal?{x:(this.min+this.max)/2,y:this.center}:{x:this.center,y:(this.min+this.max)/2}}alignedCoordinates(){const{thickness:t,crisp:e,strokeAlignment:i}=this;let{center:o,min:s,q1:a,median:n,q3:r,max:l}=this,c=o-t/2,h=o+t/2;if(e&&t>1){s=this.align(s),a=this.align(a),n=this.align(n),r=this.align(r),l=s+this.align(s,l-s);const u=this.align(t/2);o=this.align(o),c=o-u,h=o+u}const d=(s+l)/2;return c+=i,h+=i,s+=s<d?i:-i,l+=l<d?i:-i,a+=a<d?-i:i,n+=n<d?-i:i,r+=r<d?-i:i,{center:o,x0:c,x1:h,min:s,max:l,q1:a,median:n,q3:r}}updatePath(){const{path:t,stroke:e,strokeWidth:i,strokeOpacity:o,lineDash:s,lineDashOffset:a,wickStroke:n,wickStrokeWidth:r,wickStrokeOpacity:l,wickLineDash:c,wickLineDashOffset:h,strokeAlignment:d,cornerRadius:u,capLengthRatio:g,horizontal:y}=this,{center:f,x0:x,x1:S,min:v,max:m,q1:b,median:M,q3:k}=this.alignedCoordinates();this.path.clear(),this.wickPath.clear();const D=n!=null&&n!==e||r!=null&&r!==i||l!=null&&l!==o||c!=null&&c!==s||h!=null&&h!==a?this.wickPath:t;if(Math.abs(S-x)<=3){ka(D,y,f,v),Aa(D,y,f,m);return}const I=Math.min(v,m),L=Math.max(v,m),C=Math.min(b,k),w=Math.max(b,k),P=f-Math.abs((S-x)*g)/2,E=f+Math.abs((S-x)*g)/2;ka(D,y,P,I),Aa(D,y,E,I),ka(D,y,f,I),Aa(D,y,f,C+i/2),ka(D,y,f,L),Aa(D,y,f,w-i/2),ka(D,y,P,L),Aa(D,y,E,L);const T=i/2+d,R=i/2-d,_=w-C-2*R;if(_>0){const N=x+T,O=C+R,B=S-x-2*T,z={topLeft:u,topRight:u,bottomRight:u,bottomLeft:u};$f(t,y,N,O,B,_,z,new ks(N,O,B,M-O)),$f(t,y,N,O,B,_,z,new ks(N,M,B,O+_-M))}else{const N=(C+w)/2;ka(t,y,x,N),Aa(t,y,S,N)}}drawPath(t){super.drawPath(t);const{wickPath:e}=this;if(e.isEmpty())return;const{stroke:i,strokeWidth:o,strokeOpacity:s,lineDash:a,lineDashOffset:n,wickStroke:r=i,wickStrokeWidth:l=o,wickStrokeOpacity:c=s,wickLineDash:h=a,wickLineDashOffset:d=n}=this;l!==0&&(t.globalAlpha*=c,typeof r=="string"&&(t.strokeStyle=r),t.lineWidth=l,h!=null&&t.setLineDash([...h]),t.lineDashOffset=d,t.stroke(e.getPath2D()))}};p([ue()],Ut.prototype,"horizontal",2),p([ue()],Ut.prototype,"center",2),p([ue()],Ut.prototype,"thickness",2),p([ue()],Ut.prototype,"min",2),p([ue()],Ut.prototype,"q1",2),p([ue()],Ut.prototype,"median",2),p([ue()],Ut.prototype,"q3",2),p([ue()],Ut.prototype,"max",2),p([ue()],Ut.prototype,"cornerRadius",2),p([ue()],Ut.prototype,"crisp",2),p([ue()],Ut.prototype,"strokeAlignment",2),p([ue()],Ut.prototype,"wickStroke",2),p([ue()],Ut.prototype,"wickStrokeWidth",2),p([ue()],Ut.prototype,"wickStrokeOpacity",2),p([rC()],Ut.prototype,"wickLineDash",2),p([ue()],Ut.prototype,"wickLineDashOffset",2),p([ue()],Ut.prototype,"capLengthRatio",2);function ka(t,e,i,o){e?t.moveTo(o,i):t.moveTo(i,o)}function Aa(t,e,i,o){e?t.lineTo(o,i):t.lineTo(i,o)}function $f(t,e,i,o,s,a,n,r){e?Kf(t,o,i,a,s,n,r!=null?new ks(r.y,r.x,r.height,r.width):void 0):Kf(t,i,o,s,a,n,r)}import{_ModuleSupport as lC}from"ag-charts-community";var{BaseProperties:jf,AbstractBarSeriesProperties:cC,makeSeriesTooltip:hC,Property:ht,mergeDefaults:pC}=lC,Yf=class extends jf{constructor(){super(...arguments),this.lengthRatio=.5}};p([ht],Yf.prototype,"lengthRatio",2);var La=class extends jf{};p([ht],La.prototype,"stroke",2),p([ht],La.prototype,"strokeWidth",2),p([ht],La.prototype,"strokeOpacity",2),p([ht],La.prototype,"lineDash",2),p([ht],La.prototype,"lineDashOffset",2);var yt=class extends cC{constructor(){super(...arguments),this.fill="#c16068",this.fillOpacity=1,this.stroke="#333",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.cornerRadius=0,this.cap=new Yf,this.whisker=new La,this.tooltip=hC()}toJson(){const{stroke:t,strokeWidth:e,strokeOpacity:i,lineDash:o,lineDashOffset:s}=this,a=super.toJson();return a.whisker=pC(a.whisker,{stroke:t,strokeWidth:e,strokeOpacity:i,lineDash:o,lineDashOffset:s}),a}getStyle(){const{fill:t,fillOpacity:e,strokeWidth:i,strokeOpacity:o,stroke:s,lineDash:a,lineDashOffset:n,cornerRadius:r,cap:l,whisker:c}=this;return{fill:t,fillOpacity:e,strokeWidth:i,strokeOpacity:o,stroke:s,lineDash:a,lineDashOffset:n,cornerRadius:r,cap:l,whisker:c,opacity:1}}};p([ht],yt.prototype,"xKey",2),p([ht],yt.prototype,"minKey",2),p([ht],yt.prototype,"q1Key",2),p([ht],yt.prototype,"medianKey",2),p([ht],yt.prototype,"q3Key",2),p([ht],yt.prototype,"maxKey",2),p([ht],yt.prototype,"xName",2),p([ht],yt.prototype,"yName",2),p([ht],yt.prototype,"minName",2),p([ht],yt.prototype,"q1Name",2),p([ht],yt.prototype,"medianName",2),p([ht],yt.prototype,"q3Name",2),p([ht],yt.prototype,"maxName",2),p([ht],yt.prototype,"fill",2),p([ht],yt.prototype,"fillOpacity",2),p([ht],yt.prototype,"stroke",2),p([ht],yt.prototype,"strokeWidth",2),p([ht],yt.prototype,"strokeOpacity",2),p([ht],yt.prototype,"lineDash",2),p([ht],yt.prototype,"lineDashOffset",2),p([ht],yt.prototype,"cornerRadius",2),p([ht],yt.prototype,"itemStyler",2),p([ht],yt.prototype,"cap",2),p([ht],yt.prototype,"whisker",2),p([ht],yt.prototype,"tooltip",2);var{fixNumericExtent:dC,keyProperty:uC,mergeDefaults:Bp,SeriesNodePickMode:Uf,SMALLEST_KEY_INTERVAL:gC,valueProperty:An,diff:yC,animationValidation:fC,computeBarFocusBounds:mC,createDatumId:xC,HighlightState:SC,ContinuousScale:bC,ChartAxisDirection:vC,motion:Xf,getItemStyles:MC,applyShapeFillBBox:DC,calculateSegments:kC}=ml,AC=class extends ml.SeriesNodeEvent{constructor(t,e,i,o){super(t,e,i,o),this.xKey=o.properties.xKey,this.minKey=o.properties.minKey,this.q1Key=o.properties.q1Key,this.medianKey=o.properties.medianKey,this.q3Key=o.properties.q3Key,this.maxKey=o.properties.maxKey}},xl=class extends ml.AbstractBarSeries{constructor(t){super({moduleCtx:t,pickModes:[Uf.NEAREST_NODE,Uf.EXACT_SHAPE_MATCH],propertyKeys:{x:["xKey"],y:["medianKey","q1Key","q3Key","minKey","maxKey"]},propertyNames:{x:["xName"],y:["medianName","q1Name","q3Name","minName","maxName"]},categoryKey:"xValue",pathsPerSeries:[]}),this.properties=new yt,this.NodeEvent=AC}async processData(t){if(!this.visible)return;const{xKey:e,minKey:i,q1Key:o,medianKey:s,q3Key:a,maxKey:n}=this.properties,r=!this.ctx.animationManager.isSkipped(),l=this.getCategoryAxis()?.scale,c=this.getValueAxis()?.scale,{isContinuousX:h,xScaleType:d,yScaleType:u}=this.getScaleInformation({xScale:l,yScale:c}),g=[];r&&this.processedData&&g.push(yC(this.id,this.processedData)),r&&g.push(fC());const{processedData:y}=await this.requestDataModel(t,this.data,{props:[uC(e,d,{id:"xValue"}),An(i,u,{id:"minValue"}),An(o,u,{id:"q1Value"}),An(s,u,{id:"medianValue"}),An(a,u,{id:"q3Value"}),An(n,u,{id:"maxValue"}),...h?[gC]:[],...g]});this.smallestDataInterval=y.reduced?.smallestKeyInterval,this.animationState.transition("updateData")}getSeriesDomain(t){const{processedData:e,dataModel:i}=this;if(!(e&&i))return[];if(t!==this.getBarDirection()){const{index:s,def:a}=i.resolveProcessedDataDefById(this,"xValue"),n=e.domain.keys[s];return a.type==="key"&&a.valueType==="category"?n:this.padBandExtent(n)}const o=this.domainForClippedRange(t,["minValue","maxValue"],"xValue");return dC(o)}getSeriesRange(t,e){return this.domainForVisibleRange(vC.Y,["maxValue","minValue"],"xValue",e)}createNodeData(){const{visible:t,dataModel:e,processedData:i}=this,o=this.getCategoryAxis(),s=this.getValueAxis();if(!(e&&i&&o&&s))return;const{xKey:a}=this.properties,n=[],r=e.resolveKeysById(this,"xValue",i),l=e.resolveColumnById(this,"minValue",i),c=e.resolveColumnById(this,"q1Value",i),h=e.resolveColumnById(this,"medianValue",i),d=e.resolveColumnById(this,"q3Value",i),u=e.resolveColumnById(this,"maxValue",i),{barWidth:g,groupIndex:y}=this.updateGroupScale(o),f=bC.is(o.scale)?g*-.5:0,{groupScale:x}=this,S=this.isVertical(),v=kC(this.properties.segmentation,o,s,this.chart.seriesRect,this.ctx.scene),m={itemId:a,nodeData:n,labelData:[],scales:this.calculateScaling(),groupScale:this.getScaling(this.groupScale),visible:this.visible,styles:MC(this.getItemStyle.bind(this)),segments:v};return t&&(i.dataSources.get(this.id)??[]).forEach((M,k)=>{const A=r[k];if(A==null)return;const D=l[k],I=c[k],L=h[k],C=d[k],w=u[k];if([D,I,L,C,w].some(B=>typeof B!="number")||D>I||I>L||L>C||C>w)return;const P={xValue:o.scale.convert(A),minValue:s.scale.convert(D),q1Value:s.scale.convert(I),medianValue:s.scale.convert(L),q3Value:s.scale.convert(C),maxValue:s.scale.convert(w)},E=g;P.xValue+=x.convert(String(y))+f+E/2;const T=Math.abs(P.q3Value-P.q1Value),R=P.xValue,_=Math.min(P.q3Value,P.q1Value)+T/2,N={x:S?R:_,y:S?_:R};let O;S?O={x:N.x-E/2,y:P.minValue,width:E,height:P.maxValue-P.minValue}:O={x:P.minValue,y:N.y-E/2,width:P.maxValue-P.minValue,height:E},n.push({series:this,itemId:A,datum:M,datumIndex:k,xKey:a,bandwidth:E,scaledValues:P,midPoint:N,focusRect:O})}),m}legendItemSymbol(){const{fill:t,fillOpacity:e,stroke:i,strokeWidth:o,strokeOpacity:s,lineDash:a,lineDashOffset:n}=this.properties;return{marker:{fill:ml.deepClone(t),fillOpacity:e,stroke:i,strokeOpacity:s,strokeWidth:o,lineDash:a,lineDashOffset:n}}}getLegendData(t){const{id:e,ctx:{legendManager:i},visible:o}=this,{xKey:s,yName:a,showInLegend:n,legendItemName:r}=this.properties;return!s||t!=="category"?[]:[{legendType:"category",id:e,itemId:e,seriesId:e,enabled:o&&i.getItemEnabled({seriesId:e,itemId:e}),label:{text:r??a??e},symbol:this.legendItemSymbol(),legendItemName:r,hideInLegend:!n}]}getTooltipContent(t){const{id:e,dataModel:i,processedData:o,properties:s}=this,{xKey:a,xName:n,yName:r,medianKey:l,medianName:c,q1Key:h,q1Name:d,q3Key:u,q3Name:g,minKey:y,minName:f,maxKey:x,maxName:S,legendItemName:v,tooltip:m}=s,b=this.getCategoryAxis(),M=this.getValueAxis();if(!i||!o||!b||!M)return;const k=o.dataSources.get(this.id)?.[t],A=i.resolveKeysById(this,"xValue",o)[t],D=i.resolveColumnById(this,"minValue",o)[t],I=i.resolveColumnById(this,"q1Value",o)[t],L=i.resolveColumnById(this,"medianValue",o)[t],C=i.resolveColumnById(this,"q3Value",o)[t],w=i.resolveColumnById(this,"maxValue",o)[t];if(A==null)return;const P=this.getItemStyle(t,!1),E=[{label:f,fallbackLabel:y,value:this.getAxisValueText(M,"tooltip",D,k,y,v)},{label:d,fallbackLabel:h,value:this.getAxisValueText(M,"tooltip",I,k,h,v)},{label:c,fallbackLabel:l,value:this.getAxisValueText(M,"tooltip",L,k,l,v)},{label:g,fallbackLabel:u,value:this.getAxisValueText(M,"tooltip",C,k,u,v)},{label:S,fallbackLabel:x,value:this.getAxisValueText(M,"tooltip",w,k,x,v)}];return this.formatTooltipWithContext(m,{heading:this.getAxisValueText(b,"tooltip",A,k,a,v),title:v??r,symbol:this.legendItemSymbol(),data:E},{seriesId:e,datum:k,title:r,xKey:a,xName:n,yName:r,medianKey:l,medianName:c,q1Key:h,q1Name:d,q3Key:u,q3Name:g,minKey:y,minName:f,maxKey:x,maxName:S,...P})}animateEmptyUpdateReady({datumSelection:t}){const e=this.isVertical(),{from:i,to:o}=eC(e);Xf.resetMotion([t],iC(e)),Xf.staticFromToMotion(this.id,"datums",this.ctx.animationManager,[t],i,o,{phase:"initial"})}isLabelEnabled(){return!1}updateDatumSelection(t){const e=t.nodeData??[];return t.datumSelection.update(e)}getItemStyle(t,e,i){const{id:o,properties:s}=this,{xKey:a,minKey:n,q1Key:r,medianKey:l,q3Key:c,maxKey:h,itemStyler:d}=s,u=this.getHighlightStyle(e,t,i);let g=Bp(u,s.getStyle());if(d!=null&&t!=null){const m=this.cachedDatumCallback(xC(t,e?"highlight":"node"),()=>{const b=this.processedData?.dataSources.get(o)?.[t],M=this.ctx.highlightManager?.getActiveHighlight(),k=this.getHighlightStateString(M,e,t);return this.ctx.optionsGraphService.resolvePartial(["series",`${this.declarationOrder}`],this.callWithContext(d,{seriesId:o,datum:b,xKey:a,minKey:n,q1Key:r,medianKey:l,q3Key:c,maxKey:h,highlighted:e,highlightState:k,...g}))});m&&(g=Bp(m,g))}const{stroke:y,strokeWidth:f,strokeOpacity:x,lineDash:S,lineDashOffset:v}=g;return g.whisker=Bp(g.whisker,{stroke:y,strokeWidth:f,strokeOpacity:x,lineDash:S,lineDashOffset:v}),g}updateDatumStyles({datumSelection:t,isHighlight:e}){t.each((i,o)=>{o.style=this.getItemStyle(o.datumIndex,e)})}updateDatumNodes({datumSelection:t,isHighlight:e}){const{contextNodeData:i}=this;if(!i)return;const o=this.isVertical(),s=this.ctx.highlightManager.getActiveHighlight(),a=this.getShapeFillBBox();t.each((n,r)=>{const l=r.style??i.styles[this.getHighlightState(s,e,r.datumIndex)];DC(n,l.fill,a),n.fill=l.fill,n.fillOpacity=l.fillOpacity,n.stroke=l.stroke,n.strokeWidth=l.strokeWidth,n.strokeOpacity=l.strokeOpacity,n.lineDash=l.lineDash,n.lineDashOffset=l.lineDashOffset,n.wickStroke=l.whisker.stroke,n.wickStrokeWidth=l.whisker.strokeWidth,n.wickStrokeOpacity=l.whisker.strokeOpacity,n.wickLineDash=l.whisker.lineDash,n.wickLineDashOffset=l.whisker.lineDashOffset,n.cornerRadius=l.cornerRadius,n.crisp=!0,n.horizontal=!o,n.center=r.scaledValues.xValue,n.thickness=r.bandwidth,n.min=r.scaledValues.minValue,n.q1=r.scaledValues.q1Value,n.median=r.scaledValues.medianValue,n.q3=r.scaledValues.q3Value,n.max=r.scaledValues.maxValue,n.capLengthRatio=l.cap.lengthRatio,n.strokeAlignment=(i.styles[SC.None].strokeWidth??0)/2})}updateLabelNodes(){}updateLabelSelection(t){const{labelData:e,labelSelection:i}=t;return i.update(e)}nodeFactory(){return new Ut}computeFocusBounds({datumIndex:t}){return mC(this,this.contextNodeData?.nodeData[t].focusRect)}hasItemStylers(){return this.properties.itemStyler!=null}};xl.className="BoxPlotSeries",xl.type="box-plot";import{_ModuleSupport as LC}from"ag-charts-community";import{boolean as IC,constant as CC,required as As,shapeSegmentation as TC,string as Pe}from"ag-charts-core";var{boxPlotSeriesThemeableOptionsDef:wC,commonSeriesOptionsDefs:NC}=LC,PC={...NC,...wC,type:As(CC("box-plot")),xKey:As(Pe),minKey:As(Pe),q1Key:As(Pe),medianKey:As(Pe),q3Key:As(Pe),maxKey:As(Pe),xName:Pe,yName:Pe,minName:Pe,q1Name:Pe,medianName:Pe,q3Name:Pe,maxName:Pe,grouped:IC,legendItemName:Pe,segmentation:TC};import{_ModuleSupport as EC}from"ag-charts-community";var{ThemeConstants:{CARTESIAN_AXIS_TYPE:Zf},multiSeriesHighlightStyle:_C,FILL_GRADIENT_LINEAR_DEFAULTS:OC,FILL_IMAGE_DEFAULTS:RC,FILL_PATTERN_DEFAULTS:BC,SAFE_FILL_OPERATION:zC,SEGMENTATION_DEFAULTS:FC}=EC,VC={series:{direction:"vertical",fill:{$applySwitch:[{$path:"type"},{$if:[{$or:[{$isGradient:{$palette:"fill"}},{$isPattern:{$palette:"fill"}},{$isImage:{$palette:"fill"}}]},{$palette:"fill"},{$mix:[zC,{$ref:"chartBackgroundColor"},.7]}]},["gradient",OC],["image",RC],["pattern",BC]]},stroke:{$palette:"stroke"},strokeWidth:2,fillOpacity:1,strokeOpacity:1,lineDash:void 0,lineDashOffset:0,highlight:_C(),segmentation:FC},axes:{[Zf.NUMBER]:{crosshair:{snap:!1}},[Zf.CATEGORY]:{groupPaddingInner:.2,crosshair:{enabled:!1,snap:!1}}}},HC={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["cartesian"],identifier:"box-plot",moduleFactory:t=>new xl(t),predictAxis:Wf.predictCartesianTimeAxis,defaultAxes:Wf.DIRECTION_SWAP_AXES,themeTemplate:VC,groupable:!0},qf={type:"series",name:"box-plot",chartType:"cartesian",enterprise:!0,options:PC,create:t=>new xl(t)};import{_ModuleSupport as GC}from"ag-charts-community";import{_ModuleSupport as WC}from"ag-charts-community";import{_ModuleSupport as zp}from"ag-charts-community";import{Logger as Qf}from"ag-charts-core";import{_ModuleSupport as KC}from"ag-charts-community";var{AGGREGATION_SPAN:Jf,AGGREGATION_INDEX_X_MAX:$C,AGGREGATION_INDEX_X_MIN:jC,AGGREGATION_INDEX_Y_MAX:YC,AGGREGATION_INDEX_Y_MIN:UC,aggregationDomain:XC,aggregationRangeFittingPoints:ZC,compactAggregationIndices:qC,createAggregationIndices:QC}=KC,JC=1e3,tm=jC,tT=YC,eT=UC,em=$C;function iT(t,e,i,o,s,a){if(e.length<JC)return;const[n,r]=XC(t,s);let l=ZC(e,n,r,{smallestKeyInterval:a}),{indexData:c,valueData:h}=QC(e,i,o,n,r,l);const d=[{maxRange:l,indexData:c}];for(;l>64;)({indexData:c,valueData:h,maxRange:l}=qC(c,h,l)),d.push({maxRange:l,indexData:c});return d.reverse(),d}var{fixNumericExtent:oT,keyProperty:sT,createDatumId:im,SeriesNodePickMode:om,ChartAxisDirection:sm,SMALLEST_KEY_INTERVAL:aT,valueProperty:Sl,diff:nT,animationValidation:rT,computeBarFocusBounds:lT,visibleRangeIndices:am,BandScale:cT,processedDataIsAnimatable:hT,mergeDefaults:nm,simpleMemorize2:pT,getItemStylesPerItemId:dT}=zp,uT=pT(iT),gT=class extends zp.SeriesNodeEvent{constructor(t,e,i,o){super(t,e,i,o),this.xKey=o.properties.xKey,this.openKey=o.properties.openKey,this.closeKey=o.properties.closeKey,this.highKey=o.properties.highKey,this.lowKey=o.properties.lowKey}},rm=class extends zp.AbstractBarSeries{constructor(t){super({moduleCtx:t,pickModes:[om.AXIS_ALIGNED,om.EXACT_SHAPE_MATCH],propertyKeys:{x:["xKey"],y:["lowKey","highKey","openKey","closeKey"]},propertyNames:{x:["xName"],y:["lowName","highName","openName","closeName"]},categoryKey:"xValue",pathsPerSeries:[]}),this.NodeEvent=gT,this.dataAggregationFilters=void 0}async processData(t){if(!this.visible)return;const{xKey:e,openKey:i,closeKey:o,highKey:s,lowKey:a}=this.properties,n=!this.ctx.animationManager.isSkipped(),r=this.getCategoryAxis()?.scale,l=this.getValueAxis()?.scale,{isContinuousX:c,xScaleType:h,yScaleType:d}=this.getScaleInformation({xScale:r,yScale:l}),u=[];n&&(this.processedData&&u.push(nT(this.id,this.processedData)),u.push(rT())),i&&u.push(Sl(i,d,{id:"openValue",invalidValue:void 0,missingValue:void 0}));const{dataModel:g,processedData:y}=await this.requestDataModel(t,this.data,{props:[sT(e,h,{id:"xValue"}),Sl(o,d,{id:"closeValue"}),Sl(s,d,{id:"highValue"}),Sl(a,d,{id:"lowValue"}),...c?[aT]:[],...u]});this.smallestDataInterval=y.reduced?.smallestKeyInterval,this.dataAggregationFilters=this.aggregateData(g,y),this.animationState.transition("updateData")}aggregateData(t,e){if(e.type!=="ungrouped"||hT(e))return;const i=this.axes[sm.X];if(i==null)return;const o=t.resolveKeysById(this,"xValue",e),s=t.resolveColumnById(this,"highValue",e),a=t.resolveColumnById(this,"lowValue",e),{index:n}=t.resolveProcessedDataDefById(this,"xValue"),r=e.domain.keys[n];return uT(i.scale.type,o,s,a,r,e.reduced?.smallestKeyInterval)}getSeriesDomain(t){const{processedData:e,dataModel:i}=this;if(!(e&&i))return[];if(t!==this.getBarDirection()){const{index:s,def:a}=i.resolveProcessedDataDefById(this,"xValue"),n=e.domain.keys[s];return a.type==="key"&&a.valueType==="category"?n:this.padBandExtent(n)}const o=this.domainForClippedRange(t,["highValue","lowValue"],"xValue");return oT(o)}getSeriesRange(t,e){return this.domainForVisibleRange(sm.Y,["highValue","lowValue"],"xValue",e)}getZoomRangeFittingItems(t,e,i){return this.zoomFittingVisibleItems("xValue",["highValue","lowValue"],t,e,i)}getVisibleItems(t,e,i){return this.countVisibleItems("xValue",["highValue","lowValue"],t,e,i)}createNodeData(){const{visible:t,dataModel:e,processedData:i}=this,o=this.getCategoryAxis(),s=this.getValueAxis();if(!(e&&i&&o&&s))return;const a=[],{xKey:n,highKey:r,lowKey:l}=this.properties,c=i.dataSources.get(this.id)??[],h=e.resolveKeysById(this,"xValue",i),d=e.resolveColumnById(this,"openValue",i),u=e.resolveColumnById(this,"closeValue",i),g=e.resolveColumnById(this,"highValue",i),y=e.resolveColumnById(this,"lowValue",i),{groupScale:f}=this,{barWidth:x,groupIndex:S}=this.updateGroupScale(o),v=f.convert(String(S)),m=x>=1?x:f.rawBandwidth,b=cT.is(o.scale),M={itemId:n,nodeData:a,labelData:[],scales:this.calculateScaling(),groupScale:this.getScaling(this.groupScale),visible:this.visible,styles:dT(this.getItemStyle.bind(this),"up","down")};if(!t)return M;const k=(E,T,R,_,N,O,B,z)=>{const V=c[E],F=b?B/2:0,H=o.scale.convert(T)+v+F,W=s.scale.convert(R),G=s.scale.convert(_),K=s.scale.convert(N),Y=s.scale.convert(O),st=_>R,nt=st?"up":"down",X=Math.min(K,Y),Z=Math.max(K,Y)-X,Q={x:H,y:X+Z/2};a.push({series:this,itemId:nt,datum:V,datumIndex:E,xKey:n,xValue:T,openValue:R,closeValue:_,highValue:N,lowValue:O,midPoint:Q,aggregatedValue:_,isRising:st,centerX:H,width:B,y:X,height:Z,yOpen:W,yClose:G,crisp:z})},{dataAggregationFilters:A}=this,D=o.scale,[I,L]=D.range,C=Math.abs(L-I),w=E=>D.convert(h[E])+v,P=A?.find(E=>E.maxRange>C);if(P==null){const E=i.invalidData?.get(this.id);let[T,R]=am(1,c.length,o.range,_=>{const N=b?0:-m/2,O=w(_)+N;return[O,O+m]});i.input.count<1e3&&(T=0,R=i.input.count);for(let _=T;_<R;_+=1){if(E?.[_]===!0)continue;const N=h[_];if(N==null)continue;const O=d[_],B=u[_],z=g[_],V=y[_],F=V!=null&&V<=O&&V<=B,H=z!=null&&z>=O&&z>=B;if(!F){Qf.warnOnce(`invalid low value for key [${l}] in data element, low value cannot be higher than datum open or close values`);continue}if(!H){Qf.warnOnce(`invalid high value for key [${r}] in data element, high value cannot be lower than datum open or close values.`);continue}k(_,N,O,B,z,V,m,!0)}}else{const{maxRange:E,indexData:T}=P,[R,_]=am(1,E,o.range,N=>{const O=N*Jf,B=T[O+tm],z=T[O+em];if(B===-1)return;const V=b?0:-m/2;return[w(B)+V,w(z)+V+m]});for(let N=R;N<_;N+=1){const O=N*Jf,B=T[O+tm],z=T[O+em],V=T[O+tT],F=T[O+eT];if(B===-1)continue;const H=(B+z)/2|0,W=h[H];if(W==null)continue;const G=d[B],K=u[z],Y=g[V],st=y[F],nt=Math.abs(w(z)-w(B))+m;k(H,W,G,K,Y,st,nt,!1)}}return M}isVertical(){return!0}isLabelEnabled(){return!1}updateDatumSelection(t){const e=t.nodeData??[];return t.datumSelection.update(e)}updateLabelNodes(t){}updateLabelSelection(t){const{labelData:e,labelSelection:i}=t;return i.update(e)}getItemStyle(t,e,i,o="up"){const{id:s,properties:a,dataModel:n,processedData:r}=this,{itemStyler:l}=a,c=this.getHighlightStyle(e,t,i);let d=nm(c,a.getStyle(o));if(l&&n!=null&&r!=null&&t!=null){const u=r.dataSources.get(s)?.[t],g=n.resolveKeysById(this,"xValue",r)[t],{xKey:y,openKey:f,closeKey:x,highKey:S,lowKey:v}=a,m=this.ctx.highlightManager?.getActiveHighlight(),b=this.cachedDatumCallback(im(im(g),e?"highlight":"node"),()=>{const M=this.getHighlightStateString(m,e,t);return this.ctx.optionsGraphService.resolvePartial(["series",`${this.declarationOrder}`,"item",o],this.callWithContext(l,{seriesId:s,datum:u,itemId:o,xKey:y,openKey:f,closeKey:x,highKey:S,lowKey:v,highlighted:e,highlightState:M,...d}))});b&&(d=nm(b,d))}return d}getTooltipContent(t){const{id:e,dataModel:i,processedData:o,properties:s}=this,{xKey:a,xName:n,yName:r,openKey:l,openName:c,highKey:h,highName:d,lowKey:u,lowName:g,closeKey:y,closeName:f,legendItemName:x,tooltip:S}=s,v=this.getCategoryAxis(),m=this.getValueAxis();if(!i||!o||!v||!m)return;const b=o.dataSources.get(this.id)?.[t],M=i.resolveKeysById(this,"xValue",o)[t],k=i.resolveColumnById(this,"openValue",o)[t],A=i.resolveColumnById(this,"highValue",o)[t],D=i.resolveColumnById(this,"lowValue",o)[t],I=i.resolveColumnById(this,"closeValue",o)[t];if(M==null)return;const L=I>=k?"up":"down",C=this.properties.item[L],w=this.getItemStyle(t,!1),P={fill:C.fill??C.stroke,fillOpacity:C.fillOpacity??C.strokeOpacity??1,stroke:C.stroke,strokeWidth:C.strokeWidth??1,strokeOpacity:C.strokeOpacity??1,lineDash:C.lineDash??[0],lineDashOffset:C.lineDashOffset??0};return this.formatTooltipWithContext(S,{heading:this.getAxisValueText(v,"tooltip",M,b,a,x),title:x,symbol:{marker:P},data:[{label:c,fallbackLabel:l,value:this.getAxisValueText(m,"tooltip",k,b,l,x)},{label:d,fallbackLabel:h,value:this.getAxisValueText(m,"tooltip",A,b,h,x)},{label:g,fallbackLabel:u,value:this.getAxisValueText(m,"tooltip",D,b,u,x)},{label:f,fallbackLabel:y,value:this.getAxisValueText(m,"tooltip",I,b,y,x)}]},{seriesId:e,datum:b,title:r,itemId:L,xKey:a,xName:n,yName:r,openKey:l,openName:c,highKey:h,highName:d,lowKey:u,lowName:g,closeKey:y,closeName:f,...w})}computeFocusBounds(t){const e=this.getNodeData()?.at(t.datumIndex);if(e==null)return;const{centerX:i,y:o,width:s,height:a}=e,n={x:i-s/2,y:o,width:s,height:a};return lT(this,n)}};import{_ModuleSupport as yT}from"ag-charts-community";import{_ModuleSupport as fT}from"ag-charts-community";var{Path:mT,SceneChangeDetection:Ls,BBox:xT}=fT,go=class extends mT{constructor(){super(...arguments),this.centerX=0,this.y=0,this.width=0,this.height=0,this.yOpen=0,this.yClose=0,this.crisp=!1}computeBBox(){const{centerX:t,y:e,width:i,height:o}=this;return new xT(t-i/2,e,i,o)}isPointInPath(t,e){return this.getBBox().containsPoint(t,e)}distanceSquared(t,e){return this.getBBox().distanceSquared(t,e)}get midPoint(){return{x:this.centerX,y:this.y+this.height/2}}alignedCoordinates(){const{y:t,width:e,height:i,crisp:o}=this;let{centerX:s,yOpen:a,yClose:n}=this,r=s-e/2,l=s+e/2,c=t,h=t+i;if(o&&e>1){s=this.align(s),a<=n?(a=this.align(a),n=a+this.align(a,n-a)):(a=n+this.align(n,a-n),n=this.align(n));const d=this.align(e/2);r=s-d,l=s+d,c=this.align(t),h=c+this.align(c,i)}return{centerX:s,x0:r,x1:l,y0:c,y1:h,yOpen:a,yClose:n}}executeStroke(t,e){const{width:i,strokeWidth:o}=this;i<o&&(t.lineWidth=i),super.executeStroke(t,e)}};p([Ls()],go.prototype,"centerX",2),p([Ls()],go.prototype,"y",2),p([Ls()],go.prototype,"width",2),p([Ls()],go.prototype,"height",2),p([Ls()],go.prototype,"yOpen",2),p([Ls()],go.prototype,"yClose",2),p([Ls()],go.prototype,"crisp",2);var ST=class extends go{updatePath(){const{path:t}=this,{centerX:e,x0:i,x1:o,y0:s,y1:a,yOpen:n,yClose:r}=this.alignedCoordinates();t.clear(),t.moveTo(e,s),t.lineTo(e,a),Math.abs(o-i)>1&&(t.moveTo(i,n),t.lineTo(e,n),t.moveTo(e,r),t.lineTo(o,r))}},{SceneArrayChangeDetection:bT,SceneChangeDetection:bl,ExtendedPath2D:vT,BBox:MT}=yT,Ia=class extends go{constructor(){super(...arguments),this.wickPath=new vT,this.wickStroke=void 0,this.wickStrokeWidth=void 0,this.wickStrokeOpacity=void 0}computeDefaultGradientFillBBox(){const{width:t,centerX:e,yOpen:i,yClose:o}=this,s=Math.min(i,o),n=Math.max(i,o)-s,r=e-t/2,l=e+t/2;return new MT(r,s,l-r,n)}updatePath(){const{path:t,stroke:e,strokeWidth:i,strokeOpacity:o,lineDash:s,lineDashOffset:a,wickStroke:n,wickStrokeWidth:r,wickStrokeOpacity:l,wickLineDash:c,wickLineDashOffset:h}=this,{centerX:d,x0:u,x1:g,y0:y,y1:f,yOpen:x,yClose:S}=this.alignedCoordinates();this.path.clear(),this.wickPath.clear();const m=n!=null&&n!==e||r!=null&&r!==i||l!=null&&l!==o||c!=null&&c!==s||h!=null&&h!==a?this.wickPath:t;if(Math.abs(g-u)<=3){m.moveTo(d,y),m.lineTo(d,f);return}const b=Math.min(x,S),M=Math.max(x,S),k=i/2;m.moveTo(d,y),m.lineTo(d,b+k),m.moveTo(d,f),m.lineTo(d,M-k);const A=M-b-2*k;if(A>0)t.rect(u+k,b+k,g-u-2*k,A);else{const D=(b+M)/2;t.moveTo(u,D),t.lineTo(g,D)}}drawPath(t){super.drawPath(t);const{wickPath:e}=this;if(e.isEmpty())return;const{stroke:i,strokeWidth:o,strokeOpacity:s,lineDash:a,lineDashOffset:n,wickStroke:r=i,wickStrokeWidth:l=o,wickStrokeOpacity:c=s,wickLineDash:h=a,wickLineDashOffset:d=n}=this;l!==0&&(t.globalAlpha*=c,typeof r=="string"&&(t.strokeStyle=r),t.lineWidth=l,h!=null&&t.setLineDash([...h]),t.lineDashOffset=d,t.stroke(e.getPath2D()))}};p([bl()],Ia.prototype,"wickStroke",2),p([bl()],Ia.prototype,"wickStrokeWidth",2),p([bl()],Ia.prototype,"wickStrokeOpacity",2),p([bT()],Ia.prototype,"wickLineDash",2),p([bl()],Ia.prototype,"wickLineDashOffset",2);import{_ModuleSupport as DT}from"ag-charts-community";import{_ModuleSupport as kT}from"ag-charts-community";var{BaseProperties:lm,Property:Nt,AbstractBarSeriesProperties:AT,makeSeriesTooltip:LT}=kT,Is=class extends lm{constructor(){super(...arguments),this.stroke="#333",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0}};p([Nt],Is.prototype,"stroke",2),p([Nt],Is.prototype,"strokeWidth",2),p([Nt],Is.prototype,"strokeOpacity",2),p([Nt],Is.prototype,"lineDash",2),p([Nt],Is.prototype,"lineDashOffset",2);var Fp=class extends lm{constructor(){super(...arguments),this.up=new Is,this.down=new Is}};p([Nt],Fp.prototype,"up",2),p([Nt],Fp.prototype,"down",2);var He=class extends AT{};p([Nt],He.prototype,"xKey",2),p([Nt],He.prototype,"openKey",2),p([Nt],He.prototype,"closeKey",2),p([Nt],He.prototype,"highKey",2),p([Nt],He.prototype,"lowKey",2),p([Nt],He.prototype,"xName",2),p([Nt],He.prototype,"yName",2),p([Nt],He.prototype,"openName",2),p([Nt],He.prototype,"closeName",2),p([Nt],He.prototype,"highName",2),p([Nt],He.prototype,"lowName",2);var vl=class extends He{constructor(){super(...arguments),this.tooltip=LT(),this.item=new Fp}getStyle(t){const{strokeWidth:e,strokeOpacity:i,stroke:o,lineDash:s,lineDashOffset:a}=this.item[t];return{stroke:o,strokeWidth:e,strokeOpacity:i,lineDash:s,lineDashOffset:a,opacity:1}}};p([Nt],vl.prototype,"tooltip",2),p([Nt],vl.prototype,"item",2),p([Nt],vl.prototype,"itemStyler",2);var{BaseProperties:Vp,makeSeriesTooltip:IT,Property:Wt}=DT,Ca=class extends Vp{};p([Wt],Ca.prototype,"stroke",2),p([Wt],Ca.prototype,"strokeWidth",2),p([Wt],Ca.prototype,"strokeOpacity",2),p([Wt],Ca.prototype,"lineDash",2),p([Wt],Ca.prototype,"lineDashOffset",2);var bi=class extends Vp{constructor(){super(...arguments),this.fill="#c16068",this.fillOpacity=1,this.stroke="#333",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.cornerRadius=0,this.wick=new Ca}};p([Wt],bi.prototype,"fill",2),p([Wt],bi.prototype,"fillOpacity",2),p([Wt],bi.prototype,"stroke",2),p([Wt],bi.prototype,"strokeWidth",2),p([Wt],bi.prototype,"strokeOpacity",2),p([Wt],bi.prototype,"lineDash",2),p([Wt],bi.prototype,"lineDashOffset",2),p([Wt],bi.prototype,"cornerRadius",2),p([Wt],bi.prototype,"wick",2);var Hp=class extends Vp{constructor(){super(...arguments),this.up=new bi,this.down=new bi}};p([Wt],Hp.prototype,"up",2),p([Wt],Hp.prototype,"down",2);var Ml=class extends He{constructor(){super(),this.item=new Hp,this.tooltip=IT(),this.highlightStyle.deprecated=!1}getStyle(t){const{fill:e,fillOpacity:i,strokeWidth:o,strokeOpacity:s,stroke:a,lineDash:n,lineDashOffset:r,cornerRadius:l,wick:c}=this.item[t];return{fill:e,fillOpacity:i,stroke:a,strokeWidth:o,strokeOpacity:s,lineDash:n,lineDashOffset:r,cornerRadius:l,opacity:1,wick:c}}};p([Wt],Ml.prototype,"item",2),p([Wt],Ml.prototype,"tooltip",2),p([Wt],Ml.prototype,"itemStyler",2);var{isGradientFill:cm,isPatternFill:Gp,isImageFill:Wp,applyShapeStyle:CT}=WC,Dl=class extends rm{constructor(){super(...arguments),this.properties=new Ml}nodeFactory(){const t=new Ia;return t.lineCap="butt",t}updateDatumStyles({datumSelection:t,isHighlight:e}){t.each((i,o)=>{o.style=this.getItemStyle(o.datumIndex,e,void 0,o.itemId)})}updateDatumNodes({datumSelection:t,isHighlight:e}){const{contextNodeData:i}=this;if(!i)return;const o=this.ctx.highlightManager.getActiveHighlight();t.each((s,a)=>{const{centerX:n,width:r,y:l,height:c,yOpen:h,yClose:d,crisp:u}=a,g=a.style??i.styles[a.itemId][this.getHighlightState(o,e,a.datumIndex)];s.centerX=n,s.width=r,s.y=l,s.height=c,s.yOpen=h,s.yClose=d,s.crisp=u,CT(s,g,this.getShapeFillBBox());const y=g?.wick;s.wickStroke=y?.stroke,s.wickStrokeWidth=y?.strokeWidth,s.wickStrokeOpacity=y?.strokeOpacity,s.wickLineDash=y?.lineDash,s.wickLineDashOffset=y?.lineDashOffset})}legendItemSymbol(){const{up:t,down:e}=this.properties.item,i=cm(t.fill)?t.fill.colorStops.map(n=>typeof n=="string"?n:{color:n.color,stop:n.stop!=null?n.stop*.5:void 0}):[{color:Gp(t.fill)||Wp(t.fill)?t.stroke:t.fill,stop:0},{color:Gp(t.fill)||Wp(t.fill)?t.stroke:t.fill,stop:.5}],o=cm(e.fill)?e.fill.colorStops.map(n=>typeof n=="string"?n:{color:n.color,stop:n.stop!=null?n.stop*.5:void 0}):[{color:Gp(e.fill)||Wp(e.fill)?e.stroke:e.fill,stop:.5}],s={type:"gradient",gradient:"linear",rotation:90,colorStops:[...i,...o],reverse:!1},a={type:"gradient",gradient:"linear",rotation:90,colorStops:[{color:t.stroke,stop:0},{color:t.stroke,stop:.5},{color:e.stroke,stop:.5}],reverse:!1};return{marker:{fill:s,fillOpacity:t.fillOpacity,stroke:a,strokeWidth:t.strokeWidth??1,strokeOpacity:t.strokeOpacity??1,lineDash:t.lineDash,lineDashOffset:t.lineDashOffset}}}getLegendData(t){const{id:e,data:i,visible:o,ctx:{legendManager:s}}=this,{xKey:a,yName:n,showInLegend:r,legendItemName:l}=this.properties;return!i?.length||!a||t!=="category"?[]:[{legendType:"category",id:e,itemId:e,seriesId:e,enabled:o&&s.getItemEnabled({seriesId:e,itemId:e}),label:{text:l??n??e},symbol:this.legendItemSymbol(),legendItemName:l,hideInLegend:!r}]}hasItemStylers(){return this.properties.itemStyler!=null}};Dl.className="CandleStickSeries",Dl.type="candlestick";import{_ModuleSupport as TT}from"ag-charts-community";import{boolean as wT,constant as NT,number as PT,required as Ta,string as vi,undocumented as hm}from"ag-charts-core";var{commonSeriesOptionsDefs:ET,candlestickSeriesThemeableOptionsDef:_T}=TT,Kp={...ET,..._T,type:Ta(NT("candlestick")),xKey:Ta(vi),openKey:Ta(vi),highKey:Ta(vi),lowKey:Ta(vi),closeKey:Ta(vi),xName:vi,yName:vi,openName:vi,highName:vi,lowName:vi,closeName:vi};Kp.pickOutsideVisibleMinorAxis=hm(wT),Kp.focusPriority=hm(PT);import{_ModuleSupport as OT}from"ag-charts-community";var{ThemeConstants:{CARTESIAN_AXIS_TYPE:pm},multiSeriesHighlightStyle:RT,FILL_GRADIENT_LINEAR_SHADED_DEFAULTS:BT,FILL_IMAGE_DEFAULTS:zT,FILL_PATTERN_DEFAULTS:FT}=OT;function dm(t){return{fill:{$applySwitch:[{$path:"type"},{$if:[{$eq:[{$palette:"type"},"user-indexed"]},t==="up"?"transparent":{$palette:"fill"},{$palette:`${t}.fill`}]},["gradient",BT(t)],["image",zT],["pattern",FT]]},stroke:{$if:[{$eq:[{$palette:"type"},"user-indexed"]},{$palette:"stroke"},{$palette:`${t}.stroke`}]}}}var VT={series:{item:{up:dm("up"),down:dm("down")},highlightStyle:{item:{strokeWidth:3}},tooltip:{range:{$path:["/tooltip/range","nearest"]}},highlight:RT()},animation:{enabled:!1},axes:{[pm.NUMBER]:{crosshair:{snap:!1}},[pm.ORDINAL_TIME]:{groupPaddingInner:0,crosshair:{enabled:!0}}}},{CARTESIAN_AXIS_TYPE:um,CARTESIAN_POSITION:gm}=GC.ThemeConstants,HT={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["cartesian"],identifier:"candlestick",moduleFactory:t=>new Dl(t),defaultAxes:[{type:um.NUMBER,position:gm.LEFT},{type:um.ORDINAL_TIME,position:gm.BOTTOM}],themeTemplate:VT,groupable:!1},ym={type:"series",name:"candlestick",chartType:"cartesian",enterprise:!0,options:Kp,create:t=>new Dl(t)};import{_ModuleSupport as GT}from"ag-charts-community";import{_ModuleSupport as kl}from"ag-charts-community";import{Logger as WT}from"ag-charts-core";import{Logger as KT,cachedTextMeasurer as Al,findMaxValue as fm,wrapLines as mm}from"ag-charts-core";function $T(t,e){const{fontSize:i,minimumFontSize:o=i}=t,{fontSize:s,minimumFontSize:a=s}=e,n=i-o,r=s-a;let l=t.fontSize,c=e.fontSize;const h=[{labelFontSize:i,secondaryLabelFontSize:s}];for(;l>o||c>a;){const d=n>0?(l-o)/n:-1,u=r>0?(c-a)/r:-1;d>u?l--:c--,h.push({labelFontSize:l,secondaryLabelFontSize:c})}return h.reverse(),h}function xm(t,e,i,o,{padding:s},a){const{spacing:n=0}=e,r=2*s,l=2*s+n,c=(e.minimumFontSize??e.fontSize)+(o.minimumFontSize??o.fontSize);if(c>a(c+l,!1).height-l)return;const h=$T(e,o),d={fontFamily:e.fontFamily,fontStyle:e.fontStyle,fontWeight:e.fontWeight},u={fontFamily:o.fontFamily,fontStyle:o.fontStyle,fontWeight:o.fontWeight};let g,y;return fm(0,h.length-1,f=>{const{labelFontSize:x,secondaryLabelFontSize:S}=h[f],v=f===0,m={...d,fontSize:x},b={...u,fontSize:S},M=Al(m).lineHeight(),k=Al(b).lineHeight(),A=a(M+k+l,v),D=A.width-r,I=A.height-l;if(M+k>I||((g==null||g.fontSize!==x)&&(g=bm(e,t,D,I,m,e.wrapping,v?e.overflowStrategy:"hide")),g==null||g.width>D||g.height>I)||((y==null||y.fontSize!==S)&&(y=bm(o,i,D,I,b,o.wrapping,v?o.overflowStrategy:"hide")),y==null))return;const L=g.height+y.height;if(!(y.width>D||L>I))return{width:Math.max(g.width,y.width),height:L+n,meta:A.meta,label:g,secondaryLabel:y}})}function Ln(t,e,{padding:i},o){const s=2*i,a=Math.min(e.minimumFontSize??e.fontSize,e.fontSize),n={fontFamily:e.fontFamily,fontStyle:e.fontStyle,fontWeight:e.fontWeight};return fm(a,e.fontSize,r=>{const l={...n,fontSize:r},c=Al(l),h=r===a,d=e.lineHeight??c.lineHeight(),u=o(d+s,h),g=u.width-s,y=u.height-s;if(d>y||g<0)return;const f=mm(t,{maxWidth:g,maxHeight:y,font:l,textWrap:e.wrapping,overflow:(h?e.overflowStrategy:null)??"hide"});if(!f.length)return;const{width:x,height:S}=c.measureLines(f),v=f.join(`
`);return[{width:x,height:S,text:v,fontSize:r,lineHeight:d},u.meta]})}function Sm(t){return t?.minimumFontSize!=null&&t?.fontSize!=null&&t?.minimumFontSize>t?.fontSize}function $p(t,e,i,o,s,a){const n=e.enabled?t:void 0,r=o.enabled?i:void 0;(Sm(e)||Sm(o))&&KT.warnOnce("minimumFontSize should be set to a value less than or equal to the font size");let l;n!=null&&r!=null&&(l=xm(n,e,r,o,s,a));let c;if(l==null&&n!=null&&(c=Ln(n,e,s,a)),c!=null){const[d,u]=c;l={width:d.width,height:d.height,meta:u,label:d,secondaryLabel:void 0}}let h;if(l==null&&n==null&&r!=null&&(h=Ln(r,o,s,a)),h!=null){const[d,u]=h;l={width:d.width,height:d.height,meta:u,label:void 0,secondaryLabel:d}}return l}function bm(t,e,i,o,s,a,n){const r=mm(e,{maxWidth:i,maxHeight:o,font:s,textWrap:a,overflow:n});if(!r.length)return;const l=Al(s),c=t.lineHeight??l.lineHeight(),{width:h}=l.measureLines(r);return{width:h,lineHeight:c,text:r.join(`
`),height:r.length*c,fontSize:s.fontSize}}import{_ModuleSupport as jT}from"ag-charts-community";import{_ModuleSupport as vm}from"ag-charts-community";var{Property:In}=vm,wa=class extends vm.Label{constructor(){super(...arguments),this.wrapping="on-space",this.overflowStrategy="ellipsis"}};p([In],wa.prototype,"wrapping",2),p([In],wa.prototype,"overflowStrategy",2),p([In],wa.prototype,"lineHeight",2),p([In],wa.prototype,"minimumFontSize",2);var Hi=class extends wa{constructor(){super(...arguments),this.spacing=0}};p([In],Hi.prototype,"spacing",2);var Cn=class extends wa{},{CartesianSeriesProperties:YT,makeSeriesTooltip:UT,Property:se}=jT,Xt=class extends YT{constructor(){super(...arguments),this.colorRange=["black","black"],this.stroke="black",this.strokeOpacity=1,this.strokeWidth=0,this.textAlign="center",this.verticalAlign="middle",this.itemPadding=0,this.label=new Hi,this.tooltip=UT()}};p([se],Xt.prototype,"title",2),p([se],Xt.prototype,"xKey",2),p([se],Xt.prototype,"yKey",2),p([se],Xt.prototype,"colorKey",2),p([se],Xt.prototype,"xName",2),p([se],Xt.prototype,"yName",2),p([se],Xt.prototype,"colorName",2),p([se],Xt.prototype,"colorRange",2),p([se],Xt.prototype,"stroke",2),p([se],Xt.prototype,"strokeOpacity",2),p([se],Xt.prototype,"strokeWidth",2),p([se],Xt.prototype,"textAlign",2),p([se],Xt.prototype,"verticalAlign",2),p([se],Xt.prototype,"itemPadding",2),p([se],Xt.prototype,"itemStyler",2),p([se],Xt.prototype,"label",2),p([se],Xt.prototype,"tooltip",2);var{SeriesNodePickMode:Mm,computeBarFocusBounds:XT,getMissCount:ZT,valueProperty:jp,ChartAxisDirection:ri,DEFAULT_CARTESIAN_DIRECTION_KEYS:qT,DEFAULT_CARTESIAN_DIRECTION_NAMES:QT,createDatumId:JT,ColorScale:tw,Rect:ew,PointerEvents:iw,applyShapeStyle:ow,mergeDefaults:Dm,formatValue:sw,addHitTestersToQuadtree:aw,findQuadtreeMatch:km,updateLabelNode:nw}=kl,rw=class extends kl.CartesianSeriesNodeEvent{constructor(t,e,i,o){super(t,e,i,o),this.colorKey=o.properties.colorKey}},lw={left:-.5,center:0,right:-.5},cw={top:-.5,middle:0,bottom:-.5},Ll=class extends kl.CartesianSeries{constructor(t){super({moduleCtx:t,propertyKeys:{...qT,color:["colorKey"]},propertyNames:{...QT,color:["colorName"]},categoryKey:void 0,pickModes:[Mm.NEAREST_NODE,Mm.EXACT_SHAPE_MATCH],pathsPerSeries:[]}),this.properties=new Xt,this.NodeEvent=rw,this.colorScale=new tw}async processData(t){const e=this.axes[ri.X],i=this.axes[ri.Y];if(!e||!i||!this.data?.length)return;const{xKey:o,yKey:s,colorRange:a,colorKey:n}=this.properties,r=this.axes[ri.X]?.scale,l=this.axes[ri.Y]?.scale,{xScaleType:c,yScaleType:h}=this.getScaleInformation({xScale:r,yScale:l}),d=this.colorScale.type,{dataModel:u,processedData:g}=await this.requestDataModel(t,this.data,{props:[jp(o,c,{id:"xValue"}),jp(s,h,{id:"yValue"}),...n?[jp(n,d,{id:"colorValue",invalidValue:void 0})]:[]]});if(this.isColorScaleValid()){const y=u.resolveProcessedDataIndexById(this,"colorValue"),f=g.domain.values[y].filter(S=>S!=null),x=kl.extent(f);if(this.colorScale.domain=x??[],x?.length&&x[0]===x[1]){const S=Math.floor(a.length/2);this.colorScale.range=[a[S],a[S]]}else this.colorScale.range=a;this.colorScale.update()}}isColorScaleValid(){const{colorKey:t}=this.properties;if(!t)return!1;const{dataModel:e,processedData:i}=this;if(!e||!i)return!1;const o=e.resolveProcessedDataIndexById(this,"colorValue"),s=i.input.count,a=ZT(this,i.defs.values[o].missing),n=e.resolveProcessedDataIndexById(this,"colorValue"),r=i.domain.values[n].filter(c=>c!=null).length;return!(s===0||s===a||r===0)}xCoordinateRange(t,e){const i=this.axes[ri.X].scale,o=e*(i.bandwidth??0)/2,s=i.convert(t)+o,a=e*(i.bandwidth??10);return[s,s+a]}yCoordinateRange(t,e){const i=this.axes[ri.Y].scale,o=e*(i.bandwidth??0)/2,s=i.convert(t[0])+o,a=e*(i.bandwidth??10);return[s,s+a]}getSeriesDomain(t){const{dataModel:e,processedData:i}=this;return!e||!i?[]:t===ri.X?e.getDomain(this,"xValue","value",i):e.getDomain(this,"yValue","value",i)}getSeriesRange(t,e){return[NaN,NaN]}createNodeData(){const{data:t,visible:e,axes:i,dataModel:o,processedData:s}=this,a=i[ri.X],n=i[ri.Y];if(!(t&&o&&s&&e&&a&&n))return;if(a.type!=="category"||n.type!=="category"){WT.warnOnce(`Heatmap series expected axes to have "category" type, but received "${a.type}" and "${n.type}" instead.`);return}const{xKey:r,xName:l,yKey:c,yName:h,colorKey:d,colorName:u,textAlign:g,verticalAlign:y,itemPadding:f,label:x}=this.properties,S=o.resolveColumnById(this,"xValue",s),v=o.resolveColumnById(this,"yValue",s),m=d?o.resolveColumnById(this,"colorValue",s):void 0,b=d?o.getDomain(this,"colorValue","value",s):[],M=a.scale,k=n.scale,A=(M.bandwidth??0)/2,D=(k.bandwidth??0)/2,I=[],L=[],C=M.bandwidth??10,w=k.bandwidth??10,P=(C-2*f)*lw[g],E=(w-2*f)*cw[y],T=()=>({width:C,height:w,meta:null});return(s.dataSources.get(this.id)??[]).forEach((_,N)=>{const O=S[N],B=v[N],z=M.convert(O)+A,V=k.convert(B)+D,F=m?.[N],H=x.enabled&&F!=null?this.getLabelText(F,_,d,"color",b,x,{value:F,datum:_,colorKey:d,colorName:u,xKey:r,yKey:c,xName:l,yName:h}):void 0,W=$p(H,this.properties.label,void 0,this.properties.label,{padding:f},T),G={x:z,y:V,size:0},K=this.getItemStyle({datumIndex:N,datum:_,colorValue:F},!1);if(I.push({series:this,itemId:c,datumIndex:N,yKey:c,xKey:r,xValue:O,yValue:B,colorValue:F,datum:_,point:G,width:C,height:w,midPoint:{x:z,y:V},missing:m!=null&&F==null,style:K}),W?.label!=null){const{text:Y,fontSize:st,lineHeight:nt,height:X}=W.label,{fontStyle:Z,fontFamily:Q,fontWeight:pt,color:ot}=this.properties.label,q=G.x+P*(C-2*f),dt=G.y+E*(w-2*f)-(W.height-X)*.5;L.push({series:this,itemId:c,datum:_,datumIndex:N,text:Y,fontSize:st,lineHeight:nt,fontStyle:Z,fontFamily:Q,fontWeight:pt,color:ot,textAlign:g,textBaseline:y,x:q,y:dt,style:K})}}),{itemId:this.properties.yKey??this.id,nodeData:I,labelData:L,scales:this.calculateScaling(),visible:this.visible}}nodeFactory(){return new ew}update(t){return this.ctx.animationManager.skipCurrentBatch(),super.update(t)}updateDatumSelection(t){const{nodeData:e,datumSelection:i}=t,o=e??[];return i.update(o)}getItemStyle({datumIndex:t,datum:e,colorValue:i},o){const{id:s,properties:a}=this,{xKey:n,yKey:r,itemStyler:l,stroke:c,strokeWidth:h,strokeOpacity:d}=a,u=this.getHighlightStyle(o,t),g=Dm(u,{fill:this.isColorScaleValid()&&i!=null?this.colorScale.convert(i):"transparent",fillOpacity:1,stroke:c,strokeWidth:h,strokeOpacity:d,opacity:1});let y;return l!=null&&t!=null&&(y=this.cachedDatumCallback(JT(t,o?"highlight":"node"),()=>{const f=this.ctx.highlightManager?.getActiveHighlight(),x=this.getHighlightStateString(f,o,t);return this.callWithContext(l,{seriesId:s,datum:e,xKey:n,yKey:r,highlighted:o,highlightState:x,...g})})),y?Dm(y,g):g}updateDatumStyles({datumSelection:t,isHighlight:e}){t.each((i,o)=>{o.style=this.getItemStyle(o,e)})}updateDatumNodes({datumSelection:t}){const e=this.axes[ri.X],[i,o]=e?.visibleRange??[],a=!(i!==0||o!==1);t.each((n,r)=>{const{point:l,width:c,height:h,style:d}=r;ow(n,d),n.crisp=a,n.x=Math.floor(l.x-c/2),n.y=Math.floor(l.y-h/2),n.width=Math.ceil(c),n.height=Math.ceil(h)})}updateLabelSelection(t){const{labelData:e,labelSelection:i}=t,{enabled:o}=this.properties.label,s=o?e:[];return i.update(s)}updateLabelNodes(t){const e=this.ctx.highlightManager?.getActiveHighlight();t.labelSelection.each((i,o)=>{i.pointerEvents=iw.None,i.text=o.text,i.fillOpacity=this.getHighlightStyle(!1,o.datumIndex)?.opacity??1,nw(this,i,this.properties,this.properties.label,o,!1,e)})}getTooltipContent(t){const{id:e,dataModel:i,processedData:o,axes:s,properties:a,colorScale:n,ctx:r}=this,{formatManager:l}=r,{xKey:c,xName:h,yKey:d,yName:u,colorKey:g,colorName:y,colorRange:f,title:x,legendItemName:S,tooltip:v}=a,m=s[ri.X],b=s[ri.Y];if(!i||!o||!m||!b)return;const M=o.dataSources.get(this.id)?.[t],k=i.resolveColumnById(this,"xValue",o)[t],A=i.resolveColumnById(this,"yValue",o)[t],D=g!=null&&this.isColorScaleValid()?i.resolveColumnById(this,"colorValue",o)[t]:void 0;if(k==null)return;const I=[];let L;if(D==null)L=f[0];else{L=n.convert(D);const P=i.getDomain(this,"colorValue","value",o),E=l.format(this.callWithContext.bind(this),{type:"number",value:D,datum:M,seriesId:e,legendItemName:S,key:g,source:"tooltip",property:"color",domain:P,boundSeries:this.getFormatterContext("color"),fractionDigits:void 0});I.push({label:y,fallbackLabel:g,value:E??sw(D)})}I.push({label:h,fallbackLabel:c,value:this.getAxisValueText(m,"tooltip",k,M,c,S)},{label:u,fallbackLabel:d,value:this.getAxisValueText(b,"tooltip",A,M,d,S)});const C=this.getItemStyle({datumIndex:t,datum:M,colorValue:D},!1);C.fill!=null&&(L=C.fill);const w=L!=null?{marker:{shape:"square",fill:L,fillOpacity:1,stroke:void 0,strokeWidth:0,strokeOpacity:1,lineDash:[0],lineDashOffset:0}}:void 0;return this.formatTooltipWithContext(v,{title:x??S,symbol:w,data:I},{seriesId:e,datum:M,title:x,xKey:c,xName:h,yKey:d,yName:u,colorKey:g,colorName:y,...C})}getLegendData(t){return t!=="gradient"||!this.isColorScaleValid()||!this.dataModel?[]:[{legendType:"gradient",enabled:this.visible,seriesId:this.id,series:this.getFormatterContext("color"),colorDomain:this.colorScale.domain,colorRange:this.colorScale.range}]}isLabelEnabled(){return this.properties.label.enabled&&!!this.properties.colorKey}getBandScalePadding(){return{inner:0,outer:0}}computeFocusBounds({datumIndex:t}){const e=this.contextNodeData?.nodeData[t];if(e===void 0)return;const{width:i,height:o,midPoint:s}=e,a={x:s.x-i/2,y:s.y-o/2,width:i,height:o};return XT(this,a)}initQuadTree(t){aw(t,this.datumNodesIter())}pickNodesExactShape(t){const e=km(this,t);return e!=null&&e.distance<=0?[e.datum]:[]}pickNodeClosestDatum(t){return km(this,t)}hasItemStylers(){return this.properties.itemStyler!=null}};Ll.className="HeatmapSeries",Ll.type="heatmap";import{_ModuleSupport as hw}from"ag-charts-community";import{arrayOf as pw,color as dw,constant as uw,required as Yp,string as Na}from"ag-charts-core";var{commonSeriesOptionsDefs:gw,heatmapSeriesThemeableOptionsDef:yw,without:Am}=hw,fw={...Am(yw,["showInLegend"]),...Am(gw,["showInLegend"]),type:Yp(uw("heatmap")),xKey:Yp(Na),yKey:Yp(Na),colorKey:Na,xName:Na,yName:Na,colorName:Na,colorRange:pw(dw)};import{_ModuleSupport as Il}from"ag-charts-community";var mw={series:{stroke:{$if:[{$eq:[{$palette:"type"},"inbuilt"]},{$ref:"chartBackgroundColor"},{$path:["/0",{$palette:"stroke"},{$palette:"strokes"}]}]},strokeWidth:{$isUserOption:["./stroke",2,void 0]},colorRange:{$if:[{$eq:[{$palette:"type"},"inbuilt"]},{$palette:"divergingColors"},Il.SAFE_RANGE2_OPERATION]},label:{...Il.LABEL_BOXING_DEFAULTS,enabled:!1,color:{$ref:"textColor"},fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},wrapping:"on-space",overflowStrategy:"ellipsis"},itemPadding:3,highlight:Il.singleSeriesHighlightStyle()},gradientLegend:{enabled:!0,...Il.LEGEND_CONTAINER_THEME}},{ThemeConstants:{CARTESIAN_AXIS_TYPE:Lm,CARTESIAN_POSITION:Im}}=GT,xw={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["cartesian"],identifier:"heatmap",moduleFactory:t=>new Ll(t),defaultAxes:[{type:Lm.CATEGORY,position:Im.LEFT},{type:Lm.CATEGORY,position:Im.BOTTOM}],themeTemplate:mw},Cm={type:"series",name:"heatmap",chartType:"cartesian",enterprise:!0,options:fw,create:t=>new Ll(t)};import{_ModuleSupport as Sw}from"ag-charts-community";import{_ModuleSupport as bw}from"ag-charts-community";var{applyShapeStyle:vw}=bw,Cl=class extends rm{constructor(){super(...arguments),this.properties=new vl}nodeFactory(){const t=new ST;return t.lineCap="square",t}updateDatumStyles({datumSelection:t,isHighlight:e}){t.each((i,o)=>{o.style=this.getItemStyle(o.datumIndex,e,void 0,o.itemId)})}updateDatumNodes({datumSelection:t,isHighlight:e}){const{contextNodeData:i}=this;if(!i)return;const o=this.ctx.highlightManager.getActiveHighlight();t.each((s,a)=>{const{centerX:n,width:r,y:l,height:c,yOpen:h,yClose:d,crisp:u}=a;s.centerX=n,s.width=r,s.y=l,s.height=c,s.yOpen=h,s.yClose=d,s.crisp=u;const g=a.style??i.styles[a.itemId][this.getHighlightState(o,e,a.datumIndex)];vw(s,g)})}getLegendData(t){const{id:e,data:i,ctx:{legendManager:o},visible:s}=this,{xKey:a,yName:n,item:{up:r,down:l},showInLegend:c,legendItemName:h}=this.properties;if(!i?.length||!a||t!=="category")return[];const d={type:"gradient",gradient:"linear",colorSpace:"rgb",colorStops:[{color:r.stroke,stop:0},{color:r.stroke,stop:.5},{color:l.stroke,stop:.5}],rotation:90};return[{legendType:"category",id:e,itemId:e,seriesId:e,enabled:s&&o.getItemEnabled({seriesId:e,itemId:e}),label:{text:h??n??e},symbol:{marker:{fill:d,fillOpacity:r.strokeOpacity,stroke:void 0,strokeWidth:0,strokeOpacity:1,lineDash:[0],lineDashOffset:0}},legendItemName:h,hideInLegend:!c}]}hasItemStylers(){return this.properties.itemStyler!=null}};Cl.className="ohlc",Cl.type="ohlc";import{_ModuleSupport as Mw}from"ag-charts-community";import{boolean as Dw,constant as kw,number as Aw,required as Pa,string as Mi,undocumented as Tm}from"ag-charts-core";var{commonSeriesOptionsDefs:Lw,ohlcSeriesThemeableOptionsDef:Iw}=Mw,Up={...Lw,...Iw,type:Pa(kw("ohlc")),xKey:Pa(Mi),openKey:Pa(Mi),highKey:Pa(Mi),lowKey:Pa(Mi),closeKey:Pa(Mi),xName:Mi,yName:Mi,openName:Mi,highName:Mi,lowName:Mi,closeName:Mi};Up.pickOutsideVisibleMinorAxis=Tm(Dw),Up.focusPriority=Tm(Aw);var{ThemeConstants:{CARTESIAN_AXIS_TYPE:Tl,CARTESIAN_POSITION:wm},multiSeriesHighlightStyle:Cw}=Sw,Tw={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["cartesian"],identifier:"ohlc",moduleFactory:t=>new Cl(t),defaultAxes:[{type:Tl.NUMBER,position:wm.LEFT},{type:Tl.ORDINAL_TIME,position:wm.BOTTOM}],themeTemplate:{animation:{enabled:!1},series:{item:{up:{stroke:{$if:[{$eq:[{$palette:"type"},"user-indexed"]},{$palette:"stroke"},{$palette:"up.stroke"}]}},down:{stroke:{$if:[{$eq:[{$palette:"type"},"user-indexed"]},{$palette:"stroke"},{$palette:"down.stroke"}]}}},tooltip:{range:{$path:["/tooltip/range","nearest"]}},highlight:Cw(!1)},axes:{[Tl.NUMBER]:{crosshair:{snap:!1}},[Tl.ORDINAL_TIME]:{groupPaddingInner:0,crosshair:{enabled:!0}}}},groupable:!1},Nm={type:"series",name:"ohlc",chartType:"cartesian",enterprise:!0,options:Up,create:t=>new Cl(t)};import{_ModuleSupport as Pm}from"ag-charts-community";import{_ModuleSupport as wl}from"ag-charts-community";import{_ModuleSupport as ww}from"ag-charts-community";var{AGGREGATION_INDEX_Y_MAX:Nw,AGGREGATION_INDEX_Y_MIN:Pw,aggregationDomain:Ew,aggregationIndexForXRatio:Em,aggregationRangeFittingPoints:_w,aggregationXRatioForXValue:_m,compactAggregationIndices:Ow,createAggregationIndices:Rw}=ww,Bw=1e3;function Om(t,e,i,o,s,a){const n=t[a];if(n==null)return!1;const r=_m(n,e,i),l=Em(r,s);return a===o[l+Nw]}function Rm(t,e,i,o,s,a){const n=t[a];if(n==null)return!1;const r=_m(n,e,i),l=Em(r,s);return a===o[l+Pw]}function zw(t,e,i,o,s){if(e.length<Bw)return;const[a,n]=Ew(t,s);let r=_w(e,a,n);const{indexData:l,valueData:c}=Rw(e,i,o,a,n,r);let h=[],d=[];for(let g=0;g<e.length;g+=1)Om(e,a,n,l,r,g)&&h.push(g),Rm(e,a,n,l,r,g)&&d.push(g);const u=[{maxRange:r,topIndices:h,bottomIndices:d}];for(;r>64;)({maxRange:r}=Ow(l,c,r,{inPlace:!0})),h=h.filter(Om.bind(null,e,a,n,l,r)),d=d.filter(Rm.bind(null,e,a,n,l,r)),u.push({maxRange:r,topIndices:h,bottomIndices:d});return u.reverse(),u}import{_ModuleSupport as Fw}from"ag-charts-community";var{CartesianSeriesProperties:Vw,InterpolationProperties:Hw,SeriesMarker:Gw,makeSeriesTooltip:Ww,Property:Mt,DropShadow:Kw,Label:$w}=Fw,Xp=class extends $w{constructor(){super(...arguments),this.placement="outside",this.spacing=0}};p([Mt],Xp.prototype,"placement",2),p([Mt],Xp.prototype,"spacing",2);var Lt=class extends Vw{constructor(){super(...arguments),this.fill="#99CCFF",this.fillOpacity=1,this.stroke="#99CCFF",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.interpolation=new Hw,this.shadow=new Kw().set({enabled:!1}),this.marker=new Gw,this.label=new Xp,this.tooltip=Ww(),this.connectMissingData=!1}};p([Mt],Lt.prototype,"xKey",2),p([Mt],Lt.prototype,"yLowKey",2),p([Mt],Lt.prototype,"yHighKey",2),p([Mt],Lt.prototype,"xName",2),p([Mt],Lt.prototype,"yName",2),p([Mt],Lt.prototype,"yLowName",2),p([Mt],Lt.prototype,"yHighName",2),p([Mt],Lt.prototype,"fill",2),p([Mt],Lt.prototype,"fillOpacity",2),p([Mt],Lt.prototype,"stroke",2),p([Mt],Lt.prototype,"strokeWidth",2),p([Mt],Lt.prototype,"strokeOpacity",2),p([Mt],Lt.prototype,"lineDash",2),p([Mt],Lt.prototype,"lineDashOffset",2),p([Mt],Lt.prototype,"interpolation",2),p([Mt],Lt.prototype,"styler",2),p([Mt],Lt.prototype,"shadow",2),p([Mt],Lt.prototype,"marker",2),p([Mt],Lt.prototype,"label",2),p([Mt],Lt.prototype,"tooltip",2),p([Mt],Lt.prototype,"connectMissingData",2);import{_ModuleSupport as jw}from"ag-charts-community";var{CollapseMode:Nl,isScaleValid:Bm,pairUpSpans:Pl,prepareAreaFillAnimationFns:Yw,plotInterpolatedLinePathStroke:Ea,prepareLinePathPropertyAnimation:Uw,areScalingEqual:zm}=jw;function Xw(t,e,i,o){const s=(l,c)=>{Ea(l,c,e.removed),Ea(l,c,i.removed)},a=(l,c)=>{Ea(l,c,e.moved),Ea(l,c,i.moved)},n=(l,c)=>{Ea(l,c,e.added),Ea(l,c,i.added)},r=Uw(t,o);return{status:t,path:{addPhaseFn:n,updatePhaseFn:a,removePhaseFn:s},pathProperties:r}}function Zw(t,e,i){const o=t.scales.x?.type==="category",s=e.scales.x?.type==="category";if(o!==s||!Bm(t.scales.x)||!Bm(e.scales.x))return;let a="updated";e.visible&&!t.visible?a="removed":!e.visible&&t.visible&&(a="added");const n=Pl({scales:t.scales,data:t.fillData.spans},{scales:e.scales,data:e.fillData.spans},Nl.Split);if(n==null)return;const r=Pl({scales:t.scales,data:t.fillData.phantomSpans},{scales:e.scales,data:e.fillData.phantomSpans},Nl.Split);if(r==null)return;const l=Pl({scales:t.scales,data:t.highStrokeData.spans},{scales:e.scales,data:e.highStrokeData.spans},Nl.Split);if(l==null)return;const c=Pl({scales:t.scales,data:t.lowStrokeData.spans},{scales:e.scales,data:e.lowStrokeData.spans},Nl.Split);if(c==null)return;const h="fade",d=Yw(a,n,r,h),u=Xw(a,l,c,h),g=(i?.changed??!0)||!zm(t.scales.x,e.scales.x)||!zm(t.scales.y,e.scales.y)||a!=="updated";return{status:a,fill:d,stroke:u,hasMotion:g}}var{valueProperty:Fm,keyProperty:qw,ChartAxisDirection:Zt,mergeDefaults:Qw,updateLabelNode:Jw,fixNumericExtent:Vm,buildResetPathFn:tN,resetLabelFn:eN,resetMarkerFn:iN,resetMarkerPositionFn:Hm,pathSwipeInAnimation:oN,resetMotion:sN,markerSwipeScaleInAnimation:aN,seriesLabelFadeInAnimation:Zp,animationValidation:nN,diff:rN,updateClipPath:Gm,computeMarkerFocusBounds:Wm,plotAreaPathFill:lN,plotLinePathStroke:Km,interpolatePoints:$m,pathFadeInAnimation:jm,markerFadeInAnimation:Ym,fromToMotion:Um,pathMotion:Xm,extent:cN,applyShapeFillBBox:hN,PointerEvents:qp,Marker:pN,BBox:dN,findMinMax:uN,applyShapeStyle:gN,processedDataIsAnimatable:yN,simpleMemorize2:fN,markerEnabled:mN,getMarkerStyles:xN,calculateSegments:SN}=wl,bN=fN(zw),vN=class extends wl.SeriesNodeEvent{constructor(t,e,i,o){super(t,e,i,o),this.xKey=o.properties.xKey,this.yLowKey=o.properties.yLowKey,this.yHighKey=o.properties.yHighKey}},El=class extends wl.CartesianSeries{constructor(t){super({moduleCtx:t,pathsPerSeries:["fill","stroke"],pickModes:[wl.SeriesNodePickMode.AXIS_ALIGNED],propertyKeys:{[Zt.X]:["xKey"],[Zt.Y]:["yLowKey","yHighKey"]},propertyNames:{[Zt.X]:["xName"],[Zt.Y]:["yLowName","yHighName","yName"]},categoryKey:"xValue",animationResetFns:{path:tN({getVisible:()=>this.visible,getOpacity:()=>this.getOpacity()}),label:eN,datum:(e,i)=>({...iN(e),...Hm(e,i)})},clipFocusBox:!1}),this.properties=new Lt,this.NodeEvent=vN,this.dataAggregationFilters=void 0}async processData(t){const{xKey:e,yLowKey:i,yHighKey:o}=this.properties,s=this.axes[Zt.X]?.scale,a=this.axes[Zt.Y]?.scale,{xScaleType:n,yScaleType:r}=this.getScaleInformation({xScale:s,yScale:a}),l=[],c=!this.ctx.animationManager.isSkipped();!this.ctx.animationManager.isSkipped()&&this.processedData&&l.push(rN(this.id,this.processedData)),c&&l.push(nN());const{dataModel:h,processedData:d}=await this.requestDataModel(t,this.data,{props:[qw(e,n,{id:"xValue"}),Fm(i,r,{id:"yLowValue"}),Fm(o,r,{id:"yHighValue"}),...l]});this.dataAggregationFilters=this.aggregateData(h,d),this.animationState.transition("updateData")}aggregateData(t,e){if(e.type!=="ungrouped"||yN(e))return;const i=this.axes[Zt.X];if(i==null)return;const o=t.resolveKeysById(this,"xValue",e),s=t.resolveColumnById(this,"yHighValue",e),a=t.resolveColumnById(this,"yLowValue",e),{index:n}=t.resolveProcessedDataDefById(this,"xValue"),r=e.domain.keys[n];return bN(i.scale.type,o,s,a,r)}xCoordinateRange(t){const e=this.axes[Zt.X].scale.convert(t);return[e,e]}yCoordinateRange(t){const e=this.axes[Zt.Y].scale.convert(t[0]);return[e,e]}getSeriesDomain(t){const{processedData:e,dataModel:i}=this;if(!(e&&i))return[];const{domain:{keys:[o]}}=e;if(t===Zt.X){const s=i.resolveProcessedDataDefById(this,"xValue");return s?.def.type==="key"&&s.def.valueType==="category"?o:Vm(cN(o))}else{const s=this.domainForClippedRange(Zt.Y,["yHighValue","yLowValue"],"xValue"),a=uN(s);return Vm(a)}}getSeriesRange(t,e){return this.domainForVisibleRange(Zt.Y,["yHighValue","yLowValue"],"xValue",e)}createNodeData(){const{data:t,dataModel:e,processedData:i,axes:o}=this,s=o[Zt.X],a=o[Zt.Y];if(!(t&&s&&a&&e&&i&&this.chart?.seriesRect))return;const n=s.scale,r=a.scale,{xKey:l,yLowKey:c,yHighKey:h,connectMissingData:d,marker:u,interpolation:g,fill:y,fillOpacity:f,stroke:x,strokeWidth:S,strokeOpacity:v}=this.properties,m=i.dataSources.get(this.id)??[],b=(n.bandwidth??0)/2,M=e.resolveKeysById(this,"xValue",i),k=e.resolveColumnById(this,"yHighValue",i),A=e.resolveColumnById(this,"yLowValue",i),D=G=>n.convert(M[G])+b,I=[],L=[],C=[],w=(G,K,Y)=>{const st=m[G],nt=M[G];if(nt==null)return;const X=C[C.length-1];if(Number.isFinite(K)&&Number.isFinite(Y)){const Z=(ut,ct,gt)=>{L.push({index:G,series:this,itemId:ut,datum:st,datumIndex:G,midPoint:{x:pt,y:gt},yHighValue:K,yLowValue:Y,xValue:nt,xKey:l,yLowKey:c,yHighKey:h,point:{x:pt,y:gt,size:dt},enabled:!0});const Tt=this.createLabelData({datumIndex:G,point:{x:pt,y:gt},value:ct,yLowValue:Y,yHighValue:K,itemId:ut,inverted:Q,datum:st,series:this});I.push(Tt)},Q=Y>K,pt=D(G),ot=r.convert(K),q=r.convert(Y),{size:dt}=u;Z("high",K,ot),Z("low",Y,q);const tt={high:{point:{x:pt,y:ot},xDatum:nt,yDatum:K},low:{point:{x:pt,y:q},xDatum:nt,yDatum:Y}};Array.isArray(X)?X.push(tt):X!=null?(X.skip+=1,C.push([tt])):C.push([tt])}else d||(Array.isArray(X)||X==null?C.push({skip:0}):X.skip+=1)},{dataAggregationFilters:P}=this,[E,T]=n.range,R=Math.abs(T-E),_=P?.find(G=>G.maxRange>R),N=_?.topIndices,O=_?.bottomIndices;let[B,z]=this.visibleRangeIndices("xValue",s.range,N);B=Math.max(B-1,0),z=Math.min(z+1,N?.length??M.length),i.input.count<1e3&&(B=0,z=i.input.count);for(let G=B;G<z;G+=1){const K=N?.[G]??G,Y=O?.[G]??G;w(K,k[K],A[Y])}const V=C.flatMap(G=>{if(!Array.isArray(G))return[];const K=G.map(Y=>Y.high);return $m(K,g)}),F=C.flatMap(G=>{if(!Array.isArray(G))return[];const K=G.map(Y=>Y.low);return $m(K,g)}),H=SN(this.properties.segmentation,s,a,this.chart.seriesRect,this.ctx.scene,!1);return{itemId:`${c}-${h}`,labelData:I,nodeData:L,fillData:{itemId:"high",spans:V,phantomSpans:F},highStrokeData:{itemId:"high",spans:V},lowStrokeData:{itemId:"low",spans:F},scales:this.calculateScaling(),visible:this.visible,styles:xN(this,u,{fill:y,fillOpacity:f,stroke:x,strokeWidth:S,strokeOpacity:v}),segments:H}}createLabelData({datumIndex:t,point:e,value:i,itemId:o,inverted:s,datum:a,series:n}){const{xKey:r,yLowKey:l,yHighKey:c,xName:h,yName:d,yLowName:u,yHighName:g,label:y}=this.properties,{placement:f}=y,x=y.spacing+(typeof y.padding=="number"?y.padding:0);let S=o;s&&(S=o==="low"?"high":"low");const v=f==="outside"&&S==="high"||f==="inside"&&S==="low"?-1:1,m=this.getSeriesDomain(Zt.Y);return{x:e.x,y:e.y+x*v,series:n,itemId:o,datum:a,datumIndex:t,text:this.getLabelText(i,a,o==="high"?c:l,"y",m,y,{value:i,datum:a,itemId:o,xKey:r,yLowKey:l,yHighKey:c,xName:h,yLowName:u,yHighName:g,yName:d}),textAlign:"center",textBaseline:v===-1?"bottom":"top"}}isPathOrSelectionDirty(){return this.properties.marker.isDirty()}updatePathNodes(t){const{visible:e}=t,[i,o]=t.paths,s=this.contextNodeData?.segments,{strokeWidth:a,stroke:n,strokeOpacity:r,lineDash:l,lineDashOffset:c,fill:h,fillOpacity:d,opacity:u}=Qw(this.getHighlightStyle(),this.properties);o.setProperties({segments:s,fill:void 0,lineCap:"round",lineJoin:"round",pointerEvents:qp.None,stroke:n,strokeWidth:a,strokeOpacity:r,lineDash:l,lineDashOffset:c,opacity:u,visible:e}),o.datum=s;const g=this.getShapeFillBBox();hN(i,h,g),gN(i,{stroke:void 0,fill:h,fillOpacity:d,lineDash:l,lineDashOffset:c,strokeOpacity:r,strokeWidth:a,opacity:u},g),i.setProperties({segments:s,pointerEvents:qp.None,lineJoin:"round",fillShadow:this.properties.shadow,opacity:u,visible:e}),i.datum=s,Gm(this,o),Gm(this,i)}updatePaths(t){this.updateAreaPaths(t.paths,t.contextData)}updateAreaPaths(t,e){for(const i of t)i.visible=e.visible;if(e.visible)this.updateFillPath(t,e),this.updateStrokePath(t,e);else for(const i of t)i.path.clear(),i.markDirty("RangeArea")}updateFillPath(t,e){const[i]=t;i.path.clear(),lN(i,e.fillData),i.markDirty("RangeArea")}updateStrokePath(t,e){const[,i]=t;i.path.clear(),Km(i,e.highStrokeData.spans),Km(i,e.lowStrokeData.spans),i.markDirty("RangeArea")}updateDatumSelection(t){const{nodeData:e,datumSelection:i}=t,{processedData:o,axes:s,properties:a}=this,{marker:n}=a,r=mN(o.input.count,s[Zt.X].scale,n);return n.isDirty()&&(i.clear(),i.cleanup()),i.update(r?e:[])}updateDatumStyles({datumSelection:t,isHighlight:e}){const{xKey:i,yLowKey:o,yHighKey:s,marker:a,fill:n,stroke:r,strokeWidth:l,fillOpacity:c,strokeOpacity:h}=this.properties;t.each((d,u)=>{u.style=this.getMarkerStyle(a,u,{xKey:i,yHighKey:s,yLowKey:o},{isHighlight:e},void 0,{fill:n,fillOpacity:c,stroke:r,strokeWidth:l,strokeOpacity:h})})}updateDatumNodes(t){const{contextNodeData:e}=this;if(!e)return;const{datumSelection:i,isHighlight:o}=t,s=this.getShapeFillBBox(),a=this.ctx.highlightManager.getActiveHighlight();i.each((n,r)=>{const l=r.style??e.styles[this.getHighlightState(a,o,r.datumIndex)];this.applyMarkerStyle(l,n,r.point,s)}),o||this.properties.marker.markClean()}updateLabelSelection(t){const{labelData:e,labelSelection:i}=t;return i.update(e,o=>{o.pointerEvents=qp.None})}updateLabelNodes(t){const e={xKey:this.properties.xKey,xName:this.properties.xName??this.properties.xKey,yName:this.properties.yName,yLowKey:this.properties.yLowKey,yLowName:this.properties.yLowName??this.properties.yLowKey,yHighKey:this.properties.yHighKey,yHighName:this.properties.yHighName??this.properties.yHighKey},i=this.ctx.highlightManager?.getActiveHighlight();t.labelSelection.each((o,s)=>{o.fillOpacity=this.getHighlightStyle(!1,s.datumIndex).opacity??1,Jw(this,o,e,this.properties.label,s,!1,i)})}getHighlightData(t,e){const i=t.filter(o=>o.datum===e.datum);return i.length>0?i:void 0}makeStylerParams(t,e){throw new Error("not implemented")}getTooltipContent(t,e){const i=e?.itemId??"high",{id:o,dataModel:s,processedData:a,axes:n,properties:r}=this,{xName:l,yName:c,yLowKey:h,yLowName:d,xKey:u,yHighKey:g,yHighName:y,tooltip:f,legendItemName:x}=r,S=n[Zt.X],v=n[Zt.Y];if(!s||!a||!S||!v)return;const m=a.dataSources.get(this.id)?.[t],b=s.resolveKeysById(this,"xValue",a)[t],M=s.resolveColumnById(this,"yHighValue",a)[t],k=s.resolveColumnById(this,"yLowValue",a)[t];if(b==null)return;const A=this.getMarkerStyle(this.properties.marker,{datumIndex:t,datum:m},{xKey:u,yLowKey:h,yHighKey:g}),D=`${this.getAxisValueText(v,"tooltip",k,m,h,x)} - ${this.getAxisValueText(v,"tooltip",M,m,g,x)}`;return this.formatTooltipWithContext(f,{heading:this.getAxisValueText(S,"tooltip",b,m,u,x),symbol:this.legendItemSymbol(),data:[{label:c,fallbackLabel:`${d??h} - ${y??g}`,value:D}]},{seriesId:o,datum:m,title:c,itemId:i,xName:l,yName:c,yLowKey:h,yLowName:d,xKey:u,yHighKey:g,yHighName:y,...A})}legendItemSymbol(){const{fill:t,stroke:e,strokeWidth:i,strokeOpacity:o,lineDash:s,marker:a}=this.properties;return{marker:{shape:a.shape,fill:a.fill??t,stroke:a.stroke??e,fillOpacity:a.fillOpacity,strokeOpacity:a.strokeOpacity,strokeWidth:a.strokeWidth,lineDash:a.lineDash,lineDashOffset:a.lineDashOffset},line:{stroke:e,strokeOpacity:o,strokeWidth:i,lineDash:s}}}getLegendData(t){if(t!=="category")return[];const{id:e,visible:i}=this,{yLowKey:o,yHighKey:s,yName:a,yLowName:n,yHighName:r,showInLegend:l}=this.properties,c=a??`${n??o} - ${r??s}`,h=`${o}-${s}`;return[{legendType:"category",id:e,itemId:h,seriesId:e,enabled:i,label:{text:`${c}`},symbol:this.legendItemSymbol(),hideInLegend:!l}]}isLabelEnabled(){return this.properties.label.enabled}onDataChange(){}nodeFactory(){return new pN}animateEmptyUpdateReady(t){const{datumSelection:e,labelSelection:i,contextData:o,paths:s}=t,{animationManager:a}=this.ctx;this.updateAreaPaths(s,o),oN(this,a,...s),sN([e],Hm),aN(this,a,e),Zp(this,"labels",a,i)}animateReadyResize(t){const{contextData:e,paths:i}=t;this.updateAreaPaths(i,e),super.animateReadyResize(t)}animateWaitingUpdateReady(t){const{animationManager:e}=this.ctx,{datumSelection:i,labelSelection:o,contextData:s,paths:a,previousContextData:n}=t,[r,l]=a;if(r==null&&l==null)return;this.resetDatumAnimation(t),this.resetLabelAnimation(t);const c=()=>{this.resetPathAnimation(t),this.updateAreaPaths(a,s)},h=()=>{e.skipCurrentBatch(),c()};if(s==null||n==null){c(),Ym(this,e,"added",i),jm(this,"fill_path_properties",e,"add",r),jm(this,"stroke_path_properties",e,"add",l),Zp(this,"labels",e,o);return}const d=Zw(s,n,this.processedData?.reduced?.diff?.[this.id]);if(d===void 0){h();return}else if(d.status==="no-op")return;Um(this.id,"fill_path_properties",e,[r],d.fill.pathProperties),Um(this.id,"stroke_path_properties",e,[l],d.stroke.pathProperties),d.status==="added"?this.updateAreaPaths(a,s):d.status==="removed"?this.updateAreaPaths(a,n):(Xm(this.id,"fill_path_update",e,[r],d.fill.path),Xm(this.id,"stroke_path_update",e,[l],d.stroke.path)),d.hasMotion&&(Ym(this,e,void 0,i),Zp(this,"labels",e,o)),this.ctx.animationManager.animate({id:this.id,groupId:"reset_after_animation",phase:"trailing",from:{},to:{},onComplete:()=>this.updateAreaPaths(a,s)})}getFormattedMarkerStyle(t){const{xKey:e,yLowKey:i,yHighKey:o}=this.properties;return this.getMarkerStyle(this.properties.marker,t,{xKey:e,yLowKey:i,yHighKey:o},{isHighlight:!0})}computeFocusBounds(t){const e=Wm(this,t),i=Wm(this,{...t,datumIndex:t.datumIndex+1});if(e&&i)return dN.merge([e,i])}isDatumEnabled(t,e){return e%2===0&&super.isDatumEnabled(t,e)}hasItemStylers(){return this.properties.marker.itemStyler!=null||this.properties.label.itemStyler!=null}};El.className="RangeAreaSeries",El.type="range-area";import{_ModuleSupport as MN}from"ag-charts-community";import{boolean as DN,constant as kN,number as AN,required as _l,shapeSegmentation as LN,string as Cs,undocumented as Zm}from"ag-charts-core";var{commonSeriesOptionsDefs:IN,rangeAreaSeriesThemeableOptionsDef:CN}=MN,Qp={...IN,...CN,type:_l(kN("range-area")),xKey:_l(Cs),yLowKey:_l(Cs),yHighKey:_l(Cs),xName:Cs,yName:Cs,yLowName:Cs,yHighName:Cs,segmentation:LN};Qp.pickOutsideVisibleMinorAxis=Zm(DN),Qp.focusPriority=Zm(AN);import{_ModuleSupport as yo}from"ag-charts-community";var TN={series:{fill:{$applySwitch:[{$path:"type"},{$palette:"fill"},["gradient",yo.FILL_GRADIENT_LINEAR_DEFAULTS],["pattern",yo.FILL_PATTERN_DEFAULTS]]},stroke:{$palette:"stroke"},fillOpacity:.7,nodeClickRange:"nearest",strokeWidth:1,marker:{enabled:!1,fill:{$applySwitch:[{$path:"type"},{$palette:"fill"},["gradient",yo.FILL_GRADIENT_RADIAL_REVERSED_DEFAULTS],["image",yo.FILL_IMAGE_DEFAULTS],["pattern",yo.FILL_PATTERN_DEFAULTS]]},stroke:{$palette:"stroke"},size:6,strokeWidth:2},label:{...yo.LABEL_BOXING_DEFAULTS,enabled:!1,placement:"outside",padding:{$isUserOption:["./spacing",0,10]},fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"textColor"}},interpolation:{type:"linear"},tooltip:{range:{$path:["/tooltip/range","nearest"]}},highlight:yo.multiSeriesHighlightStyle(),segmentation:yo.SEGMENTATION_DEFAULTS},axes:{[yo.ThemeConstants.CARTESIAN_AXIS_TYPE.NUMBER]:{crosshair:{enabled:!0}}}},{ThemeConstants:{CARTESIAN_AXIS_TYPE:qm,CARTESIAN_POSITION:Qm}}=Pm,wN={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["cartesian"],identifier:"range-area",moduleFactory:t=>new El(t),predictAxis:Pm.predictCartesianTimeAxis,defaultAxes:[{type:qm.NUMBER,position:Qm.LEFT},{type:qm.CATEGORY,position:Qm.BOTTOM}],themeTemplate:TN},Jm={type:"series",name:"range-area",chartType:"cartesian",enterprise:!0,options:Qp,create:t=>new El(t)};import{_ModuleSupport as tx}from"ag-charts-community";import{_ModuleSupport as Ol}from"ag-charts-community";import{_ModuleSupport as NN}from"ag-charts-community";var{aggregationDomain:PN,aggregationRangeFittingPoints:EN,compactAggregationIndices:_N,createAggregationIndices:ON}=NN,RN=1e3;function BN(t,e,i,o,s,a){if(e.length<RN)return;const[n,r]=PN(t,s);let l=EN(e,n,r,{smallestKeyInterval:a}),{indexData:c,valueData:h}=ON(e,i,o,n,r,l);const d=[{maxRange:l,indexData:c}];for(;l>64;)({indexData:c,valueData:h,maxRange:l}=_N(c,h,l)),d.push({maxRange:l,indexData:c});return d.reverse(),d}import{_ModuleSupport as zN}from"ag-charts-community";var{AbstractBarSeriesProperties:FN,makeSeriesTooltip:VN,Property:Pt,DropShadow:HN,Label:GN}=zN,Jp=class extends GN{constructor(){super(...arguments),this.placement="inside",this.spacing=0}};p([Pt],Jp.prototype,"placement",2),p([Pt],Jp.prototype,"spacing",2);var Ft=class extends FN{constructor(){super(...arguments),this.fill="#99CCFF",this.fillOpacity=1,this.stroke="#99CCFF",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.cornerRadius=0,this.shadow=new HN().set({enabled:!1}),this.label=new Jp,this.tooltip=VN()}getStyle(){const{fill:t,fillOpacity:e,stroke:i,strokeWidth:o,strokeOpacity:s,lineDash:a,lineDashOffset:n,cornerRadius:r}=this;return{fill:t,fillOpacity:e,stroke:i,strokeWidth:o,strokeOpacity:s,lineDash:a,lineDashOffset:n,cornerRadius:r,opacity:1}}};p([Pt],Ft.prototype,"xKey",2),p([Pt],Ft.prototype,"yLowKey",2),p([Pt],Ft.prototype,"yHighKey",2),p([Pt],Ft.prototype,"xName",2),p([Pt],Ft.prototype,"yName",2),p([Pt],Ft.prototype,"yLowName",2),p([Pt],Ft.prototype,"yHighName",2),p([Pt],Ft.prototype,"fill",2),p([Pt],Ft.prototype,"fillOpacity",2),p([Pt],Ft.prototype,"stroke",2),p([Pt],Ft.prototype,"strokeWidth",2),p([Pt],Ft.prototype,"strokeOpacity",2),p([Pt],Ft.prototype,"lineDash",2),p([Pt],Ft.prototype,"lineDashOffset",2),p([Pt],Ft.prototype,"cornerRadius",2),p([Pt],Ft.prototype,"itemStyler",2),p([Pt],Ft.prototype,"shadow",2),p([Pt],Ft.prototype,"label",2),p([Pt],Ft.prototype,"tooltip",2);var{SeriesNodePickMode:ex,valueProperty:ix,keyProperty:WN,ChartAxisDirection:Tn,checkCrisp:KN,updateLabelNode:$N,SMALLEST_KEY_INTERVAL:jN,LARGEST_KEY_INTERVAL:YN,diff:UN,prepareBarAnimationFunctions:ox,midpointStartingBarPosition:sx,resetBarSelectionsFn:XN,fixNumericExtent:ZN,seriesLabelFadeInAnimation:ax,resetLabelFn:qN,animationValidation:QN,computeBarFocusBounds:JN,visibleRangeIndices:tP,createDatumId:eP,ContinuousScale:iP,Rect:oP,PointerEvents:sP,motion:nx,applyShapeStyle:aP,findMinMax:nP,areScalingEqual:rP,processedDataIsAnimatable:lP,AGGREGATION_SPAN:rx,AGGREGATION_INDEX_X_MAX:lx,AGGREGATION_INDEX_X_MIN:cx,AGGREGATION_INDEX_Y_MAX:cP,AGGREGATION_INDEX_Y_MIN:hP,mergeDefaults:hx,simpleMemorize2:pP,getItemStyles:dP,calculateSegments:uP}=Ol,gP=pP(BN),yP=class extends Ol.SeriesNodeEvent{constructor(t,e,i,o){super(t,e,i,o),this.xKey=o.properties.xKey,this.yLowKey=o.properties.yLowKey,this.yHighKey=o.properties.yHighKey}},Rl=class extends Ol.AbstractBarSeries{constructor(t){super({moduleCtx:t,pickModes:[ex.AXIS_ALIGNED,ex.EXACT_SHAPE_MATCH],propertyKeys:{x:["xKey"],y:["yLowKey","yHighKey"]},propertyNames:{x:["xName"],y:["yLowName","yHighName","yName"]},categoryKey:"xValue",datumSelectionGarbageCollection:!1,animationResetFns:{datum:XN,label:qN}}),this.properties=new Ft,this.dataAggregationFilters=void 0,this.NodeEvent=yP}async processData(t){const{xKey:e,yLowKey:i,yHighKey:o}=this.properties,s=this.getCategoryAxis()?.scale,a=this.getValueAxis()?.scale,{isContinuousX:n,xScaleType:r,yScaleType:l}=this.getScaleInformation({xScale:s,yScale:a}),c=[];this.ctx.animationManager.isSkipped()||(this.processedData&&c.push(UN(this.id,this.processedData)),c.push(QN()));const h=this.visible?{}:{forceValue:0},{dataModel:d,processedData:u}=await this.requestDataModel(t,this.data,{props:[WN(e,r,{id:"xValue"}),ix(i,l,{id:"yLowValue",invalidValue:null,...h}),ix(o,l,{id:"yHighValue",invalidValue:null,...h}),...n?[jN,YN]:[],...c],groupByKeys:!1});this.smallestDataInterval=u.reduced?.smallestKeyInterval,this.largestDataInterval=u.reduced?.largestKeyInterval,this.dataAggregationFilters=this.aggregateData(d,u),this.animationState.transition("updateData")}aggregateData(t,e){if(e.type!=="ungrouped"||lP(e))return;const i=this.axes[Tn.X];if(i==null)return;const o=t.resolveKeysById(this,"xValue",e),s=t.resolveColumnById(this,"yHighValue",e),a=t.resolveColumnById(this,"yLowValue",e),{index:n}=t.resolveProcessedDataDefById(this,"xValue"),r=e.domain.keys[n];return gP(i.scale.type,o,s,a,r,e.reduced?.smallestKeyInterval)}getSeriesDomain(t){const{processedData:e,dataModel:i}=this;if(!e||!i)return[];const{keys:[o]}=e.domain;if(t===this.getCategoryDirection()){const s=i.resolveProcessedDataDefById(this,"xValue");return s?.def.type==="key"&&s?.def.valueType==="category"?o:this.padBandExtent(o)}else{const s=this.domainForClippedRange(t,["yHighValue","yLowValue"],"xValue"),a=nP(s);return ZN(a)}}getSeriesRange(t,e){return this.domainForVisibleRange(Tn.Y,["yHighValue","yLowValue"],"xValue",e)}createNodeData(){const{data:t,dataModel:e,groupScale:i,processedData:o,visible:s}=this,a=this.getCategoryAxis(),n=this.getValueAxis();if(!(t&&a&&n&&e&&o?.dataSources&&this.chart?.seriesRect))return;const r=a.scale,l=n.scale,c=this.getBarDirection()===Tn.X,{xKey:h,yLowKey:d,yHighKey:u,strokeWidth:g}=this.properties,y=`${d}-${u}`,f=uP(this.properties.segmentation,a,n,this.chart.seriesRect,this.ctx.scene),x={itemId:y,nodeData:[],labelData:[],scales:this.calculateScaling(),groupScale:this.getScaling(this.groupScale),visible:this.visible,styles:dP(this.getItemStyle.bind(this)),segments:f};if(!s)return x;const S=o.dataSources.get(this.id)??[],v=e.resolveKeysById(this,"xValue",o),m=e.resolveColumnById(this,"yLowValue",o),b=e.resolveColumnById(this,"yHighValue",o),{barWidth:M,groupIndex:k}=this.updateGroupScale(a),A=iP.is(r)?M*-.5:0,D=i.convert(String(k)),I=KN(a?.scale,a?.visibleRange,this.smallestDataInterval,this.largestDataInterval),L=_=>Math.round(r.convert(v[_]))+D+A,C=(_,N,O,B,z,V,F)=>{const H=S[_],W=v[_];if(W==null)return;const G=m[_],K=b[_];if(!Number.isFinite(G?.valueOf())||!Number.isFinite(K?.valueOf()))return;const[Y,st]=G<K?[G,K]:[K,G],nt=Math.round(l.convert(V)),X=Math.round(l.convert(z)),Z=Math.max(g,Math.abs(X-nt)),Q={x:c?Math.min(nt,X):O,y:c?O:Math.min(nt,X),width:c?Z:B,height:c?B:Z},pt={x:Q.x+Q.width/2,y:Q.y+Q.height/2},ot=this.createLabelData({datumIndex:_,rect:Q,barAlongX:c,yLowValue:Y,yHighValue:st,datum:H,series:this}),q={index:N,series:this,itemId:y,datum:H,datumIndex:_,xValue:W,yLowValue:G,yHighValue:K,yLowKey:d,yHighKey:u,xKey:h,x:Q.x,y:Q.y,width:Q.width,height:Q.height,midPoint:pt,crisp:F,labels:ot};x.nodeData.push(q),x.labelData.push(...ot)},{dataAggregationFilters:w}=this,[P,E]=r.range,T=Math.abs(E-P),R=w?.find(_=>_.maxRange>T);if(R!=null){const{maxRange:_,indexData:N}=R,[O,B]=tP(1,_,a.range,z=>{const V=z*rx,F=N[V+cx],H=N[V+lx];if(F===-1)return;const W=(F+H)/2|0;return[L(W),L(H)+M]});for(let z=O;z<B;z+=1){const V=z*rx,F=N[V+cx],H=N[V+lx],W=N[V+hP],G=N[V+cP];if(F===-1)continue;const K=(F+H)/2|0;if(v[K]==null)continue;const st=L(K),nt=Math.abs(L(F)-L(H))+M,X=m[W],Z=b[G];C(K,0,st,nt,X,Z,!1)}}else if(o.type==="ungrouped"){const _=o.invalidData?.get(this.id);let[N,O]=this.visibleRangeIndices("xValue",a.range);o.input.count<1e3&&(N=0,O=o.input.count);for(let B=N;B<O;B+=1){if(_?.[B]===!0)continue;const z=L(B),V=M,F=m[B],H=b[B];C(B,0,z,V,F,H,I)}}else for(const{datumIndex:_,groupIndex:N}of e.forEachGroupDatum(this,o)){const O=L(_),B=M,z=m[_],V=b[_];C(_,N,O,B,z,V,I)}return x}createLabelData({datumIndex:t,rect:e,barAlongX:i,yLowValue:o,yHighValue:s,datum:a,series:n}){const{xKey:r,yLowKey:l,yHighKey:c,xName:h,yLowName:d,yHighName:u,yName:g,label:y}=this.properties,f={datum:a,xKey:r,yLowKey:l,yHighKey:c,xName:h,yLowName:d,yHighName:u,yName:g},{placement:x}=y,m=(y.spacing+(typeof y.padding=="number"?y.padding:0))*(x==="outside"?1:-1),b=this.getSeriesDomain(Tn.Y),M={datumIndex:t,x:e.x+(i?-m:e.width/2),y:e.y+(i?e.height/2:e.height+m),textAlign:i?"left":"center",textBaseline:i?"middle":"bottom",text:this.getLabelText(o,a,l,"y",b,y,{itemId:"low",value:o,...f}),itemId:"low",datum:a,series:n},k={datumIndex:t,x:e.x+(i?e.width+m:e.width/2),y:e.y+(i?e.height/2:-m),textAlign:i?"right":"center",textBaseline:i?"middle":"top",text:this.getLabelText(s,a,c,"y",b,y,{itemId:"high",value:s,...f}),itemId:"high",datum:a,series:n};return x==="outside"&&(M.textAlign=i?"right":"center",M.textBaseline=i?"middle":"top",k.textAlign=i?"left":"center",k.textBaseline=i?"middle":"bottom"),[M,k]}nodeFactory(){return new oP}updateDatumSelection(t){const{nodeData:e,datumSelection:i}=t,o=e??[];return i.update(o,void 0,s=>this.getDatumId(s))}getItemStyle(t,e,i){const{id:o,properties:s,dataModel:a,processedData:n}=this,{xKey:r,yHighKey:l,yLowKey:c,itemStyler:h}=s,d=this.getHighlightStyle(e,t,i);let g=hx(d,s.getStyle());if(h&&a!=null&&n!=null&&t!=null){const y=n.dataSources.get(o)?.[t],f=a.resolveKeysById(this,"xValue",n)[t],x=this.cachedDatumCallback(eP(this.getDatumId({xValue:f}),e?"highlight":"node"),()=>{const S=this.ctx.highlightManager?.getActiveHighlight(),v=this.getHighlightStateString(S,e,t);return this.callWithContext(h,{seriesId:o,datum:y,xKey:r,yHighKey:l,yLowKey:c,highlighted:e,highlightState:v,...g})});x&&(g=hx(x,g))}return g}updateDatumStyles({datumSelection:t,isHighlight:e}){t.each((i,o)=>{t.isGarbage(i)||(o.style=this.getItemStyle(o.datumIndex,e))})}updateDatumNodes({datumSelection:t,isHighlight:e}){const{contextNodeData:i}=this;if(!i)return;const o=this.ctx.highlightManager.getActiveHighlight(),s=this.getCategoryDirection()===Tn.X,a=this.getShapeFillBBox();t.each((n,r)=>{const l=r.style??i.styles[this.getHighlightState(o,e,r.datumIndex)];aP(n,l,a),n.cornerRadius=l.cornerRadius??0,n.visible=s?r.width>0:r.height>0,n.crisp=r.crisp})}updateLabelSelection(t){const e=this.properties.label.enabled?t.labelData:[];return t.labelSelection.update(e,i=>{i.pointerEvents=sP.None})}updateLabelNodes(t){const e={xKey:this.properties.xKey,xName:this.properties.xName??this.properties.xKey,yName:this.properties.yName,yLowKey:this.properties.yLowKey,yLowName:this.properties.yLowName??this.properties.yLowKey,yHighKey:this.properties.yHighKey,yHighName:this.properties.yHighName??this.properties.yHighKey},i=this.ctx.highlightManager?.getActiveHighlight();t.labelSelection.each((o,s)=>{o.fillOpacity=this.getHighlightStyle(!1,s?.datumIndex).opacity??1,$N(this,o,e,this.properties.label,s,!1,i)})}getTooltipContent(t){const{id:e,dataModel:i,processedData:o,properties:s}=this,{xKey:a,xName:n,yName:r,yLowKey:l,yHighKey:c,yLowName:h,yHighName:d,tooltip:u,legendItemName:g}=s,y=this.getCategoryAxis(),f=this.getValueAxis();if(!i||!o||!y||!f)return;const x=o.dataSources.get(this.id)?.[t],S=i.resolveKeysById(this,"xValue",o)[t],v=i.resolveColumnById(this,"yHighValue",o)[t],m=i.resolveColumnById(this,"yLowValue",o)[t];if(S==null)return;const b=this.getItemStyle(t,!1),M=`${this.getAxisValueText(f,"tooltip",m,x,l,g)} - ${this.getAxisValueText(f,"tooltip",v,x,c,g)}`;return this.formatTooltipWithContext(u,{heading:this.getAxisValueText(y,"tooltip",S,x,a,g),symbol:this.legendItemSymbol(),data:[{label:r,fallbackLabel:`${h??l} - ${d??c}`,value:M}]},{seriesId:e,datum:x,title:r,xKey:a,xName:n,yName:r,yLowKey:l,yHighKey:c,yLowName:h,yHighName:d,...b})}legendItemSymbol(){const{fill:t,stroke:e,strokeWidth:i,fillOpacity:o,strokeOpacity:s,lineDash:a,lineDashOffset:n}=this.properties;return{marker:{fill:t,stroke:e,fillOpacity:o,strokeOpacity:s,strokeWidth:i,lineDash:a,lineDashOffset:n}}}getLegendData(t){if(t!=="category")return[];const{id:e,visible:i}=this,{yName:o,yLowName:s,yHighName:a,yLowKey:n,yHighKey:r,showInLegend:l}=this.properties,c=o??`${s??n} - ${a??r}`,h=`${n}-${r}`;return[{legendType:"category",id:e,itemId:h,seriesId:e,enabled:i,label:{text:`${c}`},symbol:this.legendItemSymbol(),hideInLegend:!l}]}animateEmptyUpdateReady({datumSelection:t,labelSelection:e}){const i=ox(sx(this.isVertical(),"normal"),"unknown");nx.fromToMotion(this.id,"datums",this.ctx.animationManager,[t],i),ax(this,"labels",this.ctx.animationManager,e)}animateWaitingUpdateReady(t){const{datumSelection:e,labelSelection:i,contextData:o,previousContextData:s}=t,a=Ol.calculateDataDiff(this.id,e,this.getDatumId.bind(this),o,s,this.processedData);this.ctx.animationManager.stopByAnimationGroupId(this.id);const n=s==null?"fade":"normal",r=ox(sx(this.isVertical(),n),"added");nx.fromToMotion(this.id,"datums",this.ctx.animationManager,[e],r,(l,c)=>this.getDatumId(c),a),(a?.changed||!rP(o.groupScale,s?.groupScale))&&ax(this,"labels",this.ctx.animationManager,i)}getDatumId(t){return`${t.xValue}`}isLabelEnabled(){return this.properties.label.enabled}onDataChange(){}computeFocusBounds({datumIndex:t}){return JN(this,this.contextNodeData?.nodeData[t])}hasItemStylers(){return this.properties.itemStyler!=null}};Rl.className="RangeBarSeries",Rl.type="range-bar";import{_ModuleSupport as fP}from"ag-charts-community";import{boolean as mP,constant as xP,number as SP,required as Bl,shapeSegmentation as bP,string as Ts,undocumented as px}from"ag-charts-core";var{commonSeriesOptionsDefs:vP,rangeBarSeriesThemeableOptionsDef:MP}=fP,td={...vP,...MP,type:Bl(xP("range-bar")),xKey:Bl(Ts),yLowKey:Bl(Ts),yHighKey:Bl(Ts),xName:Ts,yName:Ts,yLowName:Ts,yHighName:Ts,segmentation:bP};td.pickOutsideVisibleMinorAxis=px(mP),td.focusPriority=px(SP);import{_ModuleSupport as ws}from"ag-charts-community";var DP={series:{direction:"vertical",fill:{$applySwitch:[{$path:"type"},{$palette:"fill"},["gradient",ws.FILL_GRADIENT_LINEAR_DEFAULTS],["image",ws.FILL_IMAGE_DEFAULTS],["pattern",ws.FILL_PATTERN_DEFAULTS]]},stroke:{$palette:"stroke"},strokeWidth:{$isUserOption:["./stroke",2,0]},label:{...ws.LABEL_BOXING_DEFAULTS,enabled:!1,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"chartBackgroundColor"},placement:"inside",padding:{$isUserOption:["./spacing",0,6]}},highlight:ws.multiSeriesHighlightStyle(),segmentation:ws.SEGMENTATION_DEFAULTS},axes:{[ws.ThemeConstants.CARTESIAN_AXIS_TYPE.NUMBER]:{crosshair:{enabled:!0}}}},kP={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["cartesian"],identifier:"range-bar",moduleFactory:t=>new Rl(t),predictAxis:tx.predictCartesianTimeAxis,defaultAxes:tx.DIRECTION_SWAP_AXES,themeTemplate:DP,groupable:!0},dx={type:"series",name:"range-bar",chartType:"cartesian",enterprise:!0,options:td,create:t=>new Rl(t)};import{_ModuleSupport as AP}from"ag-charts-community";import{_ModuleSupport as Ns}from"ag-charts-community";import{_ModuleSupport as LP}from"ag-charts-community";var{AbstractBarSeriesProperties:IP,BaseProperties:wn,PropertiesArray:CP,makeSeriesTooltip:TP,Property:at,DropShadow:wP,Label:NP}=LP,zl=class extends wn{};p([at],zl.prototype,"totalType",2),p([at],zl.prototype,"index",2),p([at],zl.prototype,"axisLabel",2);var ux=class extends wn{};p([at],ux.prototype,"renderer",2);var ed=class extends NP{constructor(){super(...arguments),this.placement="outside-end",this.spacing=0}};p([at],ed.prototype,"placement",2),p([at],ed.prototype,"spacing",2);var ge=class extends wn{constructor(){super(...arguments),this.fill="#c16068",this.stroke="#c16068",this.fillOpacity=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.strokeWidth=1,this.cornerRadius=0,this.shadow=new wP().set({enabled:!1}),this.label=new ed,this.tooltip=new ux}};p([at],ge.prototype,"name",2),p([at],ge.prototype,"fill",2),p([at],ge.prototype,"stroke",2),p([at],ge.prototype,"fillOpacity",2),p([at],ge.prototype,"strokeOpacity",2),p([at],ge.prototype,"lineDash",2),p([at],ge.prototype,"lineDashOffset",2),p([at],ge.prototype,"strokeWidth",2),p([at],ge.prototype,"cornerRadius",2),p([at],ge.prototype,"itemStyler",2),p([at],ge.prototype,"shadow",2),p([at],ge.prototype,"label",2),p([at],ge.prototype,"tooltip",2);var Ps=class extends wn{constructor(){super(...arguments),this.enabled=!0,this.stroke="black",this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.strokeWidth=2}};p([at],Ps.prototype,"enabled",2),p([at],Ps.prototype,"stroke",2),p([at],Ps.prototype,"strokeOpacity",2),p([at],Ps.prototype,"lineDash",2),p([at],Ps.prototype,"lineDashOffset",2),p([at],Ps.prototype,"strokeWidth",2);var Fl=class extends wn{constructor(){super(...arguments),this.positive=new ge,this.negative=new ge,this.total=new ge}};p([at],Fl.prototype,"positive",2),p([at],Fl.prototype,"negative",2),p([at],Fl.prototype,"total",2);var fo=class extends IP{constructor(){super(...arguments),this.item=new Fl,this.totals=new CP(zl),this.line=new Ps,this.tooltip=TP()}getStyle(t){const{fillOpacity:e,strokeWidth:i,strokeOpacity:o,fill:s,stroke:a,lineDash:n,lineDashOffset:r,cornerRadius:l}=this.item[t==="subtotal"?"total":t];return{fill:s,fillOpacity:e,stroke:a,strokeWidth:i,strokeOpacity:o,lineDash:n,lineDashOffset:r,cornerRadius:l,opacity:1}}};p([at],fo.prototype,"xKey",2),p([at],fo.prototype,"yKey",2),p([at],fo.prototype,"xName",2),p([at],fo.prototype,"yName",2),p([at],fo.prototype,"item",2),p([at],fo.prototype,"totals",2),p([at],fo.prototype,"line",2),p([at],fo.prototype,"tooltip",2);var{adjustLabelPlacement:PP,SeriesNodePickMode:gx,fixNumericExtent:EP,valueProperty:yx,keyProperty:_P,accumulativeValueProperty:Vl,trailingAccumulatedValueProperty:OP,ChartAxisDirection:Hl,createDatumId:RP,checkCrisp:BP,updateLabelNode:zP,prepareBarAnimationFunctions:FP,collapsedStartingBarPosition:VP,resetBarSelectionsFn:HP,seriesLabelFadeInAnimation:GP,resetLabelFn:WP,animationValidation:KP,DEFAULT_CARTESIAN_DIRECTION_KEYS:$P,DEFAULT_CARTESIAN_DIRECTION_NAMES:jP,computeBarFocusBounds:YP,isContinuous:fx,Rect:UP,motion:XP,applyShapeStyle:ZP,mergeDefaults:mx,getItemStylesPerItemId:qP}=Ns,Gl=class extends Ns.AbstractBarSeries{constructor(t){super({moduleCtx:t,propertyKeys:$P,propertyNames:jP,categoryKey:void 0,pickModes:[gx.NEAREST_NODE,gx.EXACT_SHAPE_MATCH],pathsPerSeries:["connector"],pathsZIndexSubOrderOffset:[-1,-1],animationResetFns:{datum:HP,label:WP}}),this.properties=new fo,this.seriesItemTypes=new Set(["positive","negative","total"])}async processData(t){const{xKey:e,yKey:i,totals:o}=this.properties,{data:s=[]}=this;if(!this.visible)return;const a=v=>fx(v)&&Number(v)>=0,n=v=>fx(v)&&Number(v)>=0,r=v=>v==="total"||v==="subtotal",l={missingValue:void 0,invalidValue:void 0},c=[],h=o.reduce((v,m)=>{const b=v.get(m.index);return b?b.push(m):v.set(m.index,[m]),v},new Map);s.forEach((v,m)=>{c.push(v),h.get(m)?.forEach(b=>c.push({...b.toJson(),[e]:b.axisLabel}))});const d=[];this.ctx.animationManager.isSkipped()||d.push(KP());const u=this.getCategoryAxis()?.scale,g=this.getValueAxis()?.scale,{isContinuousX:y,xScaleType:f,yScaleType:x}=this.getScaleInformation({xScale:u,yScale:g}),{processedData:S}=await this.requestDataModel(t,c,{props:[_P(e,f,{id:"xValue"}),Vl(i,x,{...l,id:"yCurrent"}),Vl(i,x,{...l,missingValue:0,id:"yCurrentTotal"}),Vl(i,x,{...l,id:"yCurrentPositive",validation:a}),Vl(i,x,{...l,id:"yCurrentNegative",validation:n}),OP(i,x,{...l,id:"yPrevious"}),yx(i,x,{id:"yRaw"}),yx("totalType","category",{id:"totalTypeValue",missingValue:void 0,validation:r}),...y?[Ns.SMALLEST_KEY_INTERVAL,Ns.LARGEST_KEY_INTERVAL]:[],...d]});this.smallestDataInterval=S.reduced?.smallestKeyInterval,this.largestDataInterval=S.reduced?.largestKeyInterval,this.updateSeriesItemTypes(),this.animationState.transition("updateData")}getSeriesDomain(t){const{processedData:e,dataModel:i}=this;if(!e||!i)return[];const{keys:[o],values:s}=e.domain;if(t===this.getCategoryDirection()){const a=i.resolveProcessedDataDefById(this,"xValue");if(a?.def.type==="key"&&a?.def.valueType==="category")return o;const n=t===Hl.Y,r=this.getCategoryAxis().isReversed();return this.padBandExtent(o,r!==n)}else{const a=i.resolveProcessedDataIndexById(this,"yCurrent"),n=s[a],r=[Math.min(0,n[0]),Math.max(0,n[1])];return EP(r)}}getSeriesRange(t,e){return[NaN,NaN]}createNodeData(){const{data:t,dataModel:e,processedData:i}=this,o=this.getCategoryAxis(),s=this.getValueAxis();if(!t||!o||!s||!e||!i)return;const{line:a}=this.properties,n=o.scale,r=s.scale,l=this.getBarDirection()===Hl.X,c=this.getBandwidth(o)??10,h=o.isReversed(),d=s.isReversed();if(i.type!=="ungrouped")return;const u={itemId:this.properties.yKey,nodeData:[],labelData:[],pointData:[],scales:this.calculateScaling(),groupScale:this.getScaling(this.groupScale),visible:this.visible,styles:qP(this.getItemStyle.bind(this),"total","subtotal","positive","negative")};if(!this.visible)return u;const g=[],y=e.resolveKeysById(this,"xValue",i),f=e.resolveColumnById(this,"yRaw",i),x=e.resolveColumnById(this,"totalTypeValue",i),S=e.resolveColumnById(this,"yCurrent",i),v=e.resolveColumnById(this,"yPrevious",i),m=e.resolveColumnById(this,"yCurrentTotal",i),b=this.getSeriesDomain(Hl.Y),M=BP(o?.scale,o?.visibleRange,this.smallestDataInterval,this.largestDataInterval);function k(T,R,_){return T||R?{cumulativeValue:m[_],trailingValue:R?D:0}:{cumulativeValue:S[_],trailingValue:v[_]}}function A(T,R,_,N,O){return T?N:R?(N??0)-(O??0):_}let D=0;const{xKey:I,yKey:L,xName:C,yName:w}=this.properties;(i.dataSources.get(this.id)??[]).forEach((T,R)=>{const _=x[R],N=this.isSubtotal(_),O=this.isTotal(_),B=O||N,z=y[R];if(z==null)return;const V=Math.round(n.convert(z)),F=f[R],{cumulativeValue:H,trailingValue:W}=k(O,N,R);B&&(D=H??0);const G=Math.round(r.convert(H)),K=Math.round(r.convert(W)),Y=A(O,N,F,H,W),st=(Y??0)>=0,nt=this.getSeriesItemType(st,_),{strokeWidth:X,label:Z}=this.getItemConfig(nt),Q=st?G:K,pt=st?K:G,ot=Math.max(X,Math.abs(pt-Q)),q={x:l?Math.min(Q,pt):V,y:l?V:Math.min(Q,pt),width:l?ot:c,height:l?c:ot},dt={x:q.x+q.width/2,y:q.y+q.height/2},tt=B?G:K,ut=Math.floor(a.strokeWidth)%2/2,ct=h?G:tt,gt=h?tt:G;let Tt,Re;l?(Tt={x:ct+ut,y:q.y},Re={x:gt+ut,y:q.y+q.height}):(Tt={x:q.x,y:ct+ut},Re={x:q.x+q.width,y:gt+ut});const as={x:h?Re.x:Tt.x,y:h?Re.y:Tt.y,x2:h?Tt.x:Re.x,y2:h?Tt.y:Re.y,size:0};g.push(as);const gi=nt==="subtotal"?"total":nt,wi=this.getLabelText(Y,T,L,"y",b,Z,{itemId:gi,value:Y,datum:T,xKey:I,yKey:L,xName:C,yName:w}),tn=Z.spacing+(typeof Z.padding=="number"?Z.padding:0),en={index:R,series:this,itemId:nt,datum:T,datumIndex:R,cumulativeValue:H??0,xValue:z,yValue:Y,yKey:L,xKey:I,x:q.x,y:q.y,width:q.width,height:q.height,midPoint:dt,crisp:M,label:{text:wi,...PP({isUpward:(Y??-1)>=0!==d,isVertical:!l,placement:Z.placement,spacing:tn,rect:q})}};u.nodeData.push(en),u.labelData.push(en)});const E=this.properties.line.enabled;return S!=null&&E&&(u.pointData=g),u}updateSeriesItemTypes(){const{dataModel:t,seriesItemTypes:e,processedData:i}=this;if(!t||!i)return;e.clear();const o=t.resolveProcessedDataIndexById(this,"yCurrentPositive"),s=t.resolveProcessedDataIndexById(this,"yCurrentNegative"),a=t.resolveProcessedDataIndexById(this,"totalTypeValue"),n=i.domain.values[o]??[],r=i.domain.values[s]??[];n.length>0&&e.add("positive"),r.length>0&&e.add("negative");const l=i?.domain.values[a];l&&l.forEach(c=>{(c==="total"||c==="subtotal")&&e.add("total")})}isSubtotal(t){return t==="subtotal"}isTotal(t){return t==="total"}nodeFactory(){return new UP}getSeriesItemType(t,e){return e??(t?"positive":"negative")}getItemConfig(t){switch(t){case"positive":return this.properties.item.positive;case"negative":return this.properties.item.negative;case"subtotal":case"total":return this.properties.item.total}}updateDatumSelection(t){const{nodeData:e,datumSelection:i}=t,o=e??[];return i.update(o)}getItemStyle(t,e,i,o="total"){const{id:s,properties:a}=this,{datumIndex:n=0,datum:r}=t??{},l=o==="subtotal"?"total":o,c=a.item[l],h=this.getHighlightStyle(e,n,i),d=mx(h,a.getStyle(o)),{itemStyler:u}=c,{xKey:g,yKey:y}=a;let f=d;if(u!=null&&t!=null){const x=this.ctx.highlightManager?.getActiveHighlight(),S=this.cachedDatumCallback(RP(n,e?"highlight":"node"),()=>{const v=this.getHighlightStateString(x,e,n);return this.ctx.optionsGraphService.resolvePartial(["series",`${this.declarationOrder}`,"item",l],this.callWithContext(u,{seriesId:s,itemId:o,datum:r,xKey:g,yKey:y,highlighted:e,highlightState:v,...f}))});S&&(f=mx(S,f))}return f}updateDatumStyles({datumSelection:t,isHighlight:e}){t.each((i,o)=>{o.style=this.getItemStyle(o,e,void 0,o.itemId)})}updateDatumNodes({datumSelection:t,isHighlight:e}){const{contextNodeData:i}=this;if(!i)return;const o=this.ctx.highlightManager.getActiveHighlight(),s=this.getCategoryDirection()===Hl.X,a=this.getShapeFillBBox();t.each((n,r)=>{const l=r.style??i.styles[r.itemId][this.getHighlightState(o,e,r.datumIndex)];ZP(n,l,a),n.cornerRadius=l.cornerRadius??0,n.visible=s?r.width>0:r.height>0,n.crisp=r.crisp})}updateLabelSelection(t){const{labelData:e,labelSelection:i}=t;if(e.length===0)return i.update([]);const o=e.filter(s=>{const{label:a}=this.getItemConfig(s.itemId);return a.enabled});return i.update(o)}updateLabelNodes(t){const e={itemId:"positive",xKey:this.properties.xKey,xName:this.properties.xName??this.properties.xName,yKey:this.properties.yKey,yName:this.properties.yName??this.properties.yName},i=this.ctx.highlightManager?.getActiveHighlight();t.labelSelection.each((o,s)=>{e.itemId=s.itemId,o.fillOpacity=this.getHighlightStyle(!1,s.datumIndex)?.opacity??1;const a=this.getItemConfig(s.itemId).label;zP(this,o,e,a,s.label,!1,i)})}getTooltipContent(t){const{id:e,dataModel:i,processedData:o,properties:s}=this,{xKey:a,xName:n,yKey:r,yName:l,tooltip:c,legendItemName:h}=s,d=this.getCategoryAxis(),u=this.getValueAxis();if(!i||!o||!d||!u)return;const g=o.dataSources.get(this.id)?.[t],y=i.resolveKeysById(this,"xValue",o)[t],f=i.resolveColumnById(this,"yRaw",o)[t],x=i.resolveColumnById(this,"yCurrentTotal",o),S=i.resolveColumnById(this,"totalTypeValue",o);if(y==null)return;const v=S[t],m=(f??0)>=0,b=this.getSeriesItemType(m,v);let M;if(this.isTotal(v))M=x[t];else if(this.isSubtotal(v)){M=x[t];for(let D=t-1;D>=0;D-=1)if(this.isSubtotal(S[D])){M=M-x[D];break}}else M=f;const k=this.contextNodeData?.nodeData?.[t],A=this.getItemStyle(k,!1,void 0,k?.itemId);return this.formatTooltipWithContext(c,{heading:this.getAxisValueText(d,"tooltip",y,g,a,h),symbol:this.legendItemSymbol(b),data:[{label:l,fallbackLabel:r,value:this.getAxisValueText(u,"tooltip",M,g,r,h)}]},{seriesId:e,datum:g,title:l,itemId:b,xKey:a,xName:n,yKey:r,yName:l,...A})}legendItemSymbol(t){const{fill:e,stroke:i,fillOpacity:o,strokeOpacity:s,strokeWidth:a,lineDash:n,lineDashOffset:r}=this.getItemConfig(t);return{marker:{fill:e,stroke:i,fillOpacity:o,strokeOpacity:s,strokeWidth:a,lineDash:n,lineDashOffset:r}}}getLegendData(t){if(t!=="category")return[];const{id:e,seriesItemTypes:i}=this,o=[],s=n=>n.charAt(0).toUpperCase()+n.substring(1),{showInLegend:a}=this.properties;return i.forEach(n=>{const{name:r}=this.getItemConfig(n);o.push({legendType:"category",id:e,itemId:n,seriesId:e,enabled:!0,label:{text:r??s(n)},symbol:this.legendItemSymbol(n),hideInLegend:!a,isFixed:!0})}),o}toggleSeriesItem(){}animateEmptyUpdateReady(t){const{datumSelection:e,labelSelection:i,contextData:o}=t,s=FP(VP(this.isVertical(),this.axes,"normal"),"unknown");XP.fromToMotion(this.id,"datums",this.ctx.animationManager,[e],s),GP(this,"labels",this.ctx.animationManager,i);const{pointData:a}=o;a&&(this.isVertical()?this.animateConnectorLinesVertical(t):this.animateConnectorLinesHorizontal(t))}animateConnectorLinesHorizontal(t){const{pointData:e=[]}=t.contextData,[i]=t.paths,{path:o}=i;this.updateLineNode(i);const s=this.getValueAxis(),a=s?.isReversed(),n=a?(h,d)=>h<d:(h,d)=>h>d,r=s?.scale.convert(0),l=e.reduce((h,d)=>(n(d.x,h)&&(h=d.x),h),a?1/0:0),c=(h,d,u,g,y)=>(h-d)/(u-d)*(y-g)+g;this.ctx.animationManager.animate({id:`${this.id}_connectors`,groupId:this.id,phase:"initial",from:r,to:l,ease:Ns.Motion.easeOut,collapsable:!1,onUpdate(h){o.clear(!0),e.forEach((d,u)=>{const g=c(h,r,l,r,d.x),y=c(h,r,l,r,d.x2);u!==0&&o.lineTo(g,d.y),o.moveTo(y,d.y2)}),i.checkPathDirty()},onStop:()=>this.resetConnectorLinesPath(t)})}animateConnectorLinesVertical(t){const{pointData:e=[]}=t.contextData,[i]=t.paths,{path:o}=i;this.updateLineNode(i);const s=this.getValueAxis(),a=s?.isReversed(),n=a?(h,d)=>h>d:(h,d)=>h<d,r=s?.scale.convert(0),l=e.reduce((h,d)=>(n(d.y,h)&&(h=d.y),h),a?0:1/0),c=(h,d,u,g,y)=>(h-d)/(u-d)*(y-g)+g;this.ctx.animationManager.animate({id:`${this.id}_connectors`,groupId:this.id,phase:"initial",from:r,to:l,ease:Ns.Motion.easeOut,collapsable:!1,onUpdate(h){o.clear(!0),e.forEach((d,u)=>{const g=c(h,r,l,r,d.y),y=c(h,r,l,r,d.y2);u!==0&&o.lineTo(d.x,g),o.moveTo(d.x2,y)}),i.checkPathDirty()},onStop:()=>this.resetConnectorLinesPath(t)})}animateReadyResize(t){super.animateReadyResize(t),this.resetConnectorLinesPath(t)}updatePaths(t){this.resetConnectorLinesPath({contextData:t.contextData,paths:t.paths})}resetConnectorLinesPath({contextData:t,paths:e}){if(e.length===0)return;const[i]=e;this.updateLineNode(i);const{path:o}=i;o.clear(!0);const{pointData:s}=t;s&&(s.forEach((a,n)=>{n!==0&&o.lineTo(a.x,a.y),o.moveTo(a.x2,a.y2)}),i.checkPathDirty())}updateLineNode(t){const{stroke:e,strokeWidth:i,strokeOpacity:o,lineDash:s,lineDashOffset:a}=this.properties.line;t.setProperties({fill:void 0,stroke:e,strokeWidth:i,strokeOpacity:o,lineDash:s,lineDashOffset:a,lineJoin:"round",pointerEvents:Ns.PointerEvents.None})}isLabelEnabled(){const{positive:t,negative:e,total:i}=this.properties.item;return t.label.enabled||e.label.enabled||i.label.enabled}onDataChange(){}computeFocusBounds({datumIndex:t}){return YP(this,this.contextNodeData?.nodeData[t])}hasItemStylers(){const{positive:t,negative:e,total:i}=this.properties.item;return t.itemStyler!=null||e.itemStyler!=null||i.itemStyler!=null}};Gl.className="WaterfallSeries",Gl.type="waterfall";import{_ModuleSupport as QP}from"ag-charts-community";import{arrayOfDefs as JP,constant as t1,positiveNumber as e1,required as _a,string as Nn,union as i1}from"ag-charts-core";var{commonSeriesOptionsDefs:o1,waterfallSeriesThemeableOptionsDef:s1}=QP,a1={...s1,...o1,type:_a(t1("waterfall")),xKey:_a(Nn),yKey:_a(Nn),xName:Nn,yName:Nn,totals:JP({totalType:_a(i1("total","subtotal")),index:_a(e1),axisLabel:_a(Nn)},"a total definition options array")};import{_ModuleSupport as id}from"ag-charts-community";var{FILL_GRADIENT_LINEAR_SHADED_DEFAULTS:n1,FILL_IMAGE_DEFAULTS:r1,FILL_PATTERN_DEFAULTS:l1}=id;function od(t,e){return{fill:{$applySwitch:[{$path:"type"},{$if:[{$eq:[{$palette:"type"},"user-indexed"]},{$path:[`/${e}`,{$palette:"fill"},{$palette:"fills"}]},{$palette:`${t}.fill`}]},["gradient",n1(t)],["image",r1],["pattern",l1]]},stroke:{$palette:`${t}.stroke`},strokeWidth:{$isUserOption:["./stroke",2,0]},label:{...id.LABEL_BOXING_DEFAULTS,enabled:!1,fontStyle:void 0,fontWeight:{$ref:"fontWeight"},fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},color:{$ref:"textColor"},formatter:void 0,placement:"outside-end",padding:{$isUserOption:["./spacing",0,6]}}}}var c1={series:{item:{positive:od("altUp",0),negative:od("altDown",1),total:od("neutral",2)},line:{stroke:{$palette:"neutral.stroke"},strokeOpacity:1,lineDash:[0],lineDashOffset:0,strokeWidth:2},highlight:id.singleSeriesHighlightStyle()},legend:{enabled:!0,toggleSeries:!1}},h1={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["cartesian"],identifier:"waterfall",solo:!0,moduleFactory:t=>new Gl(t),defaultAxes:AP.DIRECTION_SWAP_AXES,themeTemplate:c1},xx={type:"series",name:"waterfall",chartType:"cartesian",enterprise:!0,options:a1,create:t=>new Gl(t)},{NewAreaSeriesModule:p1,NewBarSeriesModule:d1,NewBubbleSeriesModule:u1,NewHistogramSeriesModule:g1,NewLineSeriesModule:y1,NewScatterSeriesModule:f1,numberFormatValidator:m1,without:Ge}=UI,Sx={width:ni,height:ni,grip:kn,fill:fl,stroke:fl,strokeWidth:ni,cornerRadius:ni},Ee=["cursor","highlightStyle","listeners","nodeClickRange","showInLegend","showInMiniChart","tooltip","visible","xName","yName"],bx=[...Ee,"errorBar","label","legendItemName","direction"],vx=[...Ee,"direction","legendItemName","minName","q1Name","medianName","q3Name","maxName"],Mx=[...Ee,"title","label","labelKey","labelName","sizeName"],Dx=[...Ee,"title","label","colorName","textAlign","verticalAlign","itemPadding","colorRange"],kx=[...Ee,"label"],Ax=[...Ee,"errorBar","title","label"],Lx=[...Ee,"label","yLowName","yHighName"],Ix=[...Ee,"direction","label","yLowName","yHighName"],Cx=[...Ee,"errorBar","title","label","labelKey","labelName"],Tx=[...Ee,"direction"],x1={enabled:kn,height:ni,spacing:ni,cornerRadius:Gf,mask:{fill:fl,fillOpacity:JI,stroke:fl,strokeWidth:ni},minHandle:Sx,maxHandle:Sx,miniChart:{enabled:kn,padding:{top:ni,bottom:ni},label:{enabled:kn,avoidCollisions:kn,spacing:ni,format:m1,formatter:qI,interval:{minSpacing:ni,maxSpacing:ni,values:XI,step:Gf},...QI},series:ZI(tC({area:Ge(p1.options,[...Ee,"type"]),bar:Ge(d1.options,[...bx,"type"]),"box-plot":Ge(qf.options,[...vx,"type"]),bubble:Ge(u1.options,[...Mx,"type"]),candlestick:Ge(ym.options,[...Ee,"type"]),heatmap:Ge(Cm.options,[...Dx,"type"]),histogram:Ge(g1.options,[...kx,"type"]),line:Ge(y1.options,[...Ax,"type"]),ohlc:Ge(Nm.options,[...Ee,"type"]),"range-area":Ge(Jm.options,[...Lx,"type"]),"range-bar":Ge(dx.options,[...Ix,"type"]),scatter:Ge(f1.options,[...Cx,"type"]),waterfall:Ge(xx.options,[...Tx,"type"])},"miniChart series options"))}},S1=["area","bar","bubble","candlestick","heatmap","histogram","line","ohlc","range-area","range-bar","scatter","waterfall"],b1=["itemStyler","direction","fill","fillGradientDefaults","fillPatternDefaults","fillImageDefaults","fillOpacity","shadow","focusPriority","highlight","lineDash","lineDashOffset","strokeWidth"];function wx(t,e){return{$merge:[{$switch:[e,{},[["area","line","range-area"],{marker:{enabled:{$isUserOption:["/series/$index/marker/enabled",{$path:["/series/$index/marker/enabled",!1]},!1]}}}]]},{$omit:[{$switch:[e,Ee,["bar",bx],["box-plot",vx],["bubble",Mx],["heatmap",Dx],["histogram",kx],["line",[...Ax,...b1]],["range-area",Lx],["range-bar",Ix],["scatter",Cx],["waterfall",Tx]]},t]}]}}var v1={enabled:!1,height:{$if:[{$path:"./miniChart/enabled"},40,18]},cornerRadius:4,mask:{fill:{$ref:"foregroundColor"},fillOpacity:.1,stroke:{$ref:"borderColor"},strokeWidth:1},minHandle:{fill:{$ref:"chartBackgroundColor"},stroke:{$ref:"borderColor"},strokeWidth:1,width:12,height:24,cornerRadius:4},maxHandle:{fill:{$ref:"chartBackgroundColor"},stroke:{$ref:"borderColor"},strokeWidth:1,width:12,height:24,cornerRadius:4},miniChart:{enabled:!1,label:{color:{$ref:"textColor"},fontSize:{$rem:YI.FONT_SIZE_RATIO.SMALLER},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},spacing:5},padding:{top:0,bottom:0},series:{$apply:[wx({$path:"/series/$index"},{$path:["/navigator/miniChart/series/$index/type",{$path:["type",{$path:"/series/$index/type"}]}]}),{$if:[{$or:S1.map(t=>({$eq:[{$path:"/series/0/type"},t]}))},{$map:[wx({$value:"$1"},{$path:"/series/$index/type"}),{$path:"/series"}]},void 0]}]}}},M1={type:"root",optionsKey:"navigator",packageType:"enterprise",chartTypes:["cartesian"],moduleFactory:t=>new Da(t),removable:!1,themeTemplate:{navigator:v1}};import{_ModuleSupport as Nx}from"ag-charts-community";import{_ModuleSupport as D1}from"ag-charts-community";var{ToolbarButtonProperties:k1,Property:A1}=D1,Px=class extends k1{};p([A1],Px.prototype,"value",2);var{ChartAxisDirection:sd,LayoutElement:L1,PropertiesArray:I1,Toolbar:C1,Property:Ex}=Nx,ad=class extends Nx.BaseModuleInstance{constructor(t){super(),this.ctx=t,this.enabled=!1,this.buttons=new I1(Px),this.verticalSpacing=10,this.container=t.domManager.addChild("canvas-overlay","range-buttons"),this.container.role="presentation",this.toolbar=new C1(this.ctx,"ariaLabelRangesToolbar","horizontal"),this.toolbar.addClass("ag-charts-range-buttons"),this.container.append(this.toolbar.getElement()),this.cleanup.register(this.toolbar.addToolbarListener("button-pressed",this.onButtonPress.bind(this)),t.layoutManager.registerElement(L1.ToolbarBottom,this.onLayoutStart.bind(this)),t.eventsHub.on("zoom:change",this.onZoomChanged.bind(this)),this.teardown.bind(this))}teardown(){this.container.removeChild(this.toolbar.getElement()),this.toolbar.destroy()}onLayoutStart(t){const{buttons:e,ctx:i,enabled:o,toolbar:s,verticalSpacing:a}=this,{layoutBox:n}=t;if(!o||!i.zoomManager.isZoomEnabled()){s.setHidden(!0);return}s.setHidden(!1),s.updateButtons(e);const r=s.getBounds().height;s.setBounds({x:n.x,y:n.y+n.height-r,width:n.width,height:r}),n.shrink({bottom:r+a})}onZoomChanged(){this.toolbar.clearActiveButton()}onButtonPress({button:{index:t}}){const{zoomManager:e}=this.ctx,i=this.buttons.at(t);if(!i)return;const{value:o}=i;o==null?e.resetZoom("zoom-buttons"):typeof o=="number"?e.extendToEnd("zoom-buttons",sd.X,o):Array.isArray(o)?e.updateWith("zoom-buttons",sd.X,()=>o):typeof o=="function"&&e.updateWith("zoom-buttons",sd.X,o),this.toolbar.toggleActiveButtonByIndex(t)}};p([Ex],ad.prototype,"enabled",2),p([Ex],ad.prototype,"buttons",2);var _x=1e3*60*60*24,nd=_x*30,T1=_x*365,w1={type:"root",optionsKey:"ranges",packageType:"enterprise",chartTypes:["cartesian"],moduleFactory:t=>new ad(t),themeTemplate:{ranges:{enabled:!1,buttons:{$shallowSimple:[{label:"toolbarRange1Month",ariaLabel:"toolbarRange1MonthAria",value:nd},{label:"toolbarRange3Months",ariaLabel:"toolbarRange3MonthsAria",value:3*nd},{label:"toolbarRange6Months",ariaLabel:"toolbarRange6MonthsAria",value:6*nd},{label:"toolbarRangeYearToDate",ariaLabel:"toolbarRangeYearToDateAria",value:(t,e)=>[new Date(`${new Date(e).getFullYear()}-01-01`).getTime(),void 0]},{label:"toolbarRange1Year",ariaLabel:"toolbarRange1YearAria",value:T1},{label:"toolbarRangeAll",ariaLabel:"toolbarRangeAllAria",value:void 0}]}}}};import{_ModuleSupport as Ox}from"ag-charts-community";var Rx=class nr extends Ox.BaseModuleInstance{constructor(e){super(),this.ctx=e,this.activeSections=new Set,this.sectionButtons={annotations:[],chartToolbar:[]},this.container=this.ctx.domManager.addChild("canvas-overlay","shared-toolbar"),this.container.role="presentation"}getSharedToolbar(e){return this.sharedToolbar||this.createSharedToolbar(),e==="chartToolbar"&&this.sharedToolbar&&this.sharedToolbar.setAriaLabelId("ariaLabelFinancialCharts"),this.toolbarWithSection(e)}createSharedToolbar(){this.sharedToolbar=new Ox.Toolbar(this.ctx,"ariaLabelAnnotationsToolbar","vertical"),this.sharedToolbar.addClass("ag-charts-shared-toolbar"),this.container.append(this.sharedToolbar.getElement()),this.cleanup.register(()=>{this.sharedToolbar&&(this.container.removeChild(this.sharedToolbar.getElement()),this.sharedToolbar.destroy(),this.sharedToolbar=void 0)})}toolbarWithSection(e){const i=this.sharedToolbar,o={layout:(s,a)=>{if(this.firstLayoutSection!=null&&this.firstLayoutSection!==e&&this.activeSections.has(this.firstLayoutSection))return;this.firstLayoutSection=e;const n=i.getBounds().width;i.setBounds({x:s.x,y:s.y,width:n}),s.shrink({left:n+i.horizontalSpacing+(a??0)})},addToolbarListener:(s,a)=>i.addToolbarListener(s,n=>{const r=this.getSectionIndex(e,n.button.index);if(r<0)return;const l={...n,button:this.sectionButtons[e][r]};a(l)}),updateButtons:s=>{this.sectionButtons[e]=s;const a=nr.SECTION_ORDER.flatMap(n=>this.sectionButtons[n]);i.updateButtons(a)},updateButtonByIndex:(s,a)=>{i.updateButtonByIndex(this.getIndex(e,s),a)},toggleActiveButtonByIndex:s=>{i.toggleActiveButtonByIndex(this.getIndex(e,s))},toggleButtonEnabledByIndex:(s,a)=>{i.toggleButtonEnabledByIndex(this.getIndex(e,s),a)},setHidden:s=>{s?this.activeSections.delete(e):this.activeSections.add(e);let a=0;for(const n of nr.SECTION_ORDER){if(n!==e){a+=this.sectionButtons[n].length;continue}for(const r of this.sectionButtons[e].keys())i.setButtonHiddenByIndex(a+r,s)}},destroy:()=>{o.setHidden(!0),this.activeSections.size===0&&this.destroy()},clearActiveButton:i.clearActiveButton.bind(i),addListener:i.addListener.bind(i),removeListener:i.removeListener.bind(i)};return o.setHidden(!1),o}getIndex(e,i){let o=0;for(const s of nr.SECTION_ORDER){if(s===e)return o+i;o+=this.sectionButtons[s].length}return-1}getSectionIndex(e,i){let o=0;for(const s of nr.SECTION_ORDER){if(s===e)return i>=o+this.sectionButtons[e].length?-1:i-o;o+=this.sectionButtons[s].length}return-1}};Rx.SECTION_ORDER=["chartToolbar","annotations"];var N1=Rx,P1={type:"context",contextKey:"sharedToolbar",packageType:"enterprise",chartTypes:["cartesian"],moduleFactory:t=>new N1(t)};import{_ModuleSupport as E1}from"ag-charts-community";import{_ModuleSupport as rd}from"ag-charts-community";import{cachedTextMeasurer as ld,calcLineHeight as _1}from"ag-charts-core";var{ZIndexMap:O1,LayoutElement:R1,Property:ve,BaseProperties:B1,valueProperty:z1,Group:F1,Label:Pn,Rect:V1,Text:qt}=rd,Bx={ohlc:62,candlestick:62,"hollow-candlestick":62,line:96,"step-line":96,hlc:184,"high-low":800},H1={up:"positive",down:"negative"},G1={hlc:"altNeutral"},cd=class extends B1{constructor(){super(...arguments),this.fill="black",this.fillOpacity=1}};p([ve],cd.prototype,"fill",2),p([ve],cd.prototype,"fillOpacity",2);var _e=class extends rd.BaseModuleInstance{constructor(t){super(),this.ctx=t,this.enabled=!1,this.openKey=void 0,this.highKey=void 0,this.lowKey=void 0,this.closeKey=void 0,this.volumeKey=void 0,this.title=new Pn,this.positive=new Pn,this.negative=new Pn,this.neutral=new Pn,this.altNeutral=new Pn,this.background=new cd,this.layoutStyle="block",this.id="status-bar",this.data=void 0,this.layer=new F1({name:"StatusBar",zIndex:O1.STATUS_BAR}),this.labelGroup=this.layer.appendChild(new rd.TranslatableGroup),this.backgroundNode=this.labelGroup.appendChild(new V1),this.labels=[{label:"O",configuration:2,title:this.labelGroup.appendChild(new qt),value:this.labelGroup.appendChild(new qt),id:"openValue",key:"openKey",domain:void 0,formatter:new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})},{label:"H",configuration:16,title:this.labelGroup.appendChild(new qt),value:this.labelGroup.appendChild(new qt),id:"highValue",key:"highKey",domain:void 0,formatter:new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})},{label:"H",configuration:256,title:this.labelGroup.appendChild(new qt),value:this.labelGroup.appendChild(new qt),style:"neutral",id:"highValue",key:"highKey",domain:void 0,formatter:new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})},{label:"L",configuration:8,title:this.labelGroup.appendChild(new qt),value:this.labelGroup.appendChild(new qt),id:"lowValue",key:"lowKey",domain:void 0,formatter:new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})},{label:"L",configuration:512,title:this.labelGroup.appendChild(new qt),value:this.labelGroup.appendChild(new qt),style:"neutral",id:"lowValue",key:"lowKey",domain:void 0,formatter:new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})},{label:"C",configuration:4,title:this.labelGroup.appendChild(new qt),value:this.labelGroup.appendChild(new qt),id:"closeValue",key:"closeKey",domain:void 0,formatter:new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})},{label:"C",configuration:128,title:this.labelGroup.appendChild(new qt),value:this.labelGroup.appendChild(new qt),id:"closeValue",key:"closeKey",style:"neutral",domain:void 0,formatter:new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})},{label:"",configuration:64,title:this.labelGroup.appendChild(new qt),value:this.labelGroup.appendChild(new qt),style:"neutral",id:"closeValue",key:"closeKey",domain:void 0,formatter:new Intl.NumberFormat("en-US",{notation:"compact",minimumFractionDigits:2,maximumFractionDigits:2})},{label:"Vol",configuration:32,title:this.labelGroup.appendChild(new qt),value:this.labelGroup.appendChild(new qt),id:"volumeValue",key:"volumeKey",domain:void 0,formatter:new Intl.NumberFormat("en-US",{notation:"compact",minimumFractionDigits:2,maximumFractionDigits:2})}],this.highlightManager=t.highlightManager,this.labelGroup.visible=!1,this.cleanup.register(t.scene.attachNode(this.layer),t.layoutManager.registerElement(R1.Overlay,e=>this.startPerformLayout(e)),t.eventsHub.on("layout:complete",e=>this.onLayoutComplete(e)),t.eventsHub.on("highlight:change",()=>this.updateHighlight()))}async processData(t){if(!this.enabled||this.data==null)return;const e=[];for(const s of this.labels){const{id:a,key:n}=s,r=this[n];r==null?s.domain=void 0:e.push(z1(r,"number",{id:a}))}if(e.length===0)return;const{processedData:i,dataModel:o}=await t.request(this.id,this.data,{props:e});for(const s of this.labels){const{id:a,key:n}=s;this[n]!=null&&(s.domain=o.getDomain(this,a,"value",i))}}startPerformLayout(t){if(this.labelGroup.translationX=0,this.labelGroup.translationY=0,!this.enabled)return;const{layoutBox:e}=t,i=4,o=12,s=0,a=8;this.labelGroup.translationY=e.y+s;const n=Math.max(this.title.fontSize,this.positive.fontSize,this.negative.fontSize),r=_1(n),l=Bx[this.getChartType()]??0;let c=0,h,d="alphabetic";if(this.layoutStyle==="block")e.shrink(s+r+a,"top"),h=n+(r-n)/2;else{const{title:u}=this.ctx.chartService;if(d="top",h=s+u.padding,u.enabled){const g=u.node.getBBox();c=g.x+g.width+o}else c=u.padding}for(const{label:u,configuration:g,title:y,value:f,domain:x,formatter:S}of this.labels){if(x==null||!(l&g)){y.visible=!1,f.visible=!1;continue}const v=ld(this.positive),m=ld(this.negative),b=Math.max(v.textWidth(S.format(x[0])),v.textWidth(S.format(x[1])),m.textWidth(S.format(x[0])),m.textWidth(S.format(x[1])));y.visible=!0,f.visible=!0;const M=ld(this.title).measureText(u);y.setFont(this.title),y.fill=this.title.color,y.text=u,y.textBaseline=d,y.y=h,y.x=c,c+=M.width+i,f.textBaseline=d,f.y=h,f.x=c,c+=b+o}this.backgroundNode.x=0,this.backgroundNode.y=0,this.backgroundNode.width=c-o,this.backgroundNode.height=r+s+a,this.backgroundNode.fill=this.background.fill,this.backgroundNode.fillOpacity=this.background.fillOpacity}onLayoutComplete(t){this.labelGroup.translationX=t.series.rect.x,this.updateHighlight()}updateHighlight(){if(!this.enabled)return;const t=this.highlightManager.getActiveHighlight(),e=t?.datum??this.data?.at(-1);if(e==null){this.labelGroup.visible=!1;return}this.labelGroup.visible=!0;const i=t?.itemId;let o=i!=null?H1[i]:void 0;o==null&&this.openKey!=null&&this.closeKey!=null&&(e[this.openKey]<e[this.closeKey]?o="positive":o="negative");for(const{domain:s,value:a,key:n,formatter:r,style:l}of this.labels){if(s==null)continue;let c=l??o??"neutral";c==="neutral"&&(c=G1[this.getChartType()]??c);const h=this[n],d=h!=null?e?.[h]:void 0;a.setFont(this[c]),a.fill=this[c].color,a.text=typeof d=="number"?r.format(d):""}}getChartType(){let t=this.ctx.chartService.publicApi?.getOptions()?.chartType;return(t==null||Bx[t]==null)&&(t="candlestick"),t}};p([ve],_e.prototype,"enabled",2),p([ve],_e.prototype,"openKey",2),p([ve],_e.prototype,"highKey",2),p([ve],_e.prototype,"lowKey",2),p([ve],_e.prototype,"closeKey",2),p([ve],_e.prototype,"volumeKey",2),p([ve],_e.prototype,"title",2),p([ve],_e.prototype,"positive",2),p([ve],_e.prototype,"negative",2),p([ve],_e.prototype,"neutral",2),p([ve],_e.prototype,"altNeutral",2),p([ve],_e.prototype,"background",2),p([ve],_e.prototype,"layoutStyle",2);var W1={type:"root",identifier:"status-bar",optionsKey:"statusBar",packageType:"enterprise",chartTypes:["cartesian"],moduleFactory:t=>new _e(t),themeTemplate:{statusBar:{enabled:!1,layoutStyle:E1.ThemeSymbols.DEFAULT_CAPTION_LAYOUT_STYLE,title:{color:{$ref:"textColor"},fontFamily:{$ref:"fontFamily"},fontSize:{$ref:"fontSize"},fontWeight:{$ref:"fontWeight"}},positive:{color:{$palette:"up.stroke"},fontFamily:{$ref:"fontFamily"},fontSize:{$ref:"fontSize"},fontWeight:{$ref:"fontWeight"}},negative:{color:{$palette:"down.stroke"},fontFamily:{$ref:"fontFamily"},fontSize:{$ref:"fontSize"},fontWeight:{$ref:"fontWeight"}},neutral:{color:{$palette:"neutral.stroke"},fontFamily:{$ref:"fontFamily"},fontSize:{$ref:"fontSize"},fontWeight:{$ref:"fontWeight"}},background:{fill:{$ref:"chartBackgroundColor"},fillOpacity:.5},altNeutral:{color:"gray",fontFamily:{$ref:"fontFamily"},fontSize:{$ref:"fontSize"},fontWeight:{$ref:"fontWeight"}}}}};import{_ModuleSupport as zx}from"ag-charts-community";import{AsyncAwaitQueue as K1,Logger as Fx,arraysEqual as hd,isDate as $1,isDefined as j1,isFiniteNumber as Wl,unique as Vx}from"ag-charts-core";import{clamp as Y1,isNumberEqual as Hx}from"ag-charts-core";var li=0,ye=1,Es=ye-li,Gx="end",Wx="middle",Kl=(t,e=li,i=ye)=>Y1(e,t,i);function pd(){return{x:{min:li,max:ye},y:{min:li,max:ye}}}function Qt(t){return t.x.max-t.x.min}function We(t){return t.y.max-t.y.min}function Kx(t,e){return Hx(t.min,e.min)&&Hx(t.max,e.max)}function En(t,e){return Kx(t.x,e.x)&&Kx(t.y,e.y)}function dd(t){return En(t,pd())}function ae(t){return{x:{min:t?.x?.min??li,max:t?.x?.max??ye},y:{min:t?.y?.min??li,max:t?.y?.max??ye}}}function mo(t,e,i){if(!t)return{x:0,y:0};const o=Kl(e-t.x,0,t.x+t.width),s=Kl(i-t.y,0,t.y+t.height),a=1/t.width*o,n=1-1/t.height*s;return{x:Kl(a),y:Kl(n)}}function _s(t,e,i){return{x:{min:t.x.min+e,max:t.x.max+e},y:{min:t.y.min+i,max:t.y.max+i}}}function $l(t,e,i){return{x:{min:t.x.min,max:t.x.min+Qt(t)*e},y:{min:t.y.min,max:t.y.min+We(t)*i}}}function $x(t,e,i){const o=Qt(t),s=We(t),a=t.x.min+o/2,n=t.y.min+s/2;return{x:{min:a-o*e/2,max:a+o*e/2},y:{min:n-s*i/2,max:n+s*i/2}}}function Ke(t,e,i,o){const{min:s,max:a}=e,n=s+(a-s)/2,r=t.max-t.min;switch(i){case"start":return{min:s,max:e.min+r};case"end":return{min:e.max-r,max:a};case"middle":return{min:n-r/2,max:n+r/2};case"pointer":return U1(t,e,o??n);default:return{min:s,max:a}}}function U1(t,e,i){const o=t.max-t.min,s=e.max-e.min,a=i*(1-(s-o)),n=i-a,r=t.min+n,l=t.max+n;return{min:r,max:l}}function X1(t,e,i){return{x:{min:t.x.min*e,max:t.x.max*e},y:{min:t.y.min*i,max:t.y.max*i}}}function ci(t){return{x:jl(t.x),y:jl(t.y)}}function jl(t){const e=t.max-t.min;let i=t.max>ye?ye-e:t.min,o=t.min<li?e:t.max;return i=Math.max(li,i),o=Math.min(ye,o),{min:i,max:o}}var{BaseProperties:Z1,CartesianAxis:ud,ChartAxisDirection:Os,ContinuousScale:gd,TimeScale:q1,UnitTimeScale:Q1,ChartUpdateType:Yl,ObserveChanges:Oa,TooltipManager:J1,Property:Ra,findMinMax:Ul,isObjectWithStringProperty:tE}=zx,Di=zx.Debug.create("sync");function jx(t,e,i){const o=t.getKeys(e),s=t.getKeys(i);return t.shouldFlipXY?.()?[s,o]:[o,s]}function yd(t="x"){switch(t){case"x":return[Os.X];case"y":return[Os.Y];case"xy":return[Os.X,Os.Y]}}function Yx(t,e,i){return q1.is(t)||Q1.is(t)?!hd(e.map(o=>o?.valueOf()),i.map(o=>o?.valueOf())):!hd(e,i)}var jo=class extends Z1{constructor(t){super(),this.moduleContext=t,this.enabled=!1,this.axes="x",this.nodeInteraction=!0,this.zoom=!0,this.domainMode="key",this.domainSync=new K1}updateSiblings(t){const{syncManager:e}=this.moduleContext;for(const i of e.getGroupSiblings(t??this.groupId))Di("ChartSync.updateSiblings()",i.id,i),this.updateChart(i)}updateChart(t,e=Yl.PROCESS_DOMAIN){Di("ChartSync.updateChart()",t.id,Yl[e],t),e===Yl.PROCESS_DOMAIN?t.ctx.updateService.update(e,{forceNodeDataRefresh:!0}):t.ctx.updateService.update(e)}enabledZoomSync(){const{eventsHub:t}=this.moduleContext;this.disableZoomSync?.(),this.disableZoomSync=t.on("zoom:change",this.onZoom.bind(this))}onZoom(){const{syncManager:t}=this.moduleContext;for(const e of t.getGroupSiblings(this.groupId)){if(!e.modulesManager.getModule("sync")?.zoom)continue;const i=e.modulesManager.getModule("zoom");if(!i)continue;const o=this.prepareZoomUpdate();Di("ChartsSyncManager.enabledZoomSync()",e.id,o),i.updateSyncZoom(o)}}enabledNodeInteractionSync(){this.disableNodeInteractionSync?.(),this.disableNodeInteractionSync=this.moduleContext.eventsHub.on("highlight:change",this.onHighlightChange.bind(this))}onHighlightChange(t){const{syncManager:e}=this.moduleContext;if(t.callerId.endsWith("-sync"))return;Di("ChartSync.onHighlightChange()",t);const i=t.currentHighlight?.series,[o]=yd(this.axes),s=o===Os.X?Os.Y:Os.X,[a,n]=i?jx(i,o,s):[],r=bn(t.currentHighlight);let l=a?.[0]?r?.[a[0]]:void 0,c=!1;if($1(l)&&(c=!0,l=l.getTime()),!t.currentHighlight?.datum){for(const d of e.getGroupSiblings(this.groupId))d.modulesManager.getModule("sync")?.nodeInteraction&&(d.ctx.highlightManager.updateHighlight(`${d.id}-sync`),d.ctx.tooltipManager.removeTooltip(`${d.id}-sync`));return}const h=e.getGroupSyncMode(this.groupId)==="multi-series";this.findMatchingHighlightNodes(o,s,h?n:[],c,l,t)}findMatchingHighlightNodes(t,e,i,o,s,a){const{syncManager:n}=this.moduleContext;Di("ChartSync.findMatchingHighlightNodes()",{mainDirection:t,secondaryKeys:i});for(const r of n.getGroupSiblings(this.groupId)){if(!r.modulesManager.getModule("sync")?.nodeInteraction)continue;let l=!1;for(const c of r.axes){if(!ud.is(c)||c.direction!==t)continue;const h=r.series.filter(d=>{if(!d.visible)return!1;if(i.length>0){const[,u]=jx(d,t,e);return i.every(g=>u.includes(g))}return!0}).map(this.findMatchingNodes(c,t,o,s)).filter(j1);if(h.length===1&&h[0]?.nodeDatum!==r.ctx.highlightManager.getActiveHighlight()){this.dispatchHighlightUpdate(r,h[0].nodeDatum),l=!0;break}}l||(Di("ChartSync.findMatchingHighlightNodes() - no matching nodes",r.id,a),this.dispatchHighlightUpdate(r))}}findMatchingNodes(t,e,i,o){return s=>{const a=s.getKeys(t.direction);if(t.keys.length&&!t.keys.some(d=>a.includes(d)))return;const n=s.contextNodeData?.nodeData??[];if(!n?.length)return;const r=n[0],l=`${e}Key`;if(!tE(r,l))return;const c=r[l],h=n.find(d=>{const u=d.datum[c];return i?u.getTime()===o:u===o});return h?{series:s,nodeDatum:h}:null}}dispatchHighlightUpdate(t,e){Di("ChartSync.dispatchHighlightUpdate()",t.id,e),t.ctx.highlightManager.updateHighlight(`${t.id}-sync`,e);const i=e?.series.tooltipEnabled??t.tooltip.enabled;if(e&&i){const o=t.seriesAreaBoundingBox,s=o.x+(e.midPoint?.x??e.point?.x??0),a=o.y+(e.midPoint?.y??e.point?.y??0),n=J1.makeTooltipMeta({type:"pointermove",canvasX:s,canvasY:a},e.series,e,void 0);t.ctx.tooltipManager.updateTooltip(`${t.id}-sync`,n,t.getTooltipContent(e.series,e.datumIndex,e,"tooltip"))}else t.ctx.tooltipManager.removeTooltip(`${t.id}-sync`);this.updateChart(t,Yl.SERIES_UPDATE)}async getSyncedDomain(t){if(!ud.is(t)||this.axes!=="xy"&&this.axes!==t.direction)return;const{groupState:e,directionDomains:i,domainsByKey:o,positionDomains:s}=this.updateDomainState(t);return this.validateAxis(t,e),await this.waitForDomainsToBeReady(),this.domainMode==="position"?this.calculateDerivedDomain(t,s):this.domainMode==="direction"||t.keys.length===0?this.calculateDerivedDomain(t,i):this.calculateKeyDerivedDomain(t,o)}updateDomainState(t){var e,i,o,s,a;const{syncManager:n}=this.moduleContext,r=n.getChart().id,l=t.id,c=n.getGroupState(this.groupId);if(!c)throw new Error("AG Charts - no GroupState for groupId: "+this.groupId);const h=c.domains??(c.domains={}),d=h[e=t.direction]??(h[e]={derived:[],sources:{},dirty:!0}),u=(i=d.sources)[r]??(i[r]={});u[l]=t.dataDomain.domain,d.dirty=!0;const g=c.domainsByKey??(c.domainsByKey={});for(const S of t.keys??[]){const v=g[S]??(g[S]={derived:[],sources:{},dirty:!0}),m=(o=v.sources)[r]??(o[r]={});m[l]=t.dataDomain.domain,v.dirty=!0}const y=c.domainsByPosition??(c.domainsByPosition={}),f=y[s=t.position]??(y[s]={derived:[],sources:{},dirty:!0}),x=(a=f.sources)[r]??(a[r]={});return x[l]=t.dataDomain.domain,f.dirty=!0,{groupState:c,directionDomains:d,domainsByKey:g,positionDomains:f}}validateAxis(t,e){const i=this.moduleContext.syncManager.getGroupSyncMode(this.groupId)==="multi-series";yd(this.axes).includes(t.direction)&&(i?this.validateMultiSeries(t,e):this.validateSingleSeries(t,e))}validateMultiSeries(t,e){const{min:i,max:o,nice:s,reverse:a}=t,n=new Set(t.boundSeries.flatMap(r=>r.getKeys(t.direction)));for(const r of e.members){const{axes:l,modulesManager:c}=r,h=yd(c.getModule("sync")?.axes),d=l.filter(g=>h.includes(g.direction)).filter(g=>g.boundSeries.some(y=>y.getKeys(g.direction).some(f=>n.has(f))));if(d.length===0)continue;const[u]=d;if(u.min!==i||u.max!==o||u.nice!==s||u.reverse!==a){Fx.warnOnce("To allow synchronization, ensure that all synchronized axes with matching keys have matching min, max, nice, and reverse properties."),this.enabled=!1;return}}}validateSingleSeries(t,e){const i=e.members,[{axes:o}]=i,{direction:s,min:a,max:n,nice:r,reverse:l}=t;for(const c of o)if(s===c.direction&&(r!==c.nice||l!==c.reverse||a!==c.min&&(Wl(a)||Wl(c.min))||n!==c.max&&(Wl(n)||Wl(c.max)))){Fx.warnOnce("To allow synchronization, ensure that all charts have matching min, max, nice, and reverse properties on the synchronized axes."),this.enabled=!1;return}}calculateDerivedDomain(t,e){if(!e.dirty)return e.derived;const i=e.derived;return e.derived=Vx(Object.values(e.sources).map(o=>Object.values(o)).flat(2)),gd.is(t.scale)&&(e.derived=Ul(e.derived)),e.dirty=!1,Yx(t.scale,i,e.derived)&&(Di(t.id,"updated",t.keys,{before:i,after:e.derived}),this.updateSiblings()),e.derived}calculateKeyDerivedDomain(t,e){let i=[],o=[],s=!1;for(const a of t.keys??[]){const n=e[a],r=n.derived;if(i.push(...r),!n.dirty){o.push(...n.derived);continue}n.derived=Vx(Object.values(n.sources).map(l=>Object.values(l)).flat(2)),gd.is(t.scale)&&(n.derived=Ul(n.derived)),o.push(...n.derived),n.dirty=!1,s||(s=!hd(r,n.derived))}return gd.is(t.scale)&&(i=Ul(i),o=Ul(o)),s&&Yx(t.scale,i,o)&&(Di(t.id,"updated",t.keys,{before:i,after:o}),this.updateSiblings()),o}removeAxis(t){if(!ud.is(t)||this.axes!=="xy"&&this.axes!==t.direction)return;const{syncManager:e}=this.moduleContext,i=e.getGroupState(this.groupId),o=e.getChart().id,s=t.id;delete i?.domains?.[t.direction]?.sources?.[o]?.[s];for(const a of t.keys??[])delete i?.domainsByKey?.[a]?.sources?.[o]?.[s];delete i?.domainsByPosition?.[t.position]?.sources?.[o]?.[s]}async waitForDomainsToBeReady(){const{syncManager:t}=this.moduleContext;let e=0;for(;t.getGroupMembers(this.groupId).some(i=>i.syncStatus==="init");)Di("ChartSync.waitForDomainsToBeReady() - waiting for all domains to be calculated",this.groupId),await this.domainSync.await(),e++;e>0&&Di("ChartSync.waitForDomainsToBeReady() - waited for",e,"iterations"),this.domainSync.notify()}prepareZoomUpdate(){const{zoomManager:t}=this.moduleContext,e=t.getZoom();return this.axes==="x"?delete e?.y:this.axes==="y"&&delete e?.x,ae(e)}onEnabledChange(){const{syncManager:t}=this.moduleContext;this.enabled?t.subscribe(this.groupId):t.unsubscribe(this.groupId),this.updateSiblings(),this.onNodeInteractionChange(),this.onZoomChange()}onGroupIdChange(t,e){if(!this.enabled||t===e)return;const{syncManager:i}=this.moduleContext;i.unsubscribe(e),i.subscribe(t),this.updateSiblings(e),this.updateSiblings(t)}onAxesChange(){if(!this.enabled)return;const{syncManager:t}=this.moduleContext;this.updateChart(t.getChart())}onNodeInteractionChange(){this.enabled&&this.nodeInteraction?this.enabledNodeInteractionSync():this.disableNodeInteractionSync?.()}onZoomChange(){this.enabled&&this.zoom?this.enabledZoomSync():this.disableZoomSync?.()}destroy(){const{syncManager:t}=this.moduleContext;t.unsubscribe(this.groupId),this.updateSiblings(),this.disableZoomSync?.()}};jo.className="Sync",p([Ra,Oa(t=>t.onEnabledChange())],jo.prototype,"enabled",2),p([Ra,Oa((t,e,i)=>t.onGroupIdChange(e,i))],jo.prototype,"groupId",2),p([Ra,Oa(t=>t.onAxesChange())],jo.prototype,"axes",2),p([Ra,Oa(t=>t.onNodeInteractionChange())],jo.prototype,"nodeInteraction",2),p([Ra,Oa(t=>t.onZoomChange())],jo.prototype,"zoom",2),p([Ra,Oa(t=>t.onAxesChange())],jo.prototype,"domainMode",2);var eE={type:"root",optionsKey:"sync",packageType:"enterprise",chartTypes:["cartesian"],moduleFactory:t=>new jo(t),themeTemplate:{sync:{enabled:!1}}};import{_ModuleSupport as Yo}from"ag-charts-community";import{debounce as iE,entries as fd,roundTo as oE}from"ag-charts-core";import{_ModuleSupport as md}from"ag-charts-community";var{Property:Ux}=md,Xx="#2196f3",sE="#8a8a8a",Xl=class extends md.Rect{constructor(){super(...arguments),this.fill=Xx,this.fillOpacity=.2,this.zIndex=md.ZIndexMap.ZOOM_SELECTION}updateValid(){this.fill=Xx}updateInvalid(){this.fill=sE}};Xl.className="ZoomRect",p([Ux],Xl.prototype,"fill",2),p([Ux],Xl.prototype,"fillOpacity",2);import{_ModuleSupport as xd}from"ag-charts-community";var aE=class{update(t,e,i,o,s,a){return this.oldZoom??(this.oldZoom=ae(e===xd.ChartAxisDirection.X?{...s,x:a}:{...s,y:a})),this.updateCoords(t.offsetX,t.offsetY),this.updateZoom(e,i,o)}stop(){this.coords=void 0,this.oldZoom=void 0}updateCoords(t,e){this.coords?(this.coords.x2=t,this.coords.y2=e):this.coords={x1:t,y1:e,x2:t,y2:e}}updateZoom(t,e,i){const{coords:o,oldZoom:s}=this;let a=ae(s);if(!o||!s)return t===xd.ChartAxisDirection.X?a.x:a.y;const n=mo(i,o.x1,o.y1),r=mo(i,o.x2,o.y2);if(t===xd.ChartAxisDirection.X){const c=(r.x-n.x)*Qt(s);return a.x.max+=c,a.x=Ke(a.x,s.x,e,n.x),a=ci(a),a.x}const l=(r.y-n.y)*We(s);return a.y.max-=l,a.y=Ke(a.y,s.y,e,n.y),a=ci(a),a.y}},nE=class{constructor(t,e,i,o,s,a,n,r){this.eventsHub=t,this.contextMenuRegistry=e,this.zoomManager=i,this.getModuleProperties=o,this.canResetZoom=s,this.getRect=a,this.updateZoom=n,this.isZoomValid=r}registerActions(t){const{contextMenuRegistry:e}=this;if(t)e.setVisible("zoom-to-cursor",!0),e.setVisible("pan-to-cursor",!0),e.setVisible("reset-zoom",!0);else{e.setVisible("zoom-to-cursor",!1),e.setVisible("pan-to-cursor",!1),e.setVisible("reset-zoom",!1);return}e.builtins.items["zoom-to-cursor"].action=this.onZoomToHere.bind(this),e.builtins.items["pan-to-cursor"].action=this.onPanToHere.bind(this),e.builtins.items["reset-zoom"].action=this.onResetZoom.bind(this);const i=a=>{const n=this.getRect();if(!n)return!0;const r=mo(n,a.x,a.y);return this.iterateFindNextZoomAtPoint(r)!=null},o=()=>!En(ae(this.zoomManager.getZoom()),pd()),s=this.eventsHub.on("context-menu:setup",a=>{e.builtins.items["zoom-to-cursor"].enabled=i(a),e.builtins.items["pan-to-cursor"].enabled=o(),e.builtins.items["reset-zoom"].enabled=this.canResetZoom()});return()=>{s(),e.setVisible("zoom-to-cursor",!1),e.setVisible("pan-to-cursor",!1),e.setVisible("reset-zoom",!1)}}computeOrigin(t){const e=this.getRect(),{enabled:i}=this.getModuleProperties();if(!i||!e||!t?.target||!(t instanceof MouseEvent))return;const o={x:0,y:0,width:e.width,height:e.height};return mo(o,t.offsetX,t.offsetY)}onZoomToHere({event:t}){const e=this.computeOrigin(t);if(!e)return;const i=this.iterateFindNextZoomAtPoint(e);i!=null&&this.updateZoom(i)}onPanToHere({event:t}){const e=this.computeOrigin(t);if(!e)return;const i=ae(this.zoomManager.getZoom()),o=Qt(i),s=We(i),a=e.x*o,n=e.y*s,r=Es/2;let l={x:{min:e.x-r,max:e.x+r},y:{min:e.y-r,max:e.y+r}};l=$x(l,o,s),l=_s(l,i.x.min-e.x+a,i.y.min-e.y+n),this.updateZoom(ci(l))}onResetZoom(t){this.zoomManager.resetZoom("zoom")}iterateFindNextZoomAtPoint(t){const{scrollingStep:e}=this.getModuleProperties();for(let i=e;i<=1-e;i+=e){const o=this.getNextZoomAtPoint(t,i);if(this.isZoomValid(o))return o}}getNextZoomAtPoint(t,e){const{isScalingX:i,isScalingY:o}=this.getModuleProperties(),s=ae(this.zoomManager.getZoom()),a=t.x*Qt(s),n=t.y*We(s),r=Es/2;let l={x:{min:t.x-r,max:t.x+r},y:{min:t.y-r,max:t.y+r}};return l=$x(l,i?Qt(s)*e:Es,o?We(s)*e:Es),l=_s(l,s.x.min-t.x+a,s.y.min-t.y+n),ci(l)}};import{_ModuleSupport as rE}from"ag-charts-community";import{boxEmpty as lE}from"ag-charts-core";var{ChartAxisDirection:Zx}=rE,cE=class{constructor(t){this.axesHandlers=t,this.axes=[]}destroy(){this.axes.forEach(t=>t.div.destroy())}update(t,e,i){if(this.axes.forEach(l=>l.div.setHidden(!t&&!e)),!t&&!e)return;const{X:o,Y:s}=Zx,a=[...i.axisManager.getAxisContext(o),...i.axisManager.getAxisContext(s)],{removed:n,added:r}=this.diffAxisIds(a);n.length>0&&(this.axes=this.axes.filter(l=>n.includes(l.axisId)?(l.div.destroy(),!1):!0));for(const l of r){const{axisId:c,direction:h}=l;this.axes.push(this.initAxis(i,c,this.axesHandlers,h))}for(const l of this.axes){const h=a.find(d=>d.axisId===l.axisId).getCanvasBounds();l.div.setHidden(lE(h)),h!==void 0&&l.div.setBounds(h)}}setAxisCursor(t){this.cursor=t;for(const e of this.axes)e.div.setCursor(this.getCursor(e.direction))}toggleAxisDraggingCursor(t,e){for(const i of this.axes)i.direction===t&&i.div.setCursor(e?this.getCursor(t):void 0)}getCursor(t){return this.cursor?this.cursor:t===Zx.X?"ew-resize":"ns-resize"}initAxis(t,e,i,o){const s="afterend",a=t.proxyInteractionService.createProxyElement({type:"region",domManagerId:e,where:s});return a.setCursor(this.getCursor(o)),a.addListener("drag-start",n=>{n.device==="touch"&&n.sourceEvent.preventDefault(),i.onAxisDragStart(o)}),a.addListener("drag-move",n=>i.onAxisDragMove(e,o,n)),a.addListener("drag-end",i.onAxisDragEnd),a.addListener("dblclick",()=>i.onAxisDoubleClick(e,o)),a.addListener("wheel",n=>i.onAxisWheel(e,o,n)),{axisId:e,div:a,direction:o}}diffAxisIds(t){const e=this.axes.map(a=>a.axisId),i=t.map(a=>a.axisId),o=e.filter(a=>!i.includes(a)),s=t.filter(a=>!e.includes(a.axisId));return{removed:o,added:s}}};import{_ModuleSupport as qx}from"ag-charts-community";import{entries as hE,getWindow as pE}from"ag-charts-core";var Qx=16,dE={off:1,short:.01,long:.002},uE=class{constructor(){this.deceleration=1,this.zoomCoordsHistoryIndex=0,this.coordsHistory=[]}get decelerationValue(){const{deceleration:t}=this;return Math.max(typeof t=="number"?t:dE[t]??1,1e-4)}addListener(t,e){return this.onUpdate=e,()=>{this.onUpdate=void 0}}stopInteractions(){this.inertiaHandle!=null&&(cancelAnimationFrame(this.inertiaHandle),this.inertiaHandle=void 0)}update(t){this.updateCoords(t.currentX,t.currentY);const{x1:e=0,y1:i=0,x2:o=0,y2:s=0}=this.coords??{};this.onUpdate?.({type:"update",deltaX:this.isPanningX()?e-o:0,deltaY:this.isPanningY()?i-s:0})}start(t){this.direction=t,this.coordsMonitorTimeout=setInterval(this.recordCurrentZoomCoords.bind(this),16)}stop(){const{coordsHistory:t}=this;let e=0,i=0,o=0;if(t.length>0){const s=this.zoomCoordsHistoryIndex%Qx;let a=s-1;a<0&&(a=t.length-1);let n=s;n>=t.length&&(n=0);const r=t[a],l=t[n];e=this.isPanningX()?r.x-l.x:0,i=this.isPanningY()?r.y-l.y:0,o=r.t-l.t}if(this.coords=void 0,this.direction=void 0,clearInterval(this.coordsMonitorTimeout),this.coordsMonitorTimeout=void 0,this.zoomCoordsHistoryIndex=0,this.coordsHistory.length=0,o>0&&this.decelerationValue<1){const s=e/o,a=i/o,n=Math.hypot(s,a),r=Math.atan2(a,s),l=performance.now();this.inertiaHandle=pE().requestAnimationFrame(c=>{this.animateInertia(c,c,l,n,r)})}}recordCurrentZoomCoords(){const{coords:t,coordsHistory:e,zoomCoordsHistoryIndex:i}=this;if(!t)return;const{x2:o,y2:s}=t,a=Date.now();e[i%Qx]={x:o,y:s,t:a},this.zoomCoordsHistoryIndex+=1}animateInertia(t,e,i,o,s){const a=1-this.decelerationValue,n=-o/Math.log(a),r=o*(a**(e-i)-1)/Math.log(a),l=o*(a**(t-i)-1)/Math.log(a);this.onUpdate?.({type:"update",deltaX:this.isPanningX()?-Math.cos(s)*(l-r):0,deltaY:this.isPanningY()?-Math.sin(s)*(l-r):0}),!(l>=n-1)&&(this.inertiaHandle=requestAnimationFrame(c=>{this.animateInertia(c,t,i,o,s)}))}updateCoords(t,e){this.coords?this.coords={x1:this.coords.x2,y1:this.coords.y2,x2:t,y2:e}:this.coords={x1:t,y1:e,x2:t,y2:e}}isPanningX(){return this.direction==null||this.direction===qx.ChartAxisDirection.X}isPanningY(){return this.direction==null||this.direction===qx.ChartAxisDirection.Y}translateZooms(t,e,i,o){const s=mo(t,t.x+Math.abs(i),t.y+t.height-Math.abs(o)),a=Math.sign(i)*s.x,n=-Math.sign(o)*s.y,r={};for(const[l,{direction:c,zoom:h}]of hE(e)){if(h&&h.min===li&&h.max===ye)continue;let d=ae({[c]:h});d=ci(_s(d,a*Qt(d),n*We(d))),r[l]={direction:c,zoom:d[c]}}return r}};import{_ModuleSupport as gE}from"ag-charts-community";import{entries as yE}from"ag-charts-core";var fE=200,mE=class{update(t,e,i,o){const s=t.deltaX*e*fE;return this.translateZooms(i,o,s)}translateZooms(t,e,i){const o={},s=mo(t,t.x+Math.abs(i),0),a=i<0?-s.x:s.x;for(const[n,{direction:r,zoom:l}]of yE(e)){if(r!==gE.ChartAxisDirection.X)continue;let c=ae({x:l});c=ci(_s(c,a*Qt(c),0)),o[n]={direction:r,zoom:c.x}}return o}};import{_ModuleSupport as Jx}from"ag-charts-community";import{entries as xE}from"ag-charts-core";var SE=class{updateAxes(t,e,i,o){const s=t.sourceEvent,a={},{anchorPointX:n,anchorPointY:r,isScalingX:l,isScalingY:c,scrollingStep:h}=e,d=mo(i,s.offsetX??s.clientX,s.offsetY??s.clientY);for(const[u,{direction:g,zoom:y}]of xE(o)){if(y==null)continue;let f={...y};const x=h*t.deltaY*(y.max-y.min);if(g===Jx.ChartAxisDirection.X&&l)f.max+=x,f=Ke(f,y,n,d.x);else if(g===Jx.ChartAxisDirection.Y&&c)f.max+=x,f=Ke(f,y,r,d.y);else continue;f.max<f.min||(a[u]={direction:g,zoom:jl(f)})}return a}update(t,e,i,o){const{anchorPointX:s,anchorPointY:a,isScalingX:n,isScalingY:r,scrollingStep:l}=e,c=t.offsetX+i.x,h=t.offsetY+i.y,d=mo(i,c,h),u=t.deltaY;let g=ae(o);if(g.x.max+=n?l*u*Qt(o):0,g.y.max+=r?l*u*We(o):0,!(g.x.max<g.x.min||g.y.max<g.y.min))return n&&(g.x=Ke(g.x,o.x,s,d.x)),r&&(g.y=Ke(g.y,o.y,a,d.y)),g=ci(g),g}updateDelta(t,e,i){const{anchorPointX:o,anchorPointY:s,isScalingX:a,isScalingY:n,scrollingStep:r}=e;let l=ae(i);return l.x.max+=a?r*-t*Qt(i):0,l.y.max+=n?r*-t*We(i):0,a&&(l.x=Ke(l.x,i.x,o)),n&&(l.y=Ke(l.y,i.y,s)),l=ci(l),l}},bE=class{constructor(t,e,i){this.rect=t,this.getZoom=e,this.isZoomValid=i,this.rect.visible=!1}update(t,e,i){const o=t.currentX+(i?.x??0),s=t.currentY+(i?.y??0);this.rect.visible=!0,this.updateCoords(o,s,e,i),this.updateRect(i)}stop(t,e,i){let o=ae();if(!t||!e)return o;this.coords&&(o=this.createZoomFromCoords(e,i));const s=e.width/t.width,a=e.height/t.height;return o=ci(X1(o,s,a)),this.reset(),o}reset(){this.coords=void 0,this.rect.visible=!1}didUpdate(){return this.rect.visible&&this.rect.width>0&&this.rect.height>0}updateCoords(t,e,i,o){if(!this.coords){this.coords={x1:t,y1:e,x2:t,y2:e};return}const{coords:s}=this;if(s.x2=t,s.y2=e,!o)return;const{isScalingX:a,isScalingY:n,keepAspectRatio:r}=i,l=this.getNormalisedDimensions();if(r&&a&&n){const c=o.width/o.height;s.y2<s.y1?s.y2=Math.min(s.y1-l.width/c,s.y1):s.y2=Math.max(s.y1+l.width/c,s.y1)}a||(s.x1=o.x,s.x2=o.x+o.width),n||(s.y1=o.y,s.y2=o.y+o.height)}updateRect(t){if(!t)return;const{rect:e}=this,i=this.getNormalisedDimensions(),{width:o,height:s}=i;let{x:a,y:n}=i;a=Math.max(a,t.x),a-=Math.max(0,a+o-(t.x+t.width)),n=Math.max(n,t.y),n-=Math.max(0,n+s-(t.y+t.height)),e.x=a,e.y=n,e.width=o,e.height=s;const r=this.createZoomFromCoords(t,this.getZoom());this.isZoomValid(r)?e.updateValid():e.updateInvalid()}createZoomFromCoords(t,e){const i=ae(e),o=this.getNormalisedDimensions(),s=mo(t,o.x,o.y+o.height),a=o.width/t.width,n=o.height/t.height;let r=$l(i,a,n);const l=s.x*Qt(i),c=s.y*We(i);return r=_s(r,l,c),r=ci(r),r}getNormalisedDimensions(){const{x1:t=0,y1:e=0,x2:i=0,y2:o=0}=this.coords??{},s=t<=i?t:i,a=e<=o?e:o,n=t<=i?i-t:t-i,r=e<=o?o-e:e-o;return{x:s,y:a,width:n,height:r}}};import{_ModuleSupport as vE}from"ag-charts-community";import{CleanupRegistry as ME,createElement as DE,entries as kE}from"ag-charts-core";var{ActionOnSet:tS,BaseProperties:AE,ChartAxisDirection:LE,NativeWidget:IE,PropertiesArray:CE,Toolbar:TE,ToolbarButtonProperties:wE,Property:Rs}=vE,Sd=class extends wE{};p([Rs],Sd.prototype,"value",2),p([Rs],Sd.prototype,"section",2);var Ba=class extends AE{constructor(t,e,i,o,s,a,n){super(),this.ctx=t,this.getModuleProperties=e,this.canResetZoom=i,this.updateZoom=o,this.updateAxisZoom=s,this.resetZoom=a,this.isZoomValid=n,this.enabled=!1,this.buttons=new CE(Sd),this.visible="hover",this.verticalSpacing=10,this.detectionRange=38,this.cleanup=new ME,this.container=new IE(DE("div")),this.container.addClass("ag-charts-zoom-buttons"),t.domManager.addChild("canvas-overlay","zoom-buttons",this.container.getElement()),this.toolbar=new TE(t,"ariaLabelZoomToolbar","horizontal"),this.container.addChild(this.toolbar),this.toolbar.getElement().style.transform="translateY(54px)",this.toggleVisibility(this.visible==="always"),this.cleanup.register(this.toolbar.addToolbarListener("button-pressed",this.onButtonPress.bind(this)),this.toolbar.addToolbarListener("button-focused",this.onButtonFocus.bind(this)),t.widgets.containerWidget.addListener("mousemove",this.onHover.bind(this)),t.widgets.containerWidget.addListener("mouseleave",this.onLeave.bind(this)),t.eventsHub.on("layout:complete",this.onLayoutComplete.bind(this)),this.teardown.bind(this))}destroy(){this.cleanup.flush()}toggleVisibleZoomed(t){this.visible==="zoomed"&&this.toggleVisibility(!t)}teardown(){this.ctx.domManager.removeChild("canvas-overlay","zoom-buttons"),this.container.destroy()}onLayoutComplete(t){const{buttons:e,container:i}=this,{rect:o}=t.series;for(const a of e)if(a.tooltip==null&&a.label==null){const n={"pan-end":"toolbarZoomPanEnd","pan-left":"toolbarZoomPanLeft","pan-right":"toolbarZoomPanRight","pan-start":"toolbarZoomPanStart","zoom-in":"toolbarZoomZoomIn","zoom-out":"toolbarZoomZoomOut",reset:"toolbarZoomReset"};a.tooltip=n[a.value]}this.toolbar.updateButtons(e),this.toggleButtons();const s=i.getBounds().height;i.setBounds({y:o.y+o.height-s})}onHover(t){if(!this.enabled||this.visible!=="hover"||this.toolbar.isHidden())return;const{container:e,detectionRange:i,ctx:{scene:o}}=this,{currentY:s,sourceEvent:{target:a}}=t,n=e.getElement(),r=n.offsetTop-i,l=s>r&&s<o.canvas.element.offsetHeight||a===n;this.toggleVisibility(l)}onLeave(){this.visible==="hover"&&this.toggleVisibility(!1)}toggleVisibility(t,e=!1){const{container:i,toolbar:o,verticalSpacing:s}=this;o.toggleClass("ag-charts-zoom-buttons__toolbar--hidden",!t);const a=o.getElement();a.style.transitionDuration=e?"0s":"",a.style.transform=t?"translateY(0)":`translateY(${i.getBounds().height+s}px)`}toggleButtons(){const t=ae(this.ctx.zoomManager.getZoom());if(!(this.previousZoom&&En(this.previousZoom,t))){this.previousZoom=t;for(const[e,i]of this.buttons.entries()){let o=!0;switch(i?.value){case"pan-start":o=t.x.min>li;break;case"pan-end":o=t.x.max<ye;break;case"pan-left":o=t.x.min>li;break;case"pan-right":o=t.x.max<ye;break;case"zoom-out":o=!En(t,pd());break;case"zoom-in":o=this.isZoomValid(this.getNextZoomStateUnified("zoom-in",t,this.getModuleProperties()));break;case"reset":o=this.canResetZoom(t);break}this.toolbar.toggleButtonEnabledByIndex(e,o)}}}onButtonPress({button:t}){if(!this.enabled||this.toolbar.isHidden())return;const e=this.getModuleProperties();if(e.independentAxes&&t.value!=="reset"){const i=this.ctx.zoomManager.getAxisZooms();for(const[o,{direction:s,zoom:a}]of kE(i))a!=null&&this.onButtonPressAxis(t,e,o,s,a)}else this.onButtonPressUnified(t,e)}onButtonFocus(t){this.toggleVisibility(!0,!0)}onButtonPressAxis(t,e,i,o,s){const{isScalingX:a,isScalingY:n,scrollingStep:r}=e;let l={...s};const c=s.max-s.min;switch(t.value){case"pan-start":l.max=c,l.min=0;break;case"pan-end":l.min=l.max-c,l.max=ye;break;case"pan-left":l.min-=c*r,l.max-=c*r;break;case"pan-right":l.min+=c*r,l.max+=c*r;break;case"zoom-in":case"zoom-out":{const h=o===LE.X,d=h&&a||!h&&n;let u=t.value==="zoom-in"?1-r:1+r;d||(u=1);const g=h?this.getAnchorPointX(e):this.getAnchorPointY(e);l.max=l.min+(l.max-l.min)*u,l=Ke(l,s,g);break}}this.updateAxisZoom(i,o,jl(l))}onButtonPressUnified(t,e){const{scrollingStep:i}=e,o=ae(this.ctx.zoomManager.getZoom());let s=ae(o);switch(t.value){case"reset":this.resetZoom();return;case"pan-start":s.x.max=Qt(s),s.x.min=0;break;case"pan-end":s.x.min=ye-Qt(s),s.x.max=ye;break;case"pan-left":s=_s(s,-Qt(s)*i,0);break;case"pan-right":s=_s(s,Qt(s)*i,0);break;case"zoom-in":case"zoom-out":{s=this.getNextZoomStateUnified(t.value,o,e);break}}this.updateZoom(ci(s))}getNextZoomStateUnified(t,e,i){const{isScalingX:o,isScalingY:s,scrollingStep:a}=i,n=t==="zoom-in"?1-a:1+a,r=$l(e,o?n:1,s?n:1);return r.x=Ke(r.x,e.x,this.getAnchorPointX(i)),r.y=Ke(r.y,e.y,this.getAnchorPointY(i)),r}getAnchorPointX(t){const e=this.anchorPointX??t.anchorPointX;return e==="pointer"?Gx:e}getAnchorPointY(t){const e=this.anchorPointY??t.anchorPointY;return e==="pointer"?Wx:e}};p([Rs,tS({changeValue(t){this.toolbar?.setHidden(!t)}})],Ba.prototype,"enabled",2),p([Rs],Ba.prototype,"buttons",2),p([Rs,tS({changeValue(t,e){e!=null&&this.toggleVisibility(t==="always")}})],Ba.prototype,"visible",2),p([Rs],Ba.prototype,"anchorPointX",2),p([Rs],Ba.prototype,"anchorPointY",2);var Bs=1e6;function Zl({min:t,max:e},i,o,s){return s===0?0:Bs*((i-o)/s*(e-t)+t)}function NE(t,e,i,o,s,a){[t,e]=[Math.min(t,e),Math.max(t,e)],[i,o]=[Math.min(i,o),Math.max(i,o)];const n=Bs*(i-s)/a,r=Bs*(o-s)/a,l=(i-s)/(o-s),c=(t-l*e)/(Bs-n+l*(r-Bs)),h=(e+(r-Bs)*c)/r;return{min:c,max:h}}function eS(t,e,i,o){e===0&&(e=30),o===0&&(o=30);const s=t-e,a=t+e,n=i-o,r=i+o;return!(a<n||r<s)}var PE=class{constructor(){this.touchStart={origins:[{identifier:0,normalX:NaN,normalY:NaN},{identifier:0,normalX:NaN,normalY:NaN}]},this.initialZoom={x:{min:0,max:1},y:{min:0,max:1}},this.previous={a1:NaN,a2:NaN,b1:NaN,b2:NaN}}start(t,e,i){if(t.sourceEvent.targetTouches.length!==2)return!1;t.sourceEvent.preventDefault();const o=Array.from(t.sourceEvent.targetTouches),{x:s,y:a,width:n,height:r}=e.getBoundingClientRect();this.initialZoom.x.min=i.x?.min??0,this.initialZoom.x.max=i.x?.max??1,this.initialZoom.y.min=i.y?.min??0,this.initialZoom.y.max=i.y?.max??1,this.touchStart.origins.forEach(y=>y.identifier=0),this.previous.a1=NaN,this.previous.a2=NaN,this.previous.b1=NaN,this.previous.b2=NaN;for(const y of[0,1]){const f=o[y].clientX,x=a+r-o[y].clientY;this.touchStart.origins[y].identifier=o[y].identifier,this.touchStart.origins[y].normalX=Zl(this.initialZoom.x,f,s,n),this.touchStart.origins[y].normalY=Zl(this.initialZoom.y,x,a,r)}const[l,c]=o,[h,d]=this.touchStart.origins,u=eS(l.clientX,l.radiusX,c.clientX,c.radiusX);return eS(l.clientY,l.radiusY,c.clientY,c.radiusY)&&(h.normalY=d.normalY=(h.normalY+d.normalY)/2),u&&(h.normalX=d.normalX=(h.normalX+d.normalX)/2),!0}update(t,e){t.sourceEvent.preventDefault();const i=Array.from(t.sourceEvent.targetTouches),{x:o,y:s,width:a,height:n}=e.getBoundingClientRect(),{origins:r}=this.touchStart,l=[0,1].map(S=>i.find(v=>v.identifier===r[S].identifier)),c=r[0].normalX,h=r[1].normalX,d=l[0].clientX,u=l[1].clientX,g=r[0].normalY,y=r[1].normalY,f=s+n-l[0].clientY,x=s+n-l[1].clientY;return this.twitchTolerantZoomPan4(c,h,d,u,g,y,f,x,o,s,a,n)}end(t){const e=Array.from(t.sourceEvent.targetTouches).map(i=>i.identifier);return!e.includes(this.touchStart.origins[0].identifier)||!e.includes(this.touchStart.origins[1].identifier)}twitchTolerantZoomPan4(t,e,i,o,s,a,n,r,l,c,h,d){const{initialZoom:u,previous:g}=this,y=iS(t,e,i,o,g,"a1","a2",l,h,u.x),f=iS(s,a,n,r,g,"b1","b2",c,d,u.y);return{x:y,y:f}}};function iS(t,e,i,o,s,a,n,r,l,c){if(t!=e){const h=s[a],d=s[n];return Math.abs(i-h)+Math.abs(o-d)<=1?(i=h,o=d):(s[a]=i,s[n]=o),NE(t,e,i,o,r,l)}else{const h=Zl(c,i,r,l),d=Zl(c,o,r,l),u=(h+d)/2,g=(t-u)/Bs;return{min:c.min+g,max:c.max+g}}}var{ActionOnSet:zs,ChartAxisDirection:Gi,ChartUpdateType:bd,Property:It,InteractionState:_n,ProxyProperty:EE}=Yo,ql=t=>oE(t,10),vd="zoom-cursor",On="zoom-tooltip",Md=class extends Yo.BaseProperties{constructor(t){super(),this.onChange=t,this.enabled=!1,this.padding=0}};p([It,zs({changeValue(t){this.onChange({enabled:t,padding:this.padding})}})],Md.prototype,"enabled",2),p([It,zs({changeValue(t){this.onChange({enabled:this.enabled,padding:t})}})],Md.prototype,"padding",2);var Et=class extends Yo.BaseModuleInstance{constructor(t){super(),this.ctx=t,this.enabled=!1,this.enableAxisDragging=!0,this.enableAxisScrolling=!1,this.enableDoubleClickToReset=!0,this.enablePanning=!0,this.enableScrolling=!0,this.enableSelecting=!1,this.enableTwoFingerZoom=!0,this.panKey="alt",this.axes="x",this.scrollingStep=Es/10,this.keepAspectRatio=!1,this.minVisibleItems=2,this.anchorPointX=Gx,this.anchorPointY=Wx,this.autoScaling=new Md(i=>{this.ctx.zoomManager.setAutoScaleYAxis(i.enabled,i.padding)}),this.axisDraggingMode="zoom",this.canResetZoom=i=>(i??(i=this.getZoom()),!En(i,this.getResetZoom())),this.buttons=new Ba(this.ctx,this.getModuleProperties.bind(this),this.canResetZoom,this.updateZoom.bind(this),this.updateAxisZoom.bind(this),this.resetZoom.bind(this),this.isZoomValid.bind(this)),this.axisDragger=new aE,this.panner=new uE,this.scroller=new SE,this.scrollPanner=new mE,this.twoFingers=new PE,this.deceleration="short",this.dragState=0,this.isState=i=>this.ctx.interactionManager.isState(i),this.destroyContextMenuActions=void 0,this.isFirstWheelEvent=!0,this.debouncedWheelReset=iE(()=>{this.isFirstWheelEvent=!0,this.wasFirstWheelEventZoomCapped=void 0},100);const e=new Xl;this.selector=new bE(e,this.getZoom.bind(this),this.isZoomValid.bind(this)),this.contextMenu=new nE(t.eventsHub,t.contextMenuRegistry,t.zoomManager,this.getModuleProperties.bind(this),this.canResetZoom,()=>this.paddedRect,this.updateZoom.bind(this),this.isZoomValid.bind(this)),this.domProxy=new cE({onAxisDragStart:i=>this.onAxisDragStart(i),onAxisDragMove:(i,o,s)=>this.onAxisDragMove(i,o,s),onAxisDragEnd:()=>this.onAxisDragEnd(),onAxisDoubleClick:i=>this.onAxisDoubleClick(i),onAxisWheel:(i,o,s)=>this.onAxisWheel(i,o,s)}),t.widgets.seriesDragInterpreter&&this.cleanup.register(t.widgets.seriesDragInterpreter.events.on("dblclick",i=>this.onSeriesAreaDoubleClick(i)),t.widgets.seriesDragInterpreter.events.on("drag-move",i=>this.onSeriesAreaDragMove(i)),t.widgets.seriesDragInterpreter.events.on("drag-start",i=>this.onSeriesAreaDragStart(i)),t.widgets.seriesDragInterpreter.events.on("drag-end",()=>this.onSeriesAreaDragEnd())),this.cleanup.register(t.scene.attachNode(e),t.eventsHub.on("series:keynav-zoom",i=>this.onNavZoom(i)),t.widgets.seriesWidget.addListener("wheel",i=>this.onWheel(i)),t.widgets.seriesWidget.addListener("touchstart",(i,o)=>this.onTouchStart(i,o)),t.widgets.seriesWidget.addListener("touchmove",(i,o)=>this.onTouchMove(i,o)),t.widgets.seriesWidget.addListener("touchend",i=>this.onTouchEnd(i)),t.widgets.seriesWidget.addListener("touchcancel",i=>this.onTouchEnd(i)),t.updateService.addListener("process-data",i=>this.onProcessData(i)),t.eventsHub.on("layout:complete",i=>this.onLayoutComplete(i)),t.eventsHub.on("zoom:change",i=>this.onZoomChange(i)),t.eventsHub.on("zoom:pan-start",i=>this.onZoomPanStart(i)),this.panner.addListener("update",i=>this.onPanUpdate(i)),()=>this.teardown())}teardown(){this.ctx.zoomManager.setZoomModuleEnabled(!1),this.buttons.destroy(),this.destroyContextMenuActions?.(),this.domProxy.destroy()}onEnabledChange(t){this.ctx.zoomManager.setZoomModuleEnabled(t),this.contextMenu&&(this.destroyContextMenuActions?.(),this.destroyContextMenuActions=this.contextMenu.registerActions(t))}isIgnoredTouch(t){return t?.device!=="touch"?!1:this.ctx.chartService.touch.dragAction!=="drag"?!0:this.enableSelecting?!1:this.enablePanning?dd(this.getZoom()):!0}onSeriesAreaDoubleClick(t){const{enabled:e,enableDoubleClickToReset:i}=this;!e||!i||t?.preventZoomDblClick||!this.isState(_n.ZoomClickable)||this.resetZoom()}onSeriesAreaDragStart(t){const{enabled:e,enablePanning:i,enableSelecting:o,ctx:{domManager:s,zoomManager:a}}=this;if(!e||!this.isState(_n.ZoomDraggable)||this.dragState!==0||this.isIgnoredTouch(t))return;this.panner.stopInteractions();let n=0;const r=this.isPanningKeyPressed(t.sourceEvent);i&&(!o||r)?(s.updateCursor(vd,"grabbing"),n=2,this.panner.start()):o&&!r&&(n=3),(this.dragState=n)!==0&&a.fireZoomPanStartEvent("zoom")}onSeriesAreaDragMove(t){const{dragState:e,enabled:i,paddedRect:o,panner:s,selector:a,ctx:{interactionManager:n,tooltipManager:r,updateService:l}}=this;if(!(!i||!o||!this.isState(_n.ZoomDraggable)||this.isIgnoredTouch(t))){switch(n.pushState(Yo.InteractionState.ZoomDrag),t.device==="touch"&&t.sourceEvent.preventDefault(),e){case 2:s.update(t);break;case 3:a.update(t,this.getModuleProperties(),o);break;case 0:return}r.updateTooltip(On),l.update(bd.PERFORM_LAYOUT,{skipAnimations:!0})}}onSeriesAreaDragEnd(){const{dragState:t,enabled:e,panner:i,selector:o,ctx:{domManager:s,interactionManager:a,tooltipManager:n}}=this;if(a.popState(Yo.InteractionState.ZoomDrag),!(!e||t===0)){switch(t){case 2:i.stop();break;case 3:{if(!o.didUpdate())break;const r=this.getZoom(),l=o.stop(this.seriesRect,this.paddedRect,r);this.updateZoom(l);break}}this.dragState=0,s.updateCursor(vd),n.removeTooltip(On)}}onAxisDoubleClick(t){const{enabled:e,enableDoubleClickToReset:i,ctx:{zoomManager:o}}=this;!e||!i||!this.isState(_n.ZoomClickable)||o.resetAxisZoom("zoom",t)}onAxisDragStart(t){const{axisDraggingMode:e,domProxy:i,enabled:o,enableAxisDragging:s,panner:a,ctx:{zoomManager:n}}=this;!o||!s||(a.stopInteractions(),e==="pan"?(i.setAxisCursor("grabbing"),this.dragState=2,this.panner.start(t),n.fireZoomPanStartEvent("zoom")):this.dragState=1)}onAxisDragMove(t,e,i){const{anchorPointX:o,anchorPointY:s,axisDragger:a,dragState:n,enabled:r,enableAxisDragging:l,seriesRect:c,shouldFlipXY:h,ctx:{interactionManager:d,tooltipManager:u,updateService:g,zoomManager:y}}=this;if(!r||!l||!c)return;d.pushState(Yo.InteractionState.ZoomDrag),i.device==="touch"&&i.sourceEvent.preventDefault();const f=this.getZoom();if(n===2)this.panner.update({currentX:i.offsetX,currentY:i.offsetY});else{let x=e===Gi.X?o:s;h&&(x=e===Gi.X?s:o);const S=y.getAxisZoom(t),v=a.update(i,e,x,c,f,S);y.setAxisManuallyAdjusted("zoom",t),this.updateAxisZoom(t,e,v)}u.updateTooltip(On),g.update(bd.PERFORM_LAYOUT,{skipAnimations:!0})}onAxisDragEnd(){const{axisDraggingMode:t,axisDragger:e,dragState:i,domProxy:o,enabled:s,enableAxisDragging:a,ctx:{domManager:n,interactionManager:r,tooltipManager:l}}=this;r.popState(Yo.InteractionState.ZoomDrag),!(!s||!a||i===0)&&(this.dragState=0,t==="pan"&&(o.setAxisCursor("grab"),this.panner.stop()),e.stop(),n.updateCursor(vd),l.removeTooltip(On))}onNavZoom(t){const{enabled:e,enableScrolling:i,scroller:o}=this;!this.ctx.interactionManager.isState(Yo.InteractionState.Default)||!e||!i||(t.widgetEvent.sourceEvent.preventDefault(),this.updateZoom(o.updateDelta(t.delta,this.getModuleProperties(),this.getZoom())))}onWheel(t){const{enabled:e,enablePanning:i,enableScrolling:o,paddedRect:s}=this;if(!e||!o||!s||!this.isState(_n.ZoomWheelable))return;const{deltaX:a,deltaY:n}=t.sourceEvent,r=a!=null&&n!=null&&Math.abs(a)>Math.abs(n);i&&r?this.onWheelPanning(t):this.onWheelScrolling(t)}onWheelPanning(t){const{scrollingStep:e,scrollPanner:i,seriesRect:o,ctx:{zoomManager:s}}=this;if(!o)return;t.sourceEvent.preventDefault();const a=i.update(t,e,o,s.getAxisZooms());for(const[n,{direction:r,zoom:l}]of fd(a))this.updateAxisZoom(n,r,l)}onWheelScrolling(t){const e=this.getZoom(),i=t.deltaY>0&&dd(e);this.handleWheelScrolling(t,i)}onAxisWheel(t,e,i){const{enableAxisScrolling:o,ctx:{zoomManager:s}}=this;if(!o||e!==Gi.X&&e!==Gi.Y)return;const a=e===Gi.X,n=!a,r=this.getModuleProperties({isScalingX:a,isScalingY:n}),l=this.getZoom(),c=i.deltaY>0&&l[e].min===li&&l[e].max===ye;s.setAxisManuallyAdjusted("zoom",t),this.handleWheelScrolling(i,c,r)}handleWheelScrolling(t,e,i=this.getModuleProperties()){const{enableIndependentAxes:o,scroller:s,seriesRect:a,ctx:{zoomManager:n}}=this;if(!a)return;let r=!0;if(o===!0){const l=s.updateAxes(t,i,a,n.getAxisZooms());for(const[c,{direction:h,zoom:d}]of fd(l)){const u=h===Gi.X?this.constrainZoom({x:d,y:{min:1,max:1}}).x:d;r&&(r=this.updateAxisZoom(c,h,u))}}else{const l=s.update(t,i,a,this.getZoom());if(l==null)return;r=this.updateUnifiedZoom(l)}e||(e=t.deltaY<0&&!r),this.isFirstWheelEvent?(this.wasFirstWheelEventZoomCapped=e,e||t.sourceEvent.preventDefault()):this.wasFirstWheelEventZoomCapped===!1&&t.sourceEvent.preventDefault(),this.isFirstWheelEvent=!1,this.debouncedWheelReset()}onTouchStart(t,e){!this.enableTwoFingerZoom||this.dragState!==0||this.twoFingers.start(t,e,this.getZoom())&&(this.dragState=4)}onTouchMove(t,e){if(!this.enableTwoFingerZoom||this.dragState!==4)return;const i=this.twoFingers.update(t,e);this.updateZoom(ci(i))}onTouchEnd(t){!this.enableTwoFingerZoom||this.dragState!==4||(t.sourceEvent.preventDefault(),this.twoFingers.end(t)&&(this.dragState=0))}onProcessData(t){this.shouldFlipXY=t.series.shouldFlipXY}onLayoutComplete(t){this.domProxy.update(this.enableAxisDragging,this.enableAxisScrolling,this.ctx),this.enabled&&(this.seriesRect=t.series.rect,this.paddedRect=t.series.paddedRect,this.enableAxisDragging&&this.toggleAxisDraggingCursors())}onZoomChange(t){t.callerId!=="zoom"&&this.panner.stopInteractions();const e=this.getZoom();this.buttons.toggleVisibleZoomed(dd(e))}onZoomPanStart(t){t.callerId==="zoom"&&this.panner.stopInteractions()}onPanUpdate(t){const{panner:e,seriesRect:i,ctx:{tooltipManager:o,zoomManager:s}}=this;if(!i)return;const a=e.translateZooms(i,s.getAxisZooms(),t.deltaX,t.deltaY);for(const[n,{direction:r,zoom:l}]of fd(a))this.updateAxisZoom(n,r,l);o.updateTooltip(On)}isPanningKeyPressed(t){switch(this.panKey){case"alt":return t.altKey;case"ctrl":return t.ctrlKey;case"shift":return t.shiftKey;case"meta":return t.metaKey}}isScalingX(){return this.axes==="xy"?!0:this.shouldFlipXY?this.axes==="y":this.axes==="x"}isScalingY(){return this.axes==="xy"?!0:this.shouldFlipXY?this.axes==="x":this.axes==="y"}getAnchorPointX(){return this.shouldFlipXY?this.anchorPointY:this.anchorPointX}getAnchorPointY(){return this.shouldFlipXY?this.anchorPointX:this.anchorPointY}constrainZoom(t){const{minVisibleItems:e,ctx:{zoomManager:i}}=this;return e===0?t:i.constrainZoomToItemCount(t,e)??t}isZoomValid(t){const{minVisibleItems:e,ctx:{zoomManager:i}}=this;if(e===0)return!0;const o=this.getZoom(),s=ql(Qt(t))<ql(Qt(o)),a=ql(We(t))<ql(We(o));return!s&&!a?!0:i.isVisibleItemsCountAtLeast(t,e)}isAxisZoomValid(t,e){const{minVisibleItems:i,ctx:{zoomManager:o}}=this,s=this.getZoom(),a=e.max-e.min,n=s[t].max-s[t].min,r={...s,[t]:e};return a>=n||o.isVisibleItemsCountAtLeast(r,i)}resetZoom(){this.ctx.zoomManager.resetZoom("zoom")}updateSyncZoom(t){this.updateZoom(t)}updateZoom(t){this.enableIndependentAxes?this.updatePrimaryAxisZooms(t):this.updateUnifiedZoom(t)}updateUnifiedZoom(t){return t=this.constrainZoom(t),this.isZoomValid(t)?(this.ctx.zoomManager.updateZoom("zoom",t),!0):(this.ctx.updateService.update(bd.SCENE_RENDER,{skipAnimations:!0}),!1)}updatePrimaryAxisZooms(t){this.updatePrimaryAxisZoom(t,Gi.X),this.updatePrimaryAxisZoom(t,Gi.Y)}updatePrimaryAxisZoom(t,e){const i=this.ctx.zoomManager.getPrimaryAxisId(e);i!=null&&this.updateAxisZoom(i,e,t[e])}updateAxisZoom(t,e,i){const{enableIndependentAxes:o,ctx:{zoomManager:s}}=this;if(!i)return!1;const a=this.getZoom();return o!==!0?(a[e]=i,this.updateUnifiedZoom(a)):this.isAxisZoomValid(e,i)?(s.updateAxisZoom("zoom",t,i),!0):!1}updateAxisCursor(t){if(!this.domProxy)return;const{enableAxisDragging:e=this.enableAxisDragging,enableAxisScrolling:i=this.enableAxisScrolling,axisDraggingMode:o=this.axisDraggingMode}=t;e?this.domProxy.setAxisCursor(o==="pan"?"grab":void 0):i?this.domProxy.setAxisCursor("default"):this.domProxy.setAxisCursor(void 0)}toggleAxisDraggingCursors(){const{anchorPointX:t,anchorPointY:e,domProxy:i}=this,o=this.getZoom();let s=Qt(o)!==Es,a=We(o)!==Es;if(!s){const n=$l(o,.999,1);n.x=Ke(n.x,o.x,t),s=this.isZoomValid(n)}if(!a){const n=$l(o,1,.999);n.y=Ke(n.y,o.y,e),a=this.isZoomValid(n)}i.toggleAxisDraggingCursor(Gi.X,s),i.toggleAxisDraggingCursor(Gi.Y,a)}getZoom(){return ae(this.ctx.zoomManager.getZoom())}getResetZoom(){return ae(this.ctx.zoomManager.getRestoredZoom())}getModuleProperties(t){return{anchorPointX:t?.anchorPointX??this.getAnchorPointX(),anchorPointY:t?.anchorPointY??this.getAnchorPointY(),enabled:t?.enabled??this.enabled,independentAxes:t?.independentAxes??this.enableIndependentAxes===!0,isScalingX:t?.isScalingX??this.isScalingX(),isScalingY:t?.isScalingY??this.isScalingY(),keepAspectRatio:t?.keepAspectRatio??this.keepAspectRatio,scrollingStep:t?.scrollingStep??this.scrollingStep}}};p([zs({newValue(t){this.onEnabledChange(t)}}),It],Et.prototype,"enabled",2),p([zs({changeValue(t){this.updateAxisCursor({enableAxisDragging:t})}}),It],Et.prototype,"enableAxisDragging",2),p([zs({changeValue(t){this.updateAxisCursor({enableAxisScrolling:t})}}),It],Et.prototype,"enableAxisScrolling",2),p([It],Et.prototype,"enableDoubleClickToReset",2),p([zs({changeValue(t){this.ctx.zoomManager.setIndependentAxes(!!t)}}),It],Et.prototype,"enableIndependentAxes",2),p([It],Et.prototype,"enablePanning",2),p([It],Et.prototype,"enableScrolling",2),p([It],Et.prototype,"enableSelecting",2),p([It],Et.prototype,"enableTwoFingerZoom",2),p([It],Et.prototype,"panKey",2),p([It],Et.prototype,"axes",2),p([It],Et.prototype,"scrollingStep",2),p([It],Et.prototype,"keepAspectRatio",2),p([It],Et.prototype,"minVisibleItems",2),p([It],Et.prototype,"anchorPointX",2),p([It],Et.prototype,"anchorPointY",2),p([It],Et.prototype,"autoScaling",2),p([zs({changeValue(t){this.updateAxisCursor({axisDraggingMode:t})}}),It],Et.prototype,"axisDraggingMode",2),p([It],Et.prototype,"buttons",2),p([EE("panner.deceleration"),It],Et.prototype,"deceleration",2);var _E={enabled:!0,visible:"hover",buttons:[{icon:"zoom-out",value:"zoom-out",section:"scale"},{icon:"zoom-in",value:"zoom-in",section:"scale"},{icon:"pan-left",value:"pan-left",section:"pan"},{icon:"pan-right",value:"pan-right",section:"pan"},{icon:"reset",value:"reset",section:"reset"}]},OE={type:"root",optionsKey:"zoom",packageType:"enterprise",chartTypes:["cartesian","topology"],moduleFactory:t=>new Et(t),themeTemplate:{zoom:{anchorPointX:"end",anchorPointY:"middle",axes:"x",buttons:_E,enabled:!1,enableAxisDragging:!0,enableDoubleClickToReset:!0,enablePanning:!0,enableScrolling:!0,enableSelecting:!1,enableTwoFingerZoom:!0,deceleration:"short",minVisibleItems:2,panKey:"alt",scrollingStep:.1,autoScaling:{enabled:{$eq:[{$path:"../axes"},"x"]},padding:.05}}}};import{_ModuleSupport as Dd}from"ag-charts-community";import{_ModuleSupport as Rn}from"ag-charts-community";import{CleanupRegistry as RE,createId as BE}from"ag-charts-core";import{_ModuleSupport as zE}from"ag-charts-community";import{cachedTextMeasurer as FE,countFractionDigits as VE,createId as HE,isArray as GE,measureTextSegments as WE,toPlainText as KE}from"ag-charts-core";import{_ModuleSupport as $E}from"ag-charts-community";function Bn(t,e,i){return $E.callWithContext(t.chartService,e,i)}var{AxisInterval:jE,AxisLabel:YE,ZIndexMap:UE,LinearScale:XE,BBox:ZE,TranslatableGroup:qE,Selection:QE,Text:JE,createIdsGenerator:t_,findMinMax:e_,findRangeExtent:i_,estimateTickCount:o_}=zE,kd=class Gu{constructor(e,i){this.ctx=e,this.dataProvider=i,this.id=HE(this),this.axisGroup=new qE({name:`${this.id}-AxisTicks`,zIndex:UE.AXIS}),this.labelSelection=QE.select(this.axisGroup,JE),this.interval=new jE,this.label=new YE,this.scale=new XE,this.placement="bottom",this.translationX=0,this.translationY=0,this.padding=0}get horizontal(){return this.placement.startsWith("top")||this.placement.startsWith("bottom")}attachAxis(e){e.appendChild(this.axisGroup)}calculateLayout(){const{placement:e,translationX:i,translationY:o,horizontal:s,label:a}=this;function n(u){}let r,l;switch(e){case"top":case"top-right":case"top-left":r="bottom",l="center",a.mirrored=!1,a.parallel=!0;break;case"bottom":case"bottom-right":case"bottom-left":r="top",l="center",a.mirrored=!1,a.parallel=!0;break;case"right":case"right-top":case"right-bottom":case"left":case"left-top":case"left-bottom":r="middle",l="left",a.mirrored=!0,a.parallel=!1;break;default:}const c=[],h=this.generateTicks(),{ticks:d}=h;return this.labelSelection.update(d,void 0,u=>u.tickId),this.axisGroup.setProperties({translationX:i,translationY:o}),this.labelSelection.each((u,g)=>{u.fontFamily=a.fontFamily,u.fontSize=a.fontSize,u.fontStyle=a.fontStyle,u.fontWeight=a.fontWeight,u.fill=a.color,u.textBaseline=r,u.textAlign=l,u.text=g.tickLabel,u.x=s?g.translation:0,u.y=s?0:g.translation,c.push(u.getBBox())}),c.length>0?ZE.merge(c).translate(i,o):void 0}tickFormatter(e,i,o,s){const{ctx:a}=this,{formatManager:n}=a,r=this.dataProvider.data.flatMap(l=>l.series);return(l,c)=>{const h={type:"number",value:l,datum:void 0,seriesId:void 0,legendItemName:void 0,key:void 0,source:"gradient-legend",property:"color",domain:e,boundSeries:r,fractionDigits:s};return this.label.formatValue((d,u)=>Bn(a,d,u),h,c)??n.format((d,u)=>Bn(a,d,u),h)??n.defaultFormat(h)}}inRange(e,i=.001){const[o,s]=e_(this.scale.range);return e>=o-i&&e<=s+i}generateTicks(){const{minSpacing:e,maxSpacing:i}=this.interval,{maxTickCount:o,minTickCount:s,tickCount:a}=o_(i_(this.scale.range),1,e,i,Gu.DefaultTickCount,Gu.DefaultMinSpacing),n=this.getTicksData({nice:!0,interval:this.interval.step,tickCount:a,minTickCount:s,maxTickCount:o});if(this.placement==="bottom"||this.placement==="top"){const r=FE(this.label),{domain:l}=this.scale,h=l[0]>l[1]?-1:1;let d=-1/0*h;n.ticks=n.ticks.filter(u=>{if(Math.sign(u.translation-d)!==h)return!1;const{width:g}=GE(u.tickLabel)?WE(u.tickLabel,this.label):r.measureLines(u.tickLabel);return d=u.translation+g*h,!0})}return n}getTicksData(e){const i=[],o=e.nice?this.scale.niceDomain(e):this.scale.domain,s=this.scale.ticks(e,o)?.ticks??[],a=s.reduce((l,c)=>Math.max(l,VE(c)),0),n=t_(),r=this.tickFormatter(o,s,!1,a);for(let l=0;l<s.length;l++){const c=s[l],h=this.scale.convert(c);if(!this.inRange(h))continue;const d=r(c,l);if(d==null||d==="")continue;const u=n(KE(d));i.push({tick:c,tickId:u,tickLabel:d,translation:h})}return{rawTicks:s,fractionDigits:a,ticks:i}}};kd.DefaultTickCount=5,kd.DefaultMinSpacing=10;var s_=kd,{BaseProperties:a_,ZIndexMap:n_,ProxyProperty:Ad,Property:$e,LayoutElement:r_,Group:l_,Rect:oS,Marker:c_,TranslatableGroup:h_,BBox:Ld,expandLegendPosition:Id}=Rn,Cd=class extends a_{constructor(){super(...arguments),this.thickness=16,this.preferredLength=100}};p([$e],Cd.prototype,"thickness",2),p([$e],Cd.prototype,"preferredLength",2);var Ql=class extends Rn.BaseProperties{constructor(t){super(),this.axisTicks=t}};p([Ad("axisTicks.label")],Ql.prototype,"label",2),p([Ad("axisTicks.interval")],Ql.prototype,"interval",2),p([Ad("axisTicks.padding")],Ql.prototype,"padding",2);var je=class extends Rn.BaseProperties{constructor(t){super(),this.ctx=t,this.id=BE(this),this.legendGroup=new h_({name:"legend",zIndex:n_.LEGEND}),this.containerNode=this.legendGroup.appendChild(new oS({name:"legend-container"})),this.gradientRect=new oS,this.arrow=new c_({shape:"triangle"}),this.ticksGroup=new l_({name:"legend-axis-group"}),this.cleanup=new RE,this.enabled=!1,this.position="bottom",this.reverseOrder=!1,this.gradient=new Cd,this.spacing=20,this.border=new Rn.Border(this.containerNode),this.cornerRadius=0,this.fillOpacity=1,this.padding=4,this.data=[],this.highlightManager=t.highlightManager,this.axisTicks=new s_(t,this),this.axisTicks.attachAxis(this.ticksGroup),this.scale=new Ql(this.axisTicks),this.legendGroup.append([this.gradientRect,this.arrow,this.ticksGroup]),this.cleanup.register(t.eventsHub.on("highlight:change",()=>this.onChartHoverChange()),t.layoutManager.registerElement(r_.Legend,e=>this.onStartLayout(e)),()=>this.legendGroup.remove())}isVertical(){const{placement:t}=Id(this.position);return t.startsWith("right")||t.startsWith("left")}destroy(){this.cleanup.flush()}attachLegend(t){t.appendChild(this.legendGroup)}onStartLayout(t){const[e]=this.data;if(!this.enabled||!e?.enabled||e.legendType!=="gradient"){this.legendGroup.visible=!1;return}const{colorRange:i}=this.normalizeColorArrays(e),o=this.updateGradientRect(t.layoutBox,i),s=this.updateAxis(e,o)??new Ld(0,0,0,0),a=Ld.merge([o,s]),{strokeWidth:n,padding:r}=this.getContainerStyles();a.grow(r).grow(n);const{left:l,top:c}=this.getMeasurements(t.layoutBox,a);this.updateContainer(a),this.updateArrow(),this.legendGroup.visible=!0,this.legendGroup.translationX=l,this.legendGroup.translationY=c}normalizeColorArrays(t){let e=t.colorDomain.slice();const i=t.colorRange.slice();if(e.length===i.length)return{colorDomain:e,colorRange:i};e.length>i.length&&i.splice(e.length);const[o,s]=e,a=i.length;return e=i.map((n,r)=>r===0?o:r===a-1?s:o+(s-o)*r/(a-1)),{colorDomain:e,colorRange:i}}updateGradientRect(t,e){const{gradientRect:i,gradient:o}=this,{preferredLength:s,thickness:a}=o,n=new Ld(0,0,0,0);let r;return this.isVertical()?(r=0,n.width=a,n.height=Math.min(t.height,s)):(r=90,n.width=Math.min(t.width,s),n.height=a),i.x=n.x,i.y=n.y,i.width=n.width,i.height=n.height,i.fill={type:"gradient",gradient:"linear",colorSpace:"oklch",colorStops:e.map((l,c)=>({stop:c/(e.length-1),color:l})),rotation:r},n}updateAxis(t,e){const{axisTicks:i,gradient:o,scale:s}=this,{placement:a}=Id(this.position),n=this.isVertical(),r=this.reverseOrder!==n;i.placement=a;const l=o.thickness+(s.padding??0);return i.translationX=n?l:e.x,i.translationY=n?e.y:l,i.scale.domain=r?t.colorDomain.slice().reverse():t.colorDomain,i.scale.range=n?[e.x,e.height]:[e.y,e.width],i.calculateLayout()}updateContainer(t){const e=this.getContainerStyles();Rn.applyShapeStyle(this.containerNode,e),this.containerNode.cornerRadius=e.cornerRadius,this.containerNode.x=t.x,this.containerNode.y=t.y,this.containerNode.width=t.width,this.containerNode.height=t.height}updateArrow(){const t=this.highlightManager.getActiveHighlight(),{arrow:e}=this;if(t?.colorValue==null){e.visible=!1;return}const{scale:i,label:o}=this.axisTicks,s=o.fontSize??0,a=i.convert(t.colorValue);let{x:n,y:r}=this.gradientRect,l=Math.PI;this.isVertical()?(n-=s/2,r+=a,l/=2):(n+=a,r-=s/2),e.visible=!0,e.fill=o.color,e.rotation=l,e.size=s,e.translationX=n,e.translationY=r}getMeasurements(t,e){function i(u){}let{x:o,y:s}=t;const{width:a,height:n}=e,{placement:r,floating:l,xOffset:c,yOffset:h}=Id(this.position),d=this.getContainerStyles();switch(o+=d.strokeWidth+d.padding.left,s+=d.strokeWidth+d.padding.top,r){case"left":s+=t.height/2-n/2;break;case"right":o+=t.width-a,s+=t.height/2-n/2;break;case"top":o+=t.width/2-a/2;break;case"bottom":o+=t.width/2-a/2,s+=t.height-n;break;case"right-top":case"top-right":o+=t.width-a;break;case"right-bottom":case"bottom-right":o+=t.width-a,s+=t.height-n;break;case"left-bottom":case"bottom-left":s+=t.height-n;break;case"left-top":case"top-left":break;default:}if(!l)switch(r){case"left":case"left-top":case"left-bottom":t.shrink(a+this.spacing,"left");break;case"right":case"right-top":case"right-bottom":t.shrink(a+this.spacing,"right");break;case"top":case"top-left":case"top-right":t.shrink(n+this.spacing,"top");break;case"bottom":case"bottom-left":case"bottom-right":t.shrink(n+this.spacing,"bottom");break;default:}return o+=c,s+=h,{top:s,left:o}}getContainerStyles(){const{stroke:t,strokeOpacity:e,strokeWidth:i}=this.border,{cornerRadius:o,fill:s,fillOpacity:a,padding:n}=this,r=typeof n=="number";return{cornerRadius:o,fill:s,fillOpacity:a,padding:{top:r?n:n.top??0,right:r?n:n.right??0,bottom:r?n:n.bottom??0,left:r?n:n.left??0},stroke:t,strokeOpacity:e,strokeWidth:this.border.enabled?i:0}}onChartHoverChange(){this.enabled&&this.updateArrow()}};je.className="GradientLegend",p([$e],je.prototype,"enabled",2),p([$e],je.prototype,"position",2),p([$e],je.prototype,"reverseOrder",2),p([$e],je.prototype,"gradient",2),p([$e],je.prototype,"spacing",2),p([$e],je.prototype,"border",2),p([$e],je.prototype,"cornerRadius",2),p([$e],je.prototype,"fill",2),p([$e],je.prototype,"fillOpacity",2),p([$e],je.prototype,"padding",2),p([$e],je.prototype,"scale",2);var p_={type:"legend",optionsKey:"gradientLegend",packageType:"enterprise",chartTypes:["cartesian","polar","topology","standalone"],identifier:"gradient",moduleFactory:t=>new je(t),themeTemplate:{enabled:!1,position:"bottom",spacing:20,scale:{padding:13,label:{color:{$ref:"textColor"},fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},minSpacing:5},interval:{minSpacing:15}},gradient:{preferredLength:100,thickness:16},reverseOrder:!1,fill:{$applySwitch:[{$path:"type"},{$ref:"chartBackgroundColour"},["gradient",Dd.FILL_GRADIENT_BLANK_DEFAULTS],["pattern",Dd.FILL_PATTERN_BLANK_DEFAULTS],["image",Dd.FILL_IMAGE_BLANK_DEFAULTS]]}},removable:"standalone-only"};import{createElement as d_}from"ag-charts-core";function u_(t,e){const i=t.addChild("canvas-overlay","watermark"),o=d_("span");o.innerText=e,i.addEventListener("animationend",()=>{t.removeChild("canvas-overlay","watermark"),t.removeStyles("watermark")}),i.classList.add("ag-watermark"),i.appendChild(o)}import{_ModuleSupport as g_}from"ag-charts-community";import{_ModuleSupport as y_}from"ag-charts-community";var{ordinalTimeAxisOptionsDefs:f_,angleNumberAxisOptionsDefs:m_,angleCategoryAxisOptionsDefs:x_,radiusNumberAxisOptionsDefs:S_,radiusCategoryAxisOptionsDefs:b_}=y_,v_={type:"axis",name:"ordinal-time",chartType:"cartesian",enterprise:!0,options:f_,create:t=>new an(t)},M_={type:"axis",name:"angle-number",chartType:"polar",enterprise:!0,options:m_,create:t=>new ns(t)},D_={type:"axis",name:"angle-category",chartType:"polar",enterprise:!0,options:x_,create:t=>new Ao(t)},k_={type:"axis",name:"radius-number",chartType:"polar",enterprise:!0,options:S_,create:t=>new oa(t)},A_={type:"axis",name:"radius-category",chartType:"polar",enterprise:!0,options:b_,create:t=>new Lo(t)};import{_ModuleSupport as L_}from"ag-charts-community";import{_ModuleSupport as I_}from"ag-charts-community";var{Chart:C_}=I_,Td=class extends C_{getChartType(){return"standalone"}performLayout(t){const{seriesRoot:e,annotationRoot:i}=this,{layoutBox:o}=t,s=o.clone().shrink(this.modulesManager.getModule("seriesArea").getPadding());this.seriesRect=s,this.animationRect=s;for(const a of[e,i])a.translationX=Math.floor(s.x),a.translationY=Math.floor(s.y);e.visible=this.series[0].visible,this.ctx.layoutManager.emitLayoutComplete(t,{series:{visible:!0,rect:s,paddedRect:o}})}getAriaLabel(){const t=this.series[0]?.type;if(t==null)return"";const e=this.getCaptionText();switch(t){case"radial-gauge":case"linear-gauge":{const i=[];e.length!==0&&i.push(e);for(const o of this.series)i.push(o.getCaptionText());return this.ctx.localeManager.t("ariaAnnounceGaugeChart",{caption:i.join(". ")})}case"treemap":case"sunburst":return this.ctx.localeManager.t("ariaAnnounceHierarchyChart",{caption:e});default:return this.ctx.localeManager.t("ariaAnnounceStandaloneChart",{caption:e})}}};Td.className="StandaloneChart",Td.type="standalone";var{isAgStandaloneChartOptions:T_,standaloneChartOptionsDefs:w_}=L_,N_={type:"chart",name:"standalone",enterprise:!0,options:w_,detect:T_,create(t,e){return new Td(t,e)}};import{_ModuleSupport as P_}from"ag-charts-community";import{_ModuleSupport as E_}from"ag-charts-community";var{Chart:__,MercatorScale:sS,ChartAxisDirection:Jl,Property:O_}=E_;function aS(t){return t.type==="map-shape"||t.type==="map-line"||t.type==="map-marker"||t.type==="map-shape-background"||t.type==="map-line-background"}var tc=class extends __{constructor(t,e){super(t,e),this.ctx.zoomManager.updateAxes([Jl.X,Jl.Y])}getChartType(){return"topology"}async updateData(){await super.updateData();const t=this.getOptions();this.topology!==t.topology&&(this.topology=t.topology);const{topology:e}=this;this.series.forEach(i=>{aS(i)&&i.setChartTopology(e)})}performLayout(t){const{seriesRoot:e,annotationRoot:i}=this,{layoutBox:o}=t,s=o.clone().shrink(this.modulesManager.getModule("seriesArea").getPadding());this.seriesRect=s,this.animationRect=s;const a=this.series.filter(aS),n=a.reduce((c,h)=>{if(!h.visible)return c;const d=h.topologyBounds;return d==null?c:c==null?d:c.merge(d)},void 0);let r;if(n!=null){const{lon0:c,lat0:h,lon1:d,lat1:u}=n,g=[[c,h],[d,u]],y=sS.bounds(g),{width:f,height:x}=s,S=Math.min(f/y.width,x/y.height),v=y.width*S,m=y.height*S,b=(f-v)/2,M=(x-m)/2,k=b,A=M,D=b+v,I=M+m,L=this.ctx.zoomManager.getAxisZoom(Jl.X),C=this.ctx.zoomManager.getAxisZoom(Jl.Y),w=(D-k)/(L.max-L.min),P=k-w*L.min,E=(I-A)/(1-C.min-(1-C.max)),T=A-E*(1-C.max);r=new sS(g,[[P,T],[P+w,T+E]])}a.forEach(c=>{c.scale=r});const l=this.series.some(c=>c.visible);e.visible=l;for(const c of[e,i])c.translationX=Math.floor(s.x),c.translationY=Math.floor(s.y),c.setClipRect(s.clone());this.ctx.layoutManager.emitLayoutComplete(t,{series:{visible:l,rect:s,paddedRect:o}})}};tc.className="TopologyChart",tc.type="topology",p([O_],tc.prototype,"topology",2);var{isAgTopologyChartOptions:R_,topologyChartOptionsDefs:B_}=P_,z_={type:"chart",name:"topology",enterprise:!0,options:B_,detect:R_,create(t,e){return new tc(t,e)}};import{_ModuleSupport as F_}from"ag-charts-community";import{_ModuleSupport as V_}from"ag-charts-community";import{and as ec,arrayOf as H_,arrayOfDefs as nS,boolean as Fs,constant as rS,greaterThan as lS,lessThan as cS,number as Wi,numberRange as G_,optionsDefs as hS,or as Vs,ratio as ic,required as W_,string as ki,typeUnion as K_,union as $_}from"ag-charts-core";var{annotationCalloutStylesDefs:j_,annotationNoteStylesDefs:Y_,annotationTextStylesDef:U_,annotationCommentStylesDefs:X_,annotationMeasurerStylesDefs:wd,annotationShapeStylesDefs:pS,annotationChannelTextDefs:Z_,annotationCrossLineStyleDefs:dS,annotationFibonacciStylesDefs:uS,annotationLineStyleDefs:gS,annotationLineTextDefs:q_,annotationDisjointChannelStyleDefs:Q_,annotationParallelChannelStyleDefs:J_}=V_,zn=hS({__type:W_(rS("date")),value:Vs(ki,Wi)},"a serializable date object"),yS=Vs(ki,Wi,zn),Nd=Vs(yS,hS({value:yS,groupPercentage:G_(-1,2)})),fS={...Z_,label:ki},xo={...q_,label:ki},ft={x:Nd,y:Wi},tO=K_({line:{...gS,start:ft,end:ft,text:xo},"horizontal-line":{...dS,value:Nd,text:xo},"vertical-line":{...dS,value:Nd,text:xo},"disjoint-channel":{...Q_,startHeight:Wi,endHeight:Wi,start:ft,end:ft,text:fS},"parallel-channel":{...J_,height:Wi,start:ft,end:ft,text:fS},"fibonacci-retracement":{...uS,start:ft,end:ft,text:xo,reverse:Fs},"fibonacci-retracement-trend-based":{...uS,start:ft,end:ft,endRetracement:ft,text:xo,reverse:Fs},callout:{...j_,start:ft,end:ft,text:ki},comment:{...X_,...ft,text:ki},note:{...Y_,...ft,text:ki},text:{...U_,...ft,text:ki},arrow:{...gS,text:xo,start:ft,end:ft},"arrow-up":{...pS,...ft},"arrow-down":{...pS,...ft},"date-range":{...wd,extendAbove:Fs,extendBelow:Fs,text:xo,start:ft,end:ft},"price-range":{...wd,extendLeft:Fs,extendRight:Fs,text:xo,start:ft,end:ft},"date-price-range":{...wd,text:xo,start:ft,end:ft}},"an annotation initial state object"),eO={chartType:$_("candlestick","hollow-candlestick","ohlc","line","step-line","hlc","high-low"),annotations:nS(tO),legend:nS({visible:Fs,seriesId:ki,itemId:ki,legendItemName:ki},"legend state array"),zoom:{rangeX:{start:Vs(Wi,zn),end:Vs(Wi,zn)},rangeY:{start:Vs(Wi,zn),end:Vs(Wi,zn)},ratioX:{start:ec(ic,cS("end")),end:ec(ic,lS("start"))},ratioY:{start:ec(ic,cS("end")),end:ec(ic,lS("start"))},autoScaledAxes:H_(rS("y"))}},{annotationOptionsDef:iO}=F_,oO={type:"plugin",name:"annotations",chartType:"cartesian",options:iO,create(){return null}},sO={type:"plugin",name:"navigator",chartType:"cartesian",options:x1,create(){return null}},aO={type:"plugin",name:"initialState",options:eO,create(){return null}};import{_ModuleSupport as Fn}from"ag-charts-community";import{_ModuleSupport as nO}from"ag-charts-community";import{Logger as rO,cachedTextMeasurer as lO,calcLineHeight as cO,wrapText as hO}from"ag-charts-core";import{_ModuleSupport as mS}from"ag-charts-community";import{Logger as pO}from"ag-charts-core";function xS(t,e,i){i||(e=dO(e));const o=new Map;for(const a of t)o.set(a.id,{datum:a,linksBefore:[],linksAfter:[],maxPathLengthBefore:-1,maxPathLengthAfter:-1});let s=0;return o.forEach((a,n)=>{s=Math.max(s,Pd(o,e,a,n,-1,[])+Pd(o,e,a,n,1,[])+1)}),{links:e,nodeGraph:o,maxPathLength:s}}function SS(t,e,i,o){const s=o.indexOf(e);if(s!==-1){for(let n=s;n<o.length;n+=1)i.add(o[n]);return}o.push(e);const{toNode:a}=e;for(const n of t)n.fromNode===a&&SS(t,n,i,o);o.pop()}function dO(t){const e=new Set;for(const i of t)SS(t,i,e,[]);return e.size!==0&&pO.warnOnce("Some links formed circular references. These will be removed from the output."),e.size===0?t:t.filter(i=>!e.has(i))}function Pd(t,e,i,o,s,a){if(a.includes(o))return 1/0;let n=s===-1?i.maxPathLengthBefore:i.maxPathLengthAfter;if(n===-1){n=0;const r=s===-1?i.linksBefore:i.linksAfter;for(const l of e){const{fromNode:c,toNode:h}=l,d=s===-1?h.id:c.id,u=s===-1?c.id:h.id,g=o===d?t.get(u):void 0;g!=null&&(r.push({node:g,link:l}),a?.push(o),n=Math.max(n,Pd(t,e,g,u,s,a)+1),a?.pop())}s===-1?i.maxPathLengthBefore=n:i.maxPathLengthAfter=n}return n}var{Series:uO,DataController:gO,keyProperty:yO,valueProperty:oc,Selection:Hs,Group:za,TransformableText:fO}=mS,mO=class extends mS.SeriesNodeEvent{constructor(t,e,i,o){super(t,e,i,o);const{datumIndex:s}=i,a=o.contextNodeData?.nodeData.find(n=>n.datumIndex.type===s.type&&n.datumIndex.index===s.index);this.size=a?.size,this.label=a?.type===1?a?.label:void 0}},bS=class extends uO{constructor(){super(...arguments),this.NodeEvent=mO,this.nodeCount=0,this.linkCount=0,this.linksDataModel=void 0,this.linksProcessedData=void 0,this.nodesDataModel=void 0,this.nodesProcessedData=void 0,this.processedNodes=new Map,this.linkGroup=this.contentGroup.appendChild(new za({name:"linkGroup"})),this.nodeGroup=this.contentGroup.appendChild(new za({name:"nodeGroup"})),this.focusLinkGroup=this.highlightGroup.appendChild(new za({name:"linkGroup"})),this.focusNodeGroup=this.highlightGroup.appendChild(new za({name:"nodeGroup"})),this.highlightLinkGroup=this.highlightGroup.appendChild(new za({name:"linkGroup"})),this.highlightNodeGroup=this.highlightGroup.appendChild(new za({name:"nodeGroup"})),this.labelSelection=Hs.select(this.labelGroup,fO),this.linkSelection=Hs.select(this.linkGroup,()=>this.linkFactory()),this.nodeSelection=Hs.select(this.nodeGroup,()=>this.nodeFactory()),this.focusLinkSelection=Hs.select(this.focusLinkGroup,()=>this.linkFactory()),this.focusNodeSelection=Hs.select(this.focusNodeGroup,()=>this.nodeFactory()),this.highlightLinkSelection=Hs.select(this.highlightLinkGroup,()=>this.linkFactory()),this.highlightNodeSelection=Hs.select(this.highlightNodeGroup,()=>this.nodeFactory())}get nodes(){return this.properties.nodes}async processData(t){const{data:e,nodes:i}=this;if(e==null)return;const{fromKey:o,toKey:s,sizeKey:a,idKey:n,labelKey:r}=this.properties,l=new gO("standalone",t.suppressFieldDotNotation),c=i!=null?l.request(this.id,i,{props:[yO(n,void 0,{id:"idValue",includeProperty:!1}),...r!=null?[oc(r,void 0,{id:"labelValue",includeProperty:!1})]:[]],groupByKeys:!0}):null,h=t.request(this.id,e,{props:[oc(o,void 0,{id:"fromValue",includeProperty:!1}),oc(s,void 0,{id:"toValue",includeProperty:!1}),...a!=null?[oc(a,void 0,{id:"sizeValue",includeProperty:!1,missingValue:0})]:[]],groupByKeys:!1});i!=null&&l.execute();const[d,u]=await Promise.all([c,h]);this.nodesDataModel=d?.dataModel,this.nodesProcessedData=d?.processedData,this.linksDataModel=u?.dataModel,this.linksProcessedData=u?.processedData;const g=new Map;if(d==null){const y=u.dataModel.resolveColumnById(this,"fromValue",u.processedData),f=u.dataModel.resolveColumnById(this,"toValue",u.processedData),x=S=>{const v=g.size,m=S;return{series:this,itemId:void 0,datum:{},datumIndex:{type:1,index:v},type:1,index:v,linksBefore:[],linksAfter:[],id:S,size:0,label:m,style:this.getNodeStyle({datumIndex:{type:1,index:v},datum:{},size:0,label:m},v,!1)}};u.processedData.dataSources.get(this.id)?.forEach((S,v)=>{const m=y[v],b=f[v];m==null||b==null||(g.has(m)||g.set(m,x(m)),g.has(b)||g.set(b,x(b)))})}else{const y=d.dataModel.resolveColumnById(this,"idValue",d.processedData),f=r!=null?d.dataModel.resolveColumnById(this,"labelValue",d.processedData):void 0;d.processedData.dataSources.get(this.id)?.forEach((x,S)=>{const v=y[S],m=f?.[S],b={type:1,index:S};g.set(v,{series:this,itemId:void 0,datum:x,datumIndex:b,type:1,index:S,linksBefore:[],linksAfter:[],id:v,size:0,label:m,style:this.getNodeStyle({datumIndex:b,datum:x,size:0,label:m},S,!1)})})}this.processedNodes=g}getNodeGraph(t,e,{includeCircularReferences:i}){const{linksDataModel:o,linksProcessedData:s}=this;if(o==null||s==null){const{links:y,nodeGraph:f,maxPathLength:x}=xS(new Map().values(),[],i);return this.nodeCount=0,this.linkCount=0,{nodeGraph:f,links:y,maxPathLength:x}}const{sizeKey:a}=this.properties,n=o.resolveColumnById(this,"fromValue",s),r=o.resolveColumnById(this,"toValue",s),l=a!=null?o.resolveColumnById(this,"sizeValue",s):void 0,c=new Map;this.processedNodes.forEach(y=>{const f=t(y);c.set(y.id,f)});const h=[];s.dataSources.get(this.id)?.forEach((y,f)=>{const x=n[f],S=r[f],v=l!=null?l[f]:1,m=c.get(x),b=c.get(S);if(v<=0||m==null||b==null)return;const M={type:0,index:f},k=e({series:this,itemId:void 0,datum:y,datumIndex:M,type:0,index:f,fromNode:m,toNode:b,size:v,style:this.getLinkStyle({datum:y,datumIndex:M},m.datumIndex,!1)});h.push(k)});const{links:d,nodeGraph:u,maxPathLength:g}=xS(c.values(),h,i);return u.forEach(y=>{y.datum.linksBefore=y.linksBefore.map(f=>f.link),y.datum.linksAfter=y.linksAfter.map(f=>f.link)}),this.nodeCount=u.size,this.linkCount=d.length,{nodeGraph:u,links:d,maxPathLength:g}}updateSelections(){this.nodeDataRefresh&&(this.contextNodeData=this.createNodeData(),this.nodeDataRefresh=!1)}update(t){const{seriesRect:e}=t,i={seriesRectWidth:e?.width??0,seriesRectHeight:e?.height??0};(this._nodeDataDependencies==null||this._nodeDataDependencies.seriesRectWidth!==i.seriesRectWidth||this._nodeDataDependencies.seriesRectHeight!==i.seriesRectHeight)&&(this._nodeDataDependencies=i),this.updateSelections();const o=this.contextNodeData?.nodeData??[],s=this.contextNodeData?.labelData??[];let a=this.ctx.highlightManager?.getActiveHighlight();if(a?.series===this&&a.type==null){const{itemId:h}=a;a=h!=null?o.find(d=>d.type===1&&d.id===h):void 0}else a?.series!==this&&(a=void 0);this.contentGroup.visible=this.visible,this.contentGroup.opacity=a!=null?this.properties.highlight.unhighlightedItem.opacity??1:1,this.labelSelection=this.updateLabelSelection({labelData:s,labelSelection:this.labelSelection}),this.updateLabelNodes({labelSelection:this.labelSelection}),this.linkSelection=this.updateLinkSelection({nodeData:o.filter(h=>h.type===0),datumSelection:this.linkSelection}),this.updateLinkNodes({datumSelection:this.linkSelection,isHighlight:!1}),this.nodeSelection=this.updateNodeSelection({nodeData:o.filter(h=>h.type===1),datumSelection:this.nodeSelection}),this.updateNodeNodes({datumSelection:this.nodeSelection,isHighlight:!1});let n,r,l,c;a?.type===1?(n=o.filter(h=>h.type===0&&(h.toNode===a||h.fromNode===a)),r=n.map(h=>h.fromNode===a?h.toNode:h.fromNode),r.push(a),l=[],c=[a]):a?.type===0?(n=[a],r=[a.fromNode,a.toNode],l=[a],c=[]):(n=[],r=[],l=[],c=[]),this.focusLinkSelection=this.updateLinkSelection({nodeData:n,datumSelection:this.focusLinkSelection}),this.updateLinkNodes({datumSelection:this.focusLinkSelection,isHighlight:!1}),this.focusNodeSelection=this.updateNodeSelection({nodeData:r,datumSelection:this.focusNodeSelection}),this.updateNodeNodes({datumSelection:this.focusNodeSelection,isHighlight:!1}),this.highlightLinkSelection=this.updateLinkSelection({nodeData:l,datumSelection:this.highlightLinkSelection}),this.updateLinkNodes({datumSelection:this.highlightLinkSelection,isHighlight:!0}),this.highlightNodeSelection=this.updateNodeSelection({nodeData:c,datumSelection:this.highlightNodeSelection}),this.updateNodeNodes({datumSelection:this.highlightNodeSelection,isHighlight:!0})}resetAnimation(t){}dataCount(){return NaN}getSeriesDomain(t){return[]}getSeriesRange(t,e){return[NaN,NaN]}legendItemSymbol(t,e,i={}){const{fills:o,strokes:s}=this.properties,{fill:a=o[e%o.length],fillOpacity:n=1,stroke:r=s[e%s.length],strokeWidth:l=0,strokeOpacity:c=1,lineDash:h=[0],lineDashOffset:d=0}=i;return{marker:{fill:a,fillOpacity:n,stroke:r,strokeWidth:l,strokeOpacity:c,lineDash:h,lineDashOffset:d}}}getLegendData(t){if(t!=="category")return[];const{showInLegend:e}=this.properties;return Array.from(this.processedNodes.values(),({id:i,label:o},s)=>({legendType:"category",id:this.id,itemId:i,seriesId:this.id,enabled:!0,label:{text:o??i},symbol:this.legendItemSymbol(1,s),hideInLegend:!e,isFixed:!0}))}pickNodeClosestDatum({x:t,y:e}){let i=1/0,o;return this.linkSelection.each((s,a)=>{const n=s.distanceSquared(t,e);n<i&&(i=n,o=a)}),this.nodeSelection.each((s,a)=>{const n=s.distanceSquared(t,e);n<i&&(i=n,o=a)}),o!=null?{datum:o,distance:Math.sqrt(i)}:void 0}getDatumAriaText(t,e){if(t.type===0)return this.ctx.localeManager.t("ariaAnnounceFlowProportionLink",{index:t.index+1,count:this.linkCount,from:t.fromNode.id,to:t.toNode.id,size:t.size,sizeName:this.properties.sizeName??this.properties.sizeKey});if(t.type===1)return this.ctx.localeManager.t("ariaAnnounceFlowProportionNode",{index:t.index+1,count:this.nodeCount,description:e})}pickFocus(t){const{datumIndexDelta:e,otherIndexDelta:i}=t,o=this.contextNodeData?.nodeData[t.datumIndex-t.datumIndexDelta];let s=o;if(i!==0||e===0)return;if(o?.type===0){const r=Array.from(this.linkSelection,h=>h.datum),c=r.indexOf(o)+e;if(c>=0&&c<r.length)s=r[c];else if(c>0)s=r[r.length-1];else{const h=Array.from(this.nodeSelection,d=>d.datum);s=h[h.length-1]}}else if(o?.type===1){const r=Array.from(this.nodeSelection,h=>h.datum),c=r.indexOf(o)+e;c>=0&&c<r.length?s=r[c]:c<0?s=r[0]:s=Array.from(this.linkSelection,d=>d.datum)[0]}if(s==null)return;const a=s.type===1?Array.from(this.nodeSelection).find(r=>r.datum===s):Array.from(this.linkSelection).find(r=>r.datum===s);if(a==null)return;const n=this.computeFocusBounds(a.node);if(n!=null)return{datum:a.datum,datumIndex:this.contextNodeData?.nodeData.indexOf(a.datum)??0,otherIndex:0,bounds:n,clipFocusBox:!0}}getCategoryValue(t){}datumIndexForCategoryValue(t){}};import{_ModuleSupport as xO}from"ag-charts-community";var{Path:SO,SceneChangeDetection:Uo}=xO;function vS({radius:t,startAngle:e,endAngle:i,tension:o}){const s=t*Math.cos(e),a=t*Math.sin(e),n=t*Math.cos(i),r=t*Math.sin(i),l=s*o,c=a*o,h=n*o,d=r*o;return{x:[s,l,h,n],y:[a,c,d,r]}}var So=class extends SO{constructor(){super(...arguments),this.centerX=0,this.centerY=0,this.radius=0,this.startAngle1=0,this.endAngle1=0,this.startAngle2=0,this.endAngle2=0,this.tension=1}tensionedCurveTo(t,e,i,o,s,a,n,r){const{path:l,tension:c}=this,h=1-c;l.cubicCurveTo((i-t)*h+t,(o-e)*h+e,(s-n)*h+n,(a-r)*h+r,n,r)}updatePath(){const{path:t,centerX:e,centerY:i,radius:o}=this;let{startAngle1:s,endAngle1:a,startAngle2:n,endAngle2:r}=this;s>n&&([s,n]=[n,s],[a,r]=[r,a]),t.clear();const l=e+o*Math.cos(s),c=i+o*Math.sin(s);t.moveTo(l,c),this.tensionedCurveTo(l,c,e,i,e,i,e+o*Math.cos(r),i+o*Math.sin(r)),t.arc(e,i,o,r,n,!0),this.tensionedCurveTo(e+o*Math.cos(n),i+o*Math.sin(n),e,i,e,i,e+o*Math.cos(a),i+o*Math.sin(a)),t.arc(e,i,o,a,s,!0),t.closePath()}};p([Uo()],So.prototype,"centerX",2),p([Uo()],So.prototype,"centerY",2),p([Uo()],So.prototype,"radius",2),p([Uo()],So.prototype,"startAngle1",2),p([Uo()],So.prototype,"endAngle1",2),p([Uo()],So.prototype,"startAngle2",2),p([Uo()],So.prototype,"endAngle2",2),p([Uo()],So.prototype,"tension",2);import{_ModuleSupport as bO}from"ag-charts-community";var{FillGradientDefaults:vO,FillPatternDefaults:MO,FillImageDefaults:DO,BaseProperties:MS,makeSeriesTooltip:kO,SeriesProperties:AO,Property:it,Label:LO}=bO,Ed=class extends LO{constructor(){super(...arguments),this.spacing=1,this.maxWidth=1}};p([it],Ed.prototype,"spacing",2),p([it],Ed.prototype,"maxWidth",2);var Ki=class extends MS{constructor(){super(...arguments),this.fill=void 0,this.fillOpacity=1,this.stroke=void 0,this.strokeOpacity=1,this.strokeWidth=1,this.lineDash=[0],this.lineDashOffset=0,this.tension=0}getStyle(t,e,i){const{fillOpacity:o,strokeWidth:s,strokeOpacity:a,lineDash:n,lineDashOffset:r,tension:l}=this,c=this.fill??t[i%t.length],h=this.stroke??e[i%t.length];return{fill:c,fillOpacity:o,stroke:h,strokeWidth:s,strokeOpacity:a,lineDash:n,lineDashOffset:r,tension:l}}};p([it],Ki.prototype,"fill",2),p([it],Ki.prototype,"fillOpacity",2),p([it],Ki.prototype,"stroke",2),p([it],Ki.prototype,"strokeOpacity",2),p([it],Ki.prototype,"strokeWidth",2),p([it],Ki.prototype,"lineDash",2),p([it],Ki.prototype,"lineDashOffset",2),p([it],Ki.prototype,"tension",2),p([it],Ki.prototype,"itemStyler",2);var Ai=class extends MS{constructor(){super(...arguments),this.spacing=1,this.width=1,this.fill=void 0,this.fillOpacity=1,this.stroke=void 0,this.strokeOpacity=1,this.strokeWidth=1,this.lineDash=[0],this.lineDashOffset=0}getStyle(t,e,i){const{fillOpacity:o,strokeWidth:s,strokeOpacity:a,lineDash:n,lineDashOffset:r}=this,l=this.fill??t[i%t.length],c=this.stroke??e[i%t.length];return{fill:l,fillOpacity:o,stroke:c,strokeWidth:s,strokeOpacity:a,lineDash:n,lineDashOffset:r}}};p([it],Ai.prototype,"spacing",2),p([it],Ai.prototype,"width",2),p([it],Ai.prototype,"fill",2),p([it],Ai.prototype,"fillOpacity",2),p([it],Ai.prototype,"stroke",2),p([it],Ai.prototype,"strokeOpacity",2),p([it],Ai.prototype,"strokeWidth",2),p([it],Ai.prototype,"lineDash",2),p([it],Ai.prototype,"lineDashOffset",2),p([it],Ai.prototype,"itemStyler",2);var Kt=class extends AO{constructor(){super(),this.idKey="",this.idName=void 0,this.labelKey=void 0,this.labelName=void 0,this.sizeKey=void 0,this.sizeName=void 0,this.nodes=void 0,this.fillGradientDefaults=new vO,this.fillPatternDefaults=new MO,this.fillImageDefaults=new DO,this.fills=[],this.strokes=[],this.label=new Ed,this.link=new Ki,this.node=new Ai,this.tooltip=kO(),this.highlightStyle.deprecated=!1}};p([it],Kt.prototype,"fromKey",2),p([it],Kt.prototype,"toKey",2),p([it],Kt.prototype,"idKey",2),p([it],Kt.prototype,"idName",2),p([it],Kt.prototype,"labelKey",2),p([it],Kt.prototype,"labelName",2),p([it],Kt.prototype,"sizeKey",2),p([it],Kt.prototype,"sizeName",2),p([it],Kt.prototype,"nodes",2),p([it],Kt.prototype,"fillGradientDefaults",2),p([it],Kt.prototype,"fillPatternDefaults",2),p([it],Kt.prototype,"fillImageDefaults",2),p([it],Kt.prototype,"fills",2),p([it],Kt.prototype,"strokes",2),p([it],Kt.prototype,"label",2),p([it],Kt.prototype,"link",2),p([it],Kt.prototype,"node",2),p([it],Kt.prototype,"tooltip",2);var{SeriesNodePickMode:DS,createDatumId:sc,angleBetween:ac,normalizeAngle360:IO,isBetweenAngles:kS,Sector:CO,evaluateBezier:nc,applyShapeStyle:AS,getShapeStyle:rc,getLabelStyles:TO,BBox:wO,mergeDefaults:lc}=nO,cc=t=>t.startAngle+ac(t.startAngle,t.endAngle)/2,hc=class extends bS{constructor(t){super({moduleCtx:t,pickModes:[DS.NEAREST_NODE,DS.EXACT_SHAPE_MATCH]}),this.properties=new Kt}isLabelEnabled(){return(this.properties.labelKey!=null||this.nodes==null)&&this.properties.label.enabled}linkFactory(){return new So}nodeFactory(){return new CO}createNodeData(){const{id:t,_nodeDataDependencies:{seriesRectWidth:e,seriesRectHeight:i}={seriesRectWidth:0,seriesRectHeight:0},properties:o}=this,{fromKey:s,toKey:a,sizeKey:n,labelKey:r,label:{spacing:l,maxWidth:c,fontSize:h},node:{width:d,spacing:u}}=o,g=e/2,y=i/2;let f=[];const{nodeGraph:x,links:S}=this.getNodeGraph(T=>({...T,centerX:g,centerY:y,innerRadius:NaN,outerRadius:NaN,startAngle:NaN,endAngle:NaN}),T=>({...T,centerX:g,centerY:y,radius:NaN,startAngle1:NaN,endAngle1:NaN,startAngle2:NaN,endAngle2:NaN}),{includeCircularReferences:!0});let v=0;x.forEach(({datum:T,linksBefore:R,linksAfter:_},N)=>{const O=R.reduce((B,{link:z})=>B+z.size,0)+_.reduce((B,{link:z})=>B+z.size,0);if(O===0)x.delete(N);else{const{label:B}=o;T.size=O,v+=T.size,T.label=B.enabled?this.getLabelText(T.label,T.datum,r,"label",[],B,{datum:T.datum,value:T.label,fromKey:s,toKey:a,sizeKey:n,size:T.size}):void 0}});let m=0;if(this.isLabelEnabled()){const T=lO(this.properties.label);let R=0;x.forEach(({datum:_})=>{const{id:N,label:O}=_;if(O==null)return;const B=hO(O,{maxWidth:c,font:this.properties.label,textWrap:"never"}),{width:z}=T.measureText(B);R=Math.max(z,R),f.push({id:N,text:B,centerX:g,centerY:y,angle:NaN,radius:NaN,size:_.size})}),m=R+l}const b=x.size;let M=Math.min(e,i)/2-d-m,k=u/M;if(m!==0&&(b*k>=1.5*Math.PI||M<=0)&&(f=[],M=Math.min(e,i)/2-d,k=u/M),b*k>=2*Math.PI||M<=0){rO.warnOnce("There was insufficient space to display the Chord Series.");return}const A=M,D=M+d,I=Math.max((2*Math.PI-b*k)/v,0);let L=0;x.forEach(({datum:T})=>{T.innerRadius=A,T.outerRadius=D,T.startAngle=L,T.endAngle=L+T.size*I,L=T.endAngle+k;const R=(T.innerRadius+T.outerRadius)/2,_=cc(T);T.midPoint={x:T.centerX+R*Math.cos(_),y:T.centerY+R*Math.sin(_)}});const C=[];x.forEach(({datum:T,linksBefore:R,linksAfter:_})=>{const N=cc(T),O=[...R.map(z=>({link:z.link,distance:ac(cc(z.node.datum),N),after:!1})),..._.map(z=>({link:z.link,distance:ac(cc(z.node.datum),N),after:!0}))];let B=T.startAngle;O.toSorted((z,V)=>z.distance-V.distance).forEach(({link:z,after:V})=>{const F=z.size*I;V?(z.startAngle1=B,z.endAngle1=B+F):(z.startAngle2=B,z.endAngle2=B+F),B+=z.size*I}),C.push(T)});const{tension:w}=this.properties.link;S.forEach(T=>{T.radius=M;const R=vS({radius:M,startAngle:T.startAngle1,endAngle:T.endAngle2,tension:w}),_=vS({radius:M,startAngle:T.startAngle2,endAngle:T.endAngle1,tension:w}),N=nc(...R.x,.5),O=nc(...R.y,.5),B=nc(..._.x,.5),z=nc(..._.y,.5);T.midPoint={x:T.centerX+(N+B)/2,y:T.centerY+(O+z)/2},C.push(T)}),f.forEach(T=>{const R=x.get(T.id)?.datum;R!=null&&(T.radius=D+l,T.angle=IO(R.startAngle+ac(R.startAngle,R.endAngle)/2))}),f.sort((T,R)=>T.angle-R.angle);let P=1/0,E=-1/0;return f=f.filter(T=>{const R=cO(h),_=Math.atan2(R/2,T.radius),N=T.angle-_,O=T.angle+_;return kS(P,N,O)||kS(E,N,O)?!1:(P=Math.min(N,P),E=Math.max(O,E),!0)}),{itemId:t,nodeData:C,labelData:f}}updateLabelSelection(t){const e=this.isLabelEnabled()?t.labelData:[];return t.labelSelection.update(e)}updateLabelNodes(t){const e={toKey:this.properties.toKey,fromKey:this.properties.fromKey,sizeKey:this.properties.sizeKey,size:NaN},i=this.ctx.highlightManager?.getActiveHighlight();t.labelSelection.each((o,{size:s,text:a,centerX:n,centerY:r,radius:l,angle:c})=>{e.size=s;const h=TO(this,void 0,e,this.properties.label,!1,i),{fontStyle:d,fontWeight:u,fontSize:g,fontFamily:y,color:f}=h;o.visible=!0,o.translationX=n+l*Math.cos(c),o.translationY=r+l*Math.sin(c),o.text=a,o.fill=f,o.fontStyle=d,o.fontWeight=u,o.fontSize=g,o.fontFamily=y,o.textBaseline="middle",Math.cos(c)>=0?(o.textAlign="left",o.rotation=c):(o.textAlign="right",o.rotation=c-Math.PI),o.setBoxing(h)})}updateNodeSelection(t){return t.datumSelection.update(t.nodeData,void 0,e=>sc(e.type,e.id))}getNodeStyle({datumIndex:t,datum:e,size:i=0,label:o},s,a){const{id:n,properties:r}=this,{fills:l,strokes:c,fillGradientDefaults:h,fillPatternDefaults:d,fillImageDefaults:u}=r,{itemStyler:g}=r.node,y=this.getHighlightStyle(a,t),f=lc(y,r.node.getStyle(l,c,s));let x=rc(f,h,d,u);if(g!=null&&t!=null){const S=this.ctx.highlightManager?.getActiveHighlight(),v=this.cachedDatumCallback(sc(t.index,"node",a?"highlight":"node"),()=>{const m=this.getHighlightStateString(S,a,t);return this.callWithContext(g,{seriesId:n,datum:e,highlighted:a,highlightState:m,...x,size:i,label:o})});v&&(x=rc(lc(v,x),h,d,u))}return x.opacity=1,x}updateNodeNodes(t){const{datumSelection:e,isHighlight:i}=t,o=this.getShapeFillBBox();e.each((s,a)=>{const{datumIndex:n}=a,r=this.getNodeStyle(a,n.index,i);AS(s,r,o),s.centerX=a.centerX,s.centerY=a.centerY,s.innerRadius=a.innerRadius,s.outerRadius=a.outerRadius,s.startAngle=a.startAngle,s.endAngle=a.endAngle,s.inset=s.strokeWidth/2})}updateLinkSelection(t){return t.datumSelection.update(t.nodeData,void 0,e=>sc(e.type,e.index,e.fromNode.id,e.toNode.id))}getLinkStyle({datumIndex:t,datum:e},i,o){const{id:s,properties:a}=this,{fills:n,strokes:r,fillGradientDefaults:l,fillPatternDefaults:c,fillImageDefaults:h}=a,{itemStyler:d}=a.link,u=this.getHighlightStyle(o,t),g=lc(u,a.link.getStyle(n,r,i.index));let y=rc(g,l,c,h);if(d!=null&&t!=null){const f=this.ctx.highlightManager?.getActiveHighlight(),x=this.cachedDatumCallback(sc(t.index,"link",o?"highlight":"node"),()=>{const S=this.getHighlightStateString(f,o,i);return this.callWithContext(d,{seriesId:s,datum:e,highlighted:o,highlightState:S,...y})});x&&(y=rc(lc(x,y),l,c,h))}return y.opacity=1,y}updateLinkNodes(t){const{datumSelection:e,isHighlight:i}=t,o=this.getShapeFillBBox();e.each((s,a)=>{const n=a.fromNode.datumIndex,r=this.getLinkStyle(a,n,i);s.centerX=a.centerX,s.centerY=a.centerY,s.radius=a.radius,s.startAngle1=a.startAngle1,s.endAngle1=a.endAngle1,s.startAngle2=a.startAngle2,s.endAngle2=a.endAngle2,s.tension=r.tension,AS(s,r,o)})}getShapeFillBBox(){const t=this._nodeDataDependencies?.seriesRectWidth??0,e=this._nodeDataDependencies?.seriesRectHeight??0,i=Math.min(t,e),o=(t-i)/2,s=(e-i)/2,a=new wO(o,s,t,e);return{series:a,axis:a}}getTooltipContent(t){const{id:e,linksProcessedData:i,nodesProcessedData:o,properties:s,ctx:{formatManager:a}}=this,{fromKey:n,toKey:r,sizeKey:l,sizeName:c,tooltip:h}=s,d=this.contextNodeData?.nodeData.find(v=>v.datumIndex.type===t.type&&v.datumIndex.index===t.index);if(d==null)return;const u=d.type===0?d.fromNode.index:d.index,g=d.type===0?`${d.fromNode.label} - ${d.toNode.label}`:d.label,y=t.type===0?i?.dataSources.get(this.id)?.[t.index]:o?.dataSources.get(this.id)?.[t.index],f=d.size;let x;if(d.type===0){const v=d.fromNode.datumIndex;x=this.getLinkStyle({datumIndex:t,datum:y},v,!1)}else{const v=d.label;x=this.getNodeStyle({datumIndex:t,datum:y,size:f,label:v},t.index,!1)}const S=[];if(l!=null){const v=a.format(this.callWithContext.bind(this),{type:"number",value:f,datum:y,seriesId:e,legendItemName:void 0,key:l,source:"tooltip",property:"size",domain:[],boundSeries:this.getFormatterContext("size"),fractionDigits:void 0});S.push({label:c,fallbackLabel:l,value:v??String(f)})}return this.formatTooltipWithContext(h,{title:g,symbol:this.legendItemSymbol(d.type,u,x),data:S},{seriesId:e,datum:y,title:g,fromKey:n,toKey:r,sizeKey:l,sizeName:c,size:f,...x})}computeFocusBounds(t){return t}hasItemStylers(){return this.properties.node.itemStyler!=null||this.properties.link.itemStyler!=null}};hc.className="ChordSeries",hc.type="chord";import{_ModuleSupport as NO}from"ag-charts-community";import{constant as PO,fillGradientDefaults as EO,fillImageDefaults as _O,fillPatternDefaults as OO,required as _d,string as pc,undocumented as Od}from"ag-charts-core";var{commonSeriesOptionsDefs:RO,chordSeriesThemeableOptionsDef:BO}=NO,dc={...BO,...RO,type:_d(PO("chord")),fromKey:_d(pc),toKey:_d(pc),sizeKey:pc,sizeName:pc};dc.fillGradientDefaults=Od(EO),dc.fillPatternDefaults=Od(OO),dc.fillImageDefaults=Od(_O);var zO={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["standalone"],solo:!0,identifier:"chord",moduleFactory:t=>new hc(t),themeTemplate:{series:{fills:{$palette:"fills"},strokes:{$palette:"strokes"},fillGradientDefaults:Fn.FILL_GRADIENT_LINEAR_DEFAULTS,fillPatternDefaults:Fn.FILL_PATTERN_DEFAULTS,fillImageDefaults:Fn.FILL_IMAGE_DEFAULTS,highlightStyle:{series:{dimOpacity:.2}},highlight:Fn.singleSeriesHighlightStyle(),label:{...Fn.LABEL_BOXING_DEFAULTS,fontFamily:{$ref:"fontFamily"},fontSize:{$ref:"fontSize"},fontWeight:{$ref:"fontWeight"},color:{$ref:"textColor"},spacing:5,maxWidth:100},node:{spacing:8,width:10,strokeWidth:{$isUserOption:["./stroke",2,0]}},link:{fillOpacity:.5,strokeWidth:{$isUserOption:["./stroke",2,0]},tension:.4}},legend:{enabled:!1,toggleSeries:!1}}},FO={type:"series",name:"chord",chartType:"standalone",enterprise:!0,options:dc,create:t=>new hc(t)};import{_ModuleSupport as Fa}from"ag-charts-community";var{ThemeConstants:{CARTESIAN_AXIS_TYPE:Va,CARTESIAN_POSITION:Ha},ThemeSymbols:{DEFAULT_SHADOW_COLOUR:VO}}=Fa,Ga={$eq:[{$path:["/series/0/direction",void 0]},"horizontal"]},LS={autoRotate:{$path:"/series/0/stageLabel/autoRotate"},autoRotateAngle:{$path:"/series/0/stageLabel/autoRotateAngle"},avoidCollisions:{$path:["/series/0/stageLabel/avoidCollisions",!0]},border:{$path:["/series/0/stageLabel/border"]},color:{$path:["/series/0/stageLabel/color",{$ref:"textColor"}]},cornerRadius:{$path:["/series/0/stageLabel/cornerRadius"]},enabled:{$if:[{$eq:[{$path:"/series/0/stageLabel/enabled"},void 0]},!0,{$path:"/series/0/stageLabel/enabled"}]},fill:{$path:["/series/0/stageLabel/fill"]},fillOpacity:{$path:["/series/0/stageLabel/fillOpacity"]},fontSize:{$path:["/series/0/stageLabel/fontSize",{$ref:"fontSize"}]},fontStyle:{$path:["/series/0/stageLabel/fontStyle",{$ref:"fontStyle"}]},fontWeight:{$path:["/series/0/stageLabel/fontWeight",{$ref:"fontWeight"}]},format:{$path:"/series/0/stageLabel/format"},formatter:{$path:"/series/0/stageLabel/formatter"},itemStyler:{$path:"/series/0/stageLabel/itemStyler"},minSpacing:{$path:"/series/0/stageLabel/minSpacing"},padding:{$path:["/series/0/stageLabel/padding"]},rotation:{$path:["/series/0/stageLabel/rotation",0]}},IS=[{type:{$if:[Ga,Va.NUMBER,Va.CATEGORY]},position:{$if:[Ga,Ha.LEFT,{$if:[{$eq:[{$path:["/series/0/stageLabel/placement",void 0]},"after"]},Ha.RIGHT,Ha.LEFT]}]},label:{$if:[Ga,void 0,LS]}},{type:{$if:[Ga,Va.CATEGORY,Va.NUMBER]},position:{$if:[Ga,{$if:[{$eq:[{$path:["/series/0/stageLabel/placement",void 0]},"before"]},Ha.TOP,Ha.BOTTOM]},Ha.BOTTOM]},label:{$if:[Ga,LS,void 0]}}],HO={series:{direction:"vertical",strokeWidth:{$isUserOption:["./strokes/0",2,0]},spacingRatio:.25,fills:{$applyCycle:[{$size:{$path:["./data",{$path:"/data"}]}},[{$path:["/0",void 0,{$palette:"fills"}]}],{$applySwitch:[{$path:["/type",void 0,{$value:"$1"}]},{$value:"$1"},["gradient",Fa.FILL_GRADIENT_LINEAR_SINGLE_DEFAULTS],["pattern",Fa.FILL_PATTERN_SINGLE_DEFAULTS],["image",Fa.FILL_IMAGE_DEFAULTS]]}]},strokes:{$applyCycle:[{$size:{$path:["./data",{$path:"/data"}]}},[{$path:["/0",void 0,{$palette:"strokes"}]}]]},label:{...Fa.LABEL_BOXING_DEFAULTS,enabled:!0,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"chartBackgroundColor"}},dropOff:{enabled:!0,fillOpacity:.2,strokeWidth:{$isUserOption:["./stroke",2,0]}},shadow:{enabled:!1,color:VO,xOffset:3,yOffset:3,blur:5},highlight:Fa.singleSeriesHighlightStyle()},axes:{[Va.NUMBER]:{nice:!1,gridLine:{enabled:!1},crosshair:{enabled:!1},label:{enabled:!1}},[Va.CATEGORY]:{line:{enabled:!1}}}};import{_ModuleSupport as GO}from"ag-charts-community";import{_ModuleSupport as Rd}from"ag-charts-community";import{_ModuleSupport as WO}from"ag-charts-community";var{lineDistanceSquared:uc,BBox:KO,Path:$O,SceneChangeDetection:Xo}=WO,CS=1e-6;function TS([t,e],[i,o]){return Math.abs(t-i)<=CS&&Math.abs(e-o)<=CS}var $i=class extends $O{constructor(){super(...arguments),this.x0=0,this.y0=0,this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.x3=0,this.y3=0}get midPoint(){const{x0:t,y0:e,x1:i,y1:o,x2:s,y2:a,x3:n,y3:r}=this;return{x:(t+i+s+n)/4,y:(e+o+a+r)/4}}distanceSquared(t,e){if(this.containsPoint(t,e))return 0;const{x0:i,y0:o,x1:s,y1:a,x2:n,y2:r,x3:l,y3:c}=this;return Math.min(uc(t,e,i,o,s,a,1/0),uc(t,e,s,a,n,r,1/0),uc(t,e,n,r,l,c,1/0),uc(t,e,l,c,i,o,1/0))}computeBBox(){const{x0:t,y0:e,x1:i,y1:o,x2:s,y2:a,x3:n,y3:r}=this,l=Math.min(t,i,s,n),c=Math.max(t,i,s,n)-l,h=Math.min(e,o,a,r),d=Math.max(e,o,a,r)-h;return new KO(l,h,c,d)}updatePath(){const{path:t,x0:e,y0:i,x1:o,y1:s,x2:a,y2:n,x3:r,y3:l}=this,c=[[e,i],[o,s],[a,n],[r,l]];t.clear();let h,d;c.forEach(u=>{if(h!=null&&TS(h,u)||d!=null&&TS(d,u))return;const[g,y]=u;h==null?t.moveTo(g,y):t.lineTo(g,y),h??(h=u),d=u}),t.closePath()}};p([Xo()],$i.prototype,"x0",2),p([Xo()],$i.prototype,"y0",2),p([Xo()],$i.prototype,"x1",2),p([Xo()],$i.prototype,"y1",2),p([Xo()],$i.prototype,"x2",2),p([Xo()],$i.prototype,"y2",2),p([Xo()],$i.prototype,"x3",2),p([Xo()],$i.prototype,"y3",2);import{_ModuleSupport as jO}from"ag-charts-community";var{NODE_UPDATE_STATE_TO_PHASE_MAPPING:YO}=jO;function wS(t,e,i,o){const{x0:s,y0:a,x1:n,y1:r,x2:l,y2:c,x3:h,y3:d,opacity:u}=t;return i?{x0:(s+h)/2,y0:(a+d)/2,x1:(n+l)/2,y1:(r+c)/2,x2:(n+l)/2,y2:(r+c)/2,x3:(s+h)/2,y3:(a+d)/2,opacity:u}:{x0:(s+n)/2,y0:(a+r)/2,x1:(s+n)/2,y1:(a+r)/2,x2:(l+h)/2,y2:(c+d)/2,x3:(l+h)/2,y3:(c+d)/2,opacity:u}}function UO(t,e){const i=a=>a==null;return{fromFn:(a,n,r)=>{r==="updated"&&i(n)?r="removed":r==="updated"&&i(a.previousDatum)&&(r="added");let l;r==="added"&&a.previousDatum==null&&e==="fade"?l={...Vn(a,n),opacity:0}:r==="unknown"||r==="added"?l=wS(n,a.previousDatum,t,e):l={x0:a.x0,y0:a.y0,x1:a.x1,y1:a.y1,x2:a.x2,y2:a.y2,x3:a.x3,y3:a.y3,opacity:a.opacity};const c=YO[r];return{...l,phase:c}},toFn:(a,n,r)=>{let l;return r==="removed"&&a.datum==null&&e==="fade"?l={...Vn(a,n),opacity:0}:r==="removed"||i(n)?l=wS(n,a.previousDatum,t,e):l=Vn(a,n),l}}}function Vn(t,e){const{x0:i,y0:o,x1:s,y1:a,x2:n,y2:r,x3:l,y3:c,opacity:h}=e;return{x0:i,y0:o,x1:s,y1:a,x2:n,y2:r,x3:l,y3:c,opacity:h}}var{SeriesNodePickMode:NS,SeriesZIndexMap:PS,valueProperty:XO,keyProperty:ZO,ChartAxisDirection:qO,updateLabelNode:QO,SMALLEST_KEY_INTERVAL:JO,LARGEST_KEY_INTERVAL:tR,diff:eR,fixNumericExtent:iR,seriesLabelFadeInAnimation:ES,resetMotion:oR,resetLabelFn:sR,animationValidation:aR,computeBarFocusBounds:nR,ContinuousScale:rR,Group:lR,Selection:cR,PointerEvents:_S,motion:hR,checkCrisp:pR,createDatumId:dR,applyShapeStyle:uR}=Rd,gR=class extends Rd.SeriesNodeEvent{constructor(t,e,i,o){super(t,e,i,o),this.xKey=o.properties.stageKey,this.yKey=o.properties.valueKey}},OS=class extends Rd.AbstractBarSeries{constructor({moduleCtx:t,animationResetFns:e}){super({moduleCtx:t,pickModes:[NS.AXIS_ALIGNED,NS.EXACT_SHAPE_MATCH],propertyKeys:{x:["stageKey"],y:["valueKey"]},propertyNames:{x:[],y:[]},categoryKey:"xValue",datumSelectionGarbageCollection:!1,animationResetFns:{datum:e.datum,label:sR}}),this.NodeEvent=gR,this.connectorNodeGroup=this.contentGroup.appendChild(new lR({name:`${this.id}-series-connectorNodes`,zIndex:PS.BACKGROUND})),this.connectorSelection=cR.select(this.connectorNodeGroup,()=>this.connectionFactory()),this.connectorNodeGroup.pointerEvents=_S.None}get pickModeAxis(){return"main-category"}setZIndex(t){return super.setZIndex(t),this.connectorNodeGroup.zIndex=[PS.BACKGROUND,t],!0}isVertical(){return!super.isVertical()}connectionFactory(){return new $i}async processData(t){const{stageKey:e,valueKey:i}=this.properties,{visible:o,id:s}=this,a=(y,f,x)=>o&&this.ctx.legendManager.getItemEnabled({seriesId:s,itemId:x}),n=this.getCategoryAxis()?.scale,r=this.getValueAxis()?.scale,{isContinuousX:l,xScaleType:c,yScaleType:h}=this.getScaleInformation({xScale:n,yScale:r}),d=[];this.ctx.animationManager.isSkipped()||(this.processedData&&d.push(eR(this.id,this.processedData)),d.push(aR()));const u=this.visible?{}:{forceValue:0},{processedData:g}=await this.requestDataModel(t,this.data,{props:[ZO(e,c,{id:"xValue"}),XO(i,h,{id:"yValue",...u,validation:a,invalidValue:0}),...l?[JO,tR]:[],...d],groupByKeys:!1});this.smallestDataInterval=g.reduced?.smallestKeyInterval,this.largestDataInterval=g.reduced?.largestKeyInterval,this.animationState.transition("updateData")}getSeriesDomain(t){const{processedData:e,dataModel:i,id:o,ctx:{legendManager:s}}=this;if(!e||!i)return[];const{keys:[a]}=e.domain;if(t===this.getCategoryDirection()){const n=i.resolveProcessedDataDefById(this,"xValue");return n?.def.type==="key"&&n?.def.valueType==="category"?this.hasData?a.filter((r,l)=>s.getItemEnabled({seriesId:o,itemId:l})):[]:this.padBandExtent(a)}else{const n=this.domainForClippedRange(t,["yValue"],"xValue"),r=Math.max(...n),l=[-r,r];return iR(l)}}getSeriesRange(t,e){return[NaN,NaN]}createNodeData(){const{hasData:t,data:e,dataModel:i,groupScale:o,processedData:s,id:a,ctx:{legendManager:n}}=this,r=this.getCategoryAxis(),l=this.getValueAxis();if(!(t&&e&&r&&l&&i&&s?.type==="ungrouped"))return;const c=r.scale,h=l.scale,d=this.getBarDirection()===qO.X,{stageKey:u,valueKey:g}=this.properties,y=`${g}`,f={itemId:y,nodeData:[],labelData:[],connectorData:[],scales:this.calculateScaling(),groupScale:this.getScaling(this.groupScale),visible:this.visible},x=this.visible;if(!x)return f;const S=i.resolveKeysById(this,"xValue",s),v=i.resolveColumnById(this,"yValue",s),{barWidth:m,groupIndex:b}=this.updateGroupScale(r),M=rR.is(c)?m*-.5:0,k=pR(r?.scale,r?.visibleRange,this.smallestDataInterval,this.largestDataInterval);let A;return(s.dataSources.get(this.id)??[]).forEach((I,L)=>{const C=x&&n.getItemEnabled({seriesId:a,itemId:L}),w=S[L];if(w==null)return;const P=Math.round(c.convert(w))+o.convert(String(b))+M,E=v[L],T=Math.round(h.convert(-E)),R=Math.round(h.convert(E)),_=this.getItemStyle({datum:I,datumIndex:L},!1),N=Math.max(_.strokeWidth??0,Math.abs(R-T)),O={x:d?Math.min(R,T):P,y:d?P:Math.min(R,T),width:d?N:m,height:d?m:N},B={x:O.x+O.width/2,y:O.y+O.height/2},z=this.createLabelData({datumIndex:L,rect:O,barAlongX:d,yDatum:E,datum:I,visible:C}),V={index:L,series:this,itemId:y,datum:I,datumIndex:L,xValue:w,yValue:E,xKey:u,yKey:g,x:O.x,y:O.y,width:O.width,height:O.height,midPoint:B,crisp:k,label:z,visible:C};if(f.nodeData.push(V),z!=null&&f.labelData.push(z),A!=null){const F=A.rect,H=A.nodeDatum,W=A.datumIndex;d?f.connectorData.push({datum:H,datumIndex:W,x0:F.x,y0:F.y+F.height,x1:F.x+F.width,y1:F.y+F.height,x2:O.x+O.width,y2:O.y,x3:O.x,y3:O.y,opacity:1}):f.connectorData.push({datum:H,datumIndex:W,x0:F.x+F.width,y0:F.y,x1:O.x,y1:O.y,x2:O.x,y2:O.y+O.height,x3:F.x+F.width,y3:F.y+F.height,opacity:1})}C&&(A={itemId:y,rect:O,nodeDatum:V,datumIndex:L})}),f}updateNodes(t,e){super.updateNodes(t,e);const{connectorSelection:i}=this,o=this.contextNodeData?.connectorData??[];this.connectorSelection=this.updateConnectorSelection({connectorSelection:i,connectorData:o}),this.updateConnectorNodes({connectorSelection:i})}updateDatumSelection(t){const{nodeData:e,datumSelection:i}=t,o=e??[];return i.update(o,void 0,s=>this.getDatumId(s))}updateConnectorSelection(t){const{connectorData:e,connectorSelection:i}=t;return i.update(this.connectorEnabled()?e:[],void 0,o=>this.getDatumId(o.datum))}updateConnectorNodes(t){const e=this.getShapeFillBBox();t.connectorSelection.each((i,o)=>{const{fill:s,fillOpacity:a,stroke:n,strokeOpacity:r,strokeWidth:l,lineDash:c,lineDashOffset:h}=this.connectorStyle(o.datumIndex);i.setProperties(Vn(i,o)),uR(i,{fill:s,stroke:n,fillOpacity:a,strokeOpacity:r,strokeWidth:l,lineDash:c,lineDashOffset:h},e)})}updateLabelSelection(t){const e=this.properties.label.enabled?t.labelData:[];return t.labelSelection.update(e,i=>{i.pointerEvents=_S.None})}updateLabelNodes(t){const e={stageKey:this.properties.stageKey,valueKey:this.properties.valueKey},i=this.ctx.highlightManager?.getActiveHighlight();t.labelSelection.each((o,s)=>{o.fillOpacity=this.getHighlightStyle(!1,s.datumIndex).opacity??1,QO(this,o,e,this.properties.label,s,!1,i)})}getTooltipContent(t){const{id:e,dataModel:i,processedData:o,properties:s}=this,{stageKey:a,valueKey:n,tooltip:r,legendItemName:l}=s,c=this.getCategoryAxis(),h=this.getValueAxis();if(!i||!o||!c||!h)return;const d=o.dataSources.get(this.id)?.[t],u=i.resolveKeysById(this,"xValue",o)[t],g=i.resolveColumnById(this,"yValue",o)[t];if(u!=null)return this.formatTooltipWithContext(r,{symbol:this.legendItemSymbol(t),data:[{label:this.getAxisValueText(c,"tooltip",u,d,a,l),value:this.getAxisValueText(h,"tooltip",g,d,n,l)}]},{seriesId:e,datum:d,title:a,stageKey:a,valueKey:n,...this.tooltipStyle(d,t)})}resetAllAnimation(t){super.resetAllAnimation(t),oR([this.connectorSelection],Vn)}animateEmptyUpdateReady({labelSelection:t}){const{connectorSelection:e}=this,i=this.isVertical(),s=UO(i,"normal");hR.fromToMotion(this.id,"connectors",this.ctx.animationManager,[e],s),ES(this,"labels",this.ctx.animationManager,t)}animateWaitingUpdateReady(t){const{labelSelection:e}=t;this.ctx.animationManager.stopByAnimationGroupId(this.id),ES(this,"labels",this.ctx.animationManager,e)}getDatumId(t){return dR(t.xValue)}isLabelEnabled(){return this.properties.label.enabled}computeFocusBounds({datumIndex:t}){return nR(this,this.contextNodeData?.nodeData[t])}legendItemSymbol(t){const{strokeWidth:e,fillOpacity:i,strokeOpacity:o,lineDash:s,lineDashOffset:a,fill:n,stroke:r}=this.properties.getStyle(t);return{marker:{fill:n,fillOpacity:i,stroke:r,strokeWidth:e,strokeOpacity:o,lineDash:s,lineDashOffset:a}}}getLegendData(t){const{id:e,processedData:i,dataModel:o,ctx:{legendManager:s},visible:a}=this;if(!o||!i||t!=="category")return[];const{showInLegend:n}=this.properties,r=o.resolveKeysById(this,"xValue",i);return(i.dataSources.get(this.id)??[]).map((l,c)=>{const h=r[c];if(h!=null)return{legendType:"category",id:e,datum:l,itemId:c,seriesId:e,enabled:a&&s.getItemEnabled({seriesId:e,itemId:c}),label:{text:String(h)},symbol:this.legendItemSymbol(c),skipAnimations:!0,hideInLegend:!n}}).filter(l=>l!=null)}hasItemStylers(){return this.properties.itemStyler!=null}};import{_ModuleSupport as yR}from"ag-charts-community";var{Label:fR,AbstractBarSeriesProperties:mR,makeSeriesTooltip:xR,AxisLabel:SR,Property:Me}=yR,Bd=class extends fR{constructor(){super(...arguments),this.spacing=0}};p([Me],Bd.prototype,"placement",2),p([Me],Bd.prototype,"spacing",2);var RS=class extends SR{};p([Me],RS.prototype,"placement",2);var Ye=class extends mR{constructor(){super(...arguments),this.fills=[],this.fillOpacity=1,this.strokes=[],this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.label=new Bd,this.stageLabel=new RS,this.tooltip=xR()}getStyle(t){const{fills:e,strokes:i,fillOpacity:o,strokeWidth:s,strokeOpacity:a,lineDash:n,lineDashOffset:r}=this;return{fill:e[t],fillOpacity:o,stroke:i[t],strokeWidth:s,strokeOpacity:a,lineDash:n,lineDashOffset:r,opacity:1}}};p([Me],Ye.prototype,"stageKey",2),p([Me],Ye.prototype,"valueKey",2),p([Me],Ye.prototype,"fills",2),p([Me],Ye.prototype,"fillOpacity",2),p([Me],Ye.prototype,"strokes",2),p([Me],Ye.prototype,"strokeWidth",2),p([Me],Ye.prototype,"strokeOpacity",2),p([Me],Ye.prototype,"lineDash",2),p([Me],Ye.prototype,"lineDashOffset",2),p([Me],Ye.prototype,"label",2),p([Me],Ye.prototype,"stageLabel",2),p([Me],Ye.prototype,"tooltip",2);function BS(t,{x:e,y:i,width:o,height:s,opacity:a}){return{x1:e,y1:i,x2:e+o,y2:i+s,opacity:a??1}}var{Line:bR,ChartAxisDirection:vR}=GO,gc=class extends OS{constructor(t){super({moduleCtx:t,animationResetFns:{datum:BS}}),this.properties=new Ye}get hasData(){const{id:t,ctx:{legendManager:e}}=this,i=this.data?.reduce((o,s,a)=>o+(e.getItemEnabled({seriesId:t,itemId:a})?1:0),0);return i!=null&&i>1}getBandScalePadding(){return{inner:1,outer:0}}connectorEnabled(){return!0}getItemStyle({datumIndex:t},e){return this.properties.getStyle(t)}connectorStyle(t){return this.properties.getStyle(t)}nodeFactory(){return new bR}createLabelData({datumIndex:t,rect:e,barAlongX:i,yDatum:o,datum:s,visible:a}){const{stageKey:n,valueKey:r,label:l}=this.properties,{spacing:c,placement:h}=l;if(!l.enabled)return;let d,u,g,y;if(i)switch(d=e.x+e.width/2,g="center",h){case"before":u=e.y-c,y="bottom";break;case"after":u=e.y+e.height+c,y="top";break;default:u=e.y+e.height/2,y="middle"}else switch(u=e.y+e.height/2,y="middle",h){case"before":d=e.x-c,g="right";break;case"after":d=e.x+e.width+c,g="left";break;default:d=e.x+e.width/2,g="center"}const f=this.getSeriesDomain(vR.Y),x=this.getLabelText(o,s,r,"y",f,l,{itemId:r,value:o,datum:s,stageKey:n,valueKey:r});return{x:d,y:u,textAlign:g,textBaseline:y,text:x,itemId:r,datum:s,datumIndex:t,series:this,visible:a}}updateDatumNodes(t){const e=this.getHighlightStyle(t.isHighlight);t.datumSelection.each((i,o)=>{i.setProperties(BS(i,o)),i.stroke=e?.stroke,i.strokeWidth=e?.strokeWidth??0,i.strokeOpacity=e?.strokeOpacity??1,i.lineDash=e?.lineDash,i.lineDashOffset=e?.lineDashOffset??0,i.opacity=e?.opacity??1})}tooltipStyle(t,e){const{fill:i,stroke:o,fillOpacity:s,strokeOpacity:a,strokeWidth:n,lineDash:r,lineDashOffset:l}=this.properties.getStyle(e);return{fill:i,fillOpacity:s,stroke:o,strokeOpacity:a,strokeWidth:n,lineDash:r,lineDashOffset:l}}hasItemStylers(){return this.properties.label.itemStyler!=null}};gc.className="ConeFunnelSeries",gc.type="cone-funnel";import{_ModuleSupport as MR}from"ag-charts-community";import{constant as DR,required as zd,string as zS}from"ag-charts-core";var{commonSeriesOptionsDefs:kR,coneFunnelSeriesThemeableOptionsDef:AR,without:LR}=MR,IR={...LR(kR,["showInLegend"]),...AR,type:zd(DR("cone-funnel")),stageKey:zd(zS),valueKey:zd(zS)};import{_ModuleSupport as Zo}from"ag-charts-community";var{ThemeConstants:{CARTESIAN_AXIS_TYPE:FS}}=Zo,CR={series:{direction:"vertical",fills:{$applyCycle:[{$size:{$path:["./data",{$path:"/data"}]}},{$if:[{$eq:[{$palette:"type"},"inbuilt"]},{$palette:"secondSequentialColors"},Zo.SAFE_RANGE2_OPERATION]},{$applySwitch:[{$path:["/type",void 0,{$value:"$1"}]},{$value:"$1"},["gradient",Zo.FILL_GRADIENT_LINEAR_SINGLE_DEFAULTS],["pattern",Zo.FILL_PATTERN_SINGLE_DEFAULTS],["image",Zo.FILL_IMAGE_DEFAULTS]]}]},strokes:{$applyCycle:[{$size:{$path:["./data",{$path:"/data"}]}},{$if:[{$eq:[{$palette:"type"},"inbuilt"]},{$palette:"secondSequentialColors"},Zo.SAFE_RANGE2_OPERATION]}]},strokeWidth:{$isUserOption:["./strokes/0",2,0]},label:{...Zo.LABEL_BOXING_DEFAULTS,enabled:!0,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"textColor"},placement:"before",spacing:4},tooltip:{range:{$path:["/tooltip/range","nearest"]}},highlight:Zo.singleSeriesHighlightStyle(!1)},seriesArea:{padding:{top:20,bottom:20}},axes:{[FS.NUMBER]:{nice:!1,gridLine:{enabled:!1},crosshair:{enabled:!1},label:{enabled:!1}},[FS.CATEGORY]:{line:{enabled:!1}}}},TR={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["cartesian"],identifier:"cone-funnel",moduleFactory:t=>new gc(t),solo:!0,defaultAxes:IS,themeTemplate:CR},wR={type:"series",name:"cone-funnel",chartType:"cartesian",enterprise:!0,options:IR,create:t=>new gc(t)};import{_ModuleSupport as NR}from"ag-charts-community";import{_ModuleSupport as PR}from"ag-charts-community";var{Label:ER,DropShadow:_R,AbstractBarSeriesProperties:OR,BaseProperties:RR,makeSeriesTooltip:BR,AxisLabel:zR,Property:mt}=PR,FR=class extends ER{},VS=class extends zR{};p([mt],VS.prototype,"placement",2);var bo=class extends RR{constructor(){super(...arguments),this.enabled=!0,this.fill=void 0,this.fillOpacity=1,this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0}getStyle(){const{fill:t,stroke:e,fillOpacity:i,strokeWidth:o,strokeOpacity:s,lineDash:a,lineDashOffset:n}=this;return{fill:t,fillOpacity:i,stroke:e,strokeWidth:o,strokeOpacity:s,lineDash:a,lineDashOffset:n,opacity:1}}};p([mt],bo.prototype,"enabled",2),p([mt],bo.prototype,"fill",2),p([mt],bo.prototype,"fillOpacity",2),p([mt],bo.prototype,"stroke",2),p([mt],bo.prototype,"strokeWidth",2),p([mt],bo.prototype,"strokeOpacity",2),p([mt],bo.prototype,"lineDash",2),p([mt],bo.prototype,"lineDashOffset",2);var ne=class extends OR{constructor(){super(...arguments),this.fills=[],this.fillOpacity=1,this.strokes=[],this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.spacingRatio=0,this.dropOff=new bo,this.shadow=new _R().set({enabled:!1}),this.label=new FR,this.stageLabel=new VS,this.tooltip=BR()}getStyle(t){const{fills:e,strokes:i,fillOpacity:o,strokeWidth:s,strokeOpacity:a,lineDash:n,lineDashOffset:r}=this;return{fill:e[t],fillOpacity:o,stroke:i[t],strokeWidth:s,strokeOpacity:a,lineDash:n,lineDashOffset:r,opacity:1}}};p([mt],ne.prototype,"stageKey",2),p([mt],ne.prototype,"valueKey",2),p([mt],ne.prototype,"fills",2),p([mt],ne.prototype,"fillOpacity",2),p([mt],ne.prototype,"strokes",2),p([mt],ne.prototype,"strokeWidth",2),p([mt],ne.prototype,"strokeOpacity",2),p([mt],ne.prototype,"lineDash",2),p([mt],ne.prototype,"lineDashOffset",2),p([mt],ne.prototype,"spacingRatio",2),p([mt],ne.prototype,"itemStyler",2),p([mt],ne.prototype,"dropOff",2),p([mt],ne.prototype,"shadow",2),p([mt],ne.prototype,"label",2),p([mt],ne.prototype,"stageLabel",2),p([mt],ne.prototype,"tooltip",2);var{ChartAxisDirection:HS,resetBarSelectionsFn:VR,prepareBarAnimationFunctions:GS,midpointStartingBarPosition:WS,createDatumId:HR,Rect:GR,motion:KS,applyShapeStyle:WR,mergeDefaults:Fd}=NR,yc=class extends OS{constructor(t){super({moduleCtx:t,animationResetFns:{datum:VR}}),this.properties=new ne}getBandScalePadding(){return{inner:this.properties.spacingRatio,outer:0}}connectorEnabled(){return this.properties.dropOff.enabled}connectorStyle(t){return Fd(this.properties.dropOff.getStyle(),this.properties.getStyle(t))}nodeFactory(){return new GR}createLabelData({datumIndex:t,rect:e,yDatum:i,datum:o,visible:s}){const{valueKey:a,stageKey:n,label:r}=this.properties;if(!r.enabled)return;const l=this.getSeriesDomain(HS.Y),c=this.getLabelText(i,o,a,"y",l,r,{itemId:a,value:i,datum:o,stageKey:n,valueKey:a});return{x:e.x+e.width/2,y:e.y+e.height/2,textAlign:"center",textBaseline:"middle",text:c,itemId:n,datum:o,datumIndex:t,series:this,visible:s}}getItemStyle({datum:t,datumIndex:e},i){const{id:o,properties:s}=this,{stageKey:a,valueKey:n,itemStyler:r}=s,l=this.getHighlightStyle(i,e);let h=Fd(l,s.getStyle(e));if(r!=null){const d=this.ctx.highlightManager?.getActiveHighlight(),u=this.cachedDatumCallback(HR(e,i?"highlight":"node"),()=>{const g=this.getHighlightStateString(d,i,e);return this.callWithContext(r,{seriesId:o,datum:t,highlighted:i,highlightState:g,stageKey:a,valueKey:n,...h})});u&&(h=Fd(u,h))}return h}updateDatumNodes({datumSelection:t,isHighlight:e}){const{contextNodeData:i}=this;if(!i)return;const{shadow:o}=this.properties,s=this.getCategoryDirection()===HS.X,a=this.getShapeFillBBox();t.each((n,r)=>{const l=this.getItemStyle(r,e);WR(n,l,a),n.visible=s?r.width>0:r.height>0,n.crisp=r.crisp,n.fillShadow=o})}tooltipStyle(t,e){return this.getItemStyle({datum:t,datumIndex:e},!1)}animateEmptyUpdateReady(t){super.animateEmptyUpdateReady(t);const{datumSelection:e}=t,i=this.isVertical(),s=GS(WS(i,"normal"),"unknown");KS.fromToMotion(this.id,"datums",this.ctx.animationManager,[e],s)}animateWaitingUpdateReady(t){super.animateWaitingUpdateReady(t);const{datumSelection:e}=t,{processedData:i}=this,o=i?.reduced?.diff?.[this.id],s=GS(WS(this.isVertical(),"fade"),"added");KS.fromToMotion(this.id,"datums",this.ctx.animationManager,[e],s,(a,n)=>n.xValue,o)}hasItemStylers(){return this.properties.itemStyler!=null||this.properties.label.itemStyler!=null}};yc.className="FunnelSeries",yc.type="funnel";import{_ModuleSupport as KR}from"ag-charts-community";import{constant as $R,required as Vd,string as $S}from"ag-charts-core";var{commonSeriesOptionsDefs:jR,funnelSeriesThemeableOptionsDef:YR,without:UR}=KR,XR={...YR,...UR(jR,["showInLegend"]),type:Vd($R("funnel")),stageKey:Vd($S),valueKey:Vd($S)},ZR={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["cartesian"],identifier:"funnel",moduleFactory:t=>new yc(t),solo:!0,defaultAxes:IS,themeTemplate:HO},qR={type:"series",name:"funnel",chartType:"cartesian",enterprise:!0,options:XR,create:t=>new yc(t)};import{_ModuleSupport as Hn}from"ag-charts-community";import{_ModuleSupport as Wa}from"ag-charts-community";import{cachedTextMeasurer as jS}from"ag-charts-core";var YS=class{*[Symbol.iterator](){const{node:t,datum:e}=this;t&&e&&(yield{node:t,datum:e})}nodes(){return this.node?[this.node]:[]}update(t,e,i,o){const s=t.nodes();if(s.length===0)this.node?.remove(),this.node=void 0;else{this.node===void 0&&(this.node=new i,this.node.fillOpacity=0,this.node.strokeOpacity=0,e.appendChild(this.node));const a=s[0],n=s.toReversed().find(r=>r.datum.datum.value>r.datum.datum.segmentStart)??s[s.length-1];this.node.datum=this.datum=a.datum,o(this.node,a,n)}}},US={fromFn:()=>({opacity:0,phase:"initial"}),toFn:()=>({opacity:1})};function XS(t,e){if(t==null)return"";const{min:i,max:o}=e,s=i!==0?Math.ceil(Math.log10(Math.abs(i))):0,a=o!==0?Math.ceil(Math.log10(Math.abs(o))):0,n=Math.max(2-Math.max(s,a),0);return t.toFixed(n)}function Gn(t,e,i,o){if(i.text!=null)return i.text;const s=o??i.value;let a;if(i?.formatter!=null&&(a=Bn(e,i.formatter,{seriesId:t,datum:void 0,value:s})),a!=null)return String(a)}function ZS({path:t,x:e,y:i,size:o}){t.moveTo(e,i-o/2),t.lineTo(e,i+o/2)}import{clamp as qS,iterate as QR}from"ag-charts-core";function QS(t,e){const i=QR(t.datumUnion.nodes(),t.targetSelection.nodes());return t.pickNodeNearestDistantObject(e,i)}function JS(t,e){const i=[{data:t.contextNodeData?.nodeData,selection:t.datumUnion},{data:t.contextNodeData?.targetData,selection:t.targetSelection}].filter(l=>l.data&&l.data.length>0),o=qS(0,e.otherIndex+e.otherIndexDelta,i.length-1);if(i.length===0)return;const{data:s,selection:a}=i[o];if(s==null||s.length===0)return;const n=qS(0,e.datumIndex,s.length-1),r=s[n];for(const l of a)if(l.datum===r)return{bounds:l.node,clipFocusBox:!0,datum:r,datumIndex:n,otherIndex:o}}import{_ModuleSupport as Hd}from"ag-charts-community";import{_ModuleSupport as JR}from"ag-charts-community";import{Logger as tB}from"ag-charts-core";var{BaseProperties:tb,Property:Ka}=JR,fc=class extends tb{getSegments(t,e){const{values:i,step:o,count:s}=this,a=Math.min(...t.domain),n=Math.max(...t.domain);let r;if(i!=null){const l=i.filter(c=>c>a&&c<n).sort((c,h)=>c-h);r=[a,...l,n]}else if(o!=null){const l=[];for(let c=a;c<n;c+=o)l.push(c);l.push(n),r=l}else if(s!=null){const l=s+1;r=Array.from({length:l+1},(c,h)=>h/l*(n-a)+a)}else{const l=t.ticks({nice:!0,interval:void 0,tickCount:void 0,minTickCount:0,maxTickCount:1/0})?.ticks?.filter(c=>c>a&&c<n);r=l!=null?[a,...l,n]:void 0}return r!=null&&r.length>e&&(tB.warnOnce("the configured segmentation results in more than 1 item per pixel, ignoring. Supply a segmentation configuration that results in larger segments or omit this configuration"),r=void 0),r??(r=[a,n]),r}};p([Ka],fc.prototype,"values",2),p([Ka],fc.prototype,"step",2),p([Ka],fc.prototype,"count",2);var Wn=class extends tb{constructor(){super(...arguments),this.enabled=!1,this.interval=new fc,this.spacing=0}};p([Ka],Wn.prototype,"enabled",2),p([Ka],Wn.prototype,"interval",2),p([Ka],Wn.prototype,"spacing",2);var{BaseProperties:mc,makeSeriesTooltip:eB,SeriesProperties:iB,PropertiesArray:Gd,Property:j,Label:oB,AxisLabel:sB,getColorStops:aB}=Hd,eb=class extends oB{};p([j],eb.prototype,"spacing",2);var re=class extends mc{constructor(){super(...arguments),this.value=0,this.label=new eb}getStyle(t){const{fill:e=t.fill??"black",fillOpacity:i=t.fillOpacity??1,stroke:o=t.stroke??"black",strokeWidth:s=t.strokeWidth??0,strokeOpacity:a=t.strokeOpacity??1,lineDash:n=t.lineDash??[0],lineDashOffset:r=t.lineDashOffset??0}=this;return{fill:e,fillOpacity:i,stroke:o,strokeWidth:s,strokeOpacity:a,lineDash:n,lineDashOffset:r}}};p([j],re.prototype,"text",2),p([j],re.prototype,"value",2),p([j],re.prototype,"shape",2),p([j],re.prototype,"placement",2),p([j],re.prototype,"spacing",2),p([j],re.prototype,"size",2),p([j],re.prototype,"rotation",2),p([j],re.prototype,"fill",2),p([j],re.prototype,"fillOpacity",2),p([j],re.prototype,"stroke",2),p([j],re.prototype,"strokeWidth",2),p([j],re.prototype,"strokeOpacity",2),p([j],re.prototype,"lineDash",2),p([j],re.prototype,"lineDashOffset",2),p([j],re.prototype,"label",2);var Ue=class extends mc{constructor(){super(...arguments),this.enabled=!0,this.thicknessRatio=1,this.fills=new Gd(Hd.StopProperties),this.fillMode="continuous",this.fillOpacity=1,this.stroke="black",this.strokeWidth=0,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0}getStyle(t,e,i){const{fill:o,fills:s,fillMode:a,fillOpacity:n,stroke:r,strokeWidth:l,strokeOpacity:c,lineDash:h,lineDashOffset:d}=this;return{fill:o??ob(s,a,t,i,e),fillOpacity:n,stroke:r,strokeWidth:l,strokeOpacity:c,lineDash:h,lineDashOffset:d}}};p([j],Ue.prototype,"enabled",2),p([j],Ue.prototype,"thickness",2),p([j],Ue.prototype,"thicknessRatio",2),p([j],Ue.prototype,"fills",2),p([j],Ue.prototype,"fillMode",2),p([j],Ue.prototype,"fill",2),p([j],Ue.prototype,"fillOpacity",2),p([j],Ue.prototype,"stroke",2),p([j],Ue.prototype,"strokeWidth",2),p([j],Ue.prototype,"strokeOpacity",2),p([j],Ue.prototype,"lineDash",2),p([j],Ue.prototype,"lineDashOffset",2);var Kn=class extends mc{constructor(){super(...arguments),this.values=void 0,this.step=void 0,this.minSpacing=0,this.maxSpacing=1e3}};p([j],Kn.prototype,"values",2),p([j],Kn.prototype,"step",2),p([j],Kn.prototype,"minSpacing",2),p([j],Kn.prototype,"maxSpacing",2);var ib=class extends sB{constructor(){super(...arguments),this.placement=void 0}};p([j],ib.prototype,"placement",2);var fe=class extends mc{constructor(){super(...arguments),this.min=0,this.max=1,this.fills=new Gd(Hd.StopProperties),this.fillMode="continuous",this.fillOpacity=1,this.stroke="black",this.strokeWidth=0,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.defaultFill="black",this.interval=new Kn,this.label=new ib}getStyle(t,e,i,o){const{fill:s,fills:a,defaultFill:n,fillMode:r,fillOpacity:l,stroke:c,strokeWidth:h,strokeOpacity:d,lineDash:u,lineDashOffset:g}=this;return{fill:s??(t&&a.length===0?n:void 0)??ob(a,r,e,o,i),fillOpacity:l,stroke:c,strokeWidth:h,strokeOpacity:d,lineDash:u,lineDashOffset:g}}};p([j],fe.prototype,"min",2),p([j],fe.prototype,"max",2),p([j],fe.prototype,"fills",2),p([j],fe.prototype,"fillMode",2),p([j],fe.prototype,"fill",2),p([j],fe.prototype,"fillOpacity",2),p([j],fe.prototype,"stroke",2),p([j],fe.prototype,"strokeWidth",2),p([j],fe.prototype,"strokeOpacity",2),p([j],fe.prototype,"lineDash",2),p([j],fe.prototype,"lineDashOffset",2),p([j],fe.prototype,"defaultFill",2),p([j],fe.prototype,"interval",2),p([j],fe.prototype,"label",2);var xc=class extends Hi{constructor(){super(...arguments),this.placement="inside-center",this.avoidCollisions=!0}};p([j],xc.prototype,"text",2),p([j],xc.prototype,"placement",2),p([j],xc.prototype,"avoidCollisions",2);var me=class extends iB{constructor(){super(...arguments),this.value=0,this.segmentation=new Wn,this.defaultColorRange=[],this.targets=new Gd(re),this.defaultTarget=new re,this.defaultScale=new fe,this.direction="vertical",this.thickness=1,this.cornerRadius=0,this.cornerMode="container",this.margin=0,this.scale=new fe,this.bar=new Ue,this.label=new xc,this.tooltip=eB()}};p([j],me.prototype,"value",2),p([j],me.prototype,"segmentation",2),p([j],me.prototype,"defaultColorRange",2),p([j],me.prototype,"targets",2),p([j],me.prototype,"defaultTarget",2),p([j],me.prototype,"defaultScale",2),p([j],me.prototype,"direction",2),p([j],me.prototype,"thickness",2),p([j],me.prototype,"cornerRadius",2),p([j],me.prototype,"cornerMode",2),p([j],me.prototype,"margin",2),p([j],me.prototype,"scale",2),p([j],me.prototype,"bar",2),p([j],me.prototype,"label",2),p([j],me.prototype,"tooltip",2);function ob(t,e,i,o,s){return{type:"gradient",gradient:"linear",colorSpace:"oklch",colorStops:aB(t,i,o.domain,e),rotation:s?90:0,bounds:"series"}}import{_ModuleSupport as nB}from"ag-charts-community";import{cachedTextMeasurer as rB}from"ag-charts-core";var{BBox:lB}=nB;function Wd(t){const{x0:e,y0:i,x1:o,y1:s,horizontalInset:a,verticalInset:n}=t,r=Math.min(e,o)+a,l=Math.min(i,s)+n,c=Math.max(Math.abs(o-e)-2*a,0),h=Math.max(Math.abs(s-i)-2*n,0);return{x:r,y:l,width:c,height:h}}function cB(t,e){if(e==null)return!0;const i=Wd(t),o=1e-6,s=i.x+o,a=i.y+o,n=i.x+i.width-o,r=i.y+i.height-o,l=e.x,c=e.x+e.width,h=e.y,d=e.y+e.height;return Math.max(s,l)<=Math.min(n,c)&&Math.max(a,h)<=Math.min(r,d)}function Kd(t){const{clipX0:e,clipX1:i,clipY0:o,clipY1:s}=t;return e!=null&&i!=null||o!=null&&s!=null}function hB(t){if(!Kd(t))return;const{x0:e,y0:i,x1:o,y1:s}=t,{x:a,y:n,width:r,height:l}=Wd(t);let{clipX0:c,clipX1:h,clipY0:d,clipY1:u}=t;(c==null||h==null)&&(c=e,h=o),(d==null||u==null)&&(d=i,u=s);const g=Math.min(c,h),y=Math.min(d,u),f=Math.abs(h-c),x=Math.abs(u-d);return c=Math.max(a,g),d=Math.max(n,y),h=Math.min(a+r,g+f),u=Math.min(n+l,y+x),new lB(Math.min(c,h),Math.min(d,u),Math.abs(h-c),Math.abs(u-d))}function sb(t,e){const i=t?"initial":"update";return{node:{fromFn(s,a){const n=s.previousDatum;let{x0:r,y0:l,x1:c,y1:h,clipX0:d,clipY0:u,clipX1:g,clipY1:y}=n??a;const{horizontalInset:f,verticalInset:x}=a,S=n!=null&&Kd(n),v=Kd(a);return S&&v||(!S&&v?({x0:r,y0:l,x1:c,y1:h,clipX0:d,clipY0:u,clipX1:g,clipY1:y}=a,t&&(e?g=a.clipX0:y=a.clipY0)):S&&!v?({x0:r,y0:l,x1:c,y1:h}=a,d=void 0,u=void 0,g=void 0,y=void 0):t&&(e?c=r:h=l)),{x0:r,y0:l,x1:c,y1:h,clipX0:d,clipY0:u,clipX1:g,clipY1:y,horizontalInset:f,verticalInset:x,phase:i}},toFn(s,a){const{x0:n,y0:r,x1:l,y1:c,clipX0:h,clipY0:d,clipX1:u,clipY1:g,horizontalInset:y,verticalInset:f}=a;return{x0:n,y0:r,x1:l,y1:c,clipX0:h,clipY0:d,clipX1:u,clipY1:g,horizontalInset:y,verticalInset:f}},applyFn(s,a){s.setProperties($n(s,a))}}}}function $n(t,e){const{x:i,y:o,width:s,height:a}=Wd(e),n=hB(e),r=cB(e,n);return{x:i,y:o,width:s,height:a,clipBBox:n,visible:r}}var pB={Before:"right",Center:"center",After:"left"},dB={Before:"top",Center:"middle",After:"bottom"},uB={Before:-1,Center:-.5,After:0},gB={Before:0,Center:-.5,After:-1};function yB(t,e,i,o,s,a){const{seriesRect:n,gaugeRect:r,barRect:l}=s,{padding:c,horizontal:h}=o;i.each((d,u)=>{const g=Gn(t.id,e,u,a?.label);let y,f;u.placement==="outside-start"?h?(y=r.x,f=n.height):(y=n.width,f=n.height-(r.y+r.height)):u.placement==="outside-end"?h?(y=n.width-(r.x+r.width),f=n.height):(y=n.width,f=r.y):u.avoidCollisions&&(y=r.width,f=r.height);let x;if(g==null)return;if(y!=null&&f!=null)x=Ln(g,u,{padding:c},()=>({width:y,height:f,meta:null}))?.[0];else{const T=rB(u),{width:R,height:_}=T.measureText(g);x={text:g,fontSize:u.fontSize,lineHeight:u.lineHeight??T.lineHeight(),width:R,height:_}}if(x==null){d.visible=!1;return}const S=h?r.x:r.y+r.height,v=h?r.x+r.width:r.y,m=h?l.x:l.y+l.height,b=h?l.x+l.width:l.y,M=u.spacing*(h?1:-1);let k,A,D,I;switch(u.placement){case"outside-start":k=-1/0,A=1/0,D=S-M,I="Before";break;case"outside-end":k=-1/0,A=1/0,D=v+M,I="After";break;case"inside-start":k=S,A=b,D=S+M,I="After";break;case"inside-end":k=b,A=v,D=v-M,I="Before";break;case"inside-center":k=S,A=v,D=(S+v)/2,I="Center";break;case"bar-inside":k=m,A=b,D=(m+b)/2,I="Center";break;case"bar-inside-end":k=m,A=b,D=b-M,I="Before";break;case"bar-outside-end":k=b,A=v,D=b+M,I="After";break;case"bar-end":k=-1/0,A=1/0,D=b,I="Center";break}const L=h?D:r.x+r.width/2,C=h?r.y+r.height/2:D;let w,P;h?(w=L+uB[I]*x.width,P=w+x.width):(w=C+gB[I]*x.height,P=w+x.height);const E=Math.min(w,P)>=Math.min(k,A)&&Math.max(w,P)<=Math.max(k,A);if(u.avoidCollisions&&!E){d.visible=!1;return}d.visible=!0,d.text=x.text,d.fontSize=x.fontSize,d.lineHeight=x.lineHeight,d.textAlign=h?pB[I]:"center",d.textBaseline=h?"middle":dB[I],d.x=L,d.y=C})}var{fromToMotion:$d,resetMotion:fB,SeriesNodePickMode:ab,StateMachine:mB,createDatumId:nb,toRadians:rb,BBox:ji,Group:Gs,PointerEvents:lb,Selection:Ws,Rect:xB,Text:cb,TransformableText:SB,Marker:bB,LinearScale:vB,generateTicks:MB,NiceMode:DB,easing:kB,findRangeExtent:AB,tickFormat:LB,mergeDefaults:IB,applyShapeStyle:jd}=Wa,CB={before:180,middle:0,after:0},TB={before:90,middle:0,after:-90},Sc=class extends Wa.Series{constructor(t){super({moduleCtx:t,pickModes:[ab.EXACT_SHAPE_MATCH,ab.NEAREST_NODE]}),this.properties=new me,this.seriesRect=ji.NaN,this.gaugeRect=ji.NaN,this.scale=new vB,this.originX=0,this.originY=0,this.scaleGroup=this.contentGroup.appendChild(new Gs({name:"scaleGroup"})),this.itemGroup=this.contentGroup.appendChild(new Gs({name:"itemGroup"})),this.itemTargetGroup=this.contentGroup.appendChild(new Gs({name:"itemTargetGroup"})),this.itemTargetLabelGroup=this.contentGroup.appendChild(new Gs({name:"itemTargetLabelGroup"})),this.itemLabelGroup=this.contentGroup.appendChild(new Gs({name:"itemLabelGroup"})),this.highlightTargetGroup=this.highlightGroup.appendChild(new Gs({name:"itemTargetLabelGroup"})),this.tickGroup=this.contentGroup.appendChild(new Gs({name:"tickGroup"})),this.scaleSelection=Ws.select(this.scaleGroup,()=>this.nodeFactory()),this.datumSelection=Ws.select(this.itemGroup,()=>this.nodeFactory()),this.targetSelection=Ws.select(this.itemTargetGroup,()=>this.markerFactory()),this.targetLabelSelection=Ws.select(this.itemTargetLabelGroup,cb),this.labelSelection=Ws.select(this.itemLabelGroup,cb),this.highlightTargetSelection=Ws.select(this.highlightTargetGroup,()=>this.markerFactory()),this.tickSelection=Ws.select(this.tickGroup,SB),this.datumUnion=new YS,this.animationState=new mB("empty",{empty:{update:{target:"ready",action:()=>this.animateEmptyUpdateReady()},reset:"empty",skip:"ready"},ready:{updateData:"waiting",clear:"clearing",resize:()=>this.animateReadyResize(),reset:"empty",skip:"ready"},waiting:{update:{target:"ready",action:()=>this.animateWaitingUpdateReady()},reset:"empty",skip:"ready"},clearing:{update:{target:"empty"},reset:"empty",skip:"ready"}}),this.scaleGroup.pointerEvents=lb.None,this.tickGroup.pointerEvents=lb.None}get range(){return this.horizontal?[0,this.gaugeRect.width]:[0,this.gaugeRect.height]}get horizontal(){return this.properties.direction==="horizontal"}get hasData(){return!0}nodeFactory(){const t=new xB;return t.crisp=!0,t}markerFactory(){return new bB}processData(){this.nodeDataRefresh=!0,this.animationState.transition("updateData")}formatLabel(t){return XS(t,this.properties.scale)}getShapeFillBBox(){const{properties:t,originX:e,originY:i,horizontal:o,scale:s}=this,{thickness:a}=t,n=AB(s.range),r=new ji(e,i,o?n:a,o?a:n);return{axis:r,series:r}}getTargets(){const{properties:t}=this,e=t.defaultTarget;return Array.from(t.targets).map(i=>{const{text:o=e.text,value:s=e.value??0,shape:a=e.shape??"triangle",rotation:n=e.rotation??0,placement:r=e.placement??"middle",spacing:l=e.spacing??0,size:c=e.size??0}=i,{enabled:h=e.label.enabled,color:d=e.label.color??"black",fontStyle:u=e.label.fontStyle??"normal",fontWeight:g=e.label.fontWeight??"normal",fontSize:y=e.label.fontSize,fontFamily:f=e.label.fontFamily,spacing:x=e.label.spacing??0}=i.label;return{text:o,value:s,shape:a,placement:r,spacing:l,size:c,rotation:n,label:{enabled:h,color:d,fontStyle:u,fontWeight:g,fontSize:y,fontFamily:f,spacing:x},style:i.getStyle(e)}})}getTargetPoint(t){const{properties:e,originX:i,originY:o,horizontal:s,scale:a,gaugeRect:n}=this,{thickness:r}=e,{value:l,placement:c,spacing:h,size:d}=t,u=a.convert(l);let g;switch(c){case"before":g=-(h+d/2);break;case"after":g=r+h+d/2;break;default:g=r/2;break}return{x:i+n.x+(s?u:g),y:o+n.y+(s?g:u)}}getTargetLabel(t){const{size:e,placement:i,label:o}=t,{spacing:s,color:a,fontStyle:n,fontWeight:r,fontSize:l,fontFamily:c}=o,h=void 0,d=e/2+s;let u,g,y=0,f=0;return this.horizontal?(u="center",i==="after"?(g="top",f=d):(g="bottom",f=-d)):(g="middle",i==="before"?(u="right",y=-d):(u="left",y=d)),{offsetX:y,offsetY:f,fill:a,textAlign:u,textBaseline:g,fontStyle:n,fontWeight:r,fontSize:l,fontFamily:c,lineHeight:h}}labelDatum(t,e){const{placement:i,avoidCollisions:o,spacing:s,text:a,color:n,fontSize:r,minimumFontSize:l,fontStyle:c,fontWeight:h,fontFamily:d,lineHeight:u,wrapping:g,overflowStrategy:y,formatter:f=x=>this.formatLabel(x.value)}=t;return{placement:i,avoidCollisions:o,spacing:s,text:a,value:e,fill:n,fontSize:r,minimumFontSize:l,fontStyle:c,fontWeight:h,fontFamily:d,lineHeight:u,wrapping:g,overflowStrategy:y,formatter:f}}verticalLabelInset(){const{label:t}=this.properties,e=jS(t),i=t.text?.split(`
`),o=(t.lineHeight??e.lineHeight())*(i?.length??1);return t.spacing+o}horizontalLabelInset(){const{scale:t,properties:e}=this,{scale:i,label:o}=e,s=o.text?.split(`
`),a=jS(o),n=i.interval.values??t.ticks({nice:!1,interval:i.interval.step,minTickCount:0,maxTickCount:6,tickCount:5})?.ticks??[],l=(s??n?.map(c=>Gn(this.id,this.ctx,this.labelDatum(o,c))??"")).reduce((c,h)=>{const{width:d}=a.measureText(h);return Math.max(c,d)},0);return o.spacing+l}tickFormatter(t,e){const{format:i,formatter:o}=this.properties.scale.label;let s;return i!=null&&(s=LB(e,typeof i=="string"?i:void 0)),(a,n)=>{let r;return o&&(r??(r=Bn(this.ctx,o,{value:a,index:n,domain:t,boundSeries:void 0}))),r??(r=s?.(a)),r??this.formatLabel(a)}}createNodeData(){const{id:t,properties:e,horizontal:i,scale:o,seriesRect:s}=this,{value:a,segmentation:n,thickness:r,cornerRadius:l,cornerMode:c,bar:h,scale:d,label:u,defaultColorRange:g}=e;o.domain=[d.min,d.max],o.range=i?[0,s.width]:[s.height,0];let y,f;i?(f=1,y=Math.PI/2):d.label.placement==="before"?(f=1,y=0):(f=-1,y=0);let x,S,v,m;i?(x=0,S=s.width,v=(s.height-r)/2,m=v+r,u.placement==="outside-start"?x+=this.horizontalLabelInset():u.placement==="outside-end"&&(S-=this.horizontalLabelInset())):(x=(s.width-r)/2,S=x+r,m=0,v=s.height,u.placement==="outside-start"?v-=this.verticalLabelInset():u.placement==="outside-end"&&(m+=this.verticalLabelInset())),this.gaugeRect=new ji(Math.min(x,S),Math.min(v,m),Math.abs(S-x),Math.abs(m-v));const b=0,M=0;o.domain=[d.min,d.max],o.range=i?[x,S]:[v,m];const{tickData:{ticks:k}}=MB({scale:o,label:this.properties.scale.label,interval:this.properties.scale.interval,tickFormatter:(X,Z)=>this.tickFormatter(X,Z),domain:o.domain,range:this.range,reverse:!1,primaryTickCount:void 0,defaultTickMinSpacing:0,visibleRange:[0,1],niceMode:DB.Off,labelOffset:0,axisRotation:y,sideFlag:f}),A=!1,D=this.getTargets(),I=[],L=[],C=[],w=[],[P,E]=o.range,T=Math.abs(E-P),R=i?o.convert(a):S,_=i?m:o.convert(a),N=n.enabled?n.spacing/2:0,O=i?N:0,B=i?0:N,z=Math.min(h.thickness??Math.round(h.thicknessRatio*r),r),V=-(r-z)/2,F=i?0:V,H=i?V:0,W=c==="item",G=Math.ceil(T);let K=n.enabled?n.interval.getSegments(o,G):void 0;const Y=h.getStyle(g,i,o),st=d.getStyle(h.enabled,g,i,o);if(K==null&&W){const X=Math.min(...o.domain),Z=Math.max(...o.domain),Q={value:a,segmentStart:X,segmentEnd:Z};if(h.enabled){const ut=Math.min(l,z/2,T/2)*(A?-1:1),ct=i?ut:0,gt=i?0:ut;I.push({series:this,itemId:"value",datum:Q,datumIndex:{type:0},type:0,x0:b+x-ct-F,y0:M+v-gt-H,x1:b+R+ct+F,y1:M+_+gt+H,clipX0:void 0,clipY0:void 0,clipX1:void 0,clipY1:void 0,topLeftCornerRadius:l,topRightCornerRadius:l,bottomRightCornerRadius:l,bottomLeftCornerRadius:l,horizontalInset:O,verticalInset:B,style:Y})}const ot=Math.min(l,r/2,T/2)*(A?-1:1),q=i?ot:0,dt=i?0:ot;w.push({series:this,itemId:"scale",datum:Q,datumIndex:{type:0},type:0,x0:b+x-q,y0:M+v-dt,x1:b+S+q,y1:M+m+dt,clipX0:void 0,clipY0:void 0,clipX1:void 0,clipY1:void 0,topLeftCornerRadius:l,topRightCornerRadius:l,bottomRightCornerRadius:l,bottomLeftCornerRadius:l,horizontalInset:O,verticalInset:B,style:st})}else{K??(K=o.domain);const X=b+x-F,Z=M+v-H,Q=b+R+F,pt=M+_+H;for(let ot=0;ot<K.length-1;ot+=1){const q=K[ot+0],dt=K[ot+1],tt={value:a,segmentStart:q,segmentEnd:dt},ut=ot===0,ct=ot===K.length-2,gt=o.convert(q),Tt=o.convert(dt),Re=W||ut?l:0,as=W||ct?l:0,gi=i?Re:as,wi=as,tn=i?as:Re,en=Re;h.enabled&&I.push({series:this,itemId:`value-${ot}`,datum:tt,datumIndex:{type:0},type:0,x0:b+(i?gt:x),y0:M+(i?v:gt),x1:b+(i?Tt:S),y1:M+(i?m:Tt),clipX0:X,clipY0:Z,clipX1:Q,clipY1:pt,topLeftCornerRadius:gi,topRightCornerRadius:wi,bottomRightCornerRadius:tn,bottomLeftCornerRadius:en,horizontalInset:O,verticalInset:B,style:Y}),w.push({series:this,itemId:`scale-${ot}`,datum:tt,datumIndex:{type:0},type:0,x0:b+(i?gt:x),y0:M+(i?v:gt),x1:b+(i?Tt:S),y1:M+(i?m:Tt),clipX0:void 0,clipY0:void 0,clipX1:void 0,clipY1:void 0,topLeftCornerRadius:gi,topRightCornerRadius:wi,bottomRightCornerRadius:tn,bottomLeftCornerRadius:en,horizontalInset:O,verticalInset:B,style:st})}}u.enabled&&C.push(this.labelDatum(u,a));const nt=i?CB:TB;for(let X=0;X<D.length;X+=1){const Z=D[X],{value:Q,text:pt,shape:ot,size:q,style:dt}=Z,tt=this.getTargetPoint(Z),ut=rb(Z.rotation+nt[Z.placement]);L.push({series:this,itemId:`target-${X}`,midPoint:tt,datum:{value:Q},datumIndex:{type:1,index:X},type:1,value:Q,text:pt,x:tt.x,y:tt.y,shape:ot,size:q,rotation:ut,label:this.getTargetLabel(Z),style:dt})}return{itemId:t,nodeData:I,tickData:k,targetData:L,labelData:C,scaleData:w}}updateSelections(t){(this.nodeDataRefresh||t)&&(this.contextNodeData=this.createNodeData(),this.nodeDataRefresh=!1)}highlightDatum(t){if(t!=null&&t.series===this&&t.type===1)return t}update({seriesRect:t}){const{datumSelection:e,labelSelection:i,targetSelection:o,targetLabelSelection:s,scaleSelection:a,highlightTargetSelection:n,tickSelection:r}=this;this.seriesRect=t??ji.NaN;const l=this.checkResize(t);this.updateSelections(l),this.contentGroup.visible=this.visible,this.contentGroup.opacity=this.getOpacity();const c=this.contextNodeData?.nodeData??[],h=this.contextNodeData?.labelData??[],d=this.contextNodeData?.targetData??[],u=this.contextNodeData?.scaleData??[],g=this.contextNodeData?.tickData??[],y=this.highlightDatum(this.ctx.highlightManager.getActiveHighlight());this.scaleSelection=this.updateScaleSelection({scaleData:u,scaleSelection:a}),this.updateScaleNodes({scaleSelection:a}),this.targetSelection=this.updateTargetSelection({targetData:d,targetSelection:o}),this.updateTargetNodes({targetSelection:o,isHighlight:!1}),this.targetLabelSelection=this.updateTargetLabelSelection({targetData:d,targetLabelSelection:s}),this.updateTargetLabelNodes({targetLabelSelection:s}),this.datumSelection=this.updateDatumSelection({nodeData:c,datumSelection:e}),this.updateDatumNodes({datumSelection:e}),this.labelSelection=this.updateLabelSelection({labelData:h,labelSelection:i}),this.updateLabelNodes({labelSelection:i}),this.highlightTargetSelection=this.updateTargetSelection({targetData:y!=null?[y]:[],targetSelection:n}),this.updateTargetNodes({targetSelection:n,isHighlight:!0}),this.tickSelection=this.updateTickSelection({tickData:g,tickSelection:r}),this.updateTickNodes({tickSelection:r}),l&&this.animationState.transition("resize"),this.animationState.transition("update")}updateDatumSelection(t){return t.datumSelection.update(t.nodeData,void 0,e=>nb(t.nodeData.length,e.itemId))}updateDatumNodes(t){const{datumSelection:e}=t,{ctx:i}=this,o=i.animationManager.isSkipped(),s=this.getShapeFillBBox();e.each((n,r)=>{const{topLeftCornerRadius:l,topRightCornerRadius:c,bottomRightCornerRadius:h,bottomLeftCornerRadius:d}=r;jd(n,r.style,s),n.topLeftCornerRadius=l,n.topRightCornerRadius=c,n.bottomRightCornerRadius=h,n.bottomLeftCornerRadius=d,n.pointerEvents=this.properties.bar.enabled?Wa.PointerEvents.All:Wa.PointerEvents.None,(o||n.previousDatum==null)&&n.setProperties($n(n,r))});const{horizontal:a}=this;this.datumUnion.update(e,this.itemGroup,Wa.Rect,(n,r,l)=>{const c=Math.min(r.x,l.x),h=Math.max(r.x+r.width,l.x+l.width),d=Math.min(r.y,l.y),u=Math.max(r.y+r.height,l.y+l.height),g=h-c,y=u-d;n.pointerEvents=Wa.PointerEvents.None,n.x=c,n.y=d,n.width=g,n.height=y,n.topLeftCornerRadius=a?r.topLeftCornerRadius:l.topLeftCornerRadius,n.topRightCornerRadius=l.topRightCornerRadius,n.bottomRightCornerRadius=a?l.bottomRightCornerRadius:r.bottomRightCornerRadius,n.bottomLeftCornerRadius=r.bottomLeftCornerRadius;const f=r.clipBBox,x=l.clipBBox??f;f&&x?n.clipBBox=ji.merge([f,x]).intersection(a?new ji(c,-1/0,g,1/0):new ji(-1/0,d,1/0,y)):n.clipBBox=void 0})}updateScaleSelection(t){return t.scaleSelection.update(t.scaleData,void 0,e=>nb(t.scaleData.length,e.itemId))}updateScaleNodes(t){const{scaleSelection:e}=t,i=this.getShapeFillBBox();e.each((o,s)=>{const{topLeftCornerRadius:a,topRightCornerRadius:n,bottomRightCornerRadius:r,bottomLeftCornerRadius:l}=s;jd(o,s.style,i),o.setProperties($n(o,s)),o.topLeftCornerRadius=a,o.topRightCornerRadius=n,o.bottomRightCornerRadius=r,o.bottomLeftCornerRadius=l,o.setProperties($n(o,s))})}updateTargetSelection(t){return t.targetSelection.update(t.targetData,void 0,e=>e.itemId)}updateTargetNodes(t){const{targetSelection:e,isHighlight:i}=t;e.each((o,s)=>{const{x:a,y:n,shape:r,size:l,rotation:c}=s,h=this.getTargetStyle(i,s);jd(o,h),o.size=l,o.shape=r==="line"?ZS:r,o.translationX=a,o.translationY=n,o.rotation=c})}getTargetStyle(t,{datumIndex:e,style:i}){const o=this.getHighlightStyle(t,e);return IB(o,{...i,opacity:1})}updateTargetLabelSelection(t){return t.targetLabelSelection.update(t.targetData)}updateTargetLabelNodes(t){const{targetLabelSelection:e}=t;e.each((i,o)=>{const{x:s,y:a,text:n}=o,{offsetX:r,offsetY:l,fill:c,fontStyle:h,fontWeight:d,fontSize:u,fontFamily:g,textAlign:y,textBaseline:f}=o.label;i.visible=!0,i.x=s+r,i.y=a+l,i.text=n,i.fill=c,i.fontStyle=h,i.fontWeight=d,i.fontSize=u,i.fontFamily=g,i.textAlign=y,i.textBaseline=f})}updateTickSelection(t){return t.tickSelection.update(t.tickData,void 0,e=>e.tickId)}updateTickNodes(t){const{gaugeRect:e,properties:i}=this,o=i.defaultScale,{enabled:s,color:a,fontFamily:n=o.label.fontFamily,fontSize:r=o.label.fontSize,fontStyle:l,fontWeight:c=o.label.fontWeight,spacing:h}=i.scale.label;let{placement:d}=i.scale.label;const u=rb(i.scale.label.rotation??0);let g,y,f,x;this.horizontal?(d??(d="after"),g="center",y=d==="before"?"bottom":"top",x=this.originY+e.y+(d==="before"?-h:e.height+h)):(d??(d="before"),g=d==="before"?"end":"start",y="middle",f=this.originX+e.x+(d==="before"?-h:e.width+h)),t.tickSelection.each((S,v)=>{if(!s){S.visible=!1;return}const m=f??v.translation,b=x??v.translation;S.visible=!0,S.text=v.tickLabel,S.fill=a,S.fontFamily=n,S.fontSize=r,S.fontStyle=l,S.fontWeight=c,S.textBaseline=y,S.textAlign=g,S.x=m,S.y=b,S.rotationCenterX=m,S.rotationCenterY=b,S.rotation=u})}updateLabelSelection(t){return t.labelSelection.update(t.labelData,void 0,e=>"primary")}updateLabelNodes(t){const{labelSelection:e}=t,i=this.ctx.animationManager.isSkipped();e.each((o,s)=>{o.fill=s.fill,o.fontStyle=s.fontStyle,o.fontWeight=s.fontWeight,o.fontFamily=s.fontFamily}),(i||this.labelsHaveExplicitText())&&this.formatLabelText()}labelsHaveExplicitText(){for(const{datum:t}of this.labelSelection)if(t.text==null)return!1;return!0}formatLabelText(t){const{labelSelection:e,horizontal:i,scale:o,seriesRect:s,gaugeRect:a}=this,{x:n,y:r,width:l,height:c}=a,h=t?.label??this.properties.value;let d;if(i){const y=o.convert(h);d=new ji(n,r,y-n,c)}else{const y=o.convert(h);d=new ji(n,y,l,c-y)}const u={seriesRect:s,gaugeRect:a,barRect:d},{margin:g}=this.properties;yB(this,this.ctx,e,{padding:g,horizontal:i},u,t)}resetAllAnimation(){this.ctx.animationManager.stopByAnimationGroupId(this.id),fB([this.datumSelection],$n),this.formatLabelText()}resetAnimation(t){t==="initial"?this.animationState.transition("reset"):t==="ready"&&this.animationState.transition("skip")}animateLabelText(t={}){const{animationManager:e}=this.ctx;let i=0,o=0;if(this.labelSelection.each((s,a)=>{s.opacity=1,i=s.previousDatum?.value??t.from??a.value,o=a.value}),!this.labelsHaveExplicitText())if(i===o)this.formatLabelText({label:o});else{const s=`${this.id}_labels`;e.animate({id:s,groupId:"label",from:{label:i},to:{label:o},phase:t.phase??"update",ease:kB.easeOut,onUpdate:a=>this.formatLabelText(a),onStop:()=>this.formatLabelText({label:o})})}}animateEmptyUpdateReady(){const{animationManager:t}=this.ctx,{node:e}=sb(!0,this.horizontal);$d(this.id,"node",t,[this.datumSelection],e,(i,o)=>o.itemId),$d(this.id,"label",t,[this.labelSelection],US,()=>"primary"),this.animateLabelText({from:0,phase:"initial"})}animateWaitingUpdateReady(){const{animationManager:t}=this.ctx,{node:e}=sb(!1,this.horizontal);$d(this.id,"node",t,[this.datumSelection],e,(i,o)=>o.itemId),this.animateLabelText()}animateReadyResize(){this.resetAllAnimation()}getSeriesDomain(){return[0,1]}dataCount(){return NaN}getSeriesRange(t,e){return[NaN,NaN]}getLegendData(){return[]}getTooltipContent(t){const{id:e,properties:i}=this,{tooltip:o}=i;if(t==null)return;let s,a,n;if(t.type===0?(s=i.value,a=i.label.text,n=this.ctx.localeManager.t("ariaLabelGaugeValue")):({value:s,text:a}=i.targets[t.index],n=this.ctx.localeManager.t("ariaLabelGaugeTarget")),s!=null)return this.formatTooltipWithContext(o,{data:[{label:a,fallbackLabel:n,value:this.formatLabel(s)}]},{seriesId:e,title:void 0,datum:void 0,value:s})}pickNodeClosestDatum(t){return QS(this,t)}pickFocus(t){return JS(this,t)}getCaptionText(){return this.formatLabel(this.properties.value)}getCategoryValue(t){}datumIndexForCategoryValue(t){}hasItemStylers(){return!1}};Sc.className="LinearGaugeSeries",Sc.type="linear-gauge";var wB={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["standalone"],identifier:"linear-gauge",moduleFactory:t=>new Sc(t),themeTemplate:{minWidth:200,minHeight:200,tooltip:{enabled:!1},series:{thickness:50,defaultColorRange:{$if:[{$eq:[{$palette:"type"},"inbuilt"]},{$interpolate:[{$palette:"secondDivergingColors"},5]},Hn.SAFE_RANGE2_OPERATION]},scale:{defaultFill:{$path:["/1",{$palette:"fill"},{$palette:"hierarchyColors"}]},stroke:{$path:["/2",Hn.SAFE_STROKE_FILL_OPERATION,{$palette:"hierarchyColors"}]},strokeWidth:{$isUserOption:["./stroke",2,0]},label:{spacing:11}},bar:{strokeWidth:{$isUserOption:["./stroke",2,0]}},segmentation:{enabled:!1,interval:{},spacing:1},defaultTarget:{fill:{$ref:"foregroundColor"},stroke:{$ref:"foregroundColor"},size:10,shape:"triangle",placement:"after",spacing:5,label:{enabled:!0,fontWeight:{$ref:"fontWeight"},fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},color:{$ref:"textColor"},spacing:5}},defaultScale:{label:{fontWeight:{$ref:"fontWeight"},fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},color:{$ref:"textColor"}}},label:{...Hn.LABEL_BOXING_DEFAULTS,enabled:!1,placement:"inside-start",fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},fontSize:{$rem:2},minimumFontSize:Hn.FONT_SIZE.SMALL,spacing:18,color:{$ref:"chartBackgroundColor"}},margin:4,tooltip:{range:{$path:["/tooltip/range",10]}}}}},NB={type:"series",name:"linear-gauge",chartType:"standalone",enterprise:!0,options:Hn.linearGaugeSeriesOptionsDef,create:t=>new Sc(t)};import{_ModuleSupport as bc}from"ag-charts-community";import{_ModuleSupport as Yd}from"ag-charts-community";var jn={zoom:{axes:"xy",anchorPointX:"pointer",anchorPointY:"pointer",buttons:{anchorPointX:"middle",anchorPointY:"middle"}},legend:{enabled:!1},gradientLegend:{enabled:!1,...Yd.LEGEND_CONTAINER_THEME}};function Yi(t){const e=Yd.deepClone(t);return Yd.jsonWalk(e,i=>{typeof i=="object"&&"$palette"in i&&(i.$mapPalette=i.$palette,delete i.$palette)}),e}import{_ModuleSupport as hb}from"ag-charts-community";import{Logger as pb,cachedTextMeasurer as PB}from"ag-charts-core";import{_ModuleSupport as EB}from"ag-charts-community";var _B=1e-9;function db(t,e,i,o){const[s,a]=t,[n,r]=e,l=n-s,c=r-a,h=l*l+c*c;let d,u;if(Math.abs(h)<_B)d=s,u=a;else{let f=((i-s)*l+(o-a)*c)/h;f=Math.max(0,Math.min(1,f)),d=s+f*(n-s),u=a+f*(r-a)}const g=i-d,y=o-u;return g*g+y*y}function ub(t,e,i){let o=1/0,s=t[t.length-1];for(const a of t)o=Math.min(o,db(s,a,e,i)),s=a;return Math.sqrt(o)}function Ud(t){let[e,i]=t[0],o=0;for(let s=1;s<t.length;s+=1){const[a,n]=t[s],r=Math.hypot(a-e,n-i);o+=r,e=a,i=n}return o}function vc(t){if(t.length===0)return;const e=Ud(t)/2;let[i,o]=t[0],s=0;for(let a=1;a<t.length;a+=1){const[n,r]=t[a],l=Math.hypot(n-i,r-o),c=s+l;if(c>e){const h=(e-s)/l,d=[i+(n-i)*h,o+(r-o)*h],u=Math.atan2(r-o,n-i);return{point:d,angle:u}}s=c,i=n,o=r}}import{_ModuleSupport as OB}from"ag-charts-community";var{LonLatBBox:RB}=OB;function Ks(t,e){return t.forEach(i=>{const[o,s]=i;e=RB.extend(e,o,s,o,s)}),e}function BB(t){if(t.length===0)return;let e=0,i=0,o=0,[s,a]=t[t.length-1];for(const[n,r]of t){const l=s*r-n*a;o+=l,e+=(s+n)*l,i+=(a+r)*l,s=n,a=r}return o*=3,[e/o,i/o]}function Mc(t,e,i){let o=!1,s=1/0;for(const a of t){let n=a[a.length-1],[r,l]=n;for(const c of a){const[h,d]=c;d>i!=l>i&&e<(r-h)*(i-d)/(l-d)+h&&(o=!o),s=Math.min(s,db(n,c,e,i)),n=c,r=h,l=d}}return(o?-1:1)*Math.sqrt(s)}var{Path:zB,ExtendedPath2D:FB,BBox:VB,SceneChangeDetection:HB,SceneObjectChangeDetection:GB,objectsEqual:WB}=EB,$a=class extends zB{constructor(){super(...arguments),this.projectedGeometry=void 0,this.renderMode=3,this.strokePath=new FB}computeBBox(){return(this.dirtyPath||this.isDirtyPath())&&(this.updatePath(),this.dirtyPath=!1),this.bbox?.clone()}updatePath(){const{projectedGeometry:t}=this;this.strokePath.clear(),this.path.clear(),this.bbox=t!=null?this.drawGeometry(t,void 0):void 0}drawPath(t){super.drawPath(t),this.renderStroke(t,this.strokePath.getPath2D())}containsPoint(t,e){const{projectedGeometry:i}=this;return i==null||!this.getBBox().containsPoint(t,e)?!1:this.geometryDistance(i,t,e)<=0}distanceSquared(t,e){const{projectedGeometry:i}=this;if(i==null)return 1/0;const o=this.geometryDistance(i,t,e);return o>0?o*o:0}geometryDistance(t,e,i){const{renderMode:o,strokeWidth:s}=this,a=(o&1)!==0,n=(o&2)!==0,r=Math.max(s/2,1)+1;switch(t.type){case"GeometryCollection":return t.geometries.reduce((l,c)=>Math.min(l,this.geometryDistance(c,e,i)),1/0);case"MultiPolygon":return a?t.coordinates.reduce((l,c)=>Math.min(l,Math.max(Mc(c,e,i),0)),1/0):1/0;case"Polygon":return a?Math.max(Mc(t.coordinates,e,i),0):1/0;case"MultiLineString":return n?t.coordinates.reduce((l,c)=>Math.min(l,Math.max(ub(c,e,i)-r,0)),1/0):1/0;case"LineString":return n?Math.max(ub(t.coordinates,e,i)-r,0):1/0;case"MultiPoint":case"Point":default:return 1/0}}drawGeometry(t,e){const{renderMode:i,path:o,strokePath:s}=this,a=(i&1)!==0,n=(i&2)!==0;switch(t.type){case"GeometryCollection":t.geometries.forEach(r=>{e=this.drawGeometry(r,e)});break;case"MultiPolygon":a&&t.coordinates.forEach(r=>{e=this.drawPolygon(o,r,e)});break;case"Polygon":a&&(e=this.drawPolygon(o,t.coordinates,e));break;case"LineString":n&&(e=this.drawLineString(s,t.coordinates,e,!1));break;case"MultiLineString":n&&t.coordinates.forEach(r=>{e=this.drawLineString(s,r,e,!1)});break;case"Point":case"MultiPoint":break}return e}drawPolygon(t,e,i){if(e.length<1)return i;i=this.drawLineString(t,e[0],i,!0);for(let o=1;o<e.length;o+=1){const s=e[o];this.drawLineString(t,s,void 0,!0)}return i}drawLineString(t,e,i,o){if(e.length<2)return i;const s=o?e.length-1:e.length;for(let a=0;a<s;a+=1){const[n,r]=e[a];if(a===0?t.moveTo(n,r):t.lineTo(n,r),i==null)i=new VB(n,r,0,0);else{const{x:l,y:c}=i,h=l+i.width,d=c+i.height;i.x=Math.min(l,n),i.y=Math.min(c,r),i.width=Math.max(h,n)-i.x,i.height=Math.max(d,r)-i.y}}return o&&t.closePath(),i}};p([GB({equals:WB})],$a.prototype,"projectedGeometry",2),p([HB()],$a.prototype,"renderMode",2);import{_ModuleSupport as KB}from"ag-charts-community";var{LonLatBBox:Xd}=KB;function ja(t,e){if(t.bbox!=null){const[i,o,s,a]=t.bbox;return e=Xd.extend(e,i,o,s,a),e}switch(t.type){case"GeometryCollection":t.geometries.forEach(i=>{e=ja(i,e)});break;case"MultiPolygon":t.coordinates.forEach(i=>{i.length>0&&(e=Ks(i[0],e))});break;case"Polygon":t.coordinates.length>0&&(e=Ks(t.coordinates[0],e));break;case"MultiLineString":t.coordinates.forEach(i=>{e=Ks(i,e)});break;case"LineString":e=Ks(t.coordinates,e);break;case"MultiPoint":t.coordinates.forEach(i=>{const[o,s]=i;e=Xd.extend(e,o,s,o,s)});break;case"Point":{const[i,o]=t.coordinates;e=Xd.extend(e,i,o,i,o);break}}return e}function Dc(t){switch(t.type){case"GeometryCollection":{let e,i;return t.geometries.forEach(o=>{const s=Dc(o);if(s==null)return;const a=Ks(s[0],void 0);if(a==null)return;const n=Math.abs(a.lat1-a.lat0)*Math.abs(a.lon1-a.lon0);(e==null||n>e)&&(e=n,i=s)}),i}case"MultiPolygon":{let e,i;return t.coordinates.forEach(o=>{const s=Ks(o[0],void 0);if(s==null)return;const a=Math.abs(s.lat1-s.lat0)*Math.abs(s.lon1-s.lon0);(e==null||a>e)&&(e=a,i=o)}),i}case"Polygon":return t.coordinates;case"MultiLineString":case"LineString":case"MultiPoint":case"Point":return}}function kc(t){switch(t.type){case"GeometryCollection":{let e,i;return t.geometries.forEach(o=>{const s=kc(o);if(s==null)return;const a=Ud(s);a!=null&&(e==null||a>e)&&(e=a,i=s)}),i}case"MultiLineString":{let e=0,i;return t.coordinates.forEach(o=>{const s=Ud(o);s>e&&(e=s,i=o)}),i}case"LineString":return t.coordinates;case"MultiPolygon":case"Polygon":case"MultiPoint":case"Point":return}}function Zd(t,e){if(t==null)return!1;switch(t.type){case"GeometryCollection":return t.geometries.some(i=>Zd(i,e));case"MultiPolygon":case"Polygon":return(e&1)!==0;case"MultiLineString":case"LineString":return(e&2)!==0;case"MultiPoint":case"Point":return(e&4)!==0}}function qo(t,e){switch(t.type){case"GeometryCollection":return{type:"GeometryCollection",geometries:t.geometries.map(i=>qo(i,e))};case"Polygon":return{type:"Polygon",coordinates:qd(t.coordinates,e)};case"MultiPolygon":return{type:"MultiPolygon",coordinates:$B(t.coordinates,e)};case"MultiLineString":return{type:"MultiLineString",coordinates:qd(t.coordinates,e)};case"LineString":return{type:"LineString",coordinates:Qd(t.coordinates,e)};case"MultiPoint":return{type:"MultiPoint",coordinates:Qd(t.coordinates,e)};case"Point":return{type:"Point",coordinates:e.convert(t.coordinates)}}}function $B(t,e){return t.map(i=>qd(i,e))}function qd(t,e){return t.map(i=>Qd(i,e))}function Qd(t,e){return t.map(i=>e.convert(i))}function jB(){return{fromFn:(i,o,s)=>s==="removed"?{scalingX:1,scalingY:1}:i.previousDatum==null?{scalingX:0,scalingY:0}:{scalingX:i.scalingX,scalingY:i.scalingY},toFn:(i,o,s)=>s==="removed"?{scalingX:0,scalingY:0}:{scalingX:1,scalingY:1}}}function gb(t,e){const i=t.contextNodeData?.nodeData[e.datumIndex];if(i!==void 0){for(const o of t.datumSelection.nodes())if(o.datum===i)return o}}import{_ModuleSupport as yb}from"ag-charts-community";var dU=class extends yb.SeriesProperties{},Yn=class extends yb.DataModelSeries{addChartEventListeners(){this.cleanup.register(this.ctx.eventsHub.on("legend:item-click",t=>{this.onLegendItemClick(t)}),this.ctx.eventsHub.on("legend:item-double-click",t=>{this.onLegendItemDoubleClick(t)}))}getSeriesDomain(){return[NaN,NaN]}getSeriesRange(t,e){return[NaN,NaN]}};import{_ModuleSupport as YB}from"ag-charts-community";var{Property:Dt,SeriesProperties:UB,makeSeriesTooltip:XB,Label:ZB}=YB,St=class extends UB{constructor(){super(...arguments),this.topology=void 0,this.idKey="",this.topologyIdKey="name",this.idName=void 0,this.labelKey=void 0,this.labelName=void 0,this.colorRange=void 0,this.maxStrokeWidth=void 0,this.stroke="black",this.strokeOpacity=1,this.strokeWidth=0,this.lineDash=[0],this.lineDashOffset=0,this.label=new ZB,this.tooltip=XB()}getStyle(){const{stroke:t,strokeOpacity:e,strokeWidth:i,lineDash:o,lineDashOffset:s}=this;return{stroke:t,strokeOpacity:e,strokeWidth:i,lineDash:o,lineDashOffset:s}}};p([Dt],St.prototype,"topology",2),p([Dt],St.prototype,"title",2),p([Dt],St.prototype,"legendItemName",2),p([Dt],St.prototype,"idKey",2),p([Dt],St.prototype,"topologyIdKey",2),p([Dt],St.prototype,"idName",2),p([Dt],St.prototype,"labelKey",2),p([Dt],St.prototype,"labelName",2),p([Dt],St.prototype,"sizeKey",2),p([Dt],St.prototype,"sizeName",2),p([Dt],St.prototype,"colorKey",2),p([Dt],St.prototype,"colorName",2),p([Dt],St.prototype,"sizeDomain",2),p([Dt],St.prototype,"colorRange",2),p([Dt],St.prototype,"maxStrokeWidth",2),p([Dt],St.prototype,"stroke",2),p([Dt],St.prototype,"strokeOpacity",2),p([Dt],St.prototype,"strokeWidth",2),p([Dt],St.prototype,"lineDash",2),p([Dt],St.prototype,"lineDashOffset",2),p([Dt],St.prototype,"itemStyler",2),p([Dt],St.prototype,"label",2),p([Dt],St.prototype,"tooltip",2);var{getMissCount:qB,getLabelStyles:QB,createDatumId:fb,SeriesNodePickMode:mb,valueProperty:Un,ColorScale:JB,LinearScale:tz,Selection:Jd,Text:ez,Transformable:iz,mergeDefaults:xb}=hb,Ac=class extends Yn{constructor(t){super({moduleCtx:t,categoryKey:void 0,propertyKeys:{size:["colorKey"],color:["colorKey"],label:["labelKey"]},propertyNames:{size:["sizeName"],color:["colorName"],label:["labelName"]},pickModes:[mb.EXACT_SHAPE_MATCH,mb.NEAREST_NODE],usesPlacedLabels:!0}),this.properties=new St,this._chartTopology=void 0,this.colorScale=new JB,this.sizeScale=new tz,this.datumSelection=Jd.select(this.contentGroup,()=>this.nodeFactory()),this.labelSelection=Jd.select(this.labelGroup,ez),this.highlightDatumSelection=Jd.select(this.highlightGroup,()=>this.nodeFactory()),this._previousDatumMidPoint=void 0}getNodeData(){return this.contextNodeData?.nodeData}get topology(){return this.properties.topology??this._chartTopology}get hasData(){return super.hasData&&this.topology!=null}renderToOffscreenCanvas(){return!0}setZIndex(t){return super.setZIndex(t),this.contentGroup.zIndex=[1,t],this.highlightGroup.zIndex=[2,t],!0}setChartTopology(t){this._chartTopology=t,this.topology===t&&(this.nodeDataRefresh=!0)}isLabelEnabled(){return this.properties.labelKey!=null&&this.properties.label.enabled}nodeFactory(){const t=new $a;return t.renderMode=2,t.lineJoin="round",t.lineCap="round",t}async processData(t){if(this.data==null)return;const{data:e,topology:i,sizeScale:o,colorScale:s}=this,{topologyIdKey:a,idKey:n,sizeKey:r,colorKey:l,labelKey:c,sizeDomain:h,colorRange:d}=this.properties,u=new Map;i?.features.forEach(m=>{const b=m.properties?.[a];b==null||!Zd(m.geometry,2)||u.set(b,m)});const g=this.sizeScale.type,y=this.colorScale.type,f=this.scale?.type,{dataModel:x,processedData:S}=await this.requestDataModel(t,e,{props:[Un(n,f,{id:"idValue",includeProperty:!1}),Un(n,f,{id:"featureValue",includeProperty:!1,processor:()=>m=>u.get(m)}),...c!=null?[Un(c,"category",{id:"labelValue"})]:[],...r!=null?[Un(r,g,{id:"sizeValue"})]:[],...l!=null?[Un(l,y,{id:"colorValue"})]:[]]}),v=x.resolveColumnById(this,"featureValue",S);if(this.topologyBounds=v.reduce((m,b)=>{const M=b?.geometry;return M==null?m:ja(M,m)},void 0),r!=null){const m=x.resolveProcessedDataIndexById(this,"sizeValue"),b=S.domain.values[m]??[];o.domain=h??b}if(d!=null&&this.isColorScaleValid()){const m=x.resolveProcessedDataIndexById(this,"colorValue");s.domain=S.domain.values[m],s.range=d,s.update()}i==null&&pb.warnOnce("no topology was provided for [MapLineSeries]; nothing will be rendered.")}isColorScaleValid(){const{colorKey:t}=this.properties;if(!t)return!1;const{dataModel:e,processedData:i}=this;if(!e||!i)return!1;const o=e.resolveProcessedDataIndexById(this,"colorValue"),s=i.input.count,a=qB(this,i.defs.values[o].missing);return!(s===0||s===a)}getLabelDatum(t,e,i,o){if(e==null||i==null)return;const s=kc(i);if(s==null)return;const{idKey:a,idName:n,sizeKey:r,sizeName:l,colorKey:c,colorName:h,labelKey:d,labelName:u,label:g}=this.properties;if(d==null||!g.enabled)return;const y=this.getLabelText(e,t,d,"label",[],g,{value:e,datum:t,idKey:a,idName:n,sizeKey:r,sizeName:l,colorKey:c,colorName:h,labelKey:d,labelName:u});if(y==null)return;const f=o.measureText(String(y)),x=vc(s);if(x==null)return;const[S,v]=x.point,{width:m,height:b}=f;return{point:{x:S,y:v,size:0},label:{width:m,height:b,text:y},anchor:void 0,placement:void 0}}createNodeData(){const{id:t,dataModel:e,processedData:i,sizeScale:o,properties:s,scale:a}=this,{idKey:n,sizeKey:r,colorKey:l,labelKey:c,label:h,legendItemName:d}=s;if(e==null||i==null)return;const u=e.resolveColumnById(this,"idValue",i),g=e.resolveColumnById(this,"featureValue",i),y=c!=null?e.resolveColumnById(this,"labelValue",i):void 0,f=r!=null?e.resolveColumnById(this,"sizeValue",i):void 0,x=l!=null?e.resolveColumnById(this,"colorValue",i):void 0,S=s.maxStrokeWidth??s.strokeWidth;o.range=[Math.min(s.strokeWidth,S),S];const v=PB(h),m=new Map;i.dataSources.get(this.id)?.forEach((I,L)=>{const C=u[L],w=g[L]?.geometry??void 0,P=w!=null&&a!=null?qo(w,a):void 0;C!=null&&P!=null&&m.set(C,P)});const b=[],M=[],k=[];(i.dataSources.get(this.id)??[]).forEach((I,L)=>{const C=u[L],w=x?.[L],P=f?.[L],E=y?.[L],T=m.get(C);T==null&&k.push(C);const R=this.getLabelDatum(I,E,T,v);R!=null&&M.push(R),b.push({series:this,itemId:n,datum:I,datumIndex:L,idValue:C,labelValue:E,colorValue:w,sizeValue:P,projectedGeometry:T,legendItemName:d,style:this.getItemStyle({datumIndex:L,datum:I,colorValue:w,sizeValue:P},!1)})});const D=10;if(k.length>D){const I=k.length-D;k.length=D,k.push(`(+${I} more)`)}return k.length>0&&pb.warnOnce("some data items do not have matches in the provided topology",k),{itemId:t,nodeData:b,labelData:M}}updateSelections(){this.nodeDataRefresh&&(this.contextNodeData=this.createNodeData(),this.nodeDataRefresh=!1)}update(){const{datumSelection:t,highlightDatumSelection:e}=this;this.updateSelections(),this.contentGroup.visible=this.visible,this.labelGroup.visible=this.visible;let i=this.ctx.highlightManager?.getActiveHighlight();const{legendItemName:o}=this.properties,s=o!=null&&i?.datum==null&&o===i?.legendItemName;i!=null&&(i.series!==this&&!s||i.datum==null)&&(i=void 0);const a=this.contextNodeData?.nodeData??[];this.datumSelection=this.updateDatumSelection({nodeData:a,datumSelection:t}),this.updateDatumStyles({datumSelection:t,isHighlight:!1}),this.updateDatumNodes({datumSelection:t,isHighlight:!1}),this.highlightDatumSelection=this.updateDatumSelection({nodeData:i!=null?[i]:[],datumSelection:e}),this.updateDatumStyles({datumSelection:e,isHighlight:!0}),this.updateDatumNodes({datumSelection:e,isHighlight:!0})}updateDatumSelection(t){return t.datumSelection.update(t.nodeData,void 0,e=>fb(e.idValue))}getItemStyle({datumIndex:t=0,datum:e,colorValue:i,sizeValue:o},s){const{id:a,properties:n,colorScale:r,sizeScale:l}=this,{colorRange:c,itemStyler:h}=n,d=this.getHighlightStyle(s,t),u=xb(d,n.getStyle());!s&&i!=null&&(u.stroke=this.isColorScaleValid()?r.convert(i):c?.[0]??n.stroke),o!=null&&(u.strokeWidth=l.convert(o,{clamp:!0}));let g;return h!=null&&(g=this.cachedDatumCallback(fb(t,s?"highlight":"node"),()=>{const y=this.ctx.highlightManager?.getActiveHighlight(),f=this.getHighlightStateString(y,s,t);return this.callWithContext(h,{seriesId:a,datum:e,highlighted:s,highlightState:f,...u})})),g?xb(u,g):u}updateDatumStyles({datumSelection:t,isHighlight:e}){t.each((i,o)=>{o.style=this.getItemStyle(o,e)})}updateDatumNodes({datumSelection:t}){t.each((e,i)=>{const{projectedGeometry:o,style:s}=i;if(o==null){e.visible=!1,e.projectedGeometry=void 0;return}e.visible=!0,e.projectedGeometry=o,e.setProperties(s)})}updatePlacedLabelData(t){this.labelSelection=this.labelSelection.update(t,e=>{e.pointerEvents=hb.PointerEvents.None}),this.updateLabelNodes({labelSelection:this.labelSelection})}updateLabelNodes(t){const{properties:e}=this,i=this.ctx.highlightManager?.getActiveHighlight();t.labelSelection.each((o,{x:s,y:a,width:n,height:r,text:l},c)=>{const h=QB(this,void 0,e,e.label,!1,i),{color:d,fontStyle:u,fontWeight:g,fontSize:y,fontFamily:f}=h;o.visible=!0,o.x=s+n/2,o.y=a+r/2,o.text=l,o.fill=d,o.fontStyle=u,o.fontWeight=g,o.fontSize=y,o.fontFamily=f,o.textAlign="center",o.textBaseline="middle",o.fillOpacity=this.getHighlightStyle(!1,c).opacity??1,o.setBoxing(h)})}resetAnimation(){}getLabelData(){return this.isLabelEnabled()?this.contextNodeData?.labelData??[]:[]}pickNodeClosestDatum({x:t,y:e}){let i=1/0,o;return this.datumSelection.each((s,a)=>{const n=s.distanceSquared(t,e);n<i&&(i=n,o=a)}),o!=null?{datum:o,distance:Math.sqrt(i)}:void 0}datumMidPoint(t){const{_previousDatumMidPoint:e}=this;if(e?.datum===t)return e.point;const i=t.projectedGeometry,o=i!=null?kc(i):void 0,s=o!=null?vc(o)?.point:void 0,a=s!=null?{x:s[0],y:s[1]}:void 0;return this._previousDatumMidPoint={datum:t,point:a},a}legendItemSymbol(t){const{dataModel:e,processedData:i,properties:o}=this,{strokeWidth:s,strokeOpacity:a,lineDash:n}=o;let{stroke:r}=o;if(t!=null&&this.isColorScaleValid()){const c=e.resolveColumnById(this,"colorValue",i)[t];r=this.colorScale.convert(c)}return{marker:{fill:void 0,fillOpacity:0,stroke:void 0,strokeWidth:0,strokeOpacity:0,lineDash:[0],lineDashOffset:0,enabled:!1},line:{stroke:r,strokeWidth:s,strokeOpacity:a,lineDash:n}}}getLegendData(t){const{processedData:e,dataModel:i}=this;if(e==null||i==null)return[];const{id:o,visible:s}=this,{title:a,legendItemName:n,idKey:r,idName:l,colorKey:c,colorRange:h,showInLegend:d}=this.properties;if(t==="gradient"&&c!=null&&h!=null){const u=e.domain.values[i.resolveProcessedDataIndexById(this,"colorValue")];return[{legendType:"gradient",enabled:s,seriesId:o,series:this.getFormatterContext("color"),colorRange:h,colorDomain:u}]}else return t==="category"?[{legendType:"category",id:o,itemId:o,seriesId:o,enabled:s,label:{text:n??a??l??r},symbol:this.legendItemSymbol(),legendItemName:n,hideInLegend:!d}]:[]}getTooltipContent(t){const{id:e,dataModel:i,processedData:o,properties:s,ctx:{formatManager:a}}=this,{idKey:n,idName:r,colorKey:l,colorName:c,sizeKey:h,sizeName:d,labelKey:u,labelName:g,title:y,legendItemName:f,tooltip:x}=s;if(!i||!o)return;const S=o.dataSources.get(this.id)?.[t],v=i.resolveColumnById(this,"idValue",o),m=h!=null?i.resolveColumnById(this,"sizeValue",o)[t]:void 0,b=l!=null?i.resolveColumnById(this,"colorValue",o)[t]:void 0,M=[];if(this.isLabelEnabled()&&u!=null&&u!==n){const A=i.resolveColumnById(this,"labelValue",o)[t],D=a.format(this.callWithContext.bind(this),{type:"category",value:A,datum:S,seriesId:e,legendItemName:f,key:u,source:"tooltip",property:"label",domain:[],boundSeries:this.getFormatterContext("label")});M.push({label:g,fallbackLabel:u,value:D??A})}if(m!=null&&h!=null){const A=i.getDomain(this,"sizeValue","value",o),D=a.format(this.callWithContext.bind(this),{type:"number",value:m,datum:S,seriesId:e,legendItemName:f,key:h,source:"tooltip",property:"size",domain:A,boundSeries:this.getFormatterContext("size"),fractionDigits:void 0});M.push({label:d,fallbackLabel:h,value:D??String(m)})}if(b!=null&&l!=null){const A=i.getDomain(this,"colorValue","value",o),D=a.format(this.callWithContext.bind(this),{type:"number",value:b,datum:S,seriesId:e,legendItemName:f,key:l,source:"tooltip",property:"color",domain:A,boundSeries:this.getFormatterContext("color"),fractionDigits:void 0});M.push({label:c,fallbackLabel:l,value:D??String(b)})}const k=this.getItemStyle({datumIndex:t,datum:S,colorValue:b,sizeValue:m},!1);return this.formatTooltipWithContext(x,{heading:v[t],title:y??f,symbol:this.legendItemSymbol(t),data:M},{seriesId:e,datum:S,title:y,idKey:n,idName:r,colorKey:l,colorName:c,sizeKey:h,sizeName:d,labelKey:u,labelName:g,...k})}computeFocusBounds(t){const e=gb(this,t);return e?iz.toCanvas(this.contentGroup,e.getBBox()):void 0}hasItemStylers(){return this.properties.itemStyler!=null}};Ac.className="MapLineSeries",Ac.type="map-line";import{_ModuleSupport as oz}from"ag-charts-community";import{and as sz,arrayLength as az,arrayOf as nz,color as rz,constant as lz,geoJson as cz,required as Sb,string as Li,undocumented as hz}from"ag-charts-core";var{commonSeriesOptionsDefs:pz,mapLineSeriesThemeableOptionsDef:dz,without:uz}=oz,bb={...uz(pz,["highlightStyle","highlight"]),...dz,type:Sb(lz("map-line")),idKey:Sb(Li),sizeKey:Li,colorKey:Li,labelKey:Li,idName:Li,sizeName:Li,colorName:Li,labelName:Li,topology:cz,topologyIdKey:Li,legendItemName:Li,title:Li};bb.colorRange=hz(sz(nz(rz),az(1)));var gz={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["topology"],identifier:"map-line",moduleFactory:t=>new Ac(t),themeTemplate:{...jn,series:{stroke:Yi(bc.SAFE_STROKE_FILL_OPERATION),colorRange:{$if:[{$eq:[{$mapPalette:"type"},"inbuilt"]},{$mapPalette:"divergingColors"},Yi(bc.SAFE_RANGE2_OPERATION)]},strokeWidth:1,maxStrokeWidth:3,lineDash:[0],lineDashOffset:0,label:{...bc.LABEL_BOXING_DEFAULTS,enabled:!0,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"textColor"}},highlight:Yi(bc.multiSeriesHighlightStyle(!1))},tooltip:{range:"exact"}}},yz={type:"series",name:"map-line",chartType:"topology",enterprise:!0,options:bb,create:t=>new Ac(t)};import{_ModuleSupport as fz}from"ag-charts-community";import{Logger as mz}from"ag-charts-core";import{_ModuleSupport as xz}from"ag-charts-community";var{Property:$s,SeriesProperties:Sz,makeSeriesTooltip:bz}=xz,Qo=class extends Sz{constructor(){super(...arguments),this.topology=void 0,this.stroke="black",this.strokeOpacity=1,this.strokeWidth=0,this.lineDash=[0],this.lineDashOffset=0,this.tooltip=bz()}};p([$s],Qo.prototype,"topology",2),p([$s],Qo.prototype,"stroke",2),p([$s],Qo.prototype,"strokeOpacity",2),p([$s],Qo.prototype,"strokeWidth",2),p([$s],Qo.prototype,"lineDash",2),p([$s],Qo.prototype,"lineDashOffset",2),p([$s],Qo.prototype,"tooltip",2);var{createDatumId:vz,Group:Mz,Selection:Dz,PointerEvents:vb}=fz,Lc=class extends Yn{constructor(t){super({moduleCtx:t,categoryKey:void 0,pickModes:[]}),this.properties=new Qo,this._chartTopology=void 0,this.itemGroup=this.contentGroup.appendChild(new Mz({name:"itemGroup"})),this.datumSelection=Dz.select(this.itemGroup,()=>this.nodeFactory()),this.itemGroup.pointerEvents=vb.None}getNodeData(){return this.contextNodeData?.nodeData}get topology(){return this.properties.topology??this._chartTopology}get focusable(){return!1}setOptionsData(){}setChartData(){}get hasData(){return!1}renderToOffscreenCanvas(){return!0}setChartTopology(t){this._chartTopology=t,this.topology===t&&(this.nodeDataRefresh=!0)}setZIndex(t){return super.setZIndex(t),this.contentGroup.zIndex=[0,t,0],this.highlightGroup.zIndex=[0,t,1],!0}nodeFactory(){const t=new $a;return t.renderMode=2,t.lineJoin="round",t.lineCap="round",t.pointerEvents=vb.None,t}processData(){const{topology:t}=this;this.topologyBounds=t?.features.reduce((e,i)=>{const o=i.geometry;return o==null?e:ja(o,e)},void 0),t==null&&mz.warnOnce("no topology was provided for [MapShapeBackgroundSeries]; nothing will be rendered.")}createNodeData(){const{id:t,topology:e,scale:i,properties:o}=this;if(e==null)return;const{stroke:s,strokeOpacity:a,lineDash:n,lineDashOffset:r,strokeWidth:l}=o,c=[],h=[];return e.features.forEach((d,u)=>{const{geometry:g}=d,y=g!=null&&i!=null?qo(g,i):void 0;y!=null&&c.push({series:this,itemId:u,datum:d,datumIndex:0,index:u,projectedGeometry:y,style:{stroke:s,strokeOpacity:a,lineDash:n,lineDashOffset:r,strokeWidth:l}})}),{itemId:t,nodeData:c,labelData:h}}updateSelections(){this.nodeDataRefresh&&(this.contextNodeData=this.createNodeData(),this.nodeDataRefresh=!1)}update(){const{datumSelection:t}=this;this.updateSelections(),this.contentGroup.visible=this.visible,this.labelGroup.visible=this.visible;const{nodeData:e=[]}=this.contextNodeData??{};this.datumSelection=this.updateDatumSelection({nodeData:e,datumSelection:t}),this.updateDatumNodes({datumSelection:t})}updateDatumSelection(t){return t.datumSelection.update(t.nodeData,void 0,e=>vz(e.index))}updateDatumNodes(t){const{datumSelection:e}=t;e.each((i,o)=>{const{projectedGeometry:s}=o;if(s==null){i.visible=!1,i.projectedGeometry=void 0;return}i.visible=!0,i.projectedGeometry=s,i.setProperties(o.style)})}resetAnimation(){}getLegendData(){return[]}getTooltipContent(t){}computeFocusBounds(t){}hasItemStylers(){return!1}};Lc.className="MapLineBackgroundSeries",Lc.type="map-line-background";import{_ModuleSupport as kz}from"ag-charts-community";import{constant as Az,geoJson as Lz,required as Iz}from"ag-charts-core";var{mapLineBackgroundSeriesThemeableOptionsDef:Cz}=kz,Tz={...Cz,type:Iz(Az("map-line-background")),topology:Lz},wz={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["topology"],identifier:"map-line-background",moduleFactory:t=>new Lc(t),themeTemplate:{...jn,series:{stroke:{$path:["/1",{$mapPalette:"stroke"},{$mapPalette:"secondHierarchyColors"}]},strokeWidth:1,lineDash:[0],lineDashOffset:0}}},Nz={type:"series",name:"map-line-background",chartType:"topology",enterprise:!0,options:Tz,create:t=>new Lc(t)};import{_ModuleSupport as Ya}from"ag-charts-community";import{ValidationError as Pz,validate as Ez}from"ag-charts-core";import{_ModuleSupport as Mb}from"ag-charts-community";import{Logger as _z,cachedTextMeasurer as Oz}from"ag-charts-core";var Rz=void 0,Bz=void 0;Bz=Rz;var zz=void 0,Fz=void 0;Fz=zz;var Vz=void 0,Hz=void 0;Hz=Vz;var Gz=void 0,Wz=void 0;Wz=Gz;import{insertListItemsSorted as Kz}from"ag-charts-core";function Db(t,e,i){const o=Ks(t[0],void 0);if(o==null)return;const s=(o.lon0+o.lon1)/2,a=(o.lat0+o.lat1)/2,n=Math.abs(o.lon1-o.lon0),r=Math.abs(o.lat1-o.lat0),l=BB(t[0]),[c,h]=l,d=-Mc(t,c,h);let u;const g=(M,k)=>{const D=Math.max(k-d,0);return M-.5*D},y=(M,k,A)=>{const{distance:D,maxDistance:I}=i(t,M,k,A),L=Math.hypot(c-M,h-k),C=Math.min(Math.max(c,M-A/2),M+A/2),w=Math.min(Math.max(h,k-A/2),k+A/2),P=Math.hypot(c-C,h-w),E=g(D,L),T=g(I,P);return{distance:D,maxDistance:I,value:E,maxValue:T,x:M,y:k,stride:A}},f=(M,k,A,D)=>{const I=y(k,A,D);I.maxDistance>=0&&M.push(I)},x=Math.min(n,r)/2;let S={value:y(s,a,x),next:null};for(;S!=null;){const M=S.value,{distance:k,value:A,maxValue:D,x:I,y:L,stride:C}=M;if(S=S.next,k>0&&(u==null||A>u.value)&&(u=M),u!=null&&D-u.value<=e)continue;const w=C/2,P=[];f(P,I-w,L-w,w),f(P,I+w,L-w,w),f(P,I-w,L+w,w),f(P,I+w,L+w,w),P.sort(kb),S=Kz(S,P,kb)}if(u==null)return;const{distance:v,x:m,y:b}=u;return{x:m,y:b,distance:v}}var kb=(t,e)=>e.maxValue-t.maxValue;function tu(t,e){const i=Db(t,e,(a,n,r,l)=>{const c=-Mc(a,n,r),h=c+l*Math.SQRT2;return{distance:c,maxDistance:h}});if(i==null)return;const{x:o,y:s}=i;return[o,s]}function Ab(t,e){let i;switch(t.type){case"GeometryCollection":return t.geometries.flatMap(o=>Ab(o,e));case"MultiPoint":return t.coordinates;case"Point":return[t.coordinates];case"MultiPolygon":{const o=Dc(t);i=o!=null?tu(o,e):void 0;break}case"Polygon":{const o=t.coordinates;i=o!=null?tu(o,e):void 0;break}case"MultiLineString":{const o=kc(t);i=o!=null?vc(o)?.point:void 0;break}case"LineString":{const o=t.coordinates;i=vc(o)?.point;break}}return i!=null?[i]:[]}import{_ModuleSupport as $z}from"ag-charts-community";var{BBox:jz}=$z;function Lb(t){if(!t)return;const{range:e}=t,i=e[0][0],o=e[0][1],s=e[1][0]-i,a=e[1][1]-o,n=new jz(i,o,s,a);return{series:n,axis:n}}import{_ModuleSupport as Yz}from"ag-charts-community";var{Property:rt,SeriesProperties:Uz,makeSeriesTooltip:Xz,Label:Zz}=Yz,Ib=class extends Zz{constructor(){super(...arguments),this.placement="bottom"}};p([rt],Ib.prototype,"placement",2);var lt=class extends Uz{constructor(){super(...arguments),this.topology=void 0,this.idKey=void 0,this.topologyIdKey="name",this.idName=void 0,this.latitudeKey=void 0,this.latitudeName=void 0,this.longitudeKey=void 0,this.longitudeName=void 0,this.labelKey=void 0,this.labelName=void 0,this.colorRange=void 0,this.shape="circle",this.size=6,this.fill="black",this.fillOpacity=1,this.stroke="black",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.label=new Ib,this.tooltip=Xz()}getStyle(){const{size:t,shape:e,fill:i,fillOpacity:o,stroke:s,strokeWidth:a,strokeOpacity:n,lineDash:r,lineDashOffset:l}=this;return{size:t,shape:e,fill:i,fillOpacity:o,opacity:1,stroke:s,strokeWidth:a,strokeOpacity:n,lineDash:r,lineDashOffset:l}}};p([rt],lt.prototype,"topology",2),p([rt],lt.prototype,"title",2),p([rt],lt.prototype,"legendItemName",2),p([rt],lt.prototype,"idKey",2),p([rt],lt.prototype,"topologyIdKey",2),p([rt],lt.prototype,"idName",2),p([rt],lt.prototype,"latitudeKey",2),p([rt],lt.prototype,"latitudeName",2),p([rt],lt.prototype,"longitudeKey",2),p([rt],lt.prototype,"longitudeName",2),p([rt],lt.prototype,"labelKey",2),p([rt],lt.prototype,"labelName",2),p([rt],lt.prototype,"sizeKey",2),p([rt],lt.prototype,"sizeName",2),p([rt],lt.prototype,"colorKey",2),p([rt],lt.prototype,"colorName",2),p([rt],lt.prototype,"colorRange",2),p([rt],lt.prototype,"shape",2),p([rt],lt.prototype,"size",2),p([rt],lt.prototype,"maxSize",2),p([rt],lt.prototype,"sizeDomain",2),p([rt],lt.prototype,"fill",2),p([rt],lt.prototype,"fillOpacity",2),p([rt],lt.prototype,"stroke",2),p([rt],lt.prototype,"strokeWidth",2),p([rt],lt.prototype,"strokeOpacity",2),p([rt],lt.prototype,"lineDash",2),p([rt],lt.prototype,"lineDashOffset",2),p([rt],lt.prototype,"itemStyler",2),p([rt],lt.prototype,"label",2),p([rt],lt.prototype,"tooltip",2);var{fromToMotion:qz,StateMachine:Qz,getMissCount:Jz,createDatumId:Cb,SeriesNodePickMode:Tb,valueProperty:js,computeMarkerFocusBounds:tF,ColorScale:eF,LinearScale:iF,Group:oF,Selection:eu,Text:sF,Marker:iu,applyShapeStyle:aF,getLabelStyles:nF,LonLatBBox:rF,mergeDefaults:wb}=Mb,Ic=class extends Yn{constructor(t){super({moduleCtx:t,categoryKey:void 0,propertyKeys:{size:["colorKey"],color:["colorKey"],label:["labelKey"]},propertyNames:{size:["sizeName"],color:["colorName"],label:["labelName"]},pickModes:[Tb.EXACT_SHAPE_MATCH,Tb.NEAREST_NODE],usesPlacedLabels:!0}),this.properties=new lt,this._chartTopology=void 0,this.colorScale=new eF,this.sizeScale=new iF,this.markerGroup=this.contentGroup.appendChild(new oF({name:"markerGroup"})),this.labelSelection=eu.select(this.labelGroup,sF,!1),this.markerSelection=eu.select(this.markerGroup,iu,!1),this.highlightMarkerSelection=eu.select(this.highlightGroup,iu),this.animationState=new Qz("empty",{empty:{update:{target:"ready",action:()=>this.animateMarkers()},reset:"empty",skip:"ready"},ready:{updateData:"waiting",clear:"clearing",resize:()=>this.resetAllAnimation(),reset:"empty",skip:"ready"},waiting:{update:{target:"ready",action:()=>this.animateMarkers()},resize:{target:"ready",action:()=>this.resetAllAnimation()},reset:"empty",skip:"ready"},clearing:{update:{target:"empty",action:()=>this.resetAllAnimation()},reset:"empty",skip:"ready"}},()=>this.checkProcessedDataAnimatable())}getNodeData(){return this.contextNodeData?.nodeData}get topology(){return this.properties.topology??this._chartTopology}get hasData(){const t=this.properties.latitudeKey!=null&&this.properties.longitudeKey!=null;return super.hasData&&(this.topology!=null||t)}renderToOffscreenCanvas(){return!0}setChartTopology(t){this._chartTopology=t,this.topology===t&&(this.nodeDataRefresh=!0)}setZIndex(t){return super.setZIndex(t),this.contentGroup.zIndex=[3,t],this.highlightGroup.zIndex=[4,t],!0}isLabelEnabled(){return this.properties.labelKey!=null&&this.properties.label.enabled}async processData(t){if(this.data==null)return;const{data:e,topology:i,sizeScale:o,colorScale:s}=this,{topologyIdKey:a,idKey:n,latitudeKey:r,longitudeKey:l,sizeKey:c,colorKey:h,labelKey:d,sizeDomain:u,colorRange:g}=this.properties,y=new Map;i?.features.forEach(D=>{const I=D.properties?.[a];I!=null&&y.set(I,D)});const f=this.sizeScale.type,x=this.colorScale.type,S=this.scale?.type,v=r!=null&&l!=null,{dataModel:m,processedData:b}=await this.requestDataModel(t,e,{props:[...n!=null?[js(n,S,{id:"idValue",includeProperty:!1}),js(n,S,{id:"featureValue",includeProperty:!1,processor:()=>D=>y.get(D)})]:[],...v?[js(r,S,{id:"latValue"}),js(l,S,{id:"lonValue"})]:[],...d?[js(d,"category",{id:"labelValue"})]:[],...c?[js(c,f,{id:"sizeValue"})]:[],...h?[js(h,x,{id:"colorValue"})]:[]]}),M=n!=null?m.resolveColumnById(this,"featureValue",b):void 0,k=v?m.resolveColumnById(this,"latValue",b):void 0,A=v?m.resolveColumnById(this,"lonValue",b):void 0;if(this.topologyBounds=b.dataSources.get(this.id)?.reduce((D,I,L)=>{const w=M?.[L]?.geometry;if(w!=null&&(D=ja(w,D)),k!=null&&A!=null){const P=A[L],E=k[L];D=rF.extend(D,P,E,P,E)}return D},void 0),c!=null){const D=m.resolveProcessedDataIndexById(this,"sizeValue"),I=b.domain.values[D]??[];o.domain=u??I}if(g!=null&&this.isColorScaleValid()){const D=m.resolveProcessedDataIndexById(this,"colorValue");s.domain=b.domain.values[D],s.range=g,s.update()}this.animationState.transition("updateData")}isColorScaleValid(){const{colorKey:t}=this.properties;if(!t)return!1;const{dataModel:e,processedData:i}=this;if(!e||!i)return!1;const o=e.resolveProcessedDataIndexById(this,"colorValue"),s=i.input.count,a=Jz(this,i.defs.values[o].missing);return!(s===0||s===a)}getLabelDatum(t,e,i,o,s,a){if(e==null)return;const{idKey:n,idName:r,latitudeKey:l,latitudeName:c,longitudeKey:h,longitudeName:d,sizeKey:u,sizeName:g,colorKey:y,colorName:f,labelKey:x,labelName:S,label:v,shape:m}=this.properties;if(x==null||!v.enabled)return;const{placement:b}=v,M=this.getLabelText(e,t,x,"label",[],v,{value:e,datum:t,idKey:n,idName:r,latitudeKey:l,latitudeName:c,longitudeKey:h,longitudeName:d,sizeKey:u,sizeName:g,colorKey:y,colorName:f,labelKey:x,labelName:S});if(M==null)return;const{width:k,height:A}=a.measureText(String(M)),D=iu.anchor(m);return{point:{x:i,y:o,size:s},label:{width:k,height:A,text:M},anchor:D,placement:b}}createNodeData(){const{id:t,dataModel:e,processedData:i,sizeScale:o,properties:s,scale:a}=this,{idKey:n,latitudeKey:r,longitudeKey:l,sizeKey:c,colorKey:h,labelKey:d,label:u,legendItemName:g}=s;if(e==null||i==null||a==null)return;const y=r!=null&&l!=null,f=n!=null?e.resolveColumnById(this,"idValue",i):void 0,x=n!=null?e.resolveColumnById(this,"featureValue",i):void 0,S=y?e.resolveColumnById(this,"latValue",i):void 0,v=y?e.resolveColumnById(this,"lonValue",i):void 0,m=d!=null?e.resolveColumnById(this,"labelValue",i):void 0,b=c!=null?e.resolveColumnById(this,"sizeValue",i):void 0,M=h!=null?e.resolveColumnById(this,"colorValue",i):void 0,k=s.maxSize??s.size;o.range=[Math.min(s.size,k),k];const A=Oz(u);let D;f!=null&&x!=null&&(D=new Map,i.dataSources.get(this.id)?.forEach((E,T)=>{const R=f[T],_=x[T]?.geometry??void 0,N=_!=null&&a!=null?qo(_,a):void 0;R!=null&&N!=null&&D.set(R,N)}));const I=[],L=[],C=[];(i.dataSources.get(this.id)??[]).forEach((E,T)=>{const R=f?.[T],_=v?.[T],N=S?.[T],O=M?.[T],B=b?.[T],z=m?.[T],V=B!=null?o.convert(B,{clamp:!0}):s.size,F=R!=null?D?.get(R):void 0;if(R!=null&&qo==null&&C.push(R),_!=null&&N!=null){const[H,W]=a.convert([_,N]),G=this.getLabelDatum(E,z,H,W,V,A);G&&L.push(G),I.push({series:this,itemId:r,datum:E,datumIndex:T,index:-1,idValue:R,lonValue:_,latValue:N,labelValue:z,sizeValue:B,colorValue:O,point:{x:H,y:W,size:V},midPoint:{x:H,y:W},legendItemName:g,style:this.getMarkerItemStyle({datumIndex:T,datum:E,colorValue:O,sizeValue:B},!1)})}else F!=null&&Ab(F,1).forEach(([H,W],G)=>{const K=this.getLabelDatum(E,z,H,W,V,A);K&&L.push(K),I.push({series:this,itemId:r,datum:E,datumIndex:T,index:G,idValue:R,lonValue:_,latValue:N,labelValue:z,sizeValue:B,colorValue:O,point:{x:H,y:W,size:V},midPoint:{x:H,y:W},legendItemName:g,style:this.getMarkerItemStyle({datumIndex:T,datum:E,colorValue:O,sizeValue:B},!1)})})});const P=10;if(C.length>P){const E=C.length-P;C.length=P,C.push(`(+${E} more)`)}return C.length>0&&_z.warnOnce("some data items do not have matches in the provided topology",C),{itemId:t,nodeData:I,labelData:L}}updateSelections(){this.nodeDataRefresh&&(this.contextNodeData=this.createNodeData(),this.nodeDataRefresh=!1)}checkScaleChange(){return this.previousScale===this.scale?!1:(this.previousScale=this.scale,!0)}update({seriesRect:t}){const e=this.checkResize(t),i=this.checkScaleChange(),{markerSelection:o,highlightMarkerSelection:s}=this;this.updateSelections(),this.contentGroup.visible=this.visible,this.labelGroup.visible=this.visible;let a=this.ctx.highlightManager?.getActiveHighlight();const{legendItemName:n}=this.properties,r=n!=null&&a?.datum==null&&n===a?.legendItemName;a!=null&&(a.series!==this&&!r||a.datum==null)&&(a=void 0);const l=this.contextNodeData?.nodeData??[];this.markerSelection=this.updateMarkerSelection({markerData:l,markerSelection:o}),this.updateMarkerNodes({markerSelection:o,isHighlight:!1,highlightedDatum:a}),this.highlightMarkerSelection=this.updateMarkerSelection({markerData:a!=null?[a]:[],markerSelection:s}),this.updateMarkerNodes({markerSelection:s,isHighlight:!0,highlightedDatum:a}),(i||e)&&this.animationState.transition("resize"),this.animationState.transition("update")}updatePlacedLabelData(t){this.labelSelection=this.labelSelection.update(t,e=>{e.pointerEvents=Mb.PointerEvents.None}),this.updateLabelNodes({labelSelection:this.labelSelection})}updateLabelNodes(t){const{properties:e}=this,i=this.ctx.highlightManager?.getActiveHighlight();t.labelSelection.each((o,{x:s,y:a,width:n,height:r,text:l},c)=>{const h=nF(this,void 0,e,e.label,!1,i),{color:d,fontStyle:u,fontWeight:g,fontSize:y,fontFamily:f}=h;o.visible=!0,o.x=s+n/2,o.y=a+r/2,o.text=l,o.fill=d,o.fontStyle=u,o.fontWeight=g,o.fontSize=y,o.fontFamily=f,o.textAlign="center",o.textBaseline="middle",o.fillOpacity=this.getHighlightStyle(!1,c).opacity??1,o.setBoxing(h)})}updateMarkerSelection(t){const{markerData:e,markerSelection:i}=t;return i.update(e,void 0,o=>Cb(o.index,o.idValue,o.lonValue,o.latValue))}getMarkerItemStyle({datumIndex:t,datum:e,colorValue:i,sizeValue:o},s){const{id:a,properties:n,colorScale:r,sizeScale:l}=this,{colorRange:c,itemStyler:h}=n,d=this.getHighlightStyle(s,t),u=wb(d,n.getStyle());!s&&i!=null&&(u.fill=this.isColorScaleValid()?r.convert(i):c?.[0]??u.fill),o!=null&&(u.size=l.convert(o,{clamp:!0}));let g=u;if(h!=null&&t!=null){const y=this.cachedDatumCallback(Cb(t,s?"highlight":"node"),()=>{const f=this.ctx.highlightManager?.getActiveHighlight(),x=this.getHighlightStateString(f,s,t);return this.callWithContext(h,{seriesId:a,datum:e,highlighted:s,highlightState:x,...g})});y&&(g=wb(y,u))}return g}updateMarkerNodes(t){const{markerSelection:e,isHighlight:i,highlightedDatum:o}=t,s=Lb(this.scale);e.each((a,n)=>{const{datum:r,point:l}=n,c=this.getMarkerItemStyle(n,i);a.shape=c.shape,a.size=c.size,aF(a,c,s),a.x=l.x,a.y=l.y,a.scalingCenterX=l.x,a.scalingCenterY=l.y,a.zIndex=!i&&o!=null&&r===o.datum?1:0})}isProcessedDataAnimatable(){return!0}resetAnimation(t){t==="initial"?this.animationState.transition("reset"):t==="ready"&&this.animationState.transition("skip")}resetAllAnimation(){this.ctx.animationManager.stopByAnimationGroupId(this.id),this.ctx.animationManager.skipCurrentBatch(),this.labelSelection.cleanup(),this.markerSelection.cleanup(),this.highlightMarkerSelection.cleanup()}animateMarkers(){const{animationManager:t}=this.ctx,e=jB();qz(this.id,"markers",t,[this.markerSelection,this.highlightMarkerSelection],e)}getLabelData(){return this.isLabelEnabled()?this.contextNodeData?.labelData??[]:[]}pickNodeClosestDatum(t){const{x:e,y:i}=t;let o=1/0,s;return this.contextNodeData?.nodeData.forEach(a=>{const{x:n,y:r,size:l}=a.point,c=Math.max(Math.abs(n-e)-l,0),h=Math.max(Math.abs(r-i)-l,0),d=c*c+h*h;d<o&&(o=d,s=a)}),s!=null?{datum:s,distance:Math.sqrt(o)}:void 0}legendItemSymbol(t){const{dataModel:e,processedData:i,properties:o}=this,{shape:s,fillOpacity:a,stroke:n,strokeWidth:r,strokeOpacity:l,lineDash:c,lineDashOffset:h}=o;let{fill:d}=o;if(t!=null&&this.isColorScaleValid()){const g=e.resolveColumnById(this,"colorValue",i)[t];d=this.colorScale.convert(g)}return{marker:{shape:s,fill:d,fillOpacity:a,stroke:n,strokeWidth:r,strokeOpacity:l,lineDash:c,lineDashOffset:h}}}getLegendData(t){const{processedData:e,dataModel:i}=this;if(e==null||i==null)return[];const{id:o,visible:s}=this,{title:a,legendItemName:n,idName:r,idKey:l,colorKey:c,colorRange:h,showInLegend:d}=this.properties;if(t==="gradient"&&c!=null&&h!=null){const u=e.domain.values[i.resolveProcessedDataIndexById(this,"colorValue")];return[{legendType:"gradient",enabled:s,seriesId:o,series:this.getFormatterContext("color"),colorRange:h,colorDomain:u}]}else return t==="category"?[{legendType:"category",id:o,itemId:o,seriesId:o,enabled:s,label:{text:n??a??r??l??o},symbol:this.legendItemSymbol(),legendItemName:n,hideInLegend:!d}]:[]}getTooltipContent(t){const{id:e,dataModel:i,processedData:o,properties:s,ctx:{formatManager:a}}=this,{idKey:n,idName:r,latitudeKey:l,latitudeName:c,longitudeKey:h,longitudeName:d,colorKey:u,colorName:g,sizeKey:y,sizeName:f,labelKey:x,labelName:S,title:v,legendItemName:m,tooltip:b}=s;if(!i||!o)return;const M=o.dataSources.get(this.id)?.[t],k=y!=null?i.resolveColumnById(this,"sizeValue",o)[t]:void 0,A=u!=null?i.resolveColumnById(this,"colorValue",o)[t]:void 0,D=[];if(this.isLabelEnabled()&&x!=null&&x!==n){const C=i.resolveColumnById(this,"labelValue",o)[t],w=a.format(this.callWithContext.bind(this),{type:"category",value:C,datum:M,seriesId:e,legendItemName:m,key:x,source:"tooltip",property:"label",domain:[],boundSeries:this.getFormatterContext("label")});D.push({label:S,fallbackLabel:x,value:w??C})}if(y!=null&&k!=null){const C=i.getDomain(this,"sizeValue","value",o),w=a.format(this.callWithContext.bind(this),{type:"number",value:k,datum:M,seriesId:e,legendItemName:m,key:y,source:"tooltip",property:"size",domain:C,boundSeries:this.getFormatterContext("size"),fractionDigits:void 0});D.push({label:f,fallbackLabel:y,value:w??String(k)})}if(u!=null&&A!=null){const C=i.getDomain(this,"colorValue","value",o),w=a.format(this.callWithContext.bind(this),{type:"number",value:A,datum:M,seriesId:e,legendItemName:m,key:u,source:"tooltip",property:"color",domain:C,boundSeries:this.getFormatterContext("color"),fractionDigits:void 0});D.push({label:g,fallbackLabel:u,value:w??String(A)})}let I;if(n!=null)I=i.resolveColumnById(this,"idValue",o)[t];else if(l!=null&&h!=null){const C=i.resolveColumnById(this,"latValue",o)[t],w=i.resolveColumnById(this,"lonValue",o)[t];I=`${Math.abs(C).toFixed(4)}\xB0 ${C>=0?"N":"S"}, ${Math.abs(w).toFixed(4)}\xB0 ${w>=0?"W":"E"}`}const L=this.getMarkerItemStyle({datumIndex:t,datum:M,colorValue:A,sizeValue:k},!1);return this.formatTooltipWithContext(b,{heading:I,title:v??m,symbol:this.legendItemSymbol(t),data:D},{seriesId:e,datum:M,title:v,idKey:n,idName:r,latitudeKey:l,latitudeName:c,longitudeKey:h,longitudeName:d,colorKey:u,colorName:g,sizeKey:y,sizeName:f,labelKey:x,labelName:S,...L})}getFormattedMarkerStyle(t){const e=this.getMarkerItemStyle(t,!1);return{size:e.size,shape:e.shape}}computeFocusBounds(t){return tF(this,t)}hasItemStylers(){return this.properties.itemStyler!=null}};Ic.className="MapMarkerSeries",Ic.type="map-marker";import{_ModuleSupport as lF}from"ag-charts-community";import{constant as cF,geoJson as hF,required as pF,string as De}from"ag-charts-core";var{commonSeriesOptionsDefs:dF,mapMarkerSeriesThemeableOptionsDef:uF,without:gF}=lF,yF={...gF(dF,["highlightStyle","highlight"]),...uF,type:pF(cF("map-marker")),idKey:De,latitudeKey:De,longitudeKey:De,sizeKey:De,colorKey:De,labelKey:De,idName:De,latitudeName:De,longitudeName:De,sizeName:De,colorName:De,labelName:De,topology:hF,topologyIdKey:De,legendItemName:De,title:De},fF={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["topology"],identifier:"map-marker",moduleFactory:t=>new Ic(t),themeTemplate:{...jn,series:{shape:"circle",maxSize:30,fill:Yi({$applySwitch:[{$path:"type"},{$mapPalette:"fill"},["gradient",Ya.FILL_GRADIENT_RADIAL_REVERSED_DEFAULTS],["image",Ya.FILL_IMAGE_DEFAULTS],["pattern",Ya.FILL_PATTERN_DEFAULTS]]}),stroke:{$mapPalette:"stroke"},colorRange:{$if:[{$eq:[{$mapPalette:"type"},"inbuilt"]},{$mapPalette:"divergingColors"},Yi(Ya.SAFE_RANGE2_OPERATION)]},fillOpacity:.5,label:{...Ya.LABEL_BOXING_DEFAULTS,enabled:!1,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"textColor"}},highlight:Yi(Ya.multiSeriesHighlightStyle())},tooltip:{range:"exact"}}},mF={type:"series",name:"map-marker",chartType:"topology",enterprise:!0,options:yF,create:t=>new Ic(t),validate(t,e,i){const o=Ez(t,e,i),{cleared:s,invalid:a}=o;if(s?.idKey==null&&(s?.latitudeKey==null||s?.longitudeKey==null)){const n=l=>i?`${i}.${l}`:l,r=`Either \`${n("idKey")}\` or both \`${n("latitudeKey")}\` and \`${n("longitudeKey")}\` are required.`;a.push(new Pz("required",r,null,i))}return o}};import{_ModuleSupport as Ua}from"ag-charts-community";import{_ModuleSupport as Nb}from"ag-charts-community";import{Logger as Pb,cachedTextMeasurer as xF,calcLineHeight as SF}from"ag-charts-core";function bF(t,{aspectRatio:e,precision:i}){const o=Db(t,i,(l,c,h,d)=>{const u=MF(l,c,h,e),g=u+2*d*e,y=u*Math.SQRT2,f=g*Math.SQRT2;return{distance:y,maxDistance:f}});if(o==null)return;const{x:s,y:a,distance:n}=o,r=n/Math.SQRT2;return{x:s,y:a,maxWidth:r}}function vF(t,e,i,o,s){const[a,n]=t,[r,l]=e,c=1/s,h=r-a,d=l-n,[u,g]=n<=l?t:e,[y,f]=a<=r?t:e,[x,S]=n<=l?e:t,[v,m]=a<=r?e:t;let b=1/0;if(h!==0){const L=d/h;for(let C=0;C<=1;C+=1){const w=C===0?c:-c,P=(L*a-n-w*i+o)/(L-w);if(P>=y&&P<=v){const E=Math.abs(i-P)*2;b=Math.min(b,E)}}}else for(let L=0;L<=1;L+=1){const w=(L===0?c:-c)*(a-i)+o;if(w>=g&&w<=S){const E=Math.abs(o-w)*2*s;b=Math.min(b,E)}}const M=s,k=Math.abs((u-i)/(g-o)),A=Math.abs((x-i)/(S-o));if(S<o&&A<M){const C=Math.abs(o-S)*2*s;b=Math.min(b,C)}else if(g>o&&k<M){const C=Math.abs(o-g)*2*s;b=Math.min(b,C)}const D=Math.abs((f-o)/(y-i)),I=Math.abs((m-o)/(v-i));if(v<i&&I<c){const L=Math.abs(i-v)*2;b=Math.min(b,L)}else if(y>i&&D<c){const L=Math.abs(i-y)*2;b=Math.min(b,L)}return b}function MF(t,e,i,o){let s=!1,a=1/0;for(const n of t){let r=n[n.length-1],[l,c]=r;for(const h of n){const[d,u]=h;u>i!=c>i&&e<(l-d)*(i-u)/(c-u)+d&&(s=!s);const g=vF(r,h,e,i,o);a=Math.min(a,g),r=h,l=d,c=u}}return(s?1:-1)*a}function Cc(t,e,i){i>=e&&(t.maxX=Math.min(t.maxX,i-e)),i<=e&&(t.minX=Math.max(t.minX,i-e))}function DF(t,e,i,o,s,a){const n=s-a/2,r=s+a/2,[l,c]=e,[h,d]=i,u=h-l,g=d-c,[y,f]=l<=h?e:i,[x,S]=l<=h?i:e;if(u!==0){const v=g/u;for(let m=0;m<=1;m+=1){const M=((m===0?n:r)-c)/v+l;M>=y&&M<=x&&Cc(t,o,M)}}else Math.max(n,Math.min(c,d))<=Math.min(r,Math.max(c,d))&&Cc(t,o,l);return x<o&&S>=n&&S<=r?Cc(t,o,x):y>o&&f>=n&&f<=r&&Cc(t,o,y),t}function kF(t,e,i,o){const s={minX:-1/0,maxX:1/0};for(const r of t){let l=r[r.length-1];for(const c of r)DF(s,l,c,e,i,o),l=c}const{minX:a,maxX:n}=s;return Number.isFinite(a)&&Number.isFinite(n)?{x:e+(a+n)/2,width:n-a}:{x:e,width:0}}import{_ModuleSupport as AF}from"ag-charts-community";var{Property:Ct,SeriesProperties:LF,makeSeriesTooltip:IF}=AF,kt=class extends LF{constructor(){super(...arguments),this.topology=void 0,this.idKey="",this.idName=void 0,this.topologyIdKey="name",this.labelKey=void 0,this.labelName=void 0,this.colorRange=void 0,this.fill="black",this.fillOpacity=1,this.stroke="black",this.strokeOpacity=1,this.strokeWidth=0,this.lineDash=[0],this.lineDashOffset=0,this.padding=0,this.label=new Cn,this.tooltip=IF()}getStyle(){const{fill:t,fillOpacity:e,stroke:i,strokeWidth:o,strokeOpacity:s,lineDash:a,lineDashOffset:n}=this;return{fill:t,fillOpacity:e,stroke:i,strokeWidth:o,strokeOpacity:s,lineDash:a,lineDashOffset:n,opacity:1}}};p([Ct],kt.prototype,"topology",2),p([Ct],kt.prototype,"title",2),p([Ct],kt.prototype,"legendItemName",2),p([Ct],kt.prototype,"idKey",2),p([Ct],kt.prototype,"idName",2),p([Ct],kt.prototype,"topologyIdKey",2),p([Ct],kt.prototype,"labelKey",2),p([Ct],kt.prototype,"labelName",2),p([Ct],kt.prototype,"colorKey",2),p([Ct],kt.prototype,"colorName",2),p([Ct],kt.prototype,"colorRange",2),p([Ct],kt.prototype,"fill",2),p([Ct],kt.prototype,"fillOpacity",2),p([Ct],kt.prototype,"stroke",2),p([Ct],kt.prototype,"strokeOpacity",2),p([Ct],kt.prototype,"strokeWidth",2),p([Ct],kt.prototype,"lineDash",2),p([Ct],kt.prototype,"lineDashOffset",2),p([Ct],kt.prototype,"padding",2),p([Ct],kt.prototype,"itemStyler",2),p([Ct],kt.prototype,"label",2),p([Ct],kt.prototype,"tooltip",2);var{getMissCount:CF,createDatumId:Eb,SeriesNodePickMode:_b,valueProperty:Tc,ColorScale:TF,Group:Ob,Selection:ou,Text:wF,PointerEvents:NF,applyShapeStyle:PF,getLabelStyles:EF,mergeDefaults:Rb}=Nb,Bb=Nb.MercatorScale.fixedScale(),wc=class extends Yn{constructor(t){super({moduleCtx:t,categoryKey:void 0,propertyKeys:{color:["colorKey"],label:["labelKey"]},propertyNames:{color:["colorName"],label:["labelName"]},pickModes:[_b.EXACT_SHAPE_MATCH,_b.NEAREST_NODE]}),this.properties=new kt,this._chartTopology=void 0,this.colorScale=new TF,this.itemGroup=this.contentGroup.appendChild(new Ob({name:"itemGroup"})),this.itemLabelGroup=this.contentGroup.appendChild(new Ob({name:"itemLabelGroup"})),this.datumSelection=ou.select(this.itemGroup,()=>this.nodeFactory()),this.labelSelection=ou.select(this.itemLabelGroup,wF),this.highlightDatumSelection=ou.select(this.highlightGroup,()=>this.nodeFactory()),this.previousLabelLayouts=void 0,this._previousDatumMidPoint=void 0,this.itemLabelGroup.pointerEvents=NF.None}getNodeData(){return this.contextNodeData?.nodeData}get topology(){return this.properties.topology??this._chartTopology}get hasData(){return super.hasData&&this.topology!=null}renderToOffscreenCanvas(){return!0}setChartTopology(t){this._chartTopology=t,this.topology===t&&(this.nodeDataRefresh=!0)}setZIndex(t){return super.setZIndex(t),this.contentGroup.zIndex=[1,t],this.highlightGroup.zIndex=[2,t],!0}isLabelEnabled(){return this.properties.labelKey!=null&&this.properties.label.enabled}nodeFactory(){const t=new $a;return t.renderMode=1,t.lineJoin="round",t}async processData(t){if(this.data==null)return;const{data:e,topology:i,colorScale:o}=this,{topologyIdKey:s,idKey:a,colorKey:n,labelKey:r,colorRange:l}=this.properties,c=new Map;i?.features.forEach(f=>{const x=f.properties?.[s];x==null||!Zd(f.geometry,1)||c.set(x,f)});const h=this.colorScale.type,d=this.scale?.type,{dataModel:u,processedData:g}=await this.requestDataModel(t,e,{props:[Tc(a,d,{id:"idValue",includeProperty:!1}),Tc(a,d,{id:"featureValue",includeProperty:!1,processor:()=>f=>c.get(f)}),...r?[Tc(r,"category",{id:"labelValue"})]:[],...n?[Tc(n,h,{id:"colorValue"})]:[]]}),y=u.resolveColumnById(this,"featureValue",g);if(this.topologyBounds=y.reduce((f,x)=>{const S=x?.geometry;return S==null?f:ja(S,f)},void 0),l!=null&&this.isColorScaleValid()){const f=u.resolveProcessedDataIndexById(this,"colorValue");o.domain=g.domain.values[f],o.range=l,o.update()}i==null&&Pb.warnOnce("no topology was provided for [MapShapeSeries]; nothing will be rendered.")}isColorScaleValid(){const{colorKey:t}=this.properties;if(!t)return!1;const{dataModel:e,processedData:i}=this;if(!e||!i)return!1;const o=e.resolveProcessedDataIndexById(this,"colorValue"),s=i.input.count,a=CF(this,i.defs.values[o].missing);return!(s===0||s===a)}getLabelLayout(t,e,i,o,s){if(e==null||o==null)return;const{idKey:a,idName:n,colorKey:r,colorName:l,labelKey:c,labelName:h,padding:d,label:u}=this.properties;if(c==null||!u.enabled)return;const g=this.getLabelText(e,t,c,"label",[],u,{value:e,datum:t,idKey:a,idName:n,colorKey:r,colorName:l,labelKey:c,labelName:h});if(g==null)return;const y=i.measureText(String(g)),f=g.split(`
`).length,x=(y.width+2*d)/(f*SF(u.fontSize)+2*d);if(s?.geometry===o&&s?.labelText===g&&s?.aspectRatio===x)return s;const S=qo(o,Bb),v=Dc(S);if(v==null)return;const m=bF(v,{aspectRatio:x,precision:.001});if(m==null)return;const{x:b,y:M,maxWidth:k}=m;return{geometry:o,labelText:g,aspectRatio:x,x:b,y:M,maxWidth:k,fixedPolygon:v}}getLabelDatum(t,e){const{scale:i}=this;if(i==null)return;const{padding:o,label:s}=this.properties,{labelText:a,aspectRatio:n,x:r,y:l,maxWidth:c,fixedPolygon:h}=t,d={width:Math.ceil(c*e),height:Math.ceil(c*e/n),meta:r},u=Ln(a,s,{padding:o},(b,M)=>{if(!M)return d;const k=kF(h,r,l,b/e);return{width:k.width*e,height:b,meta:k.x}});if(u==null)return;const[{text:g,fontSize:y,lineHeight:f,width:x},S]=u,v=x<d.width?r:S,m=this.scale.convert(Bb.invert([v,l]));return{x:m[0],y:m[1],text:g,fontSize:y,lineHeight:f}}createNodeData(){const{id:t,dataModel:e,processedData:i,properties:o,scale:s,previousLabelLayouts:a}=this,{idKey:n,colorKey:r,labelKey:l,label:c,legendItemName:h}=o;if(e==null||i==null)return;const d=s!=null?(s.range[1][0]-s.range[0][0])/s.bounds.width:NaN,u=e.resolveColumnById(this,"idValue",i),g=e.resolveColumnById(this,"featureValue",i),y=l!=null?e.resolveColumnById(this,"labelValue",i):void 0,f=r!=null?e.resolveColumnById(this,"colorValue",i):void 0,x=xF(c),S=new Map;this.previousLabelLayouts=S;const v=[],m=[],b=[];(i.dataSources.get(this.id)??[]).forEach((A,D)=>{const I=u[D],L=f?.[D],C=y?.[D],w=g[D]?.geometry??void 0;w==null&&b.push(I);const P=this.getLabelLayout(A,C,x,w,a?.get(I));P!=null&&S.set(I,P);const E=P!=null&&s!=null?this.getLabelDatum(P,d):void 0;E!=null&&m.push(E);const T=w!=null&&s!=null?qo(w,s):void 0;v.push({series:this,itemId:n,datum:A,datumIndex:D,idValue:I,colorValue:L,labelValue:C,projectedGeometry:T,legendItemName:h,style:this.getItemStyle({datum:A,datumIndex:D,colorValue:L},!1)})});const k=10;if(b.length>k){const A=b.length-k;b.length=k,b.push(`(+${A} more)`)}return b.length>0&&Pb.warnOnce("some data items do not have matches in the provided topology",b),{itemId:t,nodeData:v,labelData:m}}updateSelections(){this.nodeDataRefresh&&(this.contextNodeData=this.createNodeData(),this.nodeDataRefresh=!1)}update(){const{datumSelection:t,labelSelection:e,highlightDatumSelection:i}=this;this.updateSelections(),this.contentGroup.visible=this.visible,this.labelGroup.visible=this.visible;let o=this.ctx.highlightManager?.getActiveHighlight();const{legendItemName:s}=this.properties,a=s!=null&&o?.datum==null&&s===o?.legendItemName;o!=null&&(o.series!==this&&!a||o.datum==null)&&(o=void 0);const n=this.contextNodeData?.nodeData??[],r=this.contextNodeData?.labelData??[];this.datumSelection=this.updateDatumSelection({nodeData:n,datumSelection:t}),this.updateDatumStyles({datumSelection:t,isHighlight:!1}),this.updateDatumNodes({datumSelection:t}),this.labelSelection=this.updateLabelSelection({labelData:r,labelSelection:e}),this.updateLabelNodes({labelSelection:e}),this.highlightDatumSelection=this.updateDatumSelection({nodeData:o!=null?[o]:[],datumSelection:i}),this.updateDatumStyles({datumSelection:i,isHighlight:!0}),this.updateDatumNodes({datumSelection:i})}updateDatumSelection(t){return t.datumSelection.update(t.nodeData,void 0,e=>Eb(e.idValue))}getItemStyle({datumIndex:t,datum:e,colorValue:i},o){const{id:s,properties:a,colorScale:n}=this,{colorRange:r,itemStyler:l}=a,c=this.getHighlightStyle(o,t),h=Rb(c,a.getStyle());!o&&i!=null&&(h.fill=this.isColorScaleValid()?n.convert(i):r?.[0]??h.fill);let d=h;if(l!=null&&t!=null){const u=this.cachedDatumCallback(Eb(t,o?"highlight":"node"),()=>{const g=this.ctx.highlightManager?.getActiveHighlight(),y=this.getHighlightStateString(g,o,t);return this.ctx.optionsGraphService.resolvePartial(["series",`${this.declarationOrder}`],this.callWithContext(l,{seriesId:s,datum:e,highlighted:o,highlightState:y,...d}))});u&&(d=Rb(u,d))}return d}updateDatumStyles({datumSelection:t,isHighlight:e}){t.each((i,o)=>{o.style=this.getItemStyle(o,e)})}updateDatumNodes({datumSelection:t}){const e=Lb(this.scale);t.each((i,o)=>{const{projectedGeometry:s}=o;if(s==null){i.visible=!1,i.projectedGeometry=void 0;return}i.visible=!0,i.projectedGeometry=s,PF(i,o.style,e)})}updateLabelSelection(t){const e=this.isLabelEnabled()?t.labelData:[];return t.labelSelection.update(e)}updateLabelNodes(t){const{properties:e}=this,i=this.ctx.highlightManager?.getActiveHighlight();t.labelSelection.each((o,{x:s,y:a,text:n,fontSize:r,lineHeight:l},c)=>{const h=EF(this,void 0,e,e.label,!1,i),{color:d,fontStyle:u,fontWeight:g,fontFamily:y}=h;o.visible=!0,o.x=s,o.y=a,o.text=n,o.fill=d,o.fontStyle=u,o.fontWeight=g,o.fontSize=r,o.lineHeight=l,o.fontFamily=y,o.textAlign="center",o.textBaseline="middle",o.fillOpacity=this.getHighlightStyle(!1,c).opacity??1,o.setBoxing(h)})}resetAnimation(){}pickNodeClosestDatum({x:t,y:e}){let i=1/0,o;return this.datumSelection.each((s,a)=>{const n=s.distanceSquared(t,e);n<i&&(i=n,o=a)}),o!=null?{datum:o,distance:Math.sqrt(i)}:void 0}datumMidPoint(t){const{_previousDatumMidPoint:e}=this;if(e?.datum===t)return e.point;const i=t.projectedGeometry,o=i!=null?Dc(i):void 0,s=o!=null?tu(o,2):void 0,a=s!=null?{x:s[0],y:s[1]}:void 0;return this._previousDatumMidPoint={datum:t,point:a},a}legendItemSymbol(t){const{dataModel:e,processedData:i,properties:o}=this,{fillOpacity:s,stroke:a,strokeWidth:n,strokeOpacity:r,lineDash:l,lineDashOffset:c}=o;let{fill:h}=o;if(t!=null&&this.isColorScaleValid()){const u=e.resolveColumnById(this,"colorValue",i)[t];h=this.colorScale.convert(u)}return{marker:{fill:h,fillOpacity:s,stroke:a,strokeWidth:n,strokeOpacity:r,lineDash:l,lineDashOffset:c}}}getLegendData(t){const{processedData:e,dataModel:i}=this;if(e==null||i==null)return[];const{id:o,visible:s}=this,{title:a,legendItemName:n,idKey:r,idName:l,colorKey:c,colorRange:h,showInLegend:d}=this.properties;if(t==="gradient"&&c!=null&&h!=null){const u=e.domain.values[i.resolveProcessedDataIndexById(this,"colorValue")];return[{legendType:"gradient",enabled:s,seriesId:o,series:this.getFormatterContext("color"),colorRange:h,colorDomain:u}]}else return t==="category"?[{legendType:"category",id:o,itemId:o,seriesId:o,enabled:s,label:{text:n??a??l??r},symbol:this.legendItemSymbol(),legendItemName:n,hideInLegend:!d}]:[]}getTooltipContent(t){const{id:e,dataModel:i,processedData:o,properties:s,ctx:{formatManager:a}}=this,{idKey:n,idName:r,colorKey:l,colorName:c,labelKey:h,labelName:d,legendItemName:u,title:g,tooltip:y}=s;if(!i||!o)return;const f=o.dataSources.get(this.id)?.[t],x=i.resolveColumnById(this,"idValue",o)[t],S=l!=null?i.resolveColumnById(this,"colorValue",o)[t]:void 0,v=[];if(this.isLabelEnabled()&&h!=null&&h!==n){const b=i.resolveColumnById(this,"labelValue",o)[t],M=a.format(this.callWithContext.bind(this),{type:"category",value:b,datum:f,seriesId:e,legendItemName:u,key:h,source:"tooltip",property:"label",domain:[],boundSeries:this.getFormatterContext("label")});v.push({label:d,fallbackLabel:h,value:M??b})}if(S!=null){const b=i.getDomain(this,"colorValue","value",o),M=a.format(this.callWithContext.bind(this),{type:"number",value:S,datum:f,seriesId:e,legendItemName:u,key:l,source:"tooltip",property:"color",domain:b,boundSeries:this.getFormatterContext("color"),fractionDigits:void 0});v.push({label:c,fallbackLabel:l,value:M??String(S)})}const m=this.getItemStyle({datum:f,datumIndex:t,colorValue:S},!1);return this.formatTooltipWithContext(y,{heading:x,title:g??u,symbol:this.legendItemSymbol(t),data:v},{seriesId:e,datum:f,title:g,idKey:n,idName:r,colorKey:l,colorName:c,labelKey:h,labelName:d,...m})}computeFocusBounds(t){return gb(this,t)}hasItemStylers(){return this.properties.itemStyler!=null}};wc.className="MapShapeSeries",wc.type="map-shape";import{_ModuleSupport as _F}from"ag-charts-community";import{constant as OF,geoJson as RF,required as zb,string as vo}from"ag-charts-core";var{commonSeriesOptionsDefs:BF,mapShapeSeriesThemeableOptionsDef:zF,without:FF}=_F,VF={...FF(BF,["highlightStyle","highlight"]),...zF,type:zb(OF("map-shape")),idKey:zb(vo),colorKey:vo,labelKey:vo,idName:vo,colorName:vo,labelName:vo,topology:RF,topologyIdKey:vo,legendItemName:vo,title:vo},HF={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["topology"],identifier:"map-shape",moduleFactory:t=>new wc(t),themeTemplate:{...jn,series:{fill:Yi({$applySwitch:[{$path:"type"},{$mapPalette:"fill"},["gradient",Ua.FILL_GRADIENT_LINEAR_DEFAULTS],["image",Ua.FILL_IMAGE_DEFAULTS],["pattern",Ua.FILL_PATTERN_DEFAULTS]]}),stroke:{$ref:"chartBackgroundColor"},colorRange:{$if:[{$eq:[{$mapPalette:"type"},"inbuilt"]},{$mapPalette:"divergingColors"},Yi(Ua.SAFE_RANGE2_OPERATION)]},fillOpacity:1,strokeWidth:1,lineDash:[0],lineDashOffset:0,padding:2,label:{...Ua.LABEL_BOXING_DEFAULTS,color:{$ref:"chartBackgroundColor"},fontFamily:{$ref:"fontFamily"},fontSize:{$ref:"fontSize"},fontWeight:"bold",overflowStrategy:"hide"},highlight:Yi(Ua.multiSeriesHighlightStyle(!0))},tooltip:{range:"exact"}}},GF={type:"series",name:"map-shape",chartType:"topology",enterprise:!0,options:VF,create:t=>new wc(t)};import{_ModuleSupport as su}from"ag-charts-community";import{_ModuleSupport as WF}from"ag-charts-community";import{Logger as KF}from"ag-charts-core";import{_ModuleSupport as $F}from"ag-charts-community";var{Property:Mo,SeriesProperties:jF,makeSeriesTooltip:YF}=$F,Ui=class extends jF{constructor(){super(...arguments),this.topology=void 0,this.fill="black",this.fillOpacity=1,this.stroke="black",this.strokeOpacity=1,this.strokeWidth=0,this.lineDash=[0],this.lineDashOffset=0,this.tooltip=YF()}};p([Mo],Ui.prototype,"topology",2),p([Mo],Ui.prototype,"fill",2),p([Mo],Ui.prototype,"fillOpacity",2),p([Mo],Ui.prototype,"stroke",2),p([Mo],Ui.prototype,"strokeOpacity",2),p([Mo],Ui.prototype,"strokeWidth",2),p([Mo],Ui.prototype,"lineDash",2),p([Mo],Ui.prototype,"lineDashOffset",2),p([Mo],Ui.prototype,"tooltip",2);var{createDatumId:UF,Selection:XF,Group:ZF,PointerEvents:Fb}=WF,Nc=class extends Yn{constructor(t){super({moduleCtx:t,categoryKey:void 0,pickModes:[]}),this.properties=new Ui,this._chartTopology=void 0,this.itemGroup=this.contentGroup.appendChild(new ZF({name:"itemGroup"})),this.datumSelection=XF.select(this.itemGroup,()=>this.nodeFactory()),this.itemGroup.pointerEvents=Fb.None}get topology(){return this.properties.topology??this._chartTopology}get focusable(){return!1}setOptionsData(){}setChartData(){}getNodeData(){}get hasData(){return!1}renderToOffscreenCanvas(){return!0}setChartTopology(t){this._chartTopology=t,this.topology===t&&(this.nodeDataRefresh=!0)}setZIndex(t){return super.setZIndex(t),this.contentGroup.zIndex=[0,t,0],this.highlightGroup.zIndex=[0,t,1],!0}nodeFactory(){const t=new $a;return t.renderMode=1,t.lineJoin="round",t.pointerEvents=Fb.None,t}processData(){const{topology:t}=this;this.topologyBounds=t?.features.reduce((e,i)=>{const o=i.geometry;return o==null?e:ja(o,e)},void 0),t==null&&KF.warnOnce("no topology was provided for [MapShapeBackgroundSeries]; nothing will be rendered.")}createNodeData(){const{id:t,topology:e,scale:i,properties:o}=this;if(e==null)return;const{fill:s,fillOpacity:a,stroke:n,strokeWidth:r,strokeOpacity:l,lineDash:c,lineDashOffset:h}=o,d=[],u=[];return e.features.forEach((g,y)=>{const{geometry:f}=g,x=f!=null&&i!=null?qo(f,i):void 0;x!=null&&d.push({series:this,itemId:y,datum:g,datumIndex:0,index:y,projectedGeometry:x,style:{fill:s,fillOpacity:a,stroke:n,strokeWidth:r,strokeOpacity:l,lineDash:c,lineDashOffset:h}})}),{itemId:t,nodeData:d,labelData:u}}updateSelections(){this.nodeDataRefresh&&(this.contextNodeData=this.createNodeData(),this.nodeDataRefresh=!1)}update(){const{datumSelection:t}=this;this.updateSelections(),this.contentGroup.visible=this.visible,this.labelGroup.visible=this.visible;const{nodeData:e=[]}=this.contextNodeData??{};this.datumSelection=this.updateDatumSelection({nodeData:e,datumSelection:t}),this.updateDatumNodes({datumSelection:t})}updateDatumSelection(t){return t.datumSelection.update(t.nodeData,void 0,e=>UF(e.index))}updateDatumNodes(t){const{datumSelection:e}=t;e.each((i,o)=>{const{projectedGeometry:s}=o;if(s==null){i.visible=!1,i.projectedGeometry=void 0;return}i.visible=!0,i.projectedGeometry=s,i.setProperties(o.style)})}resetAnimation(){}getLegendData(){return[]}getTooltipContent(t){}pickFocus(){}computeFocusBounds(t){}hasItemStylers(){return!1}};Nc.className="MapShapeBackgroundSeries",Nc.type="map-shape-background";import{_ModuleSupport as qF}from"ag-charts-community";import{constant as QF,geoJson as JF,required as tV}from"ag-charts-core";var{commonSeriesOptionsDefs:eV,mapShapeBackgroundSeriesThemeableOptionsDef:iV}=qF,oV={...iV,...eV,type:tV(QF("map-shape-background")),topology:JF},sV={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["topology"],identifier:"map-shape-background",moduleFactory:t=>new Nc(t),themeTemplate:{...jn,series:{fill:Yi({$applySwitch:[{$path:"type"},{$path:["/1",{$mapPalette:"fill"},{$mapPalette:"hierarchyColors"}]},["gradient",su.FILL_GRADIENT_LINEAR_HIERARCHY_DEFAULTS],["image",su.FILL_IMAGE_DEFAULTS],["pattern",su.FILL_PATTERN_HIERARCHY_DEFAULTS]]}),stroke:{$ref:"chartBackgroundColor"},strokeWidth:1}}},aV={type:"series",name:"map-shape-background",chartType:"topology",enterprise:!0,options:oV,create:t=>new Nc(t)};import{_ModuleSupport as nV}from"ag-charts-community";import{_ModuleSupport as rV}from"ag-charts-community";import{_ModuleSupport as Pc}from"ag-charts-community";import{isDefined as lV}from"ag-charts-core";var{DEFAULT_POLAR_DIRECTION_KEYS:cV,DEFAULT_POLAR_DIRECTION_NAMES:hV,ChartAxisDirection:Xi,PolarAxis:pV,diff:dV,fixNumericExtent:uV,groupAccumulativeValueProperty:Vb,keyProperty:gV,normaliseGroupTo:yV,resetLabelFn:fV,seriesLabelFadeInAnimation:mV,seriesLabelFadeOutAnimation:xV,valueProperty:SV,animationValidation:bV,createDatumId:Hb,SeriesNodePickMode:Gb,normalizeAngle360:Wb,CategoryScale:vV,motion:Kb,applyShapeStyle:MV,isGradientFill:DV,updateLabelNode:kV,mergeDefaults:$b,getItemStyles:jb}=Pc,AV=class extends Pc.SeriesNodeEvent{constructor(t,e,i,o){super(t,e,i,o),this.angleKey=o.properties.angleKey,this.radiusKey=o.properties.radiusKey}},Yb=class extends Pc.PolarSeries{constructor(t,{animationResetFns:e}){super({moduleCtx:t,categoryKey:"angleValue",propertyKeys:cV,propertyNames:hV,canHaveAxes:!0,pickModes:[Gb.NEAREST_NODE,Gb.EXACT_SHAPE_MATCH],animationResetFns:{...e,label:fV}}),this.NodeEvent=AV,this.groupScale=new vV,this.circleCache={r:0,cx:0,cy:0}}getSeriesDomain(t){const{dataModel:e,processedData:i}=this;if(!i||!e)return[];if(t===Xi.Angle)return e.getDomain(this,"angleValue","key",i);{const o=e.getDomain(this,"radiusValue-end","value",i),s=Number.isFinite(o[1]-o[0])?[o[0]>0?0:o[0],o[1]<0?0:o[1]]:[];return uV(s)}}async processData(t){const{angleKey:e,radiusKey:i,normalizedTo:o}=this.properties,s=!this.ctx.animationManager.isSkipped(),a=this.getStackId(),n=`${a}-trailing`,r=[];lV(o)&&r.push(yV([a,n],Math.abs(o))),s&&this.processedData&&r.push(dV(this.id,this.processedData)),s&&r.push(bV());const l=this.visible?{}:{forceValue:0},c=this.axes[Xi.Radius]?.scale.type,h=this.axes[Xi.Angle]?.scale.type;await this.requestDataModel(t,this.data,{props:[gV(e,h,{id:"angleValue"}),SV(i,c,{id:"radiusValue-raw",invalidValue:null,...l}),...Vb(i,"normal","current",{id:"radiusValue-end",rangeId:"radiusValue-range",invalidValue:null,groupId:a,separateNegative:!0,...l},c),...Vb(i,"trailing","current",{id:"radiusValue-start",invalidValue:null,groupId:n,separateNegative:!0,...l},c),...r],groupByKeys:!0,groupByData:!1}),this.animationState.transition("updateData")}didCircleChange(){const t=this.radius,e=this.centerX,i=this.centerY,o=this.circleCache;return t!==o.r||e!==o.cx||i!==o.cy?(this.circleCache={r:t,cx:e,cy:i},!0):!1}isRadiusAxisReversed(){return this.axes[Xi.Radius]?.isReversed()}maybeRefreshNodeData(){!this.didCircleChange()&&!this.nodeDataRefresh||(this.contextNodeData=this.createNodeData(),this.nodeData=this.contextNodeData?.nodeData??[],this.nodeDataRefresh=!1)}getAxisInnerRadius(){const t=this.axes[Xi.Radius];return t instanceof pV?this.radius*t.innerRadiusRatio:0}createNodeData(){const{processedData:t,dataModel:e,groupScale:i}=this;if(!e||!t||t.type!=="grouped")return;const o=this.axes[Xi.Angle],s=this.axes[Xi.Radius],a=o?.scale,n=s?.scale;if(!a||!n)return;const r=e.resolveKeysById(this,"angleValue",t),l=e.resolveColumnById(this,"radiusValue-start",t),c=e.resolveColumnById(this,"radiusValue-end",t),h=e.resolveColumnById(this,"radiusValue-raw",t),d=e.resolveProcessedDataIndexById(this,"radiusValue-range");let u=0,g=0;o instanceof Ao&&(u=o.groupPaddingInner,g=o.paddingInner);const f=(a.bandwidth??0)*(1-g),{index:x,visibleGroupCount:S}=this.ctx.seriesStateManager.getVisiblePeerGroupIndex(this);i.domain=Array.from({length:S}).map((_,N)=>String(N)),i.range=[-f/2,f/2],i.paddingInner=S>1?u:0;const v=this.isRadiusAxisReversed(),m=v?this.radius:this.getAxisInnerRadius(),b=v?this.getAxisInnerRadius():this.radius,M=b+m,{angleKey:k,radiusKey:A,angleName:D,radiusName:I,label:L}=this.properties,C=this.getSeriesDomain(Xi.Radius),w=(_,N,O,B)=>{const z=this.getLabelText(N,_,A,"radius",C,L,{value:N,datum:_,angleKey:k,radiusKey:A,angleName:D,radiusName:I});if(z)return{x:O,y:B,text:z,textAlign:"center",textBaseline:"middle"}},P=[],E={itemId:A,nodeData:P,labelData:P,styles:jb(this.getItemStyle.bind(this))};if(!this.visible)return E;const{dataSources:T}=t,R=T.get(this.id)??[];for(const{datumIndex:_,group:N}of e.forEachGroupDatum(this,t)){const O=R[_],B=r[_];if(B==null)return;const z=h[_],V=z>=0&&!Object.is(z,-0),F=l[_],H=c[_],W=N.aggregation[d][V?1:0]??0,G=V===v;if(F===void 0||H===void 0)return;let K,Y;if(R.length===1)K=-.5*Math.PI,Y=1.5*Math.PI;else{const ut=a.convert(B);K=Wb(ut+i.convert(String(x))),Y=Wb(K+i.bandwidth)}const st=K+i.bandwidth/2,nt=M-n.convert(F),X=M-n.convert(H),Z=(nt+X)/2,Q=M-n.convert(0),pt=M-n.convert(W),ot=Math.cos(st)*Z,q=Math.sin(st)*Z,dt=this.properties.label.enabled?w(O,z,ot,q):void 0,tt=this.getColumnWidth(K,Y);P.push({series:this,datum:O,datumIndex:_,point:{x:ot,y:q,size:0},midPoint:{x:ot,y:q},label:dt,angleValue:B,radiusValue:z,negative:G,innerRadius:nt,outerRadius:X,stackInnerRadius:Q,stackOuterRadius:pt,startAngle:K,endAngle:Y,midAngle:st,axisInnerRadius:m,axisOuterRadius:b,columnWidth:tt,index:_})}return{itemId:A,nodeData:P,labelData:P,styles:jb(this.getItemStyle.bind(this))}}getColumnWidth(t,e){return NaN}update({seriesRect:t}){const e=this.checkResize(t);this.maybeRefreshNodeData(),this.contentGroup.translationX=this.centerX,this.contentGroup.translationY=this.centerY,this.highlightGroup.translationX=this.centerX,this.highlightGroup.translationY=this.centerY,this.labelGroup&&(this.labelGroup.translationX=this.centerX,this.labelGroup.translationY=this.centerY),this.updateSectorSelection(this.itemSelection,!1),this.updateSectorSelection(this.highlightSelection,!0),this.updateLabels(),e&&this.animationState.transition("resize"),this.animationState.transition("update")}getItemStyle(t,e,i){const{id:o,properties:s}=this,{angleKey:a,radiusKey:n,itemStyler:r}=s,l=this.getHighlightStyle(e,t?.datumIndex,i);let h=$b(l,s.getStyle());if(r!=null&&t!=null){const d=this.cachedDatumCallback(Hb(this.getDatumId(t),e?"highlight":"node"),()=>{const u=this.ctx.highlightManager?.getActiveHighlight(),g=this.getHighlightStateString(u,e,t.datumIndex);return this.callWithContext(r,{seriesId:o,datum:t.datum,highlighted:e,highlightState:g,angleKey:a,radiusKey:n,...h})});d&&(h=$b(d,h))}return h}updateSectorSelection(t,e){const{contextNodeData:i}=this;if(!i)return;const o=this.ctx.highlightManager.getActiveHighlight();let s=[];if(e){const h=this.ctx.highlightManager?.getActiveHighlight();h?.datum&&h.series===this&&s.push(h)}else s=this.nodeData;const a=this.isRadiusAxisReversed(),n=a?this.radius:this.getAxisInnerRadius(),r=a?this.getAxisInnerRadius():this.radius,l=this.getShapeFillBBox(),c=this.hasItemStylers();t.update(s,void 0,h=>this.getDatumId(h)).each((h,d)=>{const{midPoint:u}=d;c&&(d.style=this.getItemStyle(d,e));const g=d.style??i.styles[this.getHighlightState(o,e,d.datumIndex)],y=g.fill,x=DV(y)&&y.bounds==="item"?{centerX:u?.x??0,centerY:u?.y??0}:{centerX:0,centerY:0,innerRadius:n,outerRadius:r};this.updateItemPath(h,d,e),MV(h,g,l,x),h.cornerRadius=g.cornerRadius??0,h.lineJoin="round"})}updateLabels(){const t=this.ctx.highlightManager?.getActiveHighlight();this.labelSelection.update(this.nodeData).each((e,i)=>{kV(this,e,this.properties,this.properties.label,i.label,!1,t),e.fillOpacity=this.getHighlightStyle(!1,i.datumIndex).opacity??1})}animateEmptyUpdateReady(){const{labelSelection:t}=this,e=this.getColumnTransitionFunctions();Kb.fromToMotion(this.id,"datums",this.ctx.animationManager,[this.itemSelection],e),mV(this,"labels",this.ctx.animationManager,t)}animateClearingUpdateEmpty(){const{itemSelection:t}=this,{animationManager:e}=this.ctx,i=this.getColumnTransitionFunctions();Kb.fromToMotion(this.id,"datums",e,[t],i),xV(this,"labels",e,this.labelSelection)}getTooltipContent(t){const{id:e,dataModel:i,processedData:o,axes:s,properties:a}=this,{angleKey:n,angleName:r,radiusKey:l,radiusName:c,tooltip:h}=a,d=s[Xi.Angle],u=s[Xi.Radius],g=this.nodeData?.[t];if(!i||!o||!d||!u||!g)return;const y=o.dataSources.get(this.id)?.[t],f=i.resolveKeysById(this,"angleValue",o)[t],x=i.resolveColumnById(this,"radiusValue-raw",o)[t];if(f==null)return;const S=this.getItemStyle(g,!1);return this.formatTooltipWithContext(h,{heading:this.getAxisValueText(d,"tooltip",f,y,n,void 0),symbol:this.legendItemSymbol(),data:[{label:c,fallbackLabel:l,value:this.getAxisValueText(u,"tooltip",x,y,l,void 0)}]},{seriesId:e,datum:y,title:r,angleKey:n,angleName:r,radiusKey:l,radiusName:c,...S})}pickNodeClosestDatum(t){return this.pickNodeNearestDistantObject(t,this.itemSelection.nodes())}legendItemSymbol(){const{fill:t,stroke:e,fillOpacity:i,strokeOpacity:o,strokeWidth:s,lineDash:a,lineDashOffset:n}=this.properties,r={fill:t??"rgba(0, 0, 0, 0)",stroke:e??"rgba(0, 0, 0, 0)",fillOpacity:i,strokeOpacity:o,strokeWidth:s,lineDash:a,lineDashOffset:n};return Pc.isGradientFill(r.fill)&&(r.fill={...r.fill,gradient:"linear",rotation:0,reverse:!1}),{marker:r}}getLegendData(t){if(t!=="category")return[];const{id:e,visible:i}=this,{radiusKey:o,radiusName:s,showInLegend:a}=this.properties;return[{legendType:"category",id:e,itemId:o,seriesId:e,enabled:i,label:{text:s??o},symbol:this.legendItemSymbol(),hideInLegend:!a}]}getDatumId(t){return Hb(t.angleValue)}computeLabelsBBox(){return null}};import{_ModuleSupport as LV}from"ag-charts-community";var{SeriesProperties:IV,makeSeriesTooltip:CV,Property:Jt,Label:TV}=LV,Vt=class extends IV{constructor(){super(...arguments),this.fill="black",this.fillOpacity=1,this.stroke="black",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.cornerRadius=0,this.rotation=0,this.label=new TV,this.tooltip=CV()}getStyle(){const{fill:t,fillOpacity:e,stroke:i,strokeWidth:o,strokeOpacity:s,lineDash:a,lineDashOffset:n,cornerRadius:r}=this;return{fill:t,fillOpacity:e,stroke:i,strokeWidth:o,strokeOpacity:s,lineDash:a,lineDashOffset:n,cornerRadius:r,opacity:1}}};p([Jt],Vt.prototype,"angleKey",2),p([Jt],Vt.prototype,"angleName",2),p([Jt],Vt.prototype,"radiusKey",2),p([Jt],Vt.prototype,"radiusName",2),p([Jt],Vt.prototype,"fill",2),p([Jt],Vt.prototype,"fillOpacity",2),p([Jt],Vt.prototype,"stroke",2),p([Jt],Vt.prototype,"strokeWidth",2),p([Jt],Vt.prototype,"strokeOpacity",2),p([Jt],Vt.prototype,"lineDash",2),p([Jt],Vt.prototype,"lineDashOffset",2),p([Jt],Vt.prototype,"cornerRadius",2),p([Jt],Vt.prototype,"itemStyler",2),p([Jt],Vt.prototype,"rotation",2),p([Jt],Vt.prototype,"stackGroup",2),p([Jt],Vt.prototype,"normalizedTo",2),p([Jt],Vt.prototype,"label",2),p([Jt],Vt.prototype,"tooltip",2);import{_ModuleSupport as wV}from"ag-charts-community";import{_ModuleSupport as NV}from"ag-charts-community";var{motion:PV}=NV;function Ub(){const t={startAngle:new Map,endAngle:new Map},e=["startAngle","endAngle"],i=(n,r,l)=>{e.forEach(c=>{const h=t[c];let d=(l==="removed"||l==="updated"?n:r)[c],u=(l==="removed"?n:r)[c];isNaN(u)&&(u=n.previousDatum?.[c]??NaN);const g=d-u;Math.abs(g)>Math.PI&&(d-=Math.sign(g)*2*Math.PI),h.set(r,{from:d,to:u})})},o=(n,r)=>({startAngle:t.startAngle.get(n)[r],endAngle:t.endAngle.get(n)[r]});return{calculate:i,from:n=>o(n,"from"),to:n=>o(n,"to")}}function Xb(t,e,i){if(i==="updated"){if(t.previousDatum==null||isNaN(t.previousDatum.startAngle)||isNaN(t.previousDatum.endAngle))return"added";if(isNaN(e.startAngle)||isNaN(e.endAngle))return"removed"}return i==="added"&&t.previousDatum!=null?"updated":i}function EV(t){const e=Ub();return{toFn:(s,a,n)=>{const{startAngle:r,endAngle:l}=e.to(a);let c,h,d,u,g;return n==="removed"?(c=s.innerRadius,h=s.innerRadius,d=s.columnWidth,u=s.axisInnerRadius,g=s.axisOuterRadius):(c=isNaN(a.innerRadius)?t:a.innerRadius,h=isNaN(a.outerRadius)?t:a.outerRadius,d=isNaN(a.columnWidth)?s.columnWidth:a.columnWidth,u=a.axisInnerRadius,g=a.axisOuterRadius),{innerRadius:c,outerRadius:h,columnWidth:d,axisInnerRadius:u,axisOuterRadius:g,startAngle:r,endAngle:l}},fromFn:(s,a,n)=>{n=Xb(s,a,n),e.calculate(s,a,n);const{startAngle:r,endAngle:l}=e.from(a);let c,h,d,u,g;n==="removed"||n==="updated"?(c=s.innerRadius,h=s.outerRadius,d=s.columnWidth,u=s.axisInnerRadius,g=s.axisOuterRadius):(c=t,h=t,d=a.columnWidth,u=a.axisInnerRadius,g=a.axisOuterRadius);const y=PV.NODE_UPDATE_STATE_TO_PHASE_MAPPING[n];return{innerRadius:c,outerRadius:h,columnWidth:d,axisInnerRadius:u,axisOuterRadius:g,startAngle:r,endAngle:l,phase:y}}}}function _V(t,{innerRadius:e,outerRadius:i,columnWidth:o,axisInnerRadius:s,axisOuterRadius:a,startAngle:n,endAngle:r}){return{innerRadius:e,outerRadius:i,columnWidth:o,axisInnerRadius:s,axisOuterRadius:a,startAngle:n,endAngle:r}}var{SectorBox:Ec,motion:OV}=wV;function au(t){const{negative:e,innerRadius:i,outerRadius:o,stackInnerRadius:s,stackOuterRadius:a}=t;return{innerRadius:e?a:s,outerRadius:e?s:a,clipInnerRadius:e?o:i,clipOuterRadius:e?i:o}}function RV(t){const e=Ub();return{toFn:(s,a,n)=>{const{startAngle:r,endAngle:l}=e.to(a);let c,h,d;if(n==="removed")c=t,h=t,d=new Ec(r,l,c,h);else{let u,g;({innerRadius:c,outerRadius:h,clipInnerRadius:u,clipOuterRadius:g}=au(a)),isNaN(c)&&(c=t),isNaN(h)&&(h=t),isNaN(u)&&(u=t),isNaN(g)&&(g=t),d=new Ec(r,l,u,g)}return{innerRadius:c,outerRadius:h,startAngle:r,endAngle:l,clipSector:d}},fromFn:(s,a,n)=>{n=Xb(s,a,n),e.calculate(s,a,n);const{startAngle:r,endAngle:l}=e.from(a);let c,h,d;n==="removed"||n==="updated"?(c=s.innerRadius,h=s.outerRadius,d=s.clipSector):(c=t,h=t),d??(d=new Ec(r,l,c,h));const u=OV.NODE_UPDATE_STATE_TO_PHASE_MAPPING[n];return{innerRadius:c,outerRadius:h,startAngle:r,endAngle:l,clipSector:d,phase:u}}}}function BV(t,e){const{startAngle:i,endAngle:o}=e,{innerRadius:s,outerRadius:a,clipInnerRadius:n,clipOuterRadius:r}=au(e),l=new Ec(i,o,n,r);return{innerRadius:s,outerRadius:a,startAngle:i,endAngle:o,clipSector:l}}var{Sector:zV,SectorBox:FV,PolarZIndexMap:nu}=rV,_c=class extends Yb{constructor(t){super(t,{animationResetFns:{item:BV}}),this.properties=new Vt}setZIndex(t){return super.setZIndex(t),this.contentGroup.zIndex=[0,nu.FOREGROUND,t],this.highlightGroup.zIndex=[0,nu.HIGHLIGHT,t],this.labelGroup.zIndex=[0,nu.LABEL,t],!0}getStackId(){return`nightingale-stack-${this.seriesGrouping?.groupIndex??this.id}-yValues`}nodeFactory(){return new zV}updateItemPath(t,e,i){const{negative:o}=e;if(t.centerX=0,t.centerY=0,t.startOuterCornerRadius=o?0:this.properties.cornerRadius,t.endOuterCornerRadius=o?0:this.properties.cornerRadius,t.startInnerCornerRadius=o?this.properties.cornerRadius:0,t.endInnerCornerRadius=o?this.properties.cornerRadius:0,i){const{startAngle:s,endAngle:a}=e,{innerRadius:n,outerRadius:r,clipInnerRadius:l,clipOuterRadius:c}=au(e);t.innerRadius=n,t.outerRadius=r,t.startAngle=s,t.endAngle=a,t.clipSector=new FV(s,a,l,c)}}getColumnTransitionFunctions(){const t=this.isRadiusAxisReversed()?this.radius:this.getAxisInnerRadius();return RV(t)}hasItemStylers(){return this.properties.itemStyler!=null}};_c.className="NightingaleSeries",_c.type="nightingale";import{_ModuleSupport as VV}from"ag-charts-community";import{boolean as Zb,constant as HV,number as GV,required as ru,string as Xn}from"ag-charts-core";var{commonSeriesOptionsDefs:WV,nightingaleSeriesThemeableOptionsDef:KV}=VV,$V={...WV,...KV,type:ru(HV("nightingale")),angleKey:ru(Xn),radiusKey:ru(Xn),angleName:Xn,radiusName:Xn,grouped:Zb,stacked:Zb,stackGroup:Xn,normalizedTo:GV};import{_ModuleSupport as lu}from"ag-charts-community";var{ThemeConstants:{POLAR_AXIS_TYPE:qb,POLAR_AXIS_SHAPE:Qb},FILL_GRADIENT_RADIAL_SERIES_DEFAULTS:jV,FILL_IMAGE_DEFAULTS:YV,FILL_PATTERN_DEFAULTS:UV}=lu,XV={series:{fill:{$applySwitch:[{$path:"type"},{$palette:"fill"},["gradient",jV],["image",YV],["pattern",UV]]},stroke:{$if:[{$eq:[{$palette:"type"},"inbuilt"]},{$ref:"chartBackgroundColor"},{$palette:"stroke"}]},strokeWidth:1,label:{...lu.LABEL_BOXING_DEFAULTS,enabled:!1,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"textColor"}},highlight:lu.multiSeriesHighlightStyle()},axes:{[qb.ANGLE_CATEGORY]:{shape:{$findFirstSiblingNotOperation:Qb.CIRCLE},groupPaddingInner:0,paddingInner:0,label:{spacing:10}},[qb.RADIUS_NUMBER]:{shape:{$findFirstSiblingNotOperation:Qb.CIRCLE}}}},{ThemeConstants:{POLAR_AXIS_TYPE:Jb}}=nV,ZV={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["polar"],identifier:"nightingale",moduleFactory:t=>new _c(t),defaultAxes:[{type:Jb.ANGLE_CATEGORY},{type:Jb.RADIUS_NUMBER}],themeTemplate:XV,stackable:!0,groupable:!0,stackedByDefault:!0},qV={type:"series",name:"nightingale",chartType:"polar",enterprise:!0,options:$V,create:t=>new _c(t)};import{_ModuleSupport as tv}from"ag-charts-community";import{cachedTextMeasurer as QV,calcLineHeight as JV}from"ag-charts-core";import{_ModuleSupport as tH}from"ag-charts-community";var{SeriesProperties:eH,makeSeriesTooltip:iH,Property:Ht,Label:ev,DropShadow:oH}=tH,sH=class extends ev{},cu=class extends ev{constructor(){super(...arguments),this.spacing=0}};p([Ht],cu.prototype,"spacing",2),p([Ht],cu.prototype,"placement",2);var $t=class extends eH{constructor(){super(...arguments),this.fills=[],this.fillOpacity=1,this.strokes=[],this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.direction="vertical",this.reverse=void 0,this.spacing=0,this.aspectRatio=void 0,this.shadow=new oH().set({enabled:!1}),this.label=new sH,this.stageLabel=new cu,this.tooltip=iH()}getStyle(t=0){const{fills:e,strokes:i,fillOpacity:o,strokeWidth:s,strokeOpacity:a,lineDash:n,lineDashOffset:r}=this;return{fill:e[t%e.length],fillOpacity:o,stroke:i[t%i.length],strokeWidth:s,strokeOpacity:a,lineDash:n,lineDashOffset:r,opacity:1}}};p([Ht],$t.prototype,"stageKey",2),p([Ht],$t.prototype,"valueKey",2),p([Ht],$t.prototype,"fills",2),p([Ht],$t.prototype,"fillOpacity",2),p([Ht],$t.prototype,"strokes",2),p([Ht],$t.prototype,"strokeWidth",2),p([Ht],$t.prototype,"strokeOpacity",2),p([Ht],$t.prototype,"lineDash",2),p([Ht],$t.prototype,"lineDashOffset",2),p([Ht],$t.prototype,"direction",2),p([Ht],$t.prototype,"reverse",2),p([Ht],$t.prototype,"spacing",2),p([Ht],$t.prototype,"aspectRatio",2),p([Ht],$t.prototype,"itemStyler",2),p([Ht],$t.prototype,"shadow",2),p([Ht],$t.prototype,"label",2),p([Ht],$t.prototype,"stageLabel",2),p([Ht],$t.prototype,"tooltip",2);function iv(t,{x:e,y:i,top:o,right:s,bottom:a,left:n}){t.x0=e-o/2,t.x1=e+o/2,t.x2=e+a/2,t.x3=e-a/2,t.y0=i-n/2,t.y1=i-s/2,t.y2=i+s/2,t.y3=i+n/2}function aH(t){return{fromFn:(s,a)=>{const{x:n,y:r}=a;let{top:l,right:c,bottom:h,left:d}=a;return t==="vertical"?(l=0,h=0):(d=0,c=0),{x:n,y:r,top:l,right:c,bottom:h,left:d}},toFn:(s,a)=>{const{x:n,y:r,top:l,right:c,bottom:h,left:d}=a;return{x:n,y:r,top:l,right:c,bottom:h,left:d}},applyFn:iv}}var{StateMachine:nH,valueProperty:ov,SeriesNodePickMode:sv,createDatumId:rH,BBox:hu,Group:pu,Selection:Oc,Text:av,PointerEvents:nv,applyShapeStyle:lH,mergeDefaults:rv,fromToMotion:cH,seriesLabelFadeInAnimation:hH,getLabelStyles:pH}=tv,Rc=class extends tv.DataModelSeries{constructor(t){super({moduleCtx:t,categoryKey:void 0,pickModes:[sv.EXACT_SHAPE_MATCH,sv.NEAREST_NODE]}),this.properties=new $t,this.itemGroup=this.contentGroup.appendChild(new pu({name:"itemGroup"})),this.itemLabelGroup=this.contentGroup.appendChild(new pu({name:"itemLabelGroup"})),this.stageLabelGroup=this.contentGroup.appendChild(new pu({name:"stageLabelGroup"})),this.datumSelection=Oc.select(this.itemGroup,()=>this.nodeFactory()),this.labelSelection=Oc.select(this.itemLabelGroup,av),this.stageLabelSelection=Oc.select(this.stageLabelGroup,av),this.highlightDatumSelection=Oc.select(this.highlightGroup,()=>this.nodeFactory()),this.animationState=new nH("empty",{empty:{update:{target:"ready",action:()=>this.animateEmptyUpdateReady()},reset:"empty",skip:"ready"},ready:{clear:"empty",reset:"empty",skip:"ready"}},()=>this.checkProcessedDataAnimatable()),this.itemLabelGroup.pointerEvents=nv.None,this.stageLabelGroup.pointerEvents=nv.None}addChartEventListeners(){this.cleanup.register(this.ctx.eventsHub.on("legend:item-click",t=>this.onLegendItemClick(t)))}nodeFactory(){return new $i}getNodeData(){return this.contextNodeData?.nodeData}resetAnimation(t){t==="initial"?this.animationState.transition("reset"):t==="ready"&&this.animationState.transition("skip")}async processData(t){if(this.data==null)return;const{id:e,visible:i,ctx:{legendManager:o}}=this,{stageKey:s,valueKey:a}=this.properties,n="category",r="number",l=(h,d,u)=>i&&o.getItemEnabled({seriesId:e,itemId:u}),c=this.visible?{}:{forceValue:0};await this.requestDataModel(t,this.data,{props:[ov(s,n,{id:"xValue"}),ov(a,r,{id:"yValue",...c,validation:l,invalidValue:0})]})}createNodeData(){const{id:t,dataModel:e,processedData:i,properties:o,visible:s,ctx:{legendManager:a}}=this,{stageKey:n,valueKey:r,direction:l,reverse:c=l==="horizontal",spacing:h,aspectRatio:d,label:u,stageLabel:g}=o;if(e==null||i==null)return;const y=l==="horizontal",f=e.resolveColumnById(this,"xValue",i),x=e.resolveColumnById(this,"yValue",i),S=e.getDomain(this,"xValue","value",i),v=e.getDomain(this,"yValue","value",i),m=QV(g);let b,M;y?(b="center",M=g.placement==="before"?"bottom":"top"):(b=g.placement==="after"?"left":"right",M="middle");const k=g.enabled?[]:void 0;let A=0,D=0,I=0;const L=i.dataSources.get(this.id)??[];L.forEach((V,F)=>{const H=f[F],W=x[F],G=s&&a.getItemEnabled({seriesId:t,itemId:F});if(I+=W,k==null)return;const K=this.getLabelText(H,V,n,"x",S,this.properties.stageLabel,{datum:V,value:W,stageKey:n,valueKey:r}),{width:Y}=m.measureText(K),st=K.split(`
`).length*JV(u.fontSize);A=Math.max(A,Y),D=Math.max(D,st),k.push({x:NaN,y:NaN,text:K,textAlign:b,textBaseline:M,visible:G})});const C=this._nodeDataDependencies?.seriesRectWidth??0,w=this._nodeDataDependencies?.seriesRectHeight??0,P=h*(i.input.count-1);let E;if(y){const V=D+g.spacing;E=new hu(0,g.placement==="before"?V:0,C,w-V)}else{const V=A+g.spacing;E=new hu(g.placement==="after"?0:V,0,C-V,w)}if(d!=null&&d!==0){const V=l==="horizontal"?1/d:d,F=Math.min(E.width,E.height*V),H=F/V;E=new hu(E.x+(E.width-F)/2,E.y+(E.height-H)/2,F,H)}let T,R;y?R=g.placement==="before"?E.y-g.spacing:E.y+E.height+g.spacing:T=g.placement==="after"?E.x+E.width+g.spacing:E.x-g.spacing;const _=E.width-(y?P:0),N=E.height-(y?0:P);if(_<0||N<0)return;const O=[],B=[];let z=0;return L.forEach((V,F)=>{const H=f[F],W=x[F],G=s&&a.getItemEnabled({seriesId:t,itemId:F}),K=z+W,Y=(z+K)/(2*I),st=(K-z)/I,nt=y?_*Y+h*F:_*.5,X=y?N*.5:N*Y+h*F,Z=E.x+nt,Q=E.y+X;if(k!=null){const ct=k[F];ct.x=T??Z,ct.y=R??Q}let pt,ot,q,dt;if(y){const ct=_*st;pt=ct,q=ct;const gt=(nt+ct/2)*(N/E.width),Tt=(nt-ct/2)*(N/E.width);ot=c?E.height-gt:gt,dt=c?E.height-Tt:Tt}else{const ct=N*st;ot=ct,dt=ct;const gt=(X-ct/2)*(_/E.height),Tt=(X+ct/2)*(_/E.height);pt=c?E.width-gt:gt,q=c?E.width-Tt:Tt}const tt=this.getLabelText(W,V,r,"y",v,u,{datum:V,value:W,stageKey:n,valueKey:r}),ut={x:Z,y:Q,text:tt,textAlign:"center",textBaseline:"middle",visible:G};B.push(ut),O.push({series:this,itemId:r,datum:V,datumIndex:F,index:F,xValue:H,yValue:W,x:Z,y:Q,top:pt,right:ot,bottom:q,left:dt,label:ut,enabled:G,midPoint:{x:Z,y:Q},style:this.getItemStyle({datumIndex:F,datum:V},!1)}),z=K}),{itemId:t,nodeData:O,labelData:B,stageLabelData:k,bounds:E}}updateSelections(){this.nodeDataRefresh&&(this.contextNodeData=this.createNodeData(),this.nodeDataRefresh=!1)}update({seriesRect:t}){this.checkResize(t);const{datumSelection:e,labelSelection:i,stageLabelSelection:o,highlightDatumSelection:s}=this;this.updateSelections(),this.contentGroup.visible=this.visible,this.contentGroup.opacity=this.getOpacity();let a=this.ctx.highlightManager?.getActiveHighlight();a!=null&&(a.series!==this||a.datum==null)&&(a=void 0);const n=this.contextNodeData?.nodeData??[],r=this.contextNodeData?.labelData??[],l=this.contextNodeData?.stageLabelData??[];this.datumSelection=this.updateDatumSelection({nodeData:n,datumSelection:e}),this.updateDatumStyles({datumSelection:e,isHighlight:!1}),this.updateDatumNodes({datumSelection:e,isHighlight:!1}),this.labelSelection=this.updateLabelSelection({labelData:r,labelSelection:i}),this.updateLabelNodes({labelSelection:i,labelProperties:this.properties.label}),this.stageLabelSelection=this.updateStageLabelSelection({stageLabelData:l,stageLabelSelection:o}),this.updateLabelNodes({labelSelection:o,labelProperties:this.properties.stageLabel}),this.highlightDatumSelection=this.updateDatumSelection({nodeData:a!=null?[a]:[],datumSelection:s}),this.updateDatumStyles({datumSelection:s,isHighlight:!0}),this.updateDatumNodes({datumSelection:s,isHighlight:!0}),this.animationState.transition("update")}updateDatumSelection(t){return t.datumSelection.update(t.nodeData)}getItemStyle({datumIndex:t,datum:e},i){const{id:o,properties:s}=this,{stageKey:a,valueKey:n,itemStyler:r}=s,l=this.getHighlightStyle(i,t);let h=rv(l,s.getStyle(t));if(r!=null&&t!=null){const d=this.ctx.highlightManager?.getActiveHighlight(),u=this.cachedDatumCallback(rH(t,i?"highlight":"node"),()=>{const g=this.getHighlightStateString(d,i,t);return this.callWithContext(r,{seriesId:o,datum:e,stageKey:a,valueKey:n,highlighted:i,highlightState:g,...h})});u&&(h=rv(u,h))}return h}updateDatumStyles({datumSelection:t,isHighlight:e}){t.each((i,o)=>{o.style=this.getItemStyle(o,e)})}updateDatumNodes({datumSelection:t}){const{properties:e}=this,{shadow:i}=e,o=this.contextNodeData?.bounds,s=o?{series:o,axis:o}:void 0;t.each((a,n)=>{lH(a,n.style,s),iv(a,n),a.fillShadow=i})}updateLabelSelection(t){return t.labelSelection.update(this.properties.label.enabled?t.labelData:[])}updateStageLabelSelection(t){return t.stageLabelSelection.update(t.stageLabelData)}updateLabelNodes(t){const e=this.ctx.highlightManager?.getActiveHighlight();t.labelSelection.each((i,o,s)=>{const{visible:a,x:n,y:r,text:l,textAlign:c,textBaseline:h}=o,d=pH(this,void 0,this.properties,t.labelProperties,!1,e),{color:u,fontSize:g,fontStyle:y,fontWeight:f,fontFamily:x}=d;i.visible=a,i.x=n,i.y=r,i.text=l,i.fill=u,i.fillOpacity=this.getHighlightStyle(!1,s).opacity??1,i.fontStyle=y,i.fontWeight=f,i.fontSize=g,i.fontFamily=x,i.textAlign=c,i.textBaseline=h,i.setBoxing(d)})}computeFocusBounds(t){const e=this.getNodeData()?.[t.datumIndex];if(e!==void 0){for(const i of this.datumSelection)if(i.datum===e)return i.node}}getTooltipContent(t){const{id:e,dataModel:i,processedData:o,properties:s}=this,{stageKey:a,valueKey:n,tooltip:r}=s;if(!i||!o)return;const l=o.dataSources.get(this.id)?.[t],c=i.resolveColumnById(this,"xValue",o)[t],h=i.resolveColumnById(this,"yValue",o)[t];if(c==null)return;const d=this.getLabelText(c,l,a,"x",i.getDomain(this,"xValue","value",o),this.properties.stageLabel,{datum:l,value:c,stageKey:a,valueKey:n}),u=this.getLabelText(h,l,n,"y",i.getDomain(this,"yValue","value",o),this.properties.stageLabel,{datum:l,value:h,stageKey:a,valueKey:n}),g=this.getItemStyle({datumIndex:t,datum:l},!1);return this.formatTooltipWithContext(r,{symbol:this.legendItemSymbol(t),data:[{label:d,value:u}]},{seriesId:e,datum:l,title:void 0,stageKey:a,valueKey:n,...g})}getSeriesDomain(){return[NaN,NaN]}getSeriesRange(t,e){return[NaN,NaN]}pickNodeClosestDatum({x:t,y:e}){let i=1/0,o;return this.datumSelection.each((s,a)=>{const n=s.distanceSquared(t,e);n<i&&(i=n,o=a)}),o!=null?{datum:o,distance:Math.sqrt(i)}:void 0}legendItemSymbol(t){const{fills:e,strokes:i,strokeWidth:o,fillOpacity:s,strokeOpacity:a,lineDash:n,lineDashOffset:r}=this.properties,l=e[t]??"black",c=i[t]??"black";return{marker:{fill:l,fillOpacity:s,stroke:c,strokeWidth:o,strokeOpacity:a,lineDash:n,lineDashOffset:r}}}getLegendData(t){const{processedData:e,dataModel:i,id:o,ctx:{legendManager:s},visible:a}=this;if(!i||!e||t!=="category")return[];const{showInLegend:n}=this.properties,r=[],l=i.resolveColumnById(this,"xValue",e);return(e.dataSources.get(this.id)??[]).forEach((h,d)=>{const u=l[d];r.push({legendType:"category",id:o,itemId:d,seriesId:o,enabled:a&&s.getItemEnabled({seriesId:o,itemId:d}),label:{text:u},symbol:this.legendItemSymbol(d),hideInLegend:!n})}),r}animateReset(){this.ctx.animationManager.skipCurrentBatch(),this.ctx.animationManager.stopByAnimationGroupId(this.id)}animateEmptyUpdateReady(){const{datumSelection:t,labelSelection:e,properties:i}=this,o=aH(i.direction);cH(this.id,"nodes",this.ctx.animationManager,[t],o),hH(this,"labels",this.ctx.animationManager,e)}hasItemStylers(){return this.properties.itemStyler!=null}};Rc.className="PyramidSeries",Rc.type="pyramid";import{_ModuleSupport as dH}from"ag-charts-community";import{constant as uH,required as du,string as lv}from"ag-charts-core";var{commonSeriesOptionsDefs:gH,pyramidSeriesThemeableOptionsDef:yH}=dH,fH={...yH,...gH,type:du(uH("pyramid")),stageKey:du(lv),valueKey:du(lv)};import{_ModuleSupport as Ys}from"ag-charts-community";var{ThemeSymbols:{DEFAULT_SHADOW_COLOUR:mH}}=Ys,xH={series:{direction:"vertical",strokeWidth:{$isUserOption:["./strokes/0",2,0]},spacing:2,fills:{$applyCycle:[{$size:{$path:["./data",{$path:"/data"}]}},{$palette:"fills"},{$applySwitch:[{$path:["/type",void 0,{$value:"$1"}]},{$value:"$1"},["gradient",Ys.FILL_GRADIENT_LINEAR_DEFAULTS],["pattern",Ys.FILL_PATTERN_DEFAULTS],["image",Ys.FILL_IMAGE_DEFAULTS]]}]},strokes:{$applyCycle:[{$size:{$path:["./data",{$path:"/data"}]}},{$palette:"strokes"}]},label:{...Ys.LABEL_BOXING_DEFAULTS,enabled:!0,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"chartBackgroundColor"}},stageLabel:{...Ys.LABEL_BOXING_DEFAULTS,enabled:!0,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"textColor"},spacing:12},shadow:{enabled:!1,color:mH,xOffset:3,yOffset:3,blur:5},highlight:Ys.singleSeriesHighlightStyle()}},SH={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["standalone"],identifier:"pyramid",moduleFactory:t=>new Rc(t),solo:!0,themeTemplate:xH},bH={type:"series",name:"pyramid",chartType:"standalone",enterprise:!0,options:fH,create:t=>new Rc(t)};import{_ModuleSupport as vH}from"ag-charts-community";import{_ModuleSupport as hi}from"ag-charts-community";var{ThemeConstants:{POLAR_AXIS_TYPE:MH}}=hi,cv={series:{stroke:{$palette:"stroke"},label:{...hi.LABEL_BOXING_DEFAULTS,enabled:!1,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"textColor"}},marker:{enabled:!0,fill:{$applySwitch:[{$path:"type"},{$palette:"fill"},["gradient",hi.FILL_GRADIENT_RADIAL_REVERSED_DEFAULTS],["image",hi.FILL_IMAGE_DEFAULTS],["pattern",hi.FILL_PATTERN_DEFAULTS]]},stroke:{$palette:"stroke"},fillOpacity:1,shape:"circle",size:6,strokeOpacity:1,strokeWidth:{$isUserOption:["./stroke",1,0]}},highlight:hi.multiSeriesHighlightStyle(),tooltip:{range:{$path:["/tooltip/range","nearest"]}}},axes:{[MH.ANGLE_CATEGORY]:{label:{spacing:10}}}},DH=hi.mergeDefaults({series:{stroke:hi.SAFE_STROKE_FILL_OPERATION,strokeWidth:2}},cv),kH=hi.mergeDefaults({series:{fill:{$applySwitch:[{$path:"type"},{$palette:"fill"},["gradient",hi.FILL_GRADIENT_LINEAR_DEFAULTS],["image",hi.FILL_IMAGE_DEFAULTS],["pattern",hi.FILL_PATTERN_DEFAULTS]]},fillOpacity:.8,strokeWidth:2,marker:{enabled:!1}}},cv);import{_ModuleSupport as hv}from"ag-charts-community";import{_ModuleSupport as uu}from"ag-charts-community";import{isFiniteNumber as pv,isNumberEqual as dv}from"ag-charts-core";import{_ModuleSupport as AH}from"ag-charts-community";var{Label:LH,SeriesMarker:IH,SeriesProperties:CH,makeSeriesTooltip:TH,Property:ke}=AH,le=class extends CH{constructor(){super(...arguments),this.stroke="black",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.rotation=0,this.marker=new IH,this.label=new LH,this.tooltip=TH(),this.connectMissingData=!1}};p([ke],le.prototype,"angleKey",2),p([ke],le.prototype,"radiusKey",2),p([ke],le.prototype,"angleName",2),p([ke],le.prototype,"radiusName",2),p([ke],le.prototype,"stroke",2),p([ke],le.prototype,"strokeWidth",2),p([ke],le.prototype,"strokeOpacity",2),p([ke],le.prototype,"lineDash",2),p([ke],le.prototype,"lineDashOffset",2),p([ke],le.prototype,"rotation",2),p([ke],le.prototype,"styler",2),p([ke],le.prototype,"marker",2),p([ke],le.prototype,"label",2),p([ke],le.prototype,"tooltip",2),p([ke],le.prototype,"connectMissingData",2);var{DEFAULT_POLAR_DIRECTION_KEYS:wH,DEFAULT_POLAR_DIRECTION_NAMES:NH,ChartAxisDirection:pi,PolarAxis:PH,SeriesNodePickMode:uv,valueProperty:gv,fixNumericExtent:EH,seriesLabelFadeInAnimation:_H,markerFadeInAnimation:OH,resetMarkerFn:RH,animationValidation:BH,computeMarkerFocusBounds:zH,extent:FH,BBox:VH,Group:HH,Path:GH,PointerEvents:WH,Selection:gu,Text:KH,Marker:$H,mergeDefaults:jH,updateLabelNode:YH,getMarkerStyles:UH}=uu,XH=class extends uu.SeriesNodeEvent{constructor(t,e,i,o){super(t,e,i,o),this.angleKey=o.properties.angleKey,this.radiusKey=o.properties.radiusKey}},yu=class extends uu.PolarSeries{constructor(t){super({moduleCtx:t,categoryKey:"angleValue",propertyKeys:wH,propertyNames:NH,pickModes:[uv.NEAREST_NODE,uv.EXACT_SHAPE_MATCH],canHaveAxes:!0,animationResetFns:{item:RH},clipFocusBox:!1}),this.properties=new le,this.NodeEvent=XH,this.lineGroup=this.contentGroup.appendChild(new HH({name:"radar-line"})),this.lineSelection=gu.select(this.lineGroup,GH),this.resetInvalidToZero=!1,this.circleCache={r:0,cx:0,cy:0},this.lineGroup.zIndex=0,this.itemGroup.zIndex=1}nodeFactory(){return new $H}getSeriesDomain(t){const{dataModel:e,processedData:i}=this;if(!i||!e)return[];if(t===pi.Angle)return e.getDomain(this,"angleValue","value",i);{const o=e.getDomain(this,"radiusValue","value",i),s=FH(o.length===0?o:[0].concat(o));return EH(s)}}async processData(t){const{angleKey:e,radiusKey:i}=this.properties,o=[];this.ctx.animationManager.isSkipped()||o.push(BH());const s=this.axes[pi.Radius]?.scale.type,a=this.axes[pi.Angle]?.scale.type;await this.requestDataModel(t,this.data,{props:[gv(e,a,{id:"angleValue"}),gv(i,s,{id:"radiusValue",invalidValue:void 0}),...o]}),this.animationState.transition("updateData")}didCircleChange(){const t=this.radius,e=this.centerX,i=this.centerY,o=this.circleCache;return t===o.r&&e===o.cx&&i===o.cy?!1:(this.circleCache={r:t,cx:e,cy:i},!0)}getAxisInnerRadius(){const t=this.axes[pi.Radius];return t instanceof PH?this.radius*t.innerRadiusRatio:0}maybeRefreshNodeData(){!this.didCircleChange()&&!this.nodeDataRefresh||(this.contextNodeData=this.createNodeData(),this.nodeData=this.contextNodeData?.nodeData??[],this.nodeDataRefresh=!1)}createNodeData(){const{processedData:t,dataModel:e}=this;if(!t||!e)return;const{angleKey:i,radiusKey:o,angleName:s,radiusName:a,marker:n,label:r,stroke:l,strokeWidth:c,strokeOpacity:h}=this.properties,d=this.axes[pi.Angle]?.scale,u=this.axes[pi.Radius]?.scale;if(!d||!u)return;const g=e.resolveColumnById(this,"angleValue",t),y=e.resolveColumnById(this,"radiusValue",t),f=this.getAxisInnerRadius(),x=this.getSeriesDomain(pi.Radius),v=(t.dataSources.get(this.id)??[]).map((m,b)=>{const M=g[b],k=y[b],A=d.convert(M),D=this.radius+f-u.convert(k),I=Math.cos(A),L=Math.sin(A),C=I*D,w=L*D;let P;if(r.enabled){const E=this.getLabelText(k,m,o,"radius",x,r,{value:k,datum:m,angleKey:i,radiusKey:o,angleName:s,radiusName:a});if(E){let T="right";dv(I,0)?T="center":I>0&&(T="left");let R="bottom";dv(L,0)?R="middle":L>0&&(R="top"),P={x:C+I*n.size,y:w+L*n.size,text:E,textAlign:T,textBaseline:R}}}return{series:this,datum:m,datumIndex:b,index:b,point:{x:C,y:w,size:n.size},midPoint:{x:C,y:w},label:P,angleValue:M,radiusValue:k,missing:!pv(A)||!pv(D)}});return{itemId:o,nodeData:v,labelData:v,styles:UH(this,n,{stroke:l,strokeWidth:c,strokeOpacity:h})}}update({seriesRect:t}){const e=this.checkResize(t),i=!this.ctx.animationManager.isSkipped(),{series:o}=this.ctx.highlightManager?.getActiveHighlight()??{};this.highlightGroup.visible=(i||this.visible)&&o===this,this.maybeRefreshNodeData(),this.contentGroup.translationX=this.centerX,this.contentGroup.translationY=this.centerY,this.highlightGroup.translationX=this.centerX,this.highlightGroup.translationY=this.centerY,this.labelGroup&&(this.labelGroup.translationX=this.centerX,this.labelGroup.translationY=this.centerY),this.updatePathSelections(),this.updateMarkerSelection(),this.updateHighlightSelection(),this.updatePathNodes(),this.hasItemStylers()&&(this.updateDatumStyles(this.itemSelection,!1),this.updateDatumStyles(this.highlightSelection,!0)),this.updateMarkers(this.itemSelection,!1),this.updateMarkers(this.highlightSelection,!0),this.updateLabels(),e&&this.animationState.transition("resize"),this.animationState.transition("update")}updatePathSelections(){const t=this.visible?[!0]:[];this.lineSelection.update(t)}updateMarkerSelection(){const{marker:t}=this.properties;t.isDirty()&&(this.itemSelection.clear(),this.itemSelection.cleanup(),this.itemSelection=gu.select(this.itemGroup,()=>this.nodeFactory(),!1));const e=this.visible&&t.shape&&t.enabled?this.nodeData:[];this.itemSelection.update(e)}updateHighlightSelection(){const{marker:t}=this.properties;t.isDirty()&&(this.highlightSelection.clear(),this.highlightSelection.cleanup(),this.highlightSelection=gu.select(this.highlightGroup,()=>this.nodeFactory(),!1));const e=this.ctx.highlightManager?.getActiveHighlight(),i=this.visible&&t.shape&&t.enabled&&e?.datum?[{...e}]:[];this.highlightSelection.update(i)}getMarkerFill(t){return t?.fill??this.properties.marker.fill}getDatumStylerProperties(t){const{id:e,properties:i}=this,{angleKey:o,radiusKey:s}=i;return{seriesId:e,datum:t,angleKey:o,radiusKey:s}}updateDatumStyles(t,e){const{marker:i,stroke:o,strokeWidth:s,strokeOpacity:a}=this.properties;t.each((n,r)=>{r.style=this.getMarkerStyle(i,r,this.getDatumStylerProperties(r.datum),{isHighlight:e},void 0,{stroke:o,strokeWidth:s,strokeOpacity:a})})}updateMarkers(t,e){const i=this.getShapeFillBBox(),{contextNodeData:o}=this;if(!o)return;const s=this.ctx.highlightManager.getActiveHighlight();t.each((a,n)=>{const r=n.style??o.styles[this.getHighlightState(s,e,n.datumIndex)];this.applyMarkerStyle(r,a,n.point,i)})}updateLabels(){const{properties:t}=this,e=this.ctx.highlightManager?.getActiveHighlight();this.labelSelection.update(this.nodeData).each((i,o)=>{o.label&&(i.fillOpacity=this.getHighlightStyle(!1,o.datumIndex).opacity??1,YH(this,i,t,t.label,o.label,!1,e))})}makeStylerParams(t,e){throw new Error("not implemented")}getTooltipContent(t){const{id:e,dataModel:i,processedData:o,axes:s,properties:a}=this,{angleKey:n,angleName:r,radiusKey:l,radiusName:c,tooltip:h,marker:d}=a,u=s[pi.Angle],g=s[pi.Radius];if(!i||!o||!u||!g)return;const y=o.dataSources.get(this.id)?.[t],f=i.resolveColumnById(this,"angleValue",o)[t],x=i.resolveColumnById(this,"radiusValue",o)[t];if(f==null)return;const S=this.getMarkerStyle(d,{datum:y,datumIndex:t},this.getDatumStylerProperties(y),{isHighlight:!1});return this.formatTooltipWithContext(h,{heading:this.getAxisValueText(u,"tooltip",f,y,n,void 0),symbol:this.legendItemSymbol(),data:[{label:c,fallbackLabel:l,value:this.getAxisValueText(g,"tooltip",x,y,l,void 0)}]},{seriesId:e,datum:y,title:r,angleKey:n,radiusKey:l,angleName:r,radiusName:c,...S})}legendItemSymbol(){const{stroke:t,strokeWidth:e,strokeOpacity:i,lineDash:o,marker:s}=this.properties;return{marker:{shape:s.shape,enabled:s.enabled||e<=0,fill:this.getMarkerFill()??s.stroke??t??"rgba(0, 0, 0, 0)",stroke:s.stroke??t??"rgba(0, 0, 0, 0)",fillOpacity:s.fillOpacity,strokeOpacity:s.strokeOpacity,strokeWidth:s.strokeWidth,lineDash:s.lineDash,lineDashOffset:s.lineDashOffset},line:{stroke:t,strokeOpacity:i,strokeWidth:e,lineDash:o}}}getLegendData(t){if(t!=="category")return[];const{id:e,ctx:{legendManager:i},visible:o}=this,{radiusKey:s,radiusName:a,showInLegend:n}=this.properties;return[{legendType:"category",id:e,itemId:s,seriesId:e,enabled:o&&i.getItemEnabled({seriesId:e,itemId:s}),label:{text:a??s},symbol:this.legendItemSymbol(),hideInLegend:!n}]}pickNodeClosestDatum(t){const{nodeData:e,centerX:i,centerY:o}=this,{x:s,y:a}=t,n=this.radius;if(Math.sqrt((s-i)**2+(a-o)**2)>n+this.properties.marker.size)return;let l=1/0,c;for(const h of e){const{point:{x:d=NaN,y:u=NaN}={}}=h;if(isNaN(d)||isNaN(u))continue;const g=Math.sqrt((t.x-d-i)**2+(t.y-u-o)**2);g<l&&(l=g,c=h)}if(c){const h=Math.max(l-(c.point?.size??0),0);return{datum:c,distance:h}}}computeLabelsBBox(){const{label:t}=this.properties;this.maybeRefreshNodeData();const e=[],i=new KH;return this.nodeData.forEach(o=>{if(!t.enabled||!o.label)return;i.text=o.label.text,i.x=o.label.x,i.y=o.label.y,i.setFont(t),i.setAlign(o.label);const s=i.getBBox();e.push(s)}),e.length===0?null:VH.merge(e)}getLineNode(){return this.lineSelection?.at(0)}beforePathAnimation(){this.updatePathNodes()}updatePathNodes(){const t=this.getLineNode();if(!t)return;const{strokeWidth:e,stroke:i,strokeOpacity:o,lineDash:s,lineDashOffset:a,opacity:n}=jH(this.getHighlightStyle(),this.properties);t.setProperties({fill:void 0,lineJoin:"round",lineCap:"round",pointerEvents:WH.None,opacity:n,stroke:i,strokeWidth:e,strokeOpacity:o,lineDash:s,lineDashOffset:a})}getLinePoints(){const{nodeData:t,resetInvalidToZero:e}=this,{connectMissingData:i}=this.properties;if(t.length===0)return[];const o=this.axes[pi.Radius],a=this.axes[pi.Angle]?.isReversed(),r=o?.isReversed()&&!a?[...t].reverse():t,l=[];let c=!1,h;return r.forEach((d,u)=>{let{x:g,y}=d.point;const f=isNaN(g)||isNaN(y);f||(h??(h=d)),f&&!i&&(g=0,y=0);const x=u===0||!e&&!i&&(f||c);l.push({x:g,y,moveTo:x}),c=f}),h!==void 0&&l.push({x:h.point.x,y:h.point.y,moveTo:!1}),l}animateSinglePath(t,e,i){const{path:o}=t;o.clear(!0);const s=this.getAxisInnerRadius(),a=this.axes[pi.Radius],r=a?.isReversed()?this.radius+s-a?.scale.convert(0):s;e.forEach(l=>{const{x:c,y:h,arc:d,radius:u=0,startAngle:g=0,endAngle:y=0,moveTo:f}=l,x=Math.atan2(h,c),S=r*Math.cos(x),v=r*Math.sin(x),m=i,b=S*(1-m)+c*m,M=v*(1-m)+h*m;d?o.arc(c,h,u,g,y):f?o.moveTo(b,M):o.lineTo(b,M)}),t.checkPathDirty()}animatePaths(t){const e=this.getLinePoints(),i=this.getLineNode();i&&this.animateSinglePath(i,e,t)}animateEmptyUpdateReady(){const{itemSelection:t,labelSelection:e}=this,{animationManager:i}=this.ctx;this.beforePathAnimation(),i.animate({id:`${this.id}_'path`,groupId:this.id,from:0,to:1,phase:"initial",collapsable:!1,onUpdate:o=>this.animatePaths(o),onStop:()=>this.animatePaths(1)}),OH(this,i,"added",t),_H(this,"labels",i,e)}animateWaitingUpdateReady(t){super.animateWaitingUpdateReady(t),this.resetPaths()}animateReadyResize(t){super.animateReadyResize(t),this.resetPaths()}resetPaths(){const t=this.getLineNode();if(t){const{path:e}=t,i=this.getLinePoints();t.fill=void 0,t.stroke=this.properties.stroke,t.strokeWidth=this.properties.strokeWidth,t.strokeOpacity=this.properties.strokeOpacity,t.lineDash=this.properties.lineDash,t.lineDashOffset=this.properties.lineDashOffset,e.clear(!0);for(const{x:o,y:s,moveTo:a}of i)a?e.moveTo(o,s):e.lineTo(o,s);t.checkPathDirty()}}getFormattedMarkerStyle(t){const{angleKey:e,radiusKey:i}=this.properties;return this.getMarkerStyle(this.properties.marker,t,{angleKey:e,radiusKey:i},{isHighlight:!0})}computeFocusBounds(t){return zH(this,t)}};yu.className="RadarSeries";import{_ModuleSupport as ZH}from"ag-charts-community";var{Property:yv}=ZH,fu=class extends le{constructor(){super(...arguments),this.fill="black",this.fillOpacity=1}};p([yv],fu.prototype,"fill",2),p([yv],fu.prototype,"fillOpacity",2);var{Group:qH,Path:QH,PointerEvents:JH,Selection:tG,ChartAxisDirection:fv,applyShapeStyle:mv,mergeDefaults:eG}=hv,Bc=class extends yu{constructor(t){super(t),this.properties=new fu,this.areaGroup=this.contentGroup.appendChild(new qH({name:"radar-area"})),this.areaSelection=tG.select(this.areaGroup,QH),this.resetInvalidToZero=!0,this.areaGroup.zIndex=-1}updatePathSelections(){const t=this.visible?[!0]:[];this.areaSelection.update(t),super.updatePathSelections()}getAreaNode(){return this.areaSelection.at(0)}getMarkerFill(t){return t?.fill??this.properties.marker.fill??this.properties.fill}updatePathNodes(){super.updatePathNodes();const{fill:t,fillOpacity:e,opacity:i}=eG(this.getHighlightStyle(),this.properties),o=this.getAreaNode();o&&(mv(o,{fill:t,fillOpacity:e,stroke:void 0},this.getShapeFillBBox()),o.setProperties({lineJoin:"round",pointerEvents:JH.None,opacity:i}))}animatePaths(t){super.animatePaths(t);const e=this.getAreaNode();e&&this.animateSinglePath(e,this.getAreaPoints(),t)}getAreaPoints(){const t=this.getLinePoints(),e=n=>{const r=this.axes[n];return r instanceof hv.PolarAxis?r:void 0},i=e(fv.Radius),o=e(fv.Angle);if(!i?.isReversed())return t;const a=o?.getAxisLinePoints()?.points??[];return t.concat(...a)}hasItemStylers(){return this.properties.marker.itemStyler!=null||this.properties.label.itemStyler!=null}resetPaths(){super.resetPaths();const t=this.getAreaNode();if(t){const{path:e}=t,i=this.getAreaPoints(),o=this.getShapeFillBBox();mv(t,{fill:this.properties.fill,stroke:void 0,fillOpacity:this.properties.fillOpacity,lineDash:this.properties.lineDash,lineDashOffset:this.properties.lineDashOffset},o),t.lineJoin=t.lineCap="round",e.clear(!0),i.forEach(({x:s,y:a,moveTo:n,arc:r,radius:l=0,startAngle:c=0,endAngle:h=0})=>{r?e.arc(s,a,l,c,h):n?e.moveTo(s,a):e.lineTo(s,a)}),e.closePath(),t.checkPathDirty()}}};Bc.className="RadarAreaSeries",Bc.type="radar-area";import{_ModuleSupport as iG}from"ag-charts-community";import{constant as oG,required as mu,string as zc}from"ag-charts-core";var{commonSeriesOptionsDefs:sG,radarAreaSeriesThemeableOptionsDef:aG}=iG,nG={...sG,...aG,type:mu(oG("radar-area")),angleKey:mu(zc),radiusKey:mu(zc),angleName:zc,radiusName:zc},{ThemeConstants:{POLAR_AXIS_TYPE:xv}}=vH,rG={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["polar"],identifier:"radar-area",moduleFactory:t=>new Bc(t),defaultAxes:[{type:xv.ANGLE_CATEGORY},{type:xv.RADIUS_NUMBER}],themeTemplate:kH},lG={type:"series",name:"radar-area",chartType:"polar",enterprise:!0,options:nG,create:t=>new Bc(t)};import{_ModuleSupport as cG}from"ag-charts-community";var Fc=class extends yu{hasItemStylers(){return this.properties.marker.itemStyler!=null||this.properties.label.itemStyler!=null}updatePathSelections(){this.lineSelection.update(this.visible?[!0]:[])}};Fc.className="RadarLineSeries",Fc.type="radar-line";import{_ModuleSupport as hG}from"ag-charts-community";import{constant as pG,required as xu,string as Vc}from"ag-charts-core";var{commonSeriesOptionsDefs:dG,radarLineSeriesThemeableOptionsDef:uG}=hG,gG={...dG,...uG,type:xu(pG("radar-line")),angleKey:xu(Vc),radiusKey:xu(Vc),angleName:Vc,radiusName:Vc},{POLAR_AXIS_TYPE:Sv}=cG.ThemeConstants,yG={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["polar"],identifier:"radar-line",moduleFactory:t=>new Fc(t),defaultAxes:[{type:Sv.ANGLE_CATEGORY},{type:Sv.RADIUS_NUMBER}],themeTemplate:DH},fG={type:"series",name:"radar-line",chartType:"polar",enterprise:!0,options:gG,create:t=>new Fc(t)};import{_ModuleSupport as mG}from"ag-charts-community";import{_ModuleSupport as Hc}from"ag-charts-community";import{isDefined as xG}from"ag-charts-core";import{_ModuleSupport as SG}from"ag-charts-community";var{SeriesProperties:bG,makeSeriesTooltip:vG,Property:te,Label:MG}=SG,jt=class extends bG{constructor(){super(...arguments),this.fill="black",this.fillOpacity=1,this.stroke="black",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.cornerRadius=0,this.rotation=0,this.label=new MG,this.tooltip=vG()}getStyle(){const{fill:t,fillOpacity:e,stroke:i,strokeWidth:o,strokeOpacity:s,lineDash:a,lineDashOffset:n,cornerRadius:r}=this;return{fill:t,fillOpacity:e,stroke:i,strokeWidth:o,strokeOpacity:s,lineDash:a,lineDashOffset:n,cornerRadius:r,opacity:1}}};p([te],jt.prototype,"angleKey",2),p([te],jt.prototype,"radiusKey",2),p([te],jt.prototype,"angleName",2),p([te],jt.prototype,"radiusName",2),p([te],jt.prototype,"fill",2),p([te],jt.prototype,"fillOpacity",2),p([te],jt.prototype,"stroke",2),p([te],jt.prototype,"strokeWidth",2),p([te],jt.prototype,"strokeOpacity",2),p([te],jt.prototype,"lineDash",2),p([te],jt.prototype,"lineDashOffset",2),p([te],jt.prototype,"cornerRadius",2),p([te],jt.prototype,"itemStyler",2),p([te],jt.prototype,"rotation",2),p([te],jt.prototype,"stackGroup",2),p([te],jt.prototype,"normalizedTo",2),p([te],jt.prototype,"label",2),p([te],jt.prototype,"tooltip",2);import{_ModuleSupport as DG}from"ag-charts-community";var{SectorBox:bv,motion:kG}=DG;function AG(t,e,i){if(i==="updated"){if(t.previousDatum==null||isNaN(t.previousDatum.innerRadius)||isNaN(t.previousDatum.outerRadius))return"added";if(isNaN(e.innerRadius)||isNaN(e.outerRadius))return"removed"}return i==="added"&&t.previousDatum!=null?"updated":i}function vv(t){return{toFn:(o,s,a)=>{let n,r,l,c,h;return a==="removed"?(n=t,r=t,l=s.innerRadius,c=s.outerRadius,h=new bv(n,r,l,c)):(n=s.startAngle,r=s.endAngle,l=isNaN(s.innerRadius)?o.innerRadius:s.innerRadius,c=isNaN(s.outerRadius)?o.outerRadius:s.outerRadius,h=s.clipSector),{startAngle:n,endAngle:r,innerRadius:l,outerRadius:c,clipSector:h}},fromFn:(o,s,a)=>{a=AG(o,s,a);let n,r,l,c,h;a==="removed"||a==="updated"?(n=o.startAngle,r=o.endAngle,l=o.innerRadius,c=o.outerRadius,h=o.clipSector):(n=t,r=t,l=s.innerRadius,c=s.outerRadius),h??(h=new bv(n,r,l,c));const d=kG.NODE_UPDATE_STATE_TO_PHASE_MAPPING[a];return{startAngle:n,endAngle:r,innerRadius:l,outerRadius:c,clipSector:h,phase:d}}}}function LG(t,e){return{centerX:0,centerY:0,innerRadius:e.innerRadius,outerRadius:e.outerRadius,startAngle:e.startAngle,endAngle:e.endAngle,clipSector:e.clipSector}}var{DEFAULT_POLAR_DIRECTION_KEYS:IG,DEFAULT_POLAR_DIRECTION_NAMES:CG,ChartAxisDirection:Zi,PolarAxis:TG,diff:wG,groupAccumulativeValueProperty:Mv,keyProperty:NG,normaliseGroupTo:PG,valueProperty:EG,fixNumericExtent:_G,resetLabelFn:OG,seriesLabelFadeInAnimation:RG,seriesLabelFadeOutAnimation:BG,animationValidation:zG,angleBetween:FG,createDatumId:Dv,CategoryScale:VG,Sector:HG,SectorBox:GG,motion:kv,isGradientFill:WG,applyShapeStyle:KG,updateLabelNode:$G,mergeDefaults:Av,getItemStyles:jG}=Hc,YG=class extends Hc.SeriesNodeEvent{constructor(t,e,i,o){super(t,e,i,o),this.angleKey=o.properties.angleKey,this.radiusKey=o.properties.radiusKey}},Gc=class extends Hc.PolarSeries{constructor(t){super({moduleCtx:t,categoryKey:"radiusValue",propertyKeys:IG,propertyNames:CG,canHaveAxes:!0,animationResetFns:{item:LG,label:OG}}),this.properties=new jt,this.NodeEvent=YG,this.groupScale=new VG,this.circleCache={r:0,cx:0,cy:0}}nodeFactory(){return new HG}getSeriesDomain(t){const{dataModel:e,processedData:i}=this;if(!i||!e)return[];if(t===Zi.Angle){const o=e.getDomain(this,"angleValue-end","value",i),s=[o[0]>0?0:o[0],o[1]<0?0:o[1]];return _G(s)}else return e.getDomain(this,"radiusValue","key",i)}async processData(t){const{angleKey:e,radiusKey:i,normalizedTo:o}=this.properties,s=!this.ctx.animationManager.isSkipped(),a=this.getStackId(),n=`${a}-trailing`,r=[];xG(o)&&r.push(PG([a,n],Math.abs(o))),s&&(this.processedData&&r.push(wG(this.id,this.processedData)),r.push(zG()));const l=this.visible?{}:{forceValue:0},c=this.axes[Zi.Radius]?.scale.type,h=this.axes[Zi.Angle]?.scale.type;await this.requestDataModel(t,this.data,{props:[NG(i,c,{id:"radiusValue"}),EG(e,h,{id:"angleValue-raw",invalidValue:null,...l}),...Mv(e,"normal","current",{id:"angleValue-end",rangeId:"angleValue-range",invalidValue:null,groupId:a,separateNegative:!0,...l},h),...Mv(e,"trailing","current",{id:"angleValue-start",invalidValue:null,groupId:n,separateNegative:!0,...l},h),...r],groupByKeys:!0,groupByData:!1}),this.animationState.transition("updateData")}didCircleChange(){const t=this.radius,e=this.centerX,i=this.centerY,o=this.circleCache;return t===o.r&&e===o.cx&&i===o.cy?!1:(this.circleCache={r:t,cx:e,cy:i},!0)}maybeRefreshNodeData(){!this.didCircleChange()&&!this.nodeDataRefresh||(this.contextNodeData=this.createNodeData(),this.nodeData=this.contextNodeData?.nodeData??[],this.nodeDataRefresh=!1)}getAxisInnerRadius(){const t=this.axes[Zi.Radius];return t instanceof TG?this.radius*t.innerRadiusRatio:0}createNodeData(){const{processedData:t,dataModel:e}=this;if(!e||!t||t.type!=="grouped")return;const i=this.axes[Zi.Angle],o=this.axes[Zi.Radius],s=i?.scale,a=o?.scale;if(!s||!a)return;const n=e.resolveKeysById(this,"radiusValue",t),r=e.resolveColumnById(this,"angleValue-start",t),l=e.resolveColumnById(this,"angleValue-end",t),c=e.resolveColumnById(this,"angleValue-raw",t),h=e.resolveProcessedDataIndexById(this,"angleValue-range");let d=0;o instanceof Lo&&(d=o.groupPaddingInner);const{groupScale:u}=this,{index:g,visibleGroupCount:y}=this.ctx.seriesStateManager.getVisiblePeerGroupIndex(this);u.domain=Array.from({length:y}).map((R,_)=>String(_)),u.range=[0,Math.abs(a.bandwidth??0)],u.paddingInner=y>1?d:0;const f=u.bandwidth>=1?u.bandwidth:u.rawBandwidth,x=i.isReversed(),S=o.isReversed(),v=S?this.radius:this.getAxisInnerRadius(),b=(S?this.getAxisInnerRadius():this.radius)+v,M=this.getSeriesDomain(Zi.Angle),{angleKey:k,radiusKey:A,angleName:D,radiusName:I,label:L}=this.properties,C=(R,_,N,O)=>{const B=this.getLabelText(_,R,k,"angle",M,L,{value:_,datum:R,angleKey:k,radiusKey:A,angleName:D,radiusName:I});if(B)return{x:N,y:O,text:B,textAlign:"center",textBaseline:"middle"}},w=[],P={itemId:A,nodeData:w,labelData:w,styles:jG(this.getItemStyle.bind(this))};if(!this.visible)return P;const{dataSources:E}=t,T=E.get(this.id)??[];for(const{datumIndex:R,group:_}of e.forEachGroupDatum(this,t)){const N=T[R],O=n[R];if(O==null)return;const B=c[R],z=r[R],V=l[R],F=B>=0&&!Object.is(B,-0),H=_.aggregation[h][F?1:0],W=F===x;let G=s.convert(z,{clamp:!0}),K=s.convert(V,{clamp:!0}),Y=s.convert(0,{clamp:!0}),st=s.convert(H,{clamp:!0});W&&([Y,st]=[st,Y],[G,K]=[K,G]);const X=b-a.convert(O)+u.convert(String(g)),Z=X+f,Q=(X+Z)/2,pt=G+FG(G,K)/2,ot=Math.cos(pt)*Q,q=Math.sin(pt)*Q,dt=this.properties.label.enabled?C(N,B,ot,q):void 0,tt=new GG(G,K,X,Z);w.push({series:this,datum:N,datumIndex:R,point:{x:ot,y:q,size:0},midPoint:{x:ot,y:q},label:dt,angleValue:B,radiusValue:O,innerRadius:X,outerRadius:Z,startAngle:Y,endAngle:st,clipSector:tt,reversed:W,index:R})}return P}update({seriesRect:t}){const e=this.checkResize(t);this.maybeRefreshNodeData(),this.contentGroup.translationX=this.centerX,this.contentGroup.translationY=this.centerY,this.highlightGroup.translationX=this.centerX,this.highlightGroup.translationY=this.centerY,this.labelGroup&&(this.labelGroup.translationX=this.centerX,this.labelGroup.translationY=this.centerY),this.updateSectorSelection(this.itemSelection,!1),this.updateSectorSelection(this.highlightSelection,!0),this.updateLabels(),e&&this.animationState.transition("resize"),this.animationState.transition("update")}getItemStyle(t,e,i){const{id:o,properties:s}=this,{angleKey:a,radiusKey:n,itemStyler:r}=s,l=this.getHighlightStyle(e,t?.datumIndex,i);let h=Av(l,s.getStyle());if(r!=null&&t!=null){const d=this.cachedDatumCallback(Dv(this.getDatumId(t),e?"highlight":"node"),()=>{const u=this.ctx.highlightManager?.getActiveHighlight(),g=this.getHighlightStateString(u,e,t.datumIndex);return this.callWithContext(r,{seriesId:o,datum:t.datum,highlighted:e,highlightState:g,angleKey:a,radiusKey:n,...h})});d&&(h=Av(d,h))}return h}updateSectorSelection(t,e){let i=[];if(e){const r=this.ctx.highlightManager?.getActiveHighlight();r?.datum&&r.series===this&&i.push(r)}else i=this.nodeData;const{contextNodeData:o}=this;if(!o)return;const s=this.ctx.highlightManager.getActiveHighlight(),a=this.getShapeFillBBox(),n=this.hasItemStylers();t.update(i,void 0,r=>this.getDatumId(r)).each((r,l)=>{const c=bn(l);if(c==null)return;n&&(l.style=this.getItemStyle(l,e));const h=l.style??o.styles[this.getHighlightState(s,e,l.datumIndex)],d=h.cornerRadius,u=h.fill,g=Hc.isGradientFill(u)&&u.bounds!=="item"?{centerX:0,centerY:0}:void 0;KG(r,h,a,g),r.lineJoin="round",r.inset=r.stroke!=null?r.strokeWidth/2:0,r.startInnerCornerRadius=c.reversed?d:0,r.startOuterCornerRadius=c.reversed?d:0,r.endInnerCornerRadius=c.reversed?0:d,r.endOuterCornerRadius=c.reversed?0:d,e&&(r.startAngle=l.startAngle,r.endAngle=l.endAngle,r.clipSector=l.clipSector,r.innerRadius=l.innerRadius,r.outerRadius=l.outerRadius)})}updateLabels(){const{properties:t}=this,e=this.ctx.highlightManager?.getActiveHighlight();this.labelSelection.update(this.nodeData).each((i,o)=>{$G(this,i,t,t.label,o.label,!1,e),i.fillOpacity=this.getHighlightStyle(!1,o.datumIndex).opacity??1})}getBarTransitionFunctions(){const t=this.axes[Zi.Angle]?.scale;let e=0;if(!t)return vv(e);const i=Math.min(t.domain[0],t.domain[1]),o=Math.max(t.domain[0],t.domain[1]);return i<=0&&o>=0&&(e=t.convert(0)),vv(e)}animateEmptyUpdateReady(){const{labelSelection:t}=this,e=this.getBarTransitionFunctions();kv.fromToMotion(this.id,"datums",this.ctx.animationManager,[this.itemSelection],e),RG(this,"labels",this.ctx.animationManager,t)}animateClearingUpdateEmpty(){const{itemSelection:t}=this,{animationManager:e}=this.ctx,i=this.getBarTransitionFunctions();kv.fromToMotion(this.id,"datums",e,[t],i),BG(this,"labels",e,this.labelSelection)}getTooltipContent(t){const{id:e,dataModel:i,processedData:o,axes:s,properties:a}=this,{angleKey:n,angleName:r,radiusKey:l,radiusName:c,tooltip:h}=a,d=s[Zi.Angle],u=s[Zi.Radius],g=this.nodeData?.[t];if(!i||!o||!d||!u||!g)return;const y=o.dataSources.get(this.id)?.[t],f=i.resolveKeysById(this,"radiusValue",o)[t],x=i.resolveColumnById(this,"angleValue-raw",o)[t];if(f==null)return;const S=this.getItemStyle(g,!1);return this.formatTooltipWithContext(h,{heading:this.getAxisValueText(u,"tooltip",f,y,l,void 0),symbol:this.legendItemSymbol(),data:[{label:r,fallbackLabel:n,value:this.getAxisValueText(d,"tooltip",x,y,n,void 0)}]},{seriesId:e,datum:y,title:r,angleKey:n,angleName:r,radiusKey:l,radiusName:c,...S})}pickNodeClosestDatum(t){return this.pickNodeNearestDistantObject(t,this.itemSelection.nodes())}legendItemSymbol(){const{fill:t,stroke:e,fillOpacity:i,strokeOpacity:o,strokeWidth:s,lineDash:a,lineDashOffset:n}=this.properties,r={fill:t??"rgba(0, 0, 0, 0)",stroke:e??"rgba(0, 0, 0, 0)",fillOpacity:i,strokeOpacity:o,strokeWidth:s,lineDash:a,lineDashOffset:n};return WG(r.fill)&&(r.fill={...r.fill,gradient:"linear",rotation:0,reverse:!1}),{marker:r}}getLegendData(t){if(t!=="category")return[];const{id:e,visible:i}=this,{angleKey:o,angleName:s,showInLegend:a}=this.properties;return[{legendType:"category",id:e,itemId:o,seriesId:e,enabled:i,label:{text:s??o},symbol:this.legendItemSymbol(),hideInLegend:!a}]}getDatumId(t){return Dv(t.radiusValue)}computeLabelsBBox(){return null}getStackId(){return`radialBar-stack-${this.seriesGrouping?.groupIndex??this.id}-xValues`}hasItemStylers(){return this.properties.itemStyler!=null}};Gc.className="RadialBarSeries",Gc.type="radial-bar";import{_ModuleSupport as UG}from"ag-charts-community";import{boolean as Lv,constant as XG,number as ZG,required as Su,string as Zn}from"ag-charts-core";var{commonSeriesOptionsDefs:qG,radialBarSeriesThemeableOptionsDef:QG}=UG,JG={...qG,...QG,type:Su(XG("radial-bar")),angleKey:Su(Zn),radiusKey:Su(Zn),angleName:Zn,radiusName:Zn,grouped:Lv,stacked:Lv,stackGroup:Zn,normalizedTo:ZG};import{_ModuleSupport as bu}from"ag-charts-community";var{ThemeConstants:{POLAR_AXIS_TYPE:tW},FILL_GRADIENT_CONIC_SERIES_DEFAULTS:eW,FILL_IMAGE_DEFAULTS:iW,FILL_PATTERN_DEFAULTS:oW}=bu,sW={series:{fill:{$applySwitch:[{$path:"type"},{$palette:"fill"},["gradient",eW],["image",iW],["pattern",oW]]},stroke:{$palette:"stroke"},strokeWidth:{$isUserOption:["./stroke",1,0]},label:{...bu.LABEL_BOXING_DEFAULTS,enabled:!1,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"chartBackgroundColor"}},highlight:bu.multiSeriesHighlightStyle()},axes:{[tW.RADIUS_CATEGORY]:{innerRadiusRatio:.2,groupPaddingInner:.2,paddingInner:.2,paddingOuter:.1}}},{POLAR_AXIS_TYPE:Iv}=mG.ThemeConstants,aW={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["polar"],identifier:"radial-bar",moduleFactory:t=>new Gc(t),defaultAxes:[{type:Iv.ANGLE_NUMBER},{type:Iv.RADIUS_CATEGORY}],themeTemplate:sW,stackable:!0,groupable:!0},nW={type:"series",name:"radial-bar",chartType:"polar",enterprise:!0,options:JG,create:t=>new Gc(t)};import{_ModuleSupport as rW}from"ag-charts-community";import{_ModuleSupport as lW}from"ag-charts-community";import{_ModuleSupport as cW}from"ag-charts-community";var{Property:Cv}=cW,vu=class extends Vt{};p([Cv],vu.prototype,"columnWidthRatio",2),p([Cv],vu.prototype,"maxColumnWidthRatio",2);var{ChartAxisDirection:hW,PolarAxis:pW,RadialColumnShape:dW,getRadialColumnWidth:uW}=lW,Wc=class extends Yb{constructor(t){super(t,{animationResetFns:{item:_V}}),this.properties=new vu}getStackId(){return`radarColumn-stack-${this.seriesGrouping?.groupIndex??this.id}-yValues`}nodeFactory(){return new dW}getColumnTransitionFunctions(){const t=this.isRadiusAxisReversed()?this.radius:this.getAxisInnerRadius();return EV(t)}isRadiusAxisCircle(){const t=this.axes[hW.Radius];return t instanceof pW?t.shape==="circle":!1}updateItemPath(t,e,i){t.isBeveled=this.isRadiusAxisCircle(),t.isRadiusAxisReversed=this.isRadiusAxisReversed(),i&&(t.innerRadius=e.innerRadius,t.outerRadius=e.outerRadius,t.startAngle=e.startAngle,t.endAngle=e.endAngle,t.columnWidth=e.columnWidth,t.axisInnerRadius=e.axisInnerRadius,t.axisOuterRadius=e.axisOuterRadius)}getColumnWidth(t,e){const{columnWidthRatio:i=.5,maxColumnWidthRatio:o=.5}=this.properties;return uW(t,e,this.radius,i,o)}hasItemStylers(){return this.properties.itemStyler!=null}};Wc.className="RadialColumnSeries",Wc.type="radial-column";import{_ModuleSupport as gW}from"ag-charts-community";import{boolean as Tv,constant as yW,number as fW,required as Mu,string as qn}from"ag-charts-core";var{commonSeriesOptionsDefs:mW,radialColumnSeriesThemeableOptionsDef:xW}=gW,SW={...mW,...xW,type:Mu(yW("radial-column")),angleKey:Mu(qn),radiusKey:Mu(qn),angleName:qn,radiusName:qn,grouped:Tv,stacked:Tv,stackGroup:qn,normalizedTo:fW};import{_ModuleSupport as Du}from"ag-charts-community";var{ThemeConstants:{POLAR_AXIS_TYPE:wv,POLAR_AXIS_SHAPE:Nv},FILL_GRADIENT_RADIAL_SERIES_DEFAULTS:bW,FILL_IMAGE_DEFAULTS:vW,FILL_PATTERN_DEFAULTS:MW}=Du,DW={series:{fill:{$applySwitch:[{$path:"type"},{$palette:"fill"},["gradient",bW],["image",vW],["pattern",MW]]},stroke:{$palette:"stroke"},columnWidthRatio:.5,maxColumnWidthRatio:.5,strokeWidth:{$isUserOption:["./stroke",1,0]},label:{...Du.LABEL_BOXING_DEFAULTS,enabled:!1,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"textColor"}},highlight:Du.multiSeriesHighlightStyle()},axes:{[wv.ANGLE_CATEGORY]:{shape:{$findFirstSiblingNotOperation:Nv.CIRCLE},groupPaddingInner:0,paddingInner:0,label:{spacing:10}},[wv.RADIUS_NUMBER]:{shape:{$findFirstSiblingNotOperation:Nv.CIRCLE},innerRadiusRatio:.5}}},{POLAR_AXIS_TYPE:Pv}=rW.ThemeConstants,kW={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["polar"],identifier:"radial-column",moduleFactory:t=>new Wc(t),defaultAxes:[{type:Pv.ANGLE_CATEGORY},{type:Pv.RADIUS_NUMBER}],themeTemplate:DW,stackable:!0,groupable:!0},AW={type:"series",name:"radial-column",chartType:"polar",enterprise:!0,options:SW,create:t=>new Wc(t)};import{_ModuleSupport as Xa}from"ag-charts-community";import{_ModuleSupport as Us}from"ag-charts-community";import{cachedTextMeasurer as LW}from"ag-charts-core";import{_ModuleSupport as IW}from"ag-charts-community";var{SvgPath:CW,Rotatable:TW,Translatable:wW,Scalable:NW}=IW,ku=class extends TW(NW(wW(CW))){constructor(){super(...arguments),this.scalingCenterX=.5,this.scalingCenterY=.5,this.rotationCenterX=.5,this.rotationCenterY=.5}};ku.defaultPathData="M0.50245 0.53745C0.481767 0.53745 0.465 0.520683 0.465 0.5C0.465 0.479317 0.481767 0.46255 0.50245 0.46255L1 0.500012L0.50245 0.53745Z";import{_ModuleSupport as Kc}from"ag-charts-community";var{getColorStops:PW,normalizeAngle360:EW,normalizeAngle360Inclusive:_W,toDegrees:OW}=Kc,{BaseProperties:Qn,makeSeriesTooltip:RW,SeriesProperties:BW,PropertiesArray:Au,AxisLabel:zW,Property:$,Label:FW}=Kc,Ev=class extends FW{};p([$],Ev.prototype,"spacing",2);var ce=class extends Qn{constructor(){super(...arguments),this.label=new Ev}getStyle(){const{fill:t="black",fillOpacity:e=1,stroke:i="black",strokeWidth:o=0,strokeOpacity:s=1,lineDash:a=[0],lineDashOffset:n=0}=this;return{fill:t,fillOpacity:e,stroke:i,strokeWidth:o,strokeOpacity:s,lineDash:a,lineDashOffset:n}}};p([$],ce.prototype,"text",2),p([$],ce.prototype,"value",2),p([$],ce.prototype,"shape",2),p([$],ce.prototype,"placement",2),p([$],ce.prototype,"spacing",2),p([$],ce.prototype,"size",2),p([$],ce.prototype,"rotation",2),p([$],ce.prototype,"fill",2),p([$],ce.prototype,"fillOpacity",2),p([$],ce.prototype,"stroke",2),p([$],ce.prototype,"strokeWidth",2),p([$],ce.prototype,"strokeOpacity",2),p([$],ce.prototype,"lineDash",2),p([$],ce.prototype,"lineDashOffset",2),p([$],ce.prototype,"label",2);var Ii=class extends Qn{constructor(){super(...arguments),this.enabled=!0,this.fills=new Au(Kc.StopProperties),this.fillMode="continuous",this.fillOpacity=1,this.stroke="black",this.strokeWidth=0,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0}getStyle(t,e){const{enabled:i,fill:o,fills:s,fillMode:a,fillOpacity:n,stroke:r,strokeWidth:l,strokeOpacity:c,lineDash:h,lineDashOffset:d}=this;return{fill:i?o??Rv(s,a,t,e):"none",fillOpacity:n,stroke:r,strokeWidth:l,strokeOpacity:c,lineDash:h,lineDashOffset:d}}};p([$],Ii.prototype,"enabled",2),p([$],Ii.prototype,"fills",2),p([$],Ii.prototype,"fillMode",2),p([$],Ii.prototype,"fill",2),p([$],Ii.prototype,"fillOpacity",2),p([$],Ii.prototype,"stroke",2),p([$],Ii.prototype,"strokeWidth",2),p([$],Ii.prototype,"strokeOpacity",2),p([$],Ii.prototype,"lineDash",2),p([$],Ii.prototype,"lineDashOffset",2);var Jn=class extends Qn{constructor(){super(...arguments),this.values=void 0,this.step=void 0,this.minSpacing=0,this.maxSpacing=1e3}};p([$],Jn.prototype,"values",2),p([$],Jn.prototype,"step",2),p([$],Jn.prototype,"minSpacing",2),p([$],Jn.prototype,"maxSpacing",2);var VW=class extends zW{},Ae=class extends Qn{constructor(){super(...arguments),this.min=0,this.max=1,this.fills=new Au(Kc.StopProperties),this.fillMode="continuous",this.fillOpacity=1,this.stroke="black",this.strokeWidth=0,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.defaultFill="black",this.interval=new Jn,this.label=new VW}getStyle(t,e,i){const{fill:o,fills:s,defaultFill:a,fillMode:n,fillOpacity:r,stroke:l,strokeWidth:c,strokeOpacity:h,lineDash:d,lineDashOffset:u}=this;return{fill:o??(t&&s.length===0?a:void 0)??Rv(s,n,e,i),fillOpacity:r,stroke:l,strokeWidth:c,strokeOpacity:h,lineDash:d,lineDashOffset:u}}};p([$],Ae.prototype,"min",2),p([$],Ae.prototype,"max",2),p([$],Ae.prototype,"fills",2),p([$],Ae.prototype,"fillMode",2),p([$],Ae.prototype,"fill",2),p([$],Ae.prototype,"fillOpacity",2),p([$],Ae.prototype,"stroke",2),p([$],Ae.prototype,"strokeWidth",2),p([$],Ae.prototype,"strokeOpacity",2),p([$],Ae.prototype,"lineDash",2),p([$],Ae.prototype,"lineDashOffset",2),p([$],Ae.prototype,"defaultFill",2),p([$],Ae.prototype,"interval",2),p([$],Ae.prototype,"label",2);var Ci=class extends Qn{constructor(){super(...arguments),this.enabled=!0,this.spacing=0,this.fill="black",this.fillOpacity=1,this.stroke="black",this.strokeWidth=0,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0}};p([$],Ci.prototype,"enabled",2),p([$],Ci.prototype,"radiusRatio",2),p([$],Ci.prototype,"spacing",2),p([$],Ci.prototype,"fill",2),p([$],Ci.prototype,"fillOpacity",2),p([$],Ci.prototype,"stroke",2),p([$],Ci.prototype,"strokeWidth",2),p([$],Ci.prototype,"strokeOpacity",2),p([$],Ci.prototype,"lineDash",2),p([$],Ci.prototype,"lineDashOffset",2);var _v=class extends Hi{};p([$],_v.prototype,"text",2);var Ov=class extends Cn{};p([$],Ov.prototype,"text",2);var _t=class extends BW{constructor(){super(...arguments),this.startAngle=0,this.endAngle=0,this.segmentation=new Wn,this.defaultColorRange=[],this.targets=new Au(ce),this.defaultTarget=new ce,this.outerRadiusRatio=1,this.innerRadiusRatio=1,this.cornerRadius=0,this.cornerMode="container",this.spacing=0,this.scale=new Ae,this.bar=new Ii,this.needle=new Ci,this.label=new _v,this.secondaryLabel=new Ov,this.tooltip=RW()}};p([$],_t.prototype,"value",2),p([$],_t.prototype,"startAngle",2),p([$],_t.prototype,"endAngle",2),p([$],_t.prototype,"segmentation",2),p([$],_t.prototype,"defaultColorRange",2),p([$],_t.prototype,"targets",2),p([$],_t.prototype,"defaultTarget",2),p([$],_t.prototype,"outerRadiusRatio",2),p([$],_t.prototype,"innerRadiusRatio",2),p([$],_t.prototype,"outerRadius",2),p([$],_t.prototype,"innerRadius",2),p([$],_t.prototype,"cornerRadius",2),p([$],_t.prototype,"cornerMode",2),p([$],_t.prototype,"spacing",2),p([$],_t.prototype,"scale",2),p([$],_t.prototype,"bar",2),p([$],_t.prototype,"needle",2),p([$],_t.prototype,"label",2),p([$],_t.prototype,"secondaryLabel",2),p([$],_t.prototype,"tooltip",2);function Rv(t,e,i,o){const{domain:s,range:a}=o,[n,r]=a,l=EW((n+r)/2+Math.PI),c=_W(r-n);return{type:"gradient",gradient:"conic",colorSpace:"oklch",colorStops:PW(t,i,s,e).map(({color:d,stop:u})=>(u=Math.min(Math.max(u,0),1),u=(n+c*u-l)/(2*Math.PI),u=(u%1+1)%1,{stop:u,color:d})),bounds:"series",rotation:OW(l)+90}}import{_ModuleSupport as HW}from"ag-charts-community";var{SectorBox:Lu}=HW;function GW(t){const{startAngle:e,endAngle:i,clipStartAngle:o,clipEndAngle:s,innerRadius:a,outerRadius:n}=t;if(!(o==null||s==null))return new Lu(Math.max(o,e),Math.min(s,i),a,n)}function Bv(t,e,i){return Math.max(t,i.startAngle)<=Math.min(e,i.endAngle)}function Iu(t){return t.clipStartAngle!=null&&t.clipEndAngle!=null}function Cu(t,e){const{clipStartAngle:i,clipEndAngle:o,innerRadius:s,outerRadius:a}=t;return new Lu(i,e?i:o,s,a)}function zv(t,e){const i=t?"initial":"update";return{node:{fromFn(a,n){const r=a.previousDatum;let{startAngle:l,endAngle:c}=r??n;const h=r!=null&&Iu(r)?Cu(r,t):void 0,d=Iu(n)?Cu(n,t):void 0;let u;return h!=null&&d!=null?u=h:h==null&&d!=null?(u=d,l=n.startAngle,c=n.endAngle):h!=null&&d==null?(u=void 0,l=n.startAngle,c=n.endAngle):t&&(c=l),{startAngle:l,endAngle:c,clipSector:u,phase:i}},toFn(a,n){const{startAngle:r,endAngle:l}=n;let c;return Iu(n)&&(c=Cu(n,!1)),{startAngle:r,endAngle:l,clipSector:c}},applyFn(a,n){const{startAngle:r,endAngle:l}=n;let{clipSector:c}=n;c!=null&&(c=new Lu(Math.max(r,c.startAngle),Math.min(l,c.endAngle),c.innerRadius,c.outerRadius));const h=c==null||Bv(r,l,c);a.startAngle=r,a.endAngle=l,a.clipSector=c,a.visible=h}},needle:{fromFn(a){let{angle:n}=a.previousDatum??a.datum;return t&&(n=e),{rotation:n,phase:i}},toFn(a,n){const{angle:r}=n;return{rotation:r}}}}}function Tu(t,e){const{startAngle:i,endAngle:o}=e,s=GW(e),a=s==null||Bv(i,o,s);return{startAngle:i,endAngle:o,clipSector:s,visible:a}}function Fv(t,e){const{angle:i}=e;return{rotation:i}}var WW={top:0,middle:.5,bottom:1};function KW(t,e,i,o,s,a){const{padding:n,textAlign:r,verticalAlign:l}=o;let c,h;if(i.each((M,k)=>{k.label==="primary"?c=k:k.label==="secondary"&&(h=k)}),c==null)return;const d=Gn(t.id,e,c,a?.label);if(d==null)return;const u=h!=null?Gn(t.id,e,h,a?.secondaryLabel):void 0,g={padding:n},y=r==="center"?2:1,f=l==="middle"?2:1,x=M=>({width:Math.sqrt(Math.max(s**2-(M/f)**2,0))*y,height:Math.min(M,f*s),meta:null});let S,v,m;if(h!=null&&u!=null){const M=xm(d,c,u,h,g,x);S=M?.label,v=M?.secondaryLabel,m=M?.height??0}else{const M=Ln(d,c,g,x);S=M?.[0],v=void 0,m=M?.[0].height??0}const b=m*WW[l];i.each((M,k)=>{let A;if(k.label==="primary"?A=S:k.label==="secondary"&&(A=v),A==null){M.visible=!1;return}M.visible=!0,M.text=A.text,M.fontSize=A.fontSize,M.lineHeight=A.lineHeight,M.textAlign=r,M.textBaseline="middle";const D=k.label==="primary"?A.height/2:m-A.height/2;M.y=k.centerY+D-b,M.x=k.centerX})}var{fromToMotion:tr,resetMotion:Vv,SeriesNodePickMode:Hv,StateMachine:$W,createDatumId:wu,normalizeAngle360:jW,normalizeAngle360Inclusive:Gv,isBetweenAngles:$c,sectorBox:YW,toRadians:jc,BBox:UW,Group:Jo,PointerEvents:Yc,Selection:ts,Sector:XW,SectorBox:ZW,Text:Wv,Marker:qW,tickFormat:QW,applyShapeStyle:Uc,mergeDefaults:JW}=Us,t4={inside:90,middle:0,outside:-90},e4=[{textAlign:"left",textBaseline:"top"},{textAlign:"right",textBaseline:"top"},{textAlign:"right",textBaseline:"bottom"},{textAlign:"left",textBaseline:"bottom"}],i4=[{textAlign:"right",textBaseline:"bottom"},{textAlign:"left",textBaseline:"bottom"},{textAlign:"left",textBaseline:"top"},{textAlign:"right",textBaseline:"top"}],Xc=class extends Us.Series{constructor(t){super({moduleCtx:t,pickModes:[Hv.EXACT_SHAPE_MATCH,Hv.NEAREST_NODE]}),this.centerX=0,this.centerY=0,this.radius=0,this.textAlign="center",this.verticalAlign="middle",this.properties=new _t,this.scale=new Ju,this.scaleGroup=this.contentGroup.appendChild(new Jo({name:"scaleGroup"})),this.itemGroup=this.contentGroup.appendChild(new Jo({name:"itemGroup"})),this.itemNeedleGroup=this.contentGroup.appendChild(new Jo({name:"itemNeedleGroup"})),this.itemTargetGroup=this.contentGroup.appendChild(new Jo({name:"itemTargetGroup"})),this.itemTargetLabelGroup=this.contentGroup.appendChild(new Jo({name:"itemTargetLabelGroup"})),this.itemLabelGroup=this.contentGroup.appendChild(new Jo({name:"itemLabelGroup"})),this.highlightTargetGroup=this.highlightGroup.appendChild(new Jo({name:"itemTargetLabelGroup"})),this.tickGroup=this.contentGroup.appendChild(new Jo({name:"tickGroup"})),this.scaleSelection=ts.select(this.scaleGroup,()=>this.nodeFactory()),this.datumSelection=ts.select(this.itemGroup,()=>this.nodeFactory()),this.needleSelection=ts.select(this.itemNeedleGroup,ku),this.targetSelection=ts.select(this.itemTargetGroup,()=>this.markerFactory()),this.targetLabelSelection=ts.select(this.itemTargetLabelGroup,Wv),this.labelSelection=ts.select(this.itemLabelGroup,Wv),this.highlightTargetSelection=ts.select(this.highlightTargetGroup,()=>this.markerFactory()),this.tickSelection=ts.select(this.tickGroup,Us.TransformableText),this.datumUnion=new YS,this.animationState=new $W("empty",{empty:{update:{target:"ready",action:()=>this.animateEmptyUpdateReady()},reset:"empty",skip:"ready"},ready:{updateData:"waiting",clear:"clearing",resize:()=>this.animateReadyResize(),reset:"empty",skip:"ready"},waiting:{update:{target:"ready",action:()=>this.animateWaitingUpdateReady()},reset:"empty",skip:"ready"},clearing:{update:{target:"empty"},reset:"empty",skip:"ready"}}),this.scaleGroup.pointerEvents=Yc.None,this.tickGroup.pointerEvents=Yc.None,this.itemNeedleGroup.pointerEvents=Yc.None,this.itemLabelGroup.pointerEvents=Yc.None}get hasData(){return this.properties.value!=null}nodeFactory(){return new XW}markerFactory(){const t=new qW;return t.size=1,t}processData(){this.nodeDataRefresh=!0,this.animationState.transition("updateData")}formatLabel(t){const{min:e,max:i}=this.properties.scale;return XS(t,{min:e,max:i})}layoutScale(){const{scale:t,properties:e}=this,{seriesRectWidth:i,seriesRectHeight:o}=this.nodeDataDependencies,{scale:s,outerRadius:a}=this.properties,{min:n,max:r,label:l,interval:c}=s,h=jc(e.startAngle-90),d=jc(e.endAngle-90),g=Gv(d-h)>Math.PI,y=g||$c(1.5*Math.PI,h,d),f=g||$c(0*Math.PI,h,d),x=g||$c(.5*Math.PI,h,d),S=g||$c(1*Math.PI,h,d);let v;S&&!f?v="right":!S&&f?v="left":v="center";let m;y&&!x?m="bottom":!y&&x?m="top":m="middle";const b=YW({startAngle:h,endAngle:d,innerRadius:0,outerRadius:.5}),M=-(b.x+b.width/2)*2,k=-(b.y+b.height/2)*2,A=Math.min(i/b.width,o/b.height);t.domain=[n,r],t.range=[h,d],t.arcLength=A/2;const{maxSpacing:D,minSpacing:I}=c,{arcLength:L}=t,C=D?Math.floor(L/D):1,w=I?Math.floor(L/I):1/0,P=Math.floor(4/Math.PI*Math.abs(t.range[0]-t.range[1])),E=Math.max(C,Math.min(w,P)),T=c.values??t.ticks({nice:!1,interval:c.step,minTickCount:C,maxTickCount:w,tickCount:E})?.ticks??[],R=QW(T,typeof l.format=="string"?l.format:void 0),_=LW(l),N=T.map((H,W)=>{let G;if(l.formatter&&(G=Bn(this.ctx,l.formatter,{value:H,index:W,domain:t.domain,boundSeries:void 0})),G??(G=R?.(H)),G==null)return;const{width:K,height:Y}=_.measureText(G);return{index:W,value:H,text:G,width:K,height:Y}}).filter(H=>H!=null),O=N.reduce((H,W)=>Math.max(H,W.width),0),B=N.reduce((H,W)=>Math.max(H,W.height),0),z=l.enabled?Math.max(O,B)+l.spacing:0,V=Math.max(.5*A-z,0),F=a??V;return this.centerX=i/2+M*F,this.centerY=o/2+k*F,this.radius=F,this.textAlign=v,this.verticalAlign=m,N}getShapeFillBBox(){const{centerX:t,centerY:e,radius:i}=this,o=new UW(t-i,e-i,2*i,2*i);return{series:o,axis:o}}getTargets(){const{properties:t}=this,e=t.defaultTarget;return Array.from(t.targets).map(i=>{const{text:o=e.text,value:s=e.value??0,shape:a=e.shape??"triangle",rotation:n=e.rotation??0,placement:r=e.placement??"middle",spacing:l=e.spacing??0,size:c=e.size??0}=i,{enabled:h=e.label.enabled,color:d=e.label.color??"black",fontStyle:u=e.label.fontStyle??"normal",fontWeight:g=e.label.fontWeight??"normal",fontSize:y=e.label.fontSize,fontFamily:f=e.label.fontFamily,spacing:x=e.label.spacing??0}=i.label;return{text:o,value:s,shape:a,placement:r,spacing:l,size:c,rotation:n,label:{enabled:h,color:d,fontStyle:u,fontWeight:g,fontSize:y,fontFamily:f,spacing:x},style:i.getStyle()}})}getTargetRadius(t){const{radius:e,properties:i}=this,{innerRadiusRatio:o,outerRadiusRatio:s}=i,{placement:a,spacing:n,size:r}=t,l=e*s,c=e*o;switch(a){case"inside":return Math.max(c-n-r/2,0);case"outside":return l+n+r/2;default:return(c+l)/2}}getTargetLabel(t){const{scale:e}=this,{value:i,size:o,placement:s,label:a}=t,{spacing:n,color:r,fontStyle:l,fontWeight:c,fontSize:h,fontFamily:d}=a,u=void 0,g=e.convert(i),y=jW(g)/(Math.PI/2)|0,f=o/2+n;let x,S,v,m;switch(s){case"outside":({textAlign:x,textBaseline:S}=e4[y]),v=f*Math.cos(g),m=f*Math.sin(g);break;case"inside":({textAlign:x,textBaseline:S}=i4[y]),v=-f*Math.cos(g),m=-f*Math.sin(g);break;default:x="center",S="bottom",v=0,m=-f;break}return{offsetX:v,offsetY:m,fill:r,textAlign:x,textBaseline:S,fontStyle:l,fontWeight:c,fontSize:h,fontFamily:d,lineHeight:u}}createNodeData(){const t=this.layoutScale(),{id:e,scale:i,properties:o,radius:s,centerX:a,centerY:n}=this,{value:r,innerRadiusRatio:l,outerRadiusRatio:c,segmentation:h,cornerRadius:d,cornerMode:u,needle:g,bar:y,scale:f,label:x,secondaryLabel:S}=o,{outerRadius:v=s*c,innerRadius:m=s*l,defaultColorRange:b}=o,M=this.getTargets(),k=[],A=[],D=[],I=[],L=[],C=u==="item",w=i.convert(i.domain[0]),P=i.convert(r),E=Math.ceil(Gv(P-w)*s);let T=h.enabled?h.interval.getSegments(i,E):void 0;const R=y.getStyle(b,i),_=f.getStyle(y.enabled,b,i);if(T==null&&C){const N=Math.min(...i.domain),O=Math.max(...i.domain),B={value:r,segmentStart:N,segmentEnd:O},V=Math.min(d,(v-m)/2)/((m+v)/2);k.push({series:this,itemId:"value",datum:B,datumIndex:{type:0},type:0,centerX:a,centerY:n,outerRadius:v,innerRadius:m,startAngle:w-V,endAngle:P+V,clipStartAngle:void 0,clipEndAngle:void 0,startCornerRadius:d,endCornerRadius:d,style:R}),L.push({series:this,itemId:"scale",datum:B,datumIndex:{type:0},type:0,centerX:a,centerY:n,outerRadius:v,innerRadius:m,startAngle:i.range[0]-V,endAngle:i.range[1]+V,clipStartAngle:void 0,clipEndAngle:void 0,startCornerRadius:d,endCornerRadius:d,style:_})}else{T??(T=i.domain);for(let N=0;N<T.length-1;N++){const O=T[N],B=T[N+1],z={value:r,segmentStart:O,segmentEnd:B},V=N===0,F=N===T.length-2,H=i.convert(O),W=i.convert(B);k.push({series:this,itemId:`value-${N}`,datum:z,datumIndex:{type:0},type:0,centerX:a,centerY:n,outerRadius:v,innerRadius:m,startAngle:H,endAngle:W,clipStartAngle:w,clipEndAngle:P,startCornerRadius:C||V?d:0,endCornerRadius:C||F?d:0,style:R}),L.push({series:this,itemId:`scale-${N}`,datum:z,datumIndex:{type:0},type:0,centerX:a,centerY:n,outerRadius:v,innerRadius:m,startAngle:H,endAngle:W,clipStartAngle:void 0,clipEndAngle:void 0,startCornerRadius:C||V?d:0,endCornerRadius:C||F?d:0,style:_})}}if(!g.enabled&&x.enabled){const{text:N,color:O,fontSize:B,minimumFontSize:z,fontStyle:V,fontWeight:F,fontFamily:H,lineHeight:W,formatter:G=K=>this.formatLabel(K.value)}=x;I.push({label:"primary",centerX:a,centerY:n,text:N,value:r,fill:O,fontSize:B,minimumFontSize:z,fontStyle:V,fontWeight:F,fontFamily:H,lineHeight:W,formatter:G})}if(!g.enabled&&S.enabled){const{text:N,color:O,fontSize:B,minimumFontSize:z,fontStyle:V,fontWeight:F,fontFamily:H,lineHeight:W,formatter:G}=S;I.push({label:"secondary",centerX:a,centerY:n,text:N,value:r,fill:O,fontSize:B,minimumFontSize:z,fontStyle:V,fontWeight:F,fontFamily:H,lineHeight:W,formatter:G})}if(g.enabled){let N=g.radiusRatio!=null?s*g.radiusRatio:m;N=Math.max(N-g.spacing,0);const O=i.convert(r);D.push({centerX:a,centerY:n,radius:N,angle:O,series:this})}for(let N=0;N<M.length;N+=1){const O=M[N],{value:B,text:z,size:V,shape:F,style:H}=O;if(B<Math.min(...i.domain)||B>Math.max(...i.domain))continue;const W=this.getTargetRadius(O),G=i.convert(B),K=jc(O.rotation+t4[O.placement]);A.push({series:this,itemId:`target-${N}`,midPoint:{x:W*Math.cos(G)+a,y:W*Math.sin(G)+n},datum:{value:B},datumIndex:{type:1,index:N},type:1,value:B,text:z,centerX:a,centerY:n,shape:F,radius:W,angle:G,rotation:K,size:V,label:this.getTargetLabel(O),style:H})}return{itemId:e,nodeData:k,needleData:D,targetData:A,labelData:I,scaleData:L,tickData:t}}updateSelections(t){(this.nodeDataRefresh||t)&&(this.contextNodeData=this.createNodeData(),this.nodeDataRefresh=!1)}highlightDatum(t){if(t!=null&&t.series===this&&t.type===1)return t}update({seriesRect:t}){const{datumSelection:e,labelSelection:i,needleSelection:o,targetSelection:s,targetLabelSelection:a,scaleSelection:n,highlightTargetSelection:r,tickSelection:l}=this,c=this.checkResize(t);this.updateSelections(c),this.contentGroup.visible=this.visible,this.contentGroup.opacity=this.getOpacity();const h=this.contextNodeData?.nodeData??[],d=this.contextNodeData?.labelData??[],u=this.contextNodeData?.needleData??[],g=this.contextNodeData?.targetData??[],y=this.contextNodeData?.scaleData??[],f=this.contextNodeData?.tickData??[],x=this.highlightDatum(this.ctx.highlightManager.getActiveHighlight());this.scaleSelection=this.updateScaleSelection({scaleData:y,scaleSelection:n}),this.updateScaleNodes({scaleSelection:n}),this.needleSelection=this.updateNeedleSelection({needleData:u,needleSelection:o}),this.updateNeedleNodes({needleSelection:o}),this.targetSelection=this.updateTargetSelection({targetData:g,targetSelection:s}),this.updateTargetStyles({targetSelection:s,isHighlight:!1}),this.updateTargetNodes({targetSelection:s}),this.targetLabelSelection=this.updateTargetLabelSelection({targetData:g,targetLabelSelection:a}),this.updateTargetLabelNodes({targetLabelSelection:a}),this.datumSelection=this.updateDatumSelection({nodeData:h,datumSelection:e}),this.updateDatumNodes({datumSelection:e}),this.labelSelection=this.updateLabelSelection({labelData:d,labelSelection:i}),this.updateLabelNodes({labelSelection:i}),this.highlightTargetSelection=this.updateTargetSelection({targetData:x!=null?[x]:[],targetSelection:r}),this.updateTargetStyles({targetSelection:r,isHighlight:!0}),this.updateTargetNodes({targetSelection:r}),this.tickSelection=this.updateTickSelection({tickData:f,tickSelection:l}),this.updateTickNodes({tickSelection:l}),c&&this.animationState.transition("resize"),this.animationState.transition("update")}updateDatumSelection(t){return t.datumSelection.update(t.nodeData,void 0,e=>wu(t.nodeData.length,e.itemId))}updateDatumNodes(t){const{datumSelection:e}=t,{ctx:i,properties:o}=this,{segmentation:s}=o,a=s.spacing??0,n=i.animationManager.isSkipped(),r=this.getShapeFillBBox();e.each((l,c)=>{const{centerX:h,centerY:d,innerRadius:u,outerRadius:g,startCornerRadius:y,endCornerRadius:f}=c;l.centerX=h,l.centerY=d,l.innerRadius=u,l.outerRadius=g,l.pointerEvents=this.properties.bar.enabled?Us.PointerEvents.All:Us.PointerEvents.None,Uc(l,c.style,r),l.startOuterCornerRadius=y,l.startInnerCornerRadius=y,l.endOuterCornerRadius=f,l.endInnerCornerRadius=f,l.radialEdgeInset=(a+l.strokeWidth)/2,l.concentricEdgeInset=l.strokeWidth/2,(n||l.previousDatum==null)&&l.setProperties(Tu(l,c))}),this.datumUnion.update(e,this.itemGroup,Us.Sector,(l,c,h)=>{l.clipSector??(l.clipSector=new ZW(NaN,NaN,NaN,NaN)),l.centerX=c.centerX,l.centerY=c.centerY,l.outerRadius=l.clipSector.outerRadius=c.outerRadius,l.innerRadius=l.clipSector.innerRadius=c.innerRadius,l.startAngle=l.clipSector.startAngle=c.startAngle,l.startInnerCornerRadius=c.startInnerCornerRadius,l.startOuterCornerRadius=c.startOuterCornerRadius,l.endAngle=h.endAngle,l.clipSector.endAngle=h.clipSector?.endAngle??h.endAngle,l.endInnerCornerRadius=h.endInnerCornerRadius,l.endOuterCornerRadius=h.endOuterCornerRadius,l.pointerEvents=Us.PointerEvents.None})}updateScaleSelection(t){return t.scaleSelection.update(t.scaleData,void 0,e=>wu(t.scaleData.length,e.itemId))}updateScaleNodes(t){const{scaleSelection:e}=t,{segmentation:i}=this.properties,o=i.spacing??0,s=this.getShapeFillBBox();e.each((a,n)=>{const{centerX:r,centerY:l,innerRadius:c,outerRadius:h,startCornerRadius:d,endCornerRadius:u}=n;a.centerX=r,a.centerY=l,a.innerRadius=c,a.outerRadius=h,Uc(a,n.style,s),a.startOuterCornerRadius=d,a.startInnerCornerRadius=d,a.endOuterCornerRadius=u,a.endInnerCornerRadius=u,a.radialEdgeInset=(o+a.strokeWidth)/2,a.concentricEdgeInset=a.strokeWidth/2,a.setProperties(Tu(a,n))})}updateNeedleSelection(t){return t.needleSelection.update(t.needleData,void 0,()=>wu(0))}updateNeedleNodes(t){const{needleSelection:e}=t,{fill:i,fillOpacity:o,stroke:s,strokeOpacity:a,strokeWidth:n,lineDash:r,lineDashOffset:l}=this.properties.needle,c=this.ctx.animationManager.isSkipped();e.each((h,d)=>{const{centerX:u,centerY:g,radius:y}=d,f=y*2;h.d=ku.defaultPathData,Uc(h,{fill:i,fillOpacity:o,stroke:s,strokeOpacity:a,strokeWidth:n/f,lineDash:r.map(x=>x/f),lineDashOffset:l/f}),h.translationX=u,h.translationY=g,h.scalingX=f,h.scalingY=f,c&&h.setProperties(Fv(h,d))})}updateTargetSelection(t){return t.targetSelection.update(t.targetData,void 0,e=>e.itemId)}updateTargetStyles({targetSelection:t,isHighlight:e}){t.each((i,o)=>{o.style=this.getTargetStyle(e,o)})}updateTargetNodes({targetSelection:t}){t.each((e,i)=>{const{centerX:o,centerY:s,angle:a,radius:n,shape:r,size:l,rotation:c}=i;Uc(e,i.style),e.size=l,e.shape=r==="line"?ZS:r,e.translationX=o+n*Math.cos(a),e.translationY=s+n*Math.sin(a),e.rotation=a+c})}getTargetStyle(t,{datumIndex:e,style:i}){const o=this.getHighlightStyle(t,e);return JW(o,{...i,opacity:1})}updateTargetLabelSelection(t){return t.targetLabelSelection.update(t.targetData,void 0,e=>e.itemId)}updateTargetLabelNodes(t){const{targetLabelSelection:e}=t;e.each((i,o)=>{const{centerX:s,centerY:a,radius:n,angle:r,text:l}=o,{offsetX:c,offsetY:h,fill:d,fontStyle:u,fontWeight:g,fontSize:y,fontFamily:f,textAlign:x,textBaseline:S}=o.label;if(l==null){i.visible=!1;return}i.visible=!0,i.x=s+n*Math.cos(r)+c,i.y=a+n*Math.sin(r)+h,i.text=l,i.fill=d,i.fontStyle=u,i.fontWeight=g,i.fontSize=y,i.fontFamily=f,i.textAlign=x,i.textBaseline=S})}updateLabelSelection(t){return t.labelSelection.update(t.labelData,void 0,e=>e.label)}updateLabelNodes(t){const{labelSelection:e}=t,i=this.ctx.animationManager.isSkipped();e.each((o,s)=>{o.fill=s.fill,o.fontStyle=s.fontStyle,o.fontWeight=s.fontWeight,o.fontFamily=s.fontFamily}),(i||this.labelsHaveExplicitText())&&this.formatLabelText()}updateTickSelection(t){return t.tickSelection.update(t.tickData,void 0,e=>e.index)}updateTickNodes(t){const{scale:e,radius:i,centerX:o,centerY:s,properties:a}=this,{enabled:n,color:r,fontFamily:l,fontSize:c,fontStyle:h,fontWeight:d,spacing:u}=a.scale.label,g=jc(a.scale.label.rotation??0);t.tickSelection.each((y,f)=>{if(!n){y.visible=!1;return}y.visible=!0,y.text=f.text,y.fill=r,y.fontFamily=l,y.fontSize=c,y.fontStyle=h,y.fontWeight=d,y.textAlign="center",y.textBaseline="middle";const x=e.convert(f.value),{width:S,height:v}=f,m=Math.abs(i*Math.cos(x)),b=Math.abs(i*Math.sin(x)),M=Math.min(Math.max(Math.abs(i/Math.tan(x)),m-S/2),m+S/2),k=Math.min(Math.max(Math.abs(i*Math.tan(x)),b-v/2),b+v/2),A=Math.hypot(M,k),D=o+(A+u)*Math.cos(x),I=s+(A+u)*Math.sin(x);y.x=D,y.y=I,y.rotationCenterX=D,y.rotationCenterY=I,y.rotation=g})}labelsHaveExplicitText(){for(const{datum:t}of this.labelSelection)if(t.text==null)return!1;return!0}formatLabelText(t){const{labelSelection:e,radius:i,textAlign:o,verticalAlign:s}=this,{spacing:a,innerRadiusRatio:n}=this.properties;KW(this,this.ctx,e,{padding:a,textAlign:o,verticalAlign:s},i*n,t)}resetAllAnimation(){this.ctx.animationManager.stopByAnimationGroupId(this.id),Vv([this.datumSelection],Tu),Vv([this.needleSelection],Fv),this.formatLabelText()}resetAnimation(t){t==="initial"?this.animationState.transition("reset"):t==="ready"&&this.animationState.transition("skip")}animateLabelText(t={}){const{animationManager:e}=this.ctx;let i,o,s,a;if(this.labelSelection.each((n,r)=>{n.opacity=1,r.label==="primary"?(i=n.previousDatum?.value??t.from??r.value,o=r.value):r.label==="secondary"&&(s=n.previousDatum?.value??t.from??r.value,a=r.value)}),!this.labelsHaveExplicitText())if(o==null||a==null)this.formatLabelText();else if(i===o&&s===a)this.formatLabelText({label:o,secondaryLabel:a});else{const n=`${this.id}_labels`;e.animate({id:n,groupId:"label",from:{label:i,secondaryLabel:s},to:{label:o,secondaryLabel:a},phase:t.phase??"update",onUpdate:r=>this.formatLabelText(r),onStop:()=>this.formatLabelText({label:o,secondaryLabel:a})})}}animateEmptyUpdateReady(){const{animationManager:t}=this.ctx,{node:e,needle:i}=zv(!0,this.scale.range[0]);tr(this.id,"node",t,[this.datumSelection],e,(o,s)=>s.itemId),tr(this.id,"needle",t,[this.needleSelection],i,()=>"needle"),tr(this.id,"label",t,[this.labelSelection],US,(o,s)=>s.label),this.animateLabelText({from:this.properties.scale.min,phase:"initial"})}animateWaitingUpdateReady(){const{animationManager:t}=this.ctx,{node:e,needle:i}=zv(!1,this.scale.range[0]);tr(this.id,"node",t,[this.datumSelection],e,(o,s)=>s.itemId),tr(this.id,"needle",t,[this.needleSelection],i,()=>"needle"),this.animateLabelText()}animateReadyResize(){this.resetAllAnimation()}dataCount(){return NaN}getSeriesDomain(){return[NaN,NaN]}getSeriesRange(t,e){return[NaN,NaN]}getLegendData(){return[]}getTooltipContent(t){const{id:e,properties:i}=this,{tooltip:o}=i;let s,a,n;if(t.type===0?(s=i.value,a=i.label.text,n=this.ctx.localeManager.t("ariaLabelGaugeValue")):({value:s,text:a}=i.targets[t.index],n=this.ctx.localeManager.t("ariaLabelGaugeTarget")),s!=null)return this.formatTooltipWithContext(o,{data:[{label:a,fallbackLabel:n,value:this.formatLabel(s)}]},{seriesId:e,title:void 0,datum:void 0,value:s})}pickNodeClosestDatum(t){return QS(this,t)}pickFocus(t){return JS(this,t)}getCaptionText(){const{value:t}=this.properties,e=[];return e.push(this.formatLabel(t)),this.labelSelection.each((i,o)=>{const s=Gn(this.id,this.ctx,o);s!=null&&e.push(s)}),e.join(". ")}getCategoryValue(t){}datumIndexForCategoryValue(t){}hasItemStylers(){return!1}};Xc.className="RadialGaugeSeries",Xc.type="radial-gauge";var{FONT_SIZE_RATIO:o4}=Xa,s4={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["standalone"],identifier:"radial-gauge",moduleFactory:t=>new Xc(t),themeTemplate:{minWidth:200,minHeight:200,tooltip:{enabled:!1},series:{outerRadiusRatio:1,innerRadiusRatio:.8,startAngle:270,endAngle:450,defaultColorRange:{$if:[{$eq:[{$palette:"type"},"inbuilt"]},{$interpolate:[{$palette:"secondDivergingColors"},5]},Xa.SAFE_RANGE2_OPERATION]},scale:{defaultFill:{$path:["/1",{$palette:"fill"},{$palette:"hierarchyColors"}]},stroke:{$path:["/2",Xa.SAFE_STROKE_FILL_OPERATION,{$palette:"hierarchyColors"}]},strokeWidth:{$isUserOption:["./stroke",2,0]},label:{fontWeight:{$ref:"fontWeight"},fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},color:{$ref:"textColor"},spacing:12}},bar:{strokeWidth:{$isUserOption:["./stroke",2,0]}},segmentation:{enabled:!1,interval:{},spacing:2},defaultTarget:{fill:{$ref:"foregroundColor"},stroke:{$ref:"foregroundColor"},size:10,shape:"triangle",placement:"outside",spacing:5,label:{enabled:!0,fontWeight:{$ref:"fontWeight"},fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},color:{$ref:"textColor"},spacing:5}},needle:{enabled:!1,fill:{$ref:"foregroundColor"},spacing:10},label:{...Xa.LABEL_BOXING_DEFAULTS,enabled:!0,fontWeight:{$ref:"fontWeight"},fontSize:56,minimumFontSize:18/56,fontFamily:{$ref:"fontFamily"},color:{$ref:"textColor"}},secondaryLabel:{...Xa.LABEL_BOXING_DEFAULTS,enabled:!0,fontWeight:{$ref:"fontWeight"},fontSize:{$rem:o4.LARGE},minimumFontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},color:{$ref:"subtleTextColor"}},tooltip:{range:{$path:["/tooltip/range",10]}}}}},a4={type:"series",name:"radial-gauge",chartType:"standalone",enterprise:!0,options:Xa.radialGaugeSeriesOptionsDef,create:t=>new Xc(t)};import{_ModuleSupport as Za}from"ag-charts-community";import{_ModuleSupport as n4}from"ag-charts-community";import{Logger as r4,cachedTextMeasurer as l4,calcLineHeight as c4,wrapText as Kv}from"ag-charts-core";function $v(t){t.nodes.sort((e,i)=>Math.round((e.datum.y-i.datum.y)*100)/100||-(e.datum.size-i.datum.size))}function h4({nodes:t,size:e},{seriesRectHeight:i,nodeSpacing:o,sizeScale:s}){const a=i*e*s;let n=(i-(a+o*(t.length-1)))/2;t.forEach(({datum:r})=>{const l=i*r.size*s;r.y=n,r.height=l,n+=l+o})}function p4(t,e){const{nodes:i}=t,{seriesRectHeight:o,nodeSpacing:s}=e;$v(t);let a=0,n=0;for(const{datum:c}of i){const h=Math.max(n-c.y,0);c.y+=h,a+=h,n=c.y+c.height+s}if(n-s<o)return a>0;let l=o;for(let c=i.length-1;c>=0;c-=1){const{datum:h}=i[c],d=h.y+h.height,u=Math.min(l-d,0);h.y+=u,a+=u,l=h.y-s}return!0}function Nu(t,e,i,o,s,a,n,r){const l=(i-t)/(o-e),c=(n-s)/(r-a),h=((a-e)*(l*c)+t*c-s*l)/(c-l);return t<i?h>t&&h<Math.min(i,n):h<t&&h>Math.max(i,n)}function jv(t,e){let i=!1;const o=t.nodes.filter(a=>e(a).length===1);let s=!0;for(let a=0;s&&a<o.length;a+=1){s=!1;for(let n=0;n<o.length-1;n+=1){const{datum:r}=o[n],l=e(o[n])[0].node.datum,{datum:c}=o[n+1],h=e(o[n+1])[0].node.datum;if(!(Nu(r.x,r.y,l.x,l.y,c.x,c.y,h.x,h.y)||Nu(r.x,r.y+r.height/2,l.x,l.y+l.height/2,c.x,c.y+c.height/2,h.x,h.y+h.height/2)||Nu(r.x,r.y+r.height,l.x,l.y+l.height,c.x,c.y+c.height,h.x,h.y+h.height)))continue;const u=o[n];o[n]=o[n+1],o[n+1]=u;const g=r.y;r.y=c.y+c.height-r.height,c.y=g,i=!0,s=!0}}return i}function d4(t){let e=!1;return $v(t),e=jv(t,i=>i.linksBefore)||e,e=jv(t,i=>i.linksAfter)||e,e}function u4(t){if(t.length===0)return;let e=0,i=0;for(const{node:{datum:o}}of t)e+=o.y*o.size,i+=o.size;return e/i}function Yv(t,e,i,o){return t.nodes.forEach(({datum:s,linksBefore:a,linksAfter:n})=>{const r=o===1?a:n,l=o===1?n:a,c=u4(r);if(c!=null){const h=l.length!==0?i:1;s.y=s.y+(c-s.y)*h}}),p4(t,e)}function Uv(t,e,i){let o=!1;for(const s of t)o=Yv(s,e,i,1)||o;return o}function g4(t,e,i){let o=!1;for(let s=t.length-1;s>=0;s-=1)o=Yv(t[s],e,i,-1)||o;return o}function Xv(t){let e=!1;for(let i=t.length-1;i>=0;i-=1)e=d4(t[i])||e;return e}function y4(t,e){t.forEach(o=>{h4(o,e)});let i=!1;for(let o=0;o<6;o+=1){const s=Uv(t,e,1);i=g4(t,e,.5);const a=Xv(t);if(!s&&!i&&!a)break}i&&(Uv(t,e,1),Xv(t))}import{_ModuleSupport as f4}from"ag-charts-community";var{BBox:m4,Path:x4,SceneChangeDetection:qa,splitBezier2D:S4}=f4;function Zc(t,e,i,o,s,a,n,r,l,c){let h,d;if(s!==i&&l!==n){const k=-(o-e)/(s-i),A=-(r-a)/(l-n);h=(n-i+k*e-A*a)/(k-A),d=k*(h-e)+i}else if(s===i&&l!==n)h=e,d=-(r-a)/(l-n)*(h-r)+l;else if(s!==i&&l===n)h=r,d=-(o-e)/(s-i)*(h-e)+i;else throw new Error("Offsetting flat bezier curve");const u=Math.hypot(i-d,e-h),g=(u+c)/u,y=Math.hypot(l-d,r-h),f=(y+c)/y,x=h+(o-h)*g,S=d+(s-d)*g,v=h+(a-h)*f,m=d+(n-d)*f,b=h+(r-h)*f,M=d+(l-d)*f;t.cubicCurveTo(x,S,v,m,b,M)}var Xs=class extends x4{constructor(){super(...arguments),this.x1=0,this.x2=0,this.y1=0,this.y2=0,this.height=0,this.inset=0}computeBBox(){const t=Math.min(this.x1,this.x2),e=Math.max(this.x1,this.x2)-t,i=Math.min(this.y1,this.y2),o=Math.max(this.y1,this.y2)-i+this.height;return new m4(t,i,e,o)}updatePath(){const{path:t,inset:e}=this;t.clear();const i=this.x1+e,o=this.x2-e,s=this.y1+e,a=this.y2+e,n=this.height-2*e;if(n<0||i>o)return;const r=i,l=s+n/2,c=(i+o)/2,h=s+n/2,d=(i+o)/2,u=a+n/2,g=o,y=a+n/2;if(t.moveTo(r,l-n/2),Math.abs(this.y2-this.y1)<1||this.x2-this.x1<this.height*Math.SQRT2)t.cubicCurveTo(c,h-n/2,d,u-n/2,g,y-n/2),t.lineTo(g,y+n/2),t.cubicCurveTo(d,u+n/2,c,h+n/2,r,l+n/2);else{const[f,x]=S4(r,l,c,h,d,u,g,y,.5),S=(a>s?1:-1)*n/2;Zc(t,f[0].x,f[0].y,f[1].x,f[1].y,f[2].x,f[2].y,f[3].x,f[3].y,S),Zc(t,x[0].x,x[0].y,x[1].x,x[1].y,x[2].x,x[2].y,x[3].x,x[3].y,-S),t.lineTo(g,y+n/2),Zc(t,x[3].x,x[3].y,x[2].x,x[2].y,x[1].x,x[1].y,x[0].x,x[0].y,S),Zc(t,f[3].x,f[3].y,f[2].x,f[2].y,f[1].x,f[1].y,f[0].x,f[0].y,-S)}t.closePath()}};p([qa()],Xs.prototype,"x1",2),p([qa()],Xs.prototype,"x2",2),p([qa()],Xs.prototype,"y1",2),p([qa()],Xs.prototype,"y2",2),p([qa()],Xs.prototype,"height",2),p([qa()],Xs.prototype,"inset",2);import{_ModuleSupport as b4}from"ag-charts-community";var{BaseProperties:Zv,FillGradientDefaults:v4,FillPatternDefaults:M4,FillImageDefaults:D4,makeSeriesTooltip:k4,SeriesProperties:A4,Property:J,Label:L4}=b4,qv=class extends L4{constructor(){super(...arguments),this.spacing=1}};p([J],qv.prototype,"spacing",2);var Do=class extends Zv{constructor(){super(...arguments),this.fill=void 0,this.fillOpacity=1,this.stroke=void 0,this.strokeOpacity=1,this.strokeWidth=1,this.lineDash=[0],this.lineDashOffset=0}};p([J],Do.prototype,"fill",2),p([J],Do.prototype,"fillOpacity",2),p([J],Do.prototype,"stroke",2),p([J],Do.prototype,"strokeOpacity",2),p([J],Do.prototype,"strokeWidth",2),p([J],Do.prototype,"lineDash",2),p([J],Do.prototype,"lineDashOffset",2),p([J],Do.prototype,"itemStyler",2);var di=class extends Zv{constructor(){super(...arguments),this.spacing=1,this.width=1,this.alignment="justify",this.fill=void 0,this.fillOpacity=1,this.stroke=void 0,this.strokeOpacity=1,this.strokeWidth=1,this.lineDash=[0],this.lineDashOffset=0}};p([J],di.prototype,"spacing",2),p([J],di.prototype,"width",2),p([J],di.prototype,"alignment",2),p([J],di.prototype,"fill",2),p([J],di.prototype,"fillOpacity",2),p([J],di.prototype,"stroke",2),p([J],di.prototype,"strokeOpacity",2),p([J],di.prototype,"strokeWidth",2),p([J],di.prototype,"lineDash",2),p([J],di.prototype,"lineDashOffset",2),p([J],di.prototype,"itemStyler",2);var Ot=class extends A4{constructor(){super(),this.nodes=void 0,this.idKey="",this.idName=void 0,this.labelKey=void 0,this.labelName=void 0,this.sizeKey=void 0,this.sizeName=void 0,this.fillGradientDefaults=new v4,this.fillPatternDefaults=new M4,this.fillImageDefaults=new D4,this.defaultColorRange=[],this.defaultPatternFills=[],this.fills=[],this.strokes=[],this.label=new qv,this.link=new Do,this.node=new di,this.tooltip=k4(),this.highlightStyle.deprecated=!1}getStyle(t,e,i,o){const{fillOpacity:s,strokeWidth:a,strokeOpacity:n,lineDash:r,lineDashOffset:l,fill:c=e[o%e.length],stroke:h=i[o%e.length]}=t?this.link:this.node;return{fill:c,fillOpacity:s,stroke:h,strokeWidth:a,strokeOpacity:n,lineDash:r,lineDashOffset:l}}};p([J],Ot.prototype,"nodes",2),p([J],Ot.prototype,"fromKey",2),p([J],Ot.prototype,"toKey",2),p([J],Ot.prototype,"idKey",2),p([J],Ot.prototype,"idName",2),p([J],Ot.prototype,"labelKey",2),p([J],Ot.prototype,"labelName",2),p([J],Ot.prototype,"sizeKey",2),p([J],Ot.prototype,"sizeName",2),p([J],Ot.prototype,"fillGradientDefaults",2),p([J],Ot.prototype,"fillPatternDefaults",2),p([J],Ot.prototype,"fillImageDefaults",2),p([J],Ot.prototype,"defaultColorRange",2),p([J],Ot.prototype,"defaultPatternFills",2),p([J],Ot.prototype,"fills",2),p([J],Ot.prototype,"strokes",2),p([J],Ot.prototype,"label",2),p([J],Ot.prototype,"link",2),p([J],Ot.prototype,"node",2),p([J],Ot.prototype,"tooltip",2);var{Transformable:I4,applyShapeStyle:Qv,SeriesNodePickMode:Jv,createDatumId:qc,getShapeStyle:tM,getLabelStyles:C4,Rect:eM,BBox:iM,mergeDefaults:Qc}=n4,Jc=class extends bS{constructor(t){super({moduleCtx:t,pickModes:[Jv.NEAREST_NODE,Jv.EXACT_SHAPE_MATCH]}),this.properties=new Ot}isLabelEnabled(){return(this.properties.labelKey!=null||this.nodes==null)&&this.properties.label.enabled}linkFactory(){return new Xs}nodeFactory(){return new eM}createNodeData(){const{id:t,_nodeDataDependencies:{seriesRectWidth:e,seriesRectHeight:i}={seriesRectWidth:0,seriesRectHeight:0}}=this,{fromKey:o,toKey:s,sizeKey:a,labelKey:n,label:{spacing:r},node:{spacing:l,width:c,alignment:h}}=this.properties,{nodeGraph:d,links:u,maxPathLength:g}=this.getNodeGraph(D=>({...D,x:NaN,y:NaN,width:c,height:NaN}),D=>({...D,x1:NaN,x2:NaN,y1:NaN,y2:NaN,height:NaN}),{includeCircularReferences:!1}),y=d,f=this.isLabelEnabled()?(e-c)*(1-g/(g+1)):0,x=(e-c-2*f)/(g-1),S=[];for(let D=0;D<g;D+=1){const I=f+D*x;S.push({index:D,size:0,nodes:[],x:I})}y.forEach(D=>{const{datum:I,linksBefore:L,linksAfter:C,maxPathLengthBefore:w,maxPathLengthAfter:P}=D,E=Math.max(L.reduce((N,{link:O})=>N+O.size,0),C.reduce((N,{link:O})=>N+O.size,0));if(L.length===0&&C.length===0||E===0){D.columnIndex=-1;return}let T;switch(h){case"left":T=S[w];break;case"right":T=S[g-1-P];break;case"center":{if(L.length!==0)T=S[w];else if(C.length!==0){const N=C.reduce((O,B)=>Math.min(O,B.node.maxPathLengthBefore),g)-1;T=S[N]}else T=S[0];break}case"justify":{T=C.length===0?S[g-1]:S[w];break}}I.x=T.x,I.size=E;const{label:R}=this.properties,_=R.enabled?this.getLabelText(I.label,I.datum,n,"label",[],this.properties.label,{datum:I.datum,value:I.label,fromKey:o,toKey:s,sizeKey:a,size:E}):void 0;I.label=_,T.nodes.push(D),T.size+=E,D.columnIndex=T.index}),y.forEach(D=>{let I=1/0,L=0;D.linksAfter.forEach(C=>{const w=C.node,{columnIndex:P}=w;P<I?(I=P,L=w.datum.size):P===I&&(L=Math.max(L,w.datum.size))}),D.closestColumnIndex=I,D.maxSizeOfClosestNodesAfter=L});const v=S.reduce((D,{size:I,nodes:L})=>{const C=(1-(L.length-1)*(l/i))/I;return Math.min(D,C)},1/0);for(let D=S.length-1;D>=0;D-=1)S[D].nodes.sort((L,C)=>L.closestColumnIndex-C.closestColumnIndex||L.maxSizeOfClosestNodesAfter-C.maxSizeOfClosestNodesAfter||L.datum.size-C.datum.size);y4(S,{seriesRectHeight:i,nodeSpacing:l,sizeScale:v});let m=!1;if(y.forEach(({datum:D,linksBefore:I,linksAfter:L})=>{m||(m=D.height<0);const C=D.y+D.height,w=T=>T.sort((R,_)=>{const N=R.node.datum,O=_.node.datum,B=N.y+N.height,z=O.y+O.height,V=Math.atan2(N.y-D.y,Math.abs(N.x-D.x))-Math.atan2(O.y-D.y,Math.abs(O.x-D.x)),F=Math.atan2(B-C,Math.abs(N.x-D.x))-Math.atan2(z-C,Math.abs(O.x-D.x));return V+F});let P=D.y;w(I).forEach(({link:T})=>{T.y2=P,P+=T.size*i*v});let E=D.y;w(L).forEach(({link:T})=>{T.y1=E,E+=T.size*i*v})}),m){r4.warnOnce("There was insufficient space to display the Sankey Series. Reduce the node spacing, or provide a larger container.");return}const b=[],M=[],{fontSize:k}=this.properties.label,A=l4(this.properties.label);return S.forEach((D,I)=>{const L=I===0,C=I===S.length-1;let w=-1/0;D.nodes.sort((P,E)=>P.datum.y-E.datum.y),D.nodes.forEach(({datum:P})=>{if(P.midPoint={x:P.x+P.width/2,y:P.y+P.height/2},b.push(P),P.label==null)return;const E=L?P.x-r:P.x+P.width+r,T=P.y+P.height/2;let R;if(!L&&!C){const B=c4(k),z=T-B,V=T+B;let F=e;y.forEach(({datum:W})=>{W.x>P.x&&Math.max(W.y,z)<=Math.min(W.y+W.height,V)&&(F=Math.min(F,W.x-r))});const H=F-P.x-2*r;R=Kv(P.label,{maxWidth:H,maxHeight:P.height,font:this.properties.label,textWrap:"never",overflow:"hide"})}if(R==null||R===""){const B=L||C?r:r*2;R=Kv(P.label,{maxWidth:x-B,maxHeight:P.height,font:this.properties.label,textWrap:"never"})}if(R==="")return;const{height:_}=A.measureText(R),N=T-_/2,O=T+_/2;N>=w&&(M.push({x:E,y:T,leading:L,text:R,size:P.size}),w=O)})}),u.forEach(D=>{const{fromNode:I,toNode:L,size:C}=D;D.height=i*C*v,D.x1=I.x+c,D.x2=L.x,D.midPoint={x:(D.x1+D.x2)/2,y:(D.y1+D.y2)/2+D.height/2},b.push(D)}),{itemId:t,nodeData:b,labelData:M}}updateLabelSelection(t){const e=this.isLabelEnabled()?t.labelData:[];return t.labelSelection.update(e)}updateLabelNodes(t){const e=this.ctx.highlightManager?.getActiveHighlight();t.labelSelection.each((i,o)=>{const{x:s,y:a,leading:n,text:r}=o,c=C4(this,void 0,o,this.properties.label,!1,e),{color:h,fontStyle:d,fontWeight:u,fontSize:g,fontFamily:y}=c;i.visible=!0,i.x=s,i.y=a,i.text=r,i.fill=h,i.fontStyle=d,i.fontWeight=u,i.fontSize=g,i.fontFamily=y,i.textAlign=n?"right":"left",i.textBaseline="middle",i.setBoxing(c)})}updateNodeSelection(t){return t.datumSelection.update(t.nodeData,void 0,e=>qc(e.type,e.id))}getNodeStyle({datumIndex:t,datum:e,size:i=0,label:o},s,a){const{id:n,properties:r}=this,{fills:l,strokes:c,defaultColorRange:h,defaultPatternFills:d,fillGradientDefaults:u,fillPatternDefaults:g,fillImageDefaults:y}=r,{itemStyler:f}=r.node,x=h[s%h.length].map(k=>({color:k})),S=d[s%d.length],v=this.getHighlightStyle(a,t),m=Qc(v,r.getStyle(!1,l,c,s)),b=r.node.fill!=null;let M=tM(m,b?u:{...u.toJson(),colorStops:x},b?g:{...g.toJson(),fill:S,stroke:S},y);if(f!=null&&t!=null){const k=this.cachedDatumCallback(qc(t.index,"node",a?"highlight":"node"),()=>{const A=this.ctx.highlightManager?.getActiveHighlight(),D=this.getHighlightStateString(A,a,t);return this.callWithContext(f,{seriesId:n,datum:e,highlighted:a,highlightState:D,...M,size:i,label:o})});k&&(M=Qc(k,M,{...u.toJson(),colorStops:x},{...g.toJson(),fill:S,stroke:S},y))}return M.opacity=1,M}updateNodeNodes(t){const{datumSelection:e,isHighlight:i}=t,o=this.getShapeFillBBox();e.each((s,a)=>{const{datumIndex:n}=a,r=this.getNodeStyle(a,n.index,i);s.x=a.x,s.y=a.y,s.width=Math.max(a.width,0),s.height=Math.max(a.height,0),Qv(s,r,o)})}getShapeFillBBox(){const t=this._nodeDataDependencies?.seriesRectWidth??0,e=this._nodeDataDependencies?.seriesRectHeight??0,i=new iM(0,0,t,e);return{series:i,axis:i}}updateLinkSelection(t){return t.datumSelection.update(t.nodeData,void 0,e=>qc(e.type,e.index,e.fromNode.id,e.toNode.id))}getLinkStyle({datumIndex:t,datum:e},i,o){const{id:s,properties:a}=this,{fills:n,strokes:r,defaultColorRange:l,defaultPatternFills:c,fillGradientDefaults:h,fillPatternDefaults:d,fillImageDefaults:u}=a,{itemStyler:g}=a.link,y=l[i.index%l.length].map(b=>({color:b})),f=c[i.index%c.length],x=this.getHighlightStyle(o,t),S=Qc(x,a.getStyle(!0,n,r,i.index)),v=a.link.fill!=null;let m=tM(S,v?h:{...h.toJson(),colorStops:y},v?d:{...d.toJson(),fill:f,stroke:f},u);if(g!=null&&t!=null){const b=this.cachedDatumCallback(qc(t.index,"link",o?"highlight":"node"),()=>{const M=this.ctx.highlightManager?.getActiveHighlight(),k=this.getHighlightStateString(M,o,t);return this.callWithContext(g,{seriesId:s,datum:e,highlighted:o,highlightState:k,...m})});b&&(m=Qc(b,m,{...h.toJson(),colorStops:y},{...d.toJson(),fill:f,stroke:f},u))}return m.opacity=1,m}updateLinkNodes(t){const{datumSelection:e,isHighlight:i}=t,o=this.getShapeFillBBox();e.each((s,a)=>{const n=a.fromNode.datumIndex,r=this.getLinkStyle(a,n,i);s.x1=a.x1,s.y1=a.y1,s.x2=a.x2,s.y2=a.y2,s.height=a.height,Qv(s,r,o),s.inset=s.strokeWidth/2})}getTooltipContent(t){const{id:e,linksProcessedData:i,nodesProcessedData:o,properties:s,ctx:{formatManager:a}}=this,{fromKey:n,toKey:r,sizeKey:l,sizeName:c,tooltip:h}=s,d=this.contextNodeData?.nodeData.find(v=>v.datumIndex.type===t.type&&v.datumIndex.index===t.index);if(d==null)return;const u=d.type===0?d.fromNode.index:d.index,g=d.type===0?`${d.fromNode.label} - ${d.toNode.label}`:d.label,y=t.type===0?i?.dataSources.get(this.id)?.[t.index]:o?.dataSources.get(this.id)?.[t.index],f=d.size;let x;if(d.type===0){const v=d.fromNode.datumIndex;x=this.getLinkStyle({datumIndex:t,datum:y},v,!1)}else x=this.getNodeStyle({datumIndex:t,datum:y},t.index,!1);const S=[];if(l!=null){const v=a.format(this.callWithContext.bind(this),{type:"number",value:f,datum:y,seriesId:e,legendItemName:void 0,key:l,source:"tooltip",property:"size",domain:[],boundSeries:this.getFormatterContext("size"),fractionDigits:void 0});S.push({label:c,fallbackLabel:l,value:v??String(f)})}return this.formatTooltipWithContext(h,{title:g,symbol:this.legendItemSymbol(d.type,u,x),data:S},{seriesId:e,datum:y,title:g,fromKey:n,toKey:r,sizeKey:l,sizeName:c,size:f,...x})}computeFocusBounds(t){if(t instanceof eM){const{x:e,y:i,width:o,height:s}=t,a=new iM(e,i,o,s);return I4.toCanvas(this.contentGroup,a)}return t}hasItemStylers(){return this.properties.node.itemStyler!=null||this.properties.link.itemStyler!=null}};Jc.className="SankeySeries",Jc.type="sankey";import{_ModuleSupport as T4}from"ag-charts-community";import{arrayOf as Pu,color as oM,constant as w4,fillGradientDefaults as N4,fillImageDefaults as P4,fillPatternDefaults as E4,required as Eu,string as th,undocumented as er}from"ag-charts-core";var{commonSeriesOptionsDefs:_4,sankeySeriesThemeableOptionsDef:O4}=T4,Qa={...O4,..._4,type:Eu(w4("sankey")),fromKey:Eu(th),toKey:Eu(th),sizeKey:th,sizeName:th};Qa.fillGradientDefaults=er(N4),Qa.fillPatternDefaults=er(E4),Qa.fillImageDefaults=er(P4),Qa.defaultColorRange=er(Pu(Pu(oM))),Qa.defaultPatternFills=er(Pu(oM));var R4={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["standalone"],solo:!0,identifier:"sankey",moduleFactory:t=>new Jc(t),themeTemplate:{seriesArea:{padding:{top:10,bottom:10}},series:{fills:{$palette:"fills"},strokes:{$palette:"strokes"},fillGradientDefaults:Za.FILL_GRADIENT_LINEAR_DEFAULTS,fillPatternDefaults:Za.FILL_PATTERN_DEFAULTS,fillImageDefaults:Za.FILL_IMAGE_DEFAULTS,defaultColorRange:{$palette:"gradients"},defaultPatternFills:Za.SAFE_FILLS_OPERATION,highlightStyle:{series:{dimOpacity:.2}},highlight:{...Za.singleSeriesHighlightStyle()},label:{...Za.LABEL_BOXING_DEFAULTS,fontFamily:{$ref:"fontFamily"},fontSize:{$ref:"fontSize"},fontWeight:{$ref:"fontWeight"},color:{$ref:"textColor"},spacing:10},node:{spacing:20,width:10,strokeWidth:{$isUserOption:["./stroke",2,0]}},link:{fillOpacity:.5,strokeWidth:{$isUserOption:["./stroke",2,0]}}},legend:{enabled:!1,toggleSeries:!1}}},B4={type:"series",name:"sankey",chartType:"standalone",enterprise:!0,options:Qa,create:t=>new Jc(t)};import{_ModuleSupport as Zs}from"ag-charts-community";import{_ModuleSupport as ir}from"ag-charts-community";import{_ModuleSupport as z4}from"ag-charts-community";var{HierarchySeriesProperties:F4,HighlightStyle:V4,makeSeriesTooltip:H4,Property:Rt}=z4,es=class extends V4{constructor(){super(!1),this.label=new Hi,this.secondaryLabel=new Hi}};p([Rt],es.prototype,"fill",2),p([Rt],es.prototype,"fillOpacity",2),p([Rt],es.prototype,"stroke",2),p([Rt],es.prototype,"strokeWidth",2),p([Rt],es.prototype,"strokeOpacity",2),p([Rt],es.prototype,"label",2),p([Rt],es.prototype,"secondaryLabel",2);var Le=class extends F4{constructor(){super(...arguments),this.fillOpacity=1,this.strokeWidth=0,this.strokeOpacity=1,this.cornerRadius=0,this.highlightStyle=new es,this.label=new Hi,this.secondaryLabel=new Cn,this.tooltip=H4()}getStyle(t){const{fills:e,strokes:i,fillOpacity:o,strokeWidth:s,strokeOpacity:a}=this;return{fill:e[t%e.length],fillOpacity:o,stroke:i[t%i.length],strokeWidth:s,strokeOpacity:a,opacity:1}}};p([Rt],Le.prototype,"sizeName",2),p([Rt],Le.prototype,"labelKey",2),p([Rt],Le.prototype,"secondaryLabelKey",2),p([Rt],Le.prototype,"fillOpacity",2),p([Rt],Le.prototype,"strokeWidth",2),p([Rt],Le.prototype,"strokeOpacity",2),p([Rt],Le.prototype,"cornerRadius",2),p([Rt],Le.prototype,"sectorSpacing",2),p([Rt],Le.prototype,"padding",2),p([Rt],Le.prototype,"itemStyler",2),p([Rt],Le.prototype,"highlightStyle",2),p([Rt],Le.prototype,"label",2),p([Rt],Le.prototype,"secondaryLabel",2),p([Rt],Le.prototype,"tooltip",2);var{fromToMotion:G4,normalizeAngle360:W4,createDatumId:K4,PointerEvents:$4,Sector:sM,Group:eh,ScalableGroup:j4,Selection:_u,TransformableText:Ou,BBox:aM,applyShapeStyle:Y4,mergeDefaults:nM,formatValue:rM,getLabelStyles:U4}=ir,X4=class extends ir.HierarchyNode{constructor(){super(...arguments),this.label=void 0,this.secondaryLabel=void 0,this.contentHeight=0,this.bbox=void 0,this.startAngle=0,this.endAngle=0}};function lM(t,e=0,i=2*Math.PI/t.sumSize){for(const o of t.children){const s=e+o.sumSize*i;o.startAngle=e,o.endAngle=s,lM(o,e,i),e=s}}var ih=class extends ir.HierarchySeries{constructor(t){super(t),this.NodeClass=X4,this.properties=new Le,this.scalingGroup=this.contentGroup.appendChild(new j4),this.sectorGroup=this.scalingGroup.appendChild(new eh),this.sectorLabelGroup=this.scalingGroup.appendChild(new eh),this.highlightSectorGroup=this.scalingGroup.appendChild(new eh),this.datumSelection=_u.select(this.sectorGroup,sM),this.labelSelection=_u.select(this.sectorLabelGroup,eh),this.highlightSelection=_u.select(this.highlightSectorGroup,sM),this.sectorLabelGroup.pointerEvents=$4.None}processData(){super.processData(),lM(this.rootNode)}updateSelections(){const t=this.ctx.highlightManager?.getActiveHighlight();if(this.highlightSelection.update(t!=null?[t]:[],void 0,a=>this.getDatumId(a)),!this.nodeDataRefresh)return;this.nodeDataRefresh=!1;const{chart:e}=this;if(e==null||e.seriesRect==null)return;const o=Array.from(this.rootNode),s=a=>{a.append([new Ou({tag:0}),new Ou({tag:1})])};this.datumSelection.update(o,void 0,a=>this.getDatumId(a)),this.labelSelection.update(o,s,a=>this.getDatumId(a))}getItemStyle(t,e){const{id:i,properties:o,colorScale:s}=this,{itemStyler:a}=o,n=t.datumIndex?.[0]??0,r=e?o.highlightStyle:void 0,l=nM(r,o.getStyle(n));!e&&t.colorValue!=null&&(l.fill=s.convert(t.colorValue));let c=l;if(a!=null&&t!=null){const h=this.ctx.highlightManager?.getActiveHighlight(),d=this.cachedDatumCallback(K4(this.getDatumId(t),e?"highlight":"node"),()=>{const u=this.getHighlightStateString(h,e,t.datumIndex);return this.callWithContext(a,{seriesId:i,datum:t.datum,depth:t.depth??0,highlighted:e,highlightState:u,...c})});d&&(c=nM(d,c))}return c}updateNodes(){const{chart:t,data:e,maxDepth:i}=this;if(t==null||e==null)return;const{width:o,height:s}=t.seriesRect,{sectorSpacing:a=0,padding:n=0,cornerRadius:r,childrenKey:l,colorKey:c,colorName:h,labelKey:d,secondaryLabelKey:u,sizeKey:g,sizeName:y}=this.properties;this.contentGroup.translationX=o/2,this.contentGroup.translationY=s/2;const f=a*.5,x=Math.min(o,s)/2,S=x/(i+1),v=-Math.PI/2,m={series:new aM(-x,-x,2*x,2*x),axis:new aM(-x,-x,2*x,2*x)};this.rootNode?.walk(A=>{const{startAngle:D,endAngle:I}=A;if(A.depth!=null){const L=(D+I)/2+v,C=(A.depth+.5)*S;A.midPoint.x=Math.cos(L)*C,A.midPoint.y=Math.sin(L)*C}}),this.rootNode?.walk(A=>{const{datum:D,depth:I,startAngle:L,endAngle:C,parent:w,sumSize:P}=A;A.label=void 0,A.secondaryLabel=void 0,A.contentHeight=0;let E;if(D!=null&&I!=null&&d!=null){const tt=D[d];E=this.getLabelText(tt,D,d,"label",[],this.properties.label,{depth:I,datum:D,childrenKey:l,colorKey:c,colorName:h,labelKey:d,secondaryLabelKey:u,sizeKey:g,sizeName:y,value:tt})}E===""&&(E=void 0);let T;if(D!=null&&I!=null&&u!=null){const tt=D[u];T=this.getLabelText(tt,D,u,"secondaryLabel",[],this.properties.secondaryLabel,{depth:I,datum:D,childrenKey:l,colorKey:c,colorName:h,labelKey:d,secondaryLabelKey:u,sizeKey:g,sizeName:y,value:tt})}if(T===""&&(T=void 0),I==null)return;const R=I*S+f,_=(I+1)*S-f,N=R>f?f/R:f,O=_>f?f/_:f,B=L+N,V=C+N-B,F=L+O,W=C+O-F,G=tt=>{if(I===0&&w?.sumSize===P)return{width:2*Math.sqrt(_**2-(tt*.5)**2),height:tt,meta:0};const ct=tt,gt=2*Math.sqrt(_**2-(R+ct)**2),Tt=V<Math.PI?2*R*Math.tan(V*.5):1/0,Re=Math.min(gt,Tt),as=Math.PI/4;let gi,wi;return I===0?(gi=tt,wi=Math.sqrt(_**2-(gi/2)**2)-tt/(2*Math.tan(W*.5))):W4(V)<as?(gi=2*R*Math.tan(V*.5),wi=Math.sqrt(_**2-(gi/2)**2)-R):(wi=0,gi=0),Re>=wi?{width:Re,height:ct,meta:1}:{width:wi,height:gi,meta:2}},K=$p(E,this.properties.label,T,this.properties.secondaryLabel,{padding:n},G);if(K==null)return;const{width:Y,height:st,meta:nt,label:X,secondaryLabel:Z}=K,Q=v+(L+C)/2,pt=Math.sin(Q)>=0,ot=Math.cos(Q)>=0,q=(pt?3:12)&(ot?6:9);let dt;switch(nt){case 0:dt=0;break;case 1:{const ut=_-(S-st)*.58,ct=Math.sqrt((_-n)**2-(Y/2)**2);dt=Math.min(ut,ct);break}case 2:if(I===0){const tt=st/(2*Math.tan(V*.5))+Y*.5,ut=Math.sqrt(_**2-(st*.5)**2)-Y*.5;dt=(tt+ut)*.5}else dt=(R+_)*.5;break}if(X!=null){const{fontStyle:tt="normal",fontFamily:ut,fontWeight:ct="normal",color:gt="black"}=this.properties.label;A.label={...X,fontStyle:tt,fontFamily:ut,fontWeight:ct,color:gt,labelPlacement:nt,circleQuarter:q,radius:dt,theta:Q}}if(Z!=null){const{fontStyle:tt="normal",fontFamily:ut,fontWeight:ct="normal",color:gt="black"}=this.properties.secondaryLabel;A.secondaryLabel={...Z,fontStyle:tt,fontFamily:ut,fontWeight:ct,color:gt,labelPlacement:nt,circleQuarter:q,radius:dt,theta:Q}}A.contentHeight=K.height});const b=(A,D,I)=>{const{depth:L,startAngle:C,endAngle:w}=A;if(L==null){D.visible=!1;return}D.visible=!0;const P=this.getItemStyle(A,I),E=P.fill,T=P.strokeWidth,R=ir.isGradientFill(E)&&E.bounds!=="item"?m:void 0;Y4(D,P,R),D.centerX=0,D.centerY=0,D.innerRadius=L*S,D.outerRadius=(L+1)*S,D.startAngle=C+v,D.endAngle=w+v,D.inset=f+T*.5,D.cornerRadius=r};this.datumSelection.each((A,D)=>{b(D,A,!1)}),this.highlightSelection.each((A,D)=>{b(D,A,!0)});const M=(A,D,I,L)=>{const{depth:C,contentHeight:w}=A,P=I===0,E=P?A.label:A.secondaryLabel;if(C==null||E==null){D.visible=!1;return}const{labelPlacement:T,circleQuarter:R,radius:_,theta:N}=E;let O;L&&(O=(P?this.properties.highlightStyle.label:this.properties.highlightStyle.secondaryLabel).color);const B={childrenKey:this.properties.childrenKey,colorKey:this.properties.colorKey,colorName:this.properties.colorName??this.properties.colorKey,depth:A.depth??NaN,labelKey:this.properties.labelKey,secondaryLabelKey:this.properties.secondaryLabelKey,sizeKey:this.properties.sizeKey,sizeName:this.properties.sizeName??this.properties.sizeKey},z=P?this.properties.label:this.properties.secondaryLabel,V=this.ctx.highlightManager?.getActiveHighlight(),F=U4(this,A,B,z,L,V);switch(D.text=E.text,D.fontSize=E.fontSize,D.lineHeight=E.lineHeight,D.fontStyle=E.fontStyle,D.fontFamily=E.fontFamily,D.fontWeight=E.fontWeight,D.fill=O??E.color,D.fillOpacity=this.getHighlightStyle(L,A.datumIndex)?.opacity??1,D.setBoxing(F),T){case 0:D.textAlign="center",D.textBaseline="top",D.translationX=0,D.translationY=(P?0:w-E.height)-w*.5,D.rotation=0;break;case 1:{const H=(R&3)!==0,W=P===!H?_:_-(w-E.height);D.textAlign="center",D.textBaseline=H?"bottom":"top",D.translationX=Math.cos(N)*W,D.translationY=Math.sin(N)*W,D.rotation=H?N-Math.PI*.5:N+Math.PI*.5;break}case 2:{const H=(R&6)!==0,W=P===!H?(w-E.height)*.5:(E.height-w)*.5;D.textAlign="center",D.textBaseline="middle",D.translationX=Math.cos(N)*_+Math.cos(N+Math.PI/2)*W,D.translationY=Math.sin(N)*_+Math.sin(N+Math.PI/2)*W,D.rotation=H?N:N+Math.PI;break}}D.visible=!0},k=this.ctx.highlightManager?.getActiveHighlight();this.labelSelection.selectByClass(Ou).forEach(A=>{const D=A.closestDatum();M(D,A,A.tag,D===k)})}getTooltipContent(t){const{id:e,properties:i,ctx:o}=this,{labelKey:s,secondaryLabelKey:a,childrenKey:n,sizeKey:r,sizeName:l,colorKey:c,colorName:h,tooltip:d}=i,{formatManager:u}=o,g=t.reduce((k,A)=>k?.children[A],this.rootNode);if(g==null)return;const{datum:y,depth:f}=g;if(y==null||f==null)return;const x=[],S=r!=null?y[r]:void 0;if(S!=null){const k=[0,this.rootNode?.sumSize??0],A=u.format(this.callWithContext.bind(this),{type:"number",value:S,datum:y,seriesId:e,legendItemName:void 0,key:r,source:"tooltip",property:"size",boundSeries:this.getFormatterContext("size"),domain:k,fractionDigits:void 0});x.push({label:l,fallbackLabel:r,value:A??rM(S)})}const v=c!=null?y[c]:void 0;if(v!=null){const{colorDomain:k}=this,A=u.format(this.callWithContext.bind(this),{type:"number",value:v,datum:y,seriesId:e,legendItemName:void 0,key:c,source:"tooltip",property:"color",boundSeries:this.getFormatterContext("color"),domain:k,fractionDigits:void 0});x.push({label:h,fallbackLabel:c,value:A??rM(v)})}const m=this.getItemStyle({...g,colorValue:v??g.colorValue},!1),M={shape:"square",fill:m.fill,fillOpacity:1,stroke:void 0,strokeWidth:0,strokeOpacity:1,lineDash:[0],lineDashOffset:0};return ir.isGradientFill(M.fill)&&(M.fill={...M.fill,gradient:"linear",rotation:0,reverse:!1}),this.formatTooltipWithContext(d,{title:s!=null?y[s]:void 0,symbol:{marker:M},data:x},{seriesId:e,datum:y,title:void 0,depth:f,labelKey:s,secondaryLabelKey:a,childrenKey:n,sizeKey:r,sizeName:l,colorKey:c,colorName:h,...m})}createNodeData(){}pickNodeClosestDatum(t){return this.pickNodeNearestDistantObject(t,this.datumSelection.nodes())}animateEmptyUpdateReady(){G4(this.id,"nodes",this.ctx.animationManager,[this.scalingGroup],{toFn(){return{scalingX:1,scalingY:1}},fromFn(){return{scalingX:0,scalingY:0}}})}computeFocusBounds(t){return t}hasItemStylers(){return this.properties.itemStyler!=null}};ih.className="SunburstSeries",ih.type="sunburst";import{_ModuleSupport as Z4}from"ag-charts-community";import{constant as q4,required as Q4,string as qs}from"ag-charts-core";var{commonSeriesOptionsDefs:J4,sunburstSeriesThemeableOptionsDef:tK,without:eK}=Z4,iK={...tK,...eK(J4,["highlightStyle","highlight","showInLegend"]),type:Q4(q4("sunburst")),labelKey:qs,secondaryLabelKey:qs,childrenKey:qs,sizeKey:qs,colorKey:qs,sizeName:qs,colorName:qs},{BASE_FONT_SIZE:cM,FONT_SIZE_RATIO:hM}=Zs,oK={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["standalone"],identifier:"sunburst",moduleFactory:t=>new ih(t),solo:!0,themeTemplate:{series:{fills:{$applyCycle:[{$size:{$path:["./data",{$path:"/data"}]}},{$palette:"fills"},{$applySwitch:[{$path:["/type",void 0,{$value:"$1"}]},{$value:"$1"},["gradient",Zs.FILL_GRADIENT_RADIAL_REVERSED_SERIES_DEFAULTS],["pattern",Zs.FILL_PATTERN_DEFAULTS],["image",Zs.FILL_IMAGE_DEFAULTS]]}]},strokes:{$applyCycle:[{$size:{$path:["./data",{$path:"/data"}]}},{$palette:"strokes"}]},colorRange:{$palette:"divergingColors"},strokeWidth:{$isUserOption:["./strokes/0",2,0]},label:{...Zs.LABEL_BOXING_DEFAULTS,fontFamily:{$ref:"fontFamily"},fontSize:{$rem:hM.LARGE},minimumFontSize:{$rem:9/cM},fontWeight:{$ref:"fontWeight"},color:{$ref:"chartBackgroundColor"},overflowStrategy:"ellipsis",wrapping:"never",spacing:2},secondaryLabel:{...Zs.LABEL_BOXING_DEFAULTS,fontFamily:{$ref:"fontFamily"},fontSize:{$rem:hM.SMALLEST},minimumFontSize:{$rem:7/cM},fontWeight:{$ref:"fontWeight"},color:{$ref:"chartBackgroundColor"},overflowStrategy:"ellipsis",wrapping:"never"},sectorSpacing:2,padding:3,highlightStyle:{label:{color:{$ref:"chartBackgroundColor"}},secondaryLabel:{color:{$ref:"chartBackgroundColor"}},fill:"rgba(255,255,255, 0.33)",stroke:"rgba(0, 0, 0, 0.4)",strokeWidth:2}},gradientLegend:{enabled:!0,...Zs.LEGEND_CONTAINER_THEME}}},sK={type:"series",name:"sunburst",chartType:"standalone",enterprise:!0,options:iK,create:t=>new ih(t)};import{_ModuleSupport as is}from"ag-charts-community";import{_ModuleSupport as or}from"ag-charts-community";import{cachedTextMeasurer as aK,calcLineHeight as nK,isNumberEqual as rK,wrapText as lK}from"ag-charts-core";import{_ModuleSupport as cK}from"ag-charts-community";var{BaseProperties:oh,HierarchySeriesProperties:hK,HighlightStyle:pK,makeSeriesTooltip:dK,Property:U,Label:uK}=cK,pM=class extends uK{constructor(){super(...arguments),this.spacing=0}};p([U],pM.prototype,"spacing",2);var ui=class extends oh{constructor(){super(...arguments),this.fill=void 0,this.fillOpacity=1,this.strokeWidth=1,this.strokeOpacity=1,this.cornerRadius=0,this.textAlign="center",this.gap=0,this.padding=0,this.interactive=!0,this.label=new pM}};p([U],ui.prototype,"fill",2),p([U],ui.prototype,"fillOpacity",2),p([U],ui.prototype,"stroke",2),p([U],ui.prototype,"strokeWidth",2),p([U],ui.prototype,"strokeOpacity",2),p([U],ui.prototype,"cornerRadius",2),p([U],ui.prototype,"textAlign",2),p([U],ui.prototype,"gap",2),p([U],ui.prototype,"padding",2),p([U],ui.prototype,"interactive",2),p([U],ui.prototype,"label",2);var Xe=class extends oh{constructor(){super(...arguments),this.fill=void 0,this.fillOpacity=1,this.strokeWidth=1,this.strokeOpacity=1,this.cornerRadius=0,this.textAlign="center",this.verticalAlign="middle",this.gap=0,this.padding=0,this.label=new Hi,this.secondaryLabel=new Cn}};p([U],Xe.prototype,"fill",2),p([U],Xe.prototype,"fillOpacity",2),p([U],Xe.prototype,"stroke",2),p([U],Xe.prototype,"strokeWidth",2),p([U],Xe.prototype,"strokeOpacity",2),p([U],Xe.prototype,"cornerRadius",2),p([U],Xe.prototype,"textAlign",2),p([U],Xe.prototype,"verticalAlign",2),p([U],Xe.prototype,"gap",2),p([U],Xe.prototype,"padding",2),p([U],Xe.prototype,"label",2),p([U],Xe.prototype,"secondaryLabel",2);var Qs=class extends oh{constructor(){super(...arguments),this.label=new Hi}};p([U],Qs.prototype,"fill",2),p([U],Qs.prototype,"fillOpacity",2),p([U],Qs.prototype,"stroke",2),p([U],Qs.prototype,"strokeWidth",2),p([U],Qs.prototype,"strokeOpacity",2),p([U],Qs.prototype,"label",2);var os=class extends oh{constructor(){super(...arguments),this.label=new Hi,this.secondaryLabel=new Cn}};p([U],os.prototype,"fill",2),p([U],os.prototype,"fillOpacity",2),p([U],os.prototype,"stroke",2),p([U],os.prototype,"strokeWidth",2),p([U],os.prototype,"strokeOpacity",2),p([U],os.prototype,"label",2),p([U],os.prototype,"secondaryLabel",2);var Ru=class extends pK{constructor(){super(!1),this.group=new Qs,this.tile=new os}getStyle(t){return t?this.tile:this.group}};p([U],Ru.prototype,"group",2),p([U],Ru.prototype,"tile",2);var Ti=class extends hK{constructor(){super(...arguments),this.highlightStyle=new Ru,this.tooltip=dK(),this.group=new ui,this.tile=new Xe,this.undocumentedGroupFills=[],this.undocumentedGroupStrokes=[]}getStyle(t,e,i,o){const{fillOpacity:s,strokeWidth:a,strokeOpacity:n,fill:r=t?e[o%e.length]:e[Math.min(o,e.length)],stroke:l=t?i[o%e.length]:i[Math.min(o,i.length)]}=t?this.tile:this.group;return{fill:r,fillOpacity:s,stroke:l,strokeWidth:a,strokeOpacity:n,opacity:1}}};p([U],Ti.prototype,"sizeName",2),p([U],Ti.prototype,"labelKey",2),p([U],Ti.prototype,"secondaryLabelKey",2),p([U],Ti.prototype,"itemStyler",2),p([U],Ti.prototype,"highlightStyle",2),p([U],Ti.prototype,"tooltip",2),p([U],Ti.prototype,"group",2),p([U],Ti.prototype,"tile",2),p([U],Ti.prototype,"undocumentedGroupFills",2),p([U],Ti.prototype,"undocumentedGroupStrokes",2);var{createDatumId:gK,Rect:dM,Group:uM,BBox:Ja,Selection:Bu,Text:zu,Transformable:yK,applyShapeStyle:fK,getLabelStyles:mK,mergeDefaults:gM,formatValue:yM}=or,xK=class extends or.HierarchyNode{constructor(){super(...arguments),this.labelValue=void 0,this.secondaryLabelValue=void 0,this.label=void 0,this.secondaryLabel=void 0,this.bbox=void 0,this.padding=void 0}};function ss(t){return t.children.length>0?t.sumSize-t.sizeValue:t.sizeValue}var fM={left:0,center:.5,right:1},SK={top:0,middle:.5,bottom:1},QX=class extends or.Group{distanceSquared(t,e){return this.getBBox().distanceSquared(t,e)}},sh=class extends or.HierarchySeries{constructor(){super(...arguments),this.NodeClass=xK,this.properties=new Ti,this.rectGroup=this.contentGroup.appendChild(new uM),this.datumSelection=Bu.select(this.rectGroup,dM),this.labelSelection=Bu.select(this.labelGroup,uM),this.highlightSelection=Bu.select(this.rectGroup,dM)}groupTitleHeight(t,e){const{labelValue:i}=t,{label:o}=this.properties.group,s=3;if(i!=null){if(o.fontSize>e.width/s||o.fontSize>e.height/s)return;{const{height:a}=aK(o).measureLines(i);return Math.max(a,o.fontSize)}}}getNodePadding(t,e){if(t.parent==null)return{top:0,right:0,bottom:0,left:0};if(t.children.length===0){const{padding:n}=this.properties.tile;return{top:n,right:n,bottom:n,left:n}}const{label:{spacing:i},padding:o}=this.properties.group,s=this.groupTitleHeight(t,e),a=s!=null?s+i:0;return{top:o+a,right:o,bottom:o,left:o}}sortChildren({children:t}){const e=Array.from(t,(o,s)=>s).filter(o=>ss(t[o])>0).sort((o,s)=>ss(t[s])-ss(t[o]));return{sortedChildrenIndices:e,childAt:o=>{const s=e[o];return t[s]}}}squarify(t,e){const{datum:i,children:o}=t;if(e.width<=0||e.height<=0){t.bbox=void 0,t.padding=void 0,t.midPoint.x=NaN,t.midPoint.y=NaN;return}const s=i!=null?this.getNodePadding(t,e):{top:0,right:0,bottom:0,left:0};t.parent==null?(t.bbox=void 0,t.padding=void 0,t.midPoint.x=NaN,t.midPoint.y=NaN):(t.bbox=e,t.padding=s,t.midPoint.x=e.x+e.width/2,t.midPoint.y=e.y);const{sortedChildrenIndices:a,childAt:n}=this.sortChildren(t),r=a.every(M=>o[M].children.length===0),l=1,c=e.width-s.left-s.right,h=e.height-s.top-s.bottom;if(c<=0||h<=0)return;const d=a.length;let u=0,g=0,y=1/0,f=a.reduce((M,k)=>M+ss(o[k]),0);const x=new Ja(e.x+s.left,e.y+s.top,c,h),S=x.clone();let v=0;for(;v<d;){const M=ss(n(v)),k=ss(n(g)),A=S.width<S.height;u+=M;const D=A?S.height:S.width,I=A?S.width:S.height,L=I*k/u;let C=D*u/f;const w=Math.max(L,C)/Math.min(L,C),P=Math.abs(l-w);if(P<y){y=P,v++;continue}u-=M,C=D*u/f;let E=A?S.x:S.y;for(let T=g;T<v;T++){const R=n(T),_=ss(R),N=A?E:S.x,O=A?S.y:E,B=I*_/u,z=A?B:C,V=A?C:B,F=new Ja(N,O,z,V);this.applyGap(x,F,r),this.squarify(R,F),f-=_,E+=B}A?(S.y+=C,S.height-=C):(S.x+=C,S.width-=C),g=v,u=0,y=1/0}const m=S.width<S.height;let b=m?S.x:S.y;for(let M=g;M<d;M++){const k=n(M),A=m?b:S.x,D=m?S.y:b,I=ss(k)/f,L=S.width*(m?I:1),C=S.height*(m?1:I),w=new Ja(A,D,L,C);this.applyGap(x,w,r),this.squarify(k,w),b+=m?L:C}}applyGap(t,e,i){const o=i?this.properties.tile.gap*.5:this.properties.group.gap*.5,s=l=>({left:l.x,top:l.y,right:l.x+l.width,bottom:l.y+l.height}),a=s(t),n=s(e);["top","right","bottom","left"].forEach(l=>{rK(a[l],n[l])||e.shrink(o,l)})}createNodeData(){}getItemStyle(t,e,i){const{id:o,properties:s,colorScale:a,ctx:n}=this,{itemStyler:r}=s,l=t.datumIndex?.[0]??0,c=e?s.fills:s.undocumentedGroupFills,h=e?s.strokes:s.undocumentedGroupStrokes,d=e?l:t.depth??-1,u=i?s.highlightStyle.getStyle(e):void 0,g=gM(u,s.getStyle(e,c,h,d));!i&&e&&t.colorValue!=null&&(g.fill=a.convert(t.colorValue));let y=g;if(r!=null&&t!=null){const f=this.cachedDatumCallback(gK(this.getDatumId(t),i?"highlight":"node"),()=>{const x=n.highlightManager?.getActiveHighlight(),S=this.getHighlightStateString(x,i,t.datumIndex);return this.callWithContext(r,{seriesId:o,datum:t.datum,depth:t.depth??-1,highlighted:i,highlightState:S,...y})});f&&(y=gM(f,y))}return y}updateSelections(){let t=this.ctx.highlightManager?.getActiveHighlight();if(t!=null&&!this.properties.group.interactive&&t.children.length!==0&&(t=void 0),this.highlightSelection.update(t!=null?[t]:[],void 0,s=>this.getDatumId(s)),!this.nodeDataRefresh)return;this.nodeDataRefresh=!1;const{seriesRect:e}=this.chart??{};if(!e)return;const i=Array.from(this.rootNode),o=s=>{s.append([new zu({tag:0}),new zu({tag:1})])};this.datumSelection.update(i,void 0,s=>this.getDatumId(s)),this.labelSelection.update(i,o,s=>this.getDatumId(s))}updateNodes(){const{rootNode:t,data:e}=this,{childrenKey:i,colorKey:o,colorName:s,labelKey:a,secondaryLabelKey:n,sizeKey:r,sizeName:l,highlightStyle:c,tile:h,group:d}=this.properties,{seriesRect:u}=this.chart??{};if(!u||!e)return;this.rootNode?.walk(m=>{const{datum:b,depth:M,children:k}=m,A=k.length===0,D=A?h.label:d.label;let I;if(D.enabled&&b!=null&&M!=null&&a!=null){const C=b[a];I=this.getLabelText(C,b,a,"label",[],D,{depth:M,datum:b,childrenKey:i,colorKey:o,colorName:s,labelKey:a,secondaryLabelKey:n,sizeKey:r,sizeName:l,value:C})}I===""&&(I=void 0);let L;if(h.secondaryLabel.enabled&&A&&b!=null&&M!=null&&n!=null){const C=b[n];L=this.getLabelText(C,b,n,"secondaryLabel",[],h.secondaryLabel,{depth:M,datum:b,childrenKey:i,colorKey:o,colorName:s,labelKey:a,secondaryLabelKey:n,sizeKey:r,sizeName:l,value:C})}L===""&&(L=void 0),m.labelValue=I,m.secondaryLabelValue=L});const{width:g,height:y}=u;this.squarify(t,new Ja(0,0,g,y)),this.rootNode?.walk(m=>{const{bbox:b,children:M,labelValue:k,secondaryLabelValue:A}=m;if(m.label=void 0,m.secondaryLabel=void 0,b!=null)if(M.length===0){const D={width:b.width,height:b.height,meta:null},I=$p(k,this.properties.tile.label,A,this.properties.tile.secondaryLabel,{padding:h.padding},()=>D);if(I==null)return;const{height:L,label:C,secondaryLabel:w}=I,{textAlign:P,verticalAlign:E,padding:T}=h,R=fM[P]??.5,_=b.x+T+(b.width-2*T)*R,N=SK[E]??.5,O=b.y+T+L*.5+(b.height-2*T-L)*N;if(C!=null){const{fontStyle:B="normal",fontFamily:z,fontWeight:V="normal",color:F="black"}=this.properties.tile.label;m.label={text:C.text,fontSize:C.fontSize,lineHeight:C.lineHeight,fontStyle:B,fontFamily:z,fontWeight:V,color:F,textAlign:P,verticalAlign:"middle",x:_,y:O-(L-C.height)*.5}}if(w!=null){const{fontStyle:B="normal",fontFamily:z,fontWeight:V="normal",color:F="black"}=this.properties.tile.secondaryLabel;m.secondaryLabel={text:w.text,fontSize:w.fontSize,lineHeight:w.fontSize,fontStyle:B,fontFamily:z,fontWeight:V,color:F,textAlign:P,verticalAlign:"middle",x:_,y:O+(L-w.height)*.5}}}else{if(k==null)return;{const{padding:D,textAlign:I}=d,L=this.groupTitleHeight(m,b);if(L==null)return;const C=b.width-2*D,w=lK(k,{maxWidth:b.width-2*D,font:d.label,textWrap:"never"}),P=fM[I]??.5,{fontStyle:E="normal",fontFamily:T,fontWeight:R="normal",color:_="black"}=this.properties.group.label;m.label={text:w,fontSize:d.label.fontSize,lineHeight:nK(d.label.fontSize),fontStyle:E,fontFamily:T,fontWeight:R,color:_,textAlign:I,verticalAlign:"middle",x:b.x+D+C*P,y:b.y+D+L*.5}}}});const f={series:new Ja(0,0,g,y),axis:new Ja(0,0,g,y)},x=(m,b,M)=>{const{bbox:k}=m;if(k==null){b.visible=!1;return}const{depth:A=-1}=m,D=m.children.length===0,I=this.getItemStyle(m,D,M);b.crisp=!0,fK(b,I,f),b.cornerRadius=D?h.cornerRadius:d.cornerRadius,b.zIndex=[0,A,M?1:0];const L=m.parent?.children.every(P=>P.children.length===0),C=m.parent!=null?m.parent.bbox:void 0,w=m.parent!=null?m.parent.padding:void 0;L===!0&&C!=null&&w!=null?(b.clipBBox=k,b.x=C.x+w.left,b.y=C.y+w.top,b.width=C.width-(w.left+w.right),b.height=C.height-(w.top+w.bottom)):(b.clipBBox=void 0,b.x=k.x,b.y=k.y,b.width=k.width,b.height=k.height),b.visible=!0};this.datumSelection.each((m,b)=>x(b,m,!1)),this.highlightSelection.each((m,b)=>{x(b,m,!0)});const S=(m,b,M,k)=>{const A=m.children.length===0,D=M===0?m.label:m.secondaryLabel;if(D==null){b.visible=!1;return}const I=M===0?h.label:h.secondaryLabel;let L;if(k){const{tile:E,group:T}=c;L=E.secondaryLabel.color,A?M===0&&(L=E.label.color):L=T.label.color}const C={childrenKey:this.properties.childrenKey,colorKey:this.properties.colorKey,colorName:this.properties.colorName??this.properties.colorKey,depth:m.depth??NaN,labelKey:this.properties.labelKey,secondaryLabelKey:this.properties.secondaryLabelKey,sizeKey:this.properties.sizeKey,sizeName:this.properties.sizeName??this.properties.sizeKey},w=this.ctx.highlightManager?.getActiveHighlight(),P=mK(this,m,C,I,k,w);b.text=D.text,b.fontSize=D.fontSize,b.lineHeight=D.lineHeight,b.fontStyle=D.fontStyle,b.fontFamily=D.fontFamily,b.fontWeight=D.fontWeight,b.fill=L??D.color,b.fillOpacity=this.getHighlightStyle(k,m.datumIndex)?.opacity??1,b.textAlign=D.textAlign,b.textBaseline=D.verticalAlign,b.x=D.x,b.y=D.y,b.setBoxing(P),b.visible=!0,b.zIndex=1},v=this.ctx.highlightManager?.getActiveHighlight();this.labelSelection.selectByClass(zu).forEach(m=>{const b=m.closestDatum();S(b,m,m.tag,b===v)})}pickNodesExactShape(t){const e=super.pickNodesExactShape(t);return e.sort((i,o)=>o.datumIndex.length-i.datumIndex.length),e}pickNodeClosestDatum(t){const e=this.pickNodesExactShape(t);return e.length!==0?{datum:e[0],distance:0}:this.pickNodeNearestDistantObject(t,this.datumSelection.nodes())}getTooltipContent(t){const{id:e,properties:i,ctx:o}=this,{formatManager:s}=o,{labelKey:a,secondaryLabelKey:n,childrenKey:r,sizeKey:l,sizeName:c,colorKey:h,colorName:d,tooltip:u}=i,g=t.reduce((I,L)=>I?.children[L],this.rootNode);if(g==null)return;const{datum:y,depth:f,children:x}=g;if(y==null||f==null)return;const S=x.length===0,v=[],m=l!=null?y[l]:void 0;if(m!=null){const I=[0,this.rootNode?.sumSize??0],L=s.format(this.callWithContext.bind(this),{type:"number",value:m,datum:y,seriesId:e,legendItemName:void 0,key:l,source:"tooltip",property:"size",boundSeries:this.getFormatterContext("size"),domain:I,fractionDigits:void 0});v.push({label:c,fallbackLabel:l,value:L??yM(m)})}const b=h!=null?y[h]:void 0;if(b!=null){const{colorDomain:I}=this,L=s.format(this.callWithContext.bind(this),{type:"number",value:b,datum:y,seriesId:e,legendItemName:void 0,key:h,source:"tooltip",property:"color",boundSeries:this.getFormatterContext("color"),domain:I,fractionDigits:void 0});v.push({label:d,fallbackLabel:h,value:L??yM(b)})}const M=this.getItemStyle({...g,colorValue:b??g.colorValue},S,!1),A={shape:"square",fill:M.fill,fillOpacity:1,stroke:void 0,strokeWidth:0,strokeOpacity:1,lineDash:[0],lineDashOffset:0};or.isGradientFill(A.fill)&&(A.fill={...A.fill,gradient:"linear",rotation:0,reverse:!1});const D=S?{marker:A}:void 0;return this.formatTooltipWithContext(u,{title:a!=null?y[a]:void 0,symbol:D,data:v},{seriesId:e,datum:y,title:void 0,depth:f,labelKey:a,secondaryLabelKey:n,childrenKey:r,sizeKey:l,sizeName:c,colorKey:h,colorName:d,...M})}computeFocusBounds(t){return yK.toCanvas(this.contentGroup,t.getBBox())}hasItemStylers(){return this.properties.itemStyler!=null}};sh.className="TreemapSeries",sh.type="treemap";import{_ModuleSupport as bK}from"ag-charts-community";import{arrayOf as mM,color as xM,constant as vK,required as MK,string as Js,undocumented as SM}from"ag-charts-core";var{commonSeriesOptionsDefs:DK,treemapSeriesThemeableOptionsDef:kK,without:AK}=bK,Fu={...kK,...AK(DK,["highlightStyle","highlight","showInLegend"]),type:MK(vK("treemap")),labelKey:Js,secondaryLabelKey:Js,childrenKey:Js,sizeKey:Js,colorKey:Js,sizeName:Js,colorName:Js};Fu.undocumentedGroupFills=SM(mM(xM)),Fu.undocumentedGroupStrokes=SM(mM(xM));var{FONT_SIZE_RATIO:bM}=is,LK={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["standalone"],identifier:"treemap",moduleFactory:t=>new sh(t),solo:!0,themeTemplate:{series:{fills:{$applyCycle:[{$size:{$path:["./data",{$path:"/data"}]}},{$palette:"fills"},{$applySwitch:[{$path:["/type",void 0,{$value:"$1"}]},{$value:"$1"},["gradient",is.FILL_GRADIENT_LINEAR_DEFAULTS],["pattern",is.FILL_PATTERN_DEFAULTS],["image",is.FILL_IMAGE_DEFAULTS]]}]},strokes:{$applyCycle:[{$size:{$path:["./data",{$path:"/data"}]}},{$palette:"strokes"}]},colorRange:{$palette:"divergingColors"},undocumentedGroupFills:{$palette:"hierarchyColors"},undocumentedGroupStrokes:{$palette:"secondHierarchyColors"},group:{label:{...is.LABEL_BOXING_DEFAULTS,enabled:!0,color:{$ref:"textColor"},fontStyle:void 0,fontWeight:{$ref:"fontWeight"},fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},spacing:4},fill:void 0,stroke:void 0,strokeWidth:1,padding:4,gap:2,textAlign:"left"},tile:{label:{...is.LABEL_BOXING_DEFAULTS,enabled:!0,color:{$ref:"chartBackgroundColor"},fontStyle:void 0,fontWeight:{$ref:"fontWeight"},fontSize:{$rem:1.5},minimumFontSize:{$rem:bM.SMALLER},fontFamily:{$ref:"fontFamily"},wrapping:"on-space",overflowStrategy:"ellipsis",spacing:2},secondaryLabel:{...is.LABEL_BOXING_DEFAULTS,enabled:!0,color:{$ref:"chartBackgroundColor"},fontStyle:void 0,fontWeight:void 0,fontSize:{$ref:"fontSize"},minimumFontSize:{$rem:bM.SMALLER},fontFamily:{$ref:"fontFamily"},wrapping:"never",overflowStrategy:"ellipsis"},fill:void 0,stroke:void 0,strokeWidth:{$isUserOption:["../strokes/0",2,{$isUserOption:["./stroke",2,0]}]},padding:3,gap:1},highlightStyle:{group:{label:{color:{$ref:"textColor"}},fill:"rgba(255,255,255, 0.33)",stroke:"rgba(0, 0, 0, 0.4)",strokeWidth:2},tile:{label:{color:{$ref:"chartBackgroundColor"}},secondaryLabel:{color:{$ref:"chartBackgroundColor"}},fill:"rgba(255,255,255, 0.33)",stroke:"rgba(0, 0, 0, 0.4)",strokeWidth:2}}},gradientLegend:{enabled:!0,...is.LEGEND_CONTAINER_THEME}}},IK={type:"series",name:"treemap",chartType:"standalone",enterprise:!0,options:Fu,create:t=>new sh(t)},e6=g_.ModuleRegistry,CK=[v_,qf,ym,wR,qR,Cm,Nm,Jm,dx,xx],TK=[M_,D_,k_,A_,qV,lG,fG,nW,AW],wK=[N_,bH,NB,a4,sK,IK,FO,B4],NK=[z_,yz,Nz,mF,GF,aV],PK=[...CK,...TK,...wK,...NK,oO,sO,aO],EK=`.ag-watermark{position:absolute;bottom:20px;right:25px;font-weight:700;font-family:Impact,sans-serif;font-size:19px;opacity:.7;animation:1s ease-out 3s ag-watermark-fadeout;color:#9b9b9b;pointer-events:none;&:before{content:"";display:block;height:40px;width:170px;background-image:url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjU4IiBoZWlnaHQ9IjQwIiB2aWV3Qm94PSIwIDAgMjU4IDQwIiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8cGF0aCBkPSJNMjUuNzc5IDI4LjY1N0gxMy4zNTlMMTEuMTczIDM0LjAxMkg1LjY3Mjk3TDE3LjE4MiA3LjA1OTk5SDIxLjk1M0wzMy40NjIgMzQuMDEySDI3Ljk2MkwyNS43NzYgMjguNjU3SDI1Ljc3OVpNMjQuMDY4IDI0LjM5N0wxOS41ODggMTMuNDM0TDE1LjEwNyAyNC4zOTdIMjQuMDY4Wk02Mi4wOTIgMTguODIzSDQ5LjgxN1YyMy4wODZINTYuNzc1QzU2LjU1NSAyNS4yMjIgNTUuNzU1IDI2LjkyNyA1NC4zNzIgMjguMjAyQzUyLjk4OSAyOS40NzYgNTEuMTY2IDMwLjExNSA0OC45MDkgMzAuMTE1QzQ3LjYyMiAzMC4xMTUgNDYuNDUgMjkuODg1IDQ1LjM5MyAyOS40MjNDNDQuMzU4MyAyOC45NzgxIDQzLjQzMjYgMjguMzEzOCA0Mi42OCAyNy40NzZDNDEuOTI3IDI2LjYzOSA0MS4zNDQgMjUuNjMxIDQwLjkzMSAyNC40NTNDNDAuNTE5IDIzLjI3NSA0MC4zMTEgMjEuOTcgNDAuMzExIDIwLjUzN0M0MC4zMTEgMTkuMTA1IDQwLjUxNiAxNy44IDQwLjkzMSAxNi42MjFDNDEuMzQ0IDE1LjQ0MyA0MS45MjcgMTQuNDM2IDQyLjY4IDEzLjU5OEM0My40Mzc2IDEyLjc1NzcgNDQuMzY5NiAxMi4wOTMyIDQ1LjQxMSAxMS42NTFDNDYuNDc4IDExLjE4OSA0Ny42NTYgMTAuOTYgNDguOTQ2IDEwLjk2QzUxLjYxMiAxMC45NiA1My42MzcgMTEuNjAyIDU1LjAyIDEyLjg4NUw1OC4zIDkuNjA0OTlDNTUuODE3IDcuNjY5OTkgNTIuNjc2IDYuNjk5OTkgNDguODcyIDYuNjk5OTlDNDYuNzYgNi42OTk5OSA0NC44NTMgNy4wMzQ5OSA0My4xNTQgNy43MDA5OUM0MS40NTUgOC4zNjc5OSAzOS45OTggOS4zMDM5OSAzOC43ODMgMTAuNTA0QzM3LjU2NyAxMS43MDcgMzYuNjM0IDEzLjE1OCAzNS45NzcgMTQuODU3QzM1LjMxOSAxNi41NTYgMzQuOTk0IDE4LjQ1MSAzNC45OTQgMjAuNTRDMzQuOTk0IDIyLjYzIDM1LjMyOSAyNC40OTQgMzUuOTk1IDI2LjIwNUMzNi42NjIgMjcuOTE2IDM3LjYwNSAyOS4zNzQgMzguODE3IDMwLjU3N0M0MC4wMzIgMzEuNzggNDEuNDg2IDMyLjcxMyA0My4xODggMzMuMzgzQzQ0Ljg4OCAzNC4wNDkgNDYuNzgyIDM0LjM4NCA0OC44NzIgMzQuMzg0QzUwLjk2MSAzNC4zODQgNTIuNzUgMzQuMDQ5IDU0LjM5IDMzLjM4M0M1Ni4wMzEgMzIuNzE2IDU3LjQyNiAzMS43OCA1OC41NzkgMzAuNTc3QzU5LjczMyAyOS4zNzQgNjAuNjE5IDI3LjkxNiA2MS4yMzkgMjYuMjA1QzYxLjg2IDI0LjQ5NCA2Mi4xNyAyMi42MDUgNjIuMTcgMjAuNTRDNjIuMTY5NiAxOS45Njg4IDYyLjE0NDUgMTkuMzk4IDYyLjA5NSAxOC44MjlMNjIuMDkyIDE4LjgyM1pNMTUxLjgxIDE2Ljk4MUMxNTMuNDEgMTQuNjA5IDE1Ny40MTkgMTQuMzU4IDE1OS4wMjIgMTQuMzU4VjE4LjkxQzE1Ni45NTcgMTguOTEgMTU0Ljk4NSAxOC45OTYgMTUzLjc1NyAxOS44OTJDMTUyLjUyOSAyMC43OTIgMTUxLjkxOSAyMS45ODIgMTUxLjkxOSAyMy40NjRWMzMuOTlIMTQ2Ljk2NFYxNC4zNThIMTUxLjczNkwxNTEuODEgMTYuOTgxWk0xNDMuMDExIDE0LjM2MVYzNC4wMzFIMTM4LjI0TDEzOC4xMzEgMzEuMDQ1QzEzNy40NjYgMzIuMDc2IDEzNi41NTEgMzIuOTIxOSAxMzUuNDcxIDMzLjUwNEMxMzQuMzc2IDM0LjA5OSAxMzMuMDY4IDM0LjM5NiAxMzEuNTM2IDM0LjM5NkMxMzAuMiAzNC4zOTYgMTI4Ljk2MyAzNC4xNTIgMTI3LjgyMiAzMy42NjhDMTI2LjcgMzMuMTk2NCAxMjUuNjg5IDMyLjQ5NSAxMjQuODU1IDMxLjYwOUMxMjQuMDE4IDMwLjcyMiAxMjMuMzU0IDI5LjY2MiAxMjIuODcxIDI4LjQyMkMxMjIuMzg0IDI3LjE4NSAxMjIuMTQyIDI1LjgxMSAxMjIuMTQyIDI0LjMwNEMxMjIuMTQyIDIyLjc5OCAxMjIuMzg0IDIxLjM3OCAxMjIuODcxIDIwLjExNkMxMjMuMzU3IDE4Ljg1NCAxMjQuMDE4IDE3Ljc3MiAxMjQuODU1IDE2Ljg3M0MxMjUuNjg4IDE1Ljk3NjQgMTI2LjY5OCAxNS4yNjM2IDEyNy44MjIgMTQuNzhDMTI4Ljk2MyAxNC4yODEgMTMwLjIwMyAxNC4wMzMgMTMxLjUzNiAxNC4wMzNDMTMzLjA0MyAxNC4wMzMgMTM0LjMzIDE0LjMxOCAxMzUuMzk3IDE0Ljg4OEMxMzYuNDYyIDE1LjQ1ODkgMTM3LjM3NSAxNi4yNzggMTM4LjA1NyAxNy4yNzZWMTQuMzYxSDE0My4wMTFaTTEzMi42MzEgMzAuMTMzQzEzNC4yNTYgMzAuMTMzIDEzNS41NjcgMjkuNTk0IDEzNi41NjUgMjguNTEyQzEzNy41NjEgMjcuNDMgMTM4LjA2IDI1Ljk5MSAxMzguMDYgMjQuMTk2QzEzOC4wNiAyMi40MDEgMTM3LjU2MSAyMC45OSAxMzYuNTY1IDE5Ljg5OUMxMzUuNTcgMTguODA3IDEzNC4yNTkgMTguMjU4IDEzMi42MzEgMTguMjU4QzEzMS4wMDMgMTguMjU4IDEyOS43MjkgMTguODA0IDEyOC43MzQgMTkuODk5QzEyNy43MzggMjAuOTkzIDEyNy4yMzkgMjIuNDM4IDEyNy4yMzkgMjQuMjMzQzEyNy4yMzkgMjYuMDI4IDEyNy43MzUgMjcuNDMzIDEyOC43MzQgMjguNTE1QzEyOS43MjkgMjkuNTk0IDEzMS4wMjggMzAuMTM2IDEzMi42MzEgMzAuMTM2VjMwLjEzM1pNOTMuNjk4IDI3Ljg3NkM5My41Nzk1IDI4LjAwMjUgOTMuNDU2NCAyOC4xMjQ2IDkzLjMyOSAyOC4yNDJDOTEuOTQ3IDI5LjUxNiA5MC4xMjMgMzAuMTU1IDg3Ljg2NiAzMC4xNTVDODYuNTggMzAuMTU1IDg1LjQwOCAyOS45MjYgODQuMzUgMjkuNDY0QzgzLjMxNTUgMjkuMDE4OSA4Mi4zODk4IDI4LjM1NDYgODEuNjM3IDI3LjUxN0M4MC44ODQgMjYuNjc5IDgwLjMwMSAyNS42NzIgNzkuODg5IDI0LjQ5NEM3OS40NzYgMjMuMzE1IDc5LjI2OSAyMi4wMSA3OS4yNjkgMjAuNTc4Qzc5LjI2OSAxOS4xNDUgNzkuNDczIDE3Ljg0IDc5Ljg4OSAxNi42NjJDODAuMzAxIDE1LjQ4NCA4MC44ODQgMTQuNDc2IDgxLjYzNyAxMy42MzlDODIuMzk0OSAxMi43OTg3IDgzLjMyNzMgMTIuMTM0MiA4NC4zNjkgMTEuNjkyQzg1LjQzNiAxMS4yMyA4Ni42MTQgMTEgODcuOTAzIDExQzkwLjU3IDExIDkyLjU5NSAxMS42NDIgOTMuOTc3IDEyLjkyNkw5Ny4yNTggOS42NDQ5OUM5NC43NzQgNy43MTA5OSA5MS42MzMgNi43Mzk5OSA4Ny44MjkgNi43Mzk5OUM4NS43MTggNi43Mzk5OSA4My44MTEgNy4wNzQ5OSA4Mi4xMTIgNy43NDE5OUM4MC40MTMgOC40MDc5OSA3OC45NTYgOS4zNDQ5OSA3Ny43NCAxMC41NDVDNzYuNTI1IDExLjc0NyA3NS41OTIgMTMuMTk5IDc0LjkzNCAxNC44OThDNzQuMjc3IDE2LjU5NyA3My45NTEgMTguNDkxIDczLjk1MSAyMC41ODFDNzMuOTUxIDIyLjY3IDc0LjI4NiAyNC41MzQgNzQuOTUzIDI2LjI0NUM3NS42MTkgMjcuOTU3IDc2LjU2MiAyOS40MTQgNzcuNzc0IDMwLjYxN0M3OC45OSAzMS44MiA4MC40NDQgMzIuNzUzIDgyLjE0NiAzMy40MjNDODMuODQ1IDM0LjA5IDg1LjczOSAzNC40MjQgODcuODI5IDM0LjQyNEM4OS45MTkgMzQuNDI0IDkxLjcwOCAzNC4wOSA5My4zNDggMzMuNDIzQzk0LjcxOCAzMi44NjUgOTUuOTE4IDMyLjEyMSA5Ni45NDggMzEuMTkxQzk3LjE0OSAzMS4wMDggOTcuMzQ4IDMwLjgxNSA5Ny41MzcgMzAuNjJMOTMuNzAxIDI3Ljg4NUw5My42OTggMjcuODc2Wk0xMTAuODAyIDE0LjAxNUMxMDkuMTk5IDE0LjAxNSAxMDYuODM2IDE0LjQ3MSAxMDUuNjExIDE2LjE1OEwxMDUuNTM3IDYuMDE1OTlIMTAwLjc2NVYzMy45MzlIMTA1LjcyVjIyLjY0MUMxMDUuNzcxIDIxLjQ2MDcgMTA2LjI4OCAyMC4zNDg4IDEwNy4xNTcgMTkuNTQ4OUMxMDguMDI3IDE4Ljc0OTEgMTA5LjE3OCAxOC4zMjY2IDExMC4zNTggMTguMzc0QzExMy4zOTcgMTguMzc0IDExNC4yNjggMjEuMTU5IDExNC4yNjggMjIuNjQxVjMzLjkzOUgxMTkuMjIzVjIxLjA1OUMxMTkuMjIzIDIxLjA1OSAxMTkuMTQyIDE0LjAxNSAxMTAuODAyIDE0LjAxNVpNMTczLjc2MyAxNC4zNThIMTY5Ljk5OVY4LjcxNDk5SDE2NS4wNDhWMTQuMzU4SDE2MS4yODRWMTguOTE2SDE2NS4wNDhWMzQuMDAzSDE2OS45OTlWMTguOTE2SDE3My43NjNWMTQuMzU4Wk0xOTAuNzg3IDI1LjI2MkMxOTAuMTI5IDI0LjUwMTQgMTg5LjMwNyAyMy44OTk0IDE4OC4zODQgMjMuNTAxQzE4Ny40ODggMjMuMTE3IDE4Ni4zMzEgMjIuNzMyIDE4NC45NDggMjIuMzY0QzE4NC4xNjUgMjIuMTQzOSAxODMuMzkgMjEuODk3OCAxODIuNjIzIDIxLjYyNkMxODIuMTYzIDIxLjQ2MjEgMTgxLjc0MSAyMS4yMDY2IDE4MS4zODMgMjAuODc1QzE4MS4yMzUgMjAuNzQyMSAxODEuMTE4IDIwLjU3ODkgMTgxLjAzOSAyMC4zOTY0QzE4MC45NjEgMjAuMjE0IDE4MC45MjIgMjAuMDE2NiAxODAuOTI3IDE5LjgxOEMxODAuOTI3IDE5LjI3MiAxODEuMTU2IDE4Ljg0NCAxODEuNjI1IDE4LjUxQzE4Mi4xMjEgMTguMTU2IDE4Mi44NjIgMTcuOTc2IDE4My44MjYgMTcuOTc2QzE4NC43OSAxNy45NzYgMTg1LjU4NyAxOC4yMDkgMTg2LjE0OCAxOC42NjhDMTg2LjcwNiAxOS4xMjQgMTg3LjAwNyAxOS43MjUgMTg3LjA3MiAyMC41TDE4Ny4wOTQgMjAuNzgySDE5MS42MzNMMTkxLjYxNyAyMC40NkMxOTEuNTIxIDE4LjQ4NSAxOTAuNzcxIDE2LjkgMTg5LjM4NSAxNS43NUMxODguMDEyIDE0LjYxMiAxODYuMTg1IDE0LjAzMyAxODMuOTYyIDE0LjAzM0MxODIuNDc3IDE0LjAzMyAxODEuMTQxIDE0LjI4NyAxNzkuOTk0IDE0Ljc4NkMxNzguODMxIDE1LjI5MSAxNzcuOTI2IDE1Ljk5NSAxNzcuMjk2IDE2Ljg4MkMxNzYuNjczIDE3Ljc0NTUgMTc2LjMzOCAxOC43ODQgMTc2LjM0MSAxOS44NDlDMTc2LjM0MSAyMS4xNjcgMTc2LjY5OCAyMi4yNDkgMTc3LjM5OSAyMy4wNjRDMTc4LjA2IDIzLjg0MzIgMTc4Ljg5OCAyNC40NTM0IDE3OS44NDIgMjQuODQ0QzE4MC43NDQgMjUuMjE2IDE4MS45MjggMjUuNjA3IDE4My4zNjEgMjZDMTg0LjgwNiAyNi40MSAxODUuODcyIDI2Ljc4NSAxODYuNTMgMjcuMTIzQzE4Ny4xIDI3LjQxNCAxODcuMzc5IDI3Ljg0NSAxODcuMzc5IDI4LjQ0NEMxODcuMzc5IDI5LjA0MiAxODcuMTIyIDI5LjQ2NyAxODYuNTk1IDI5LjgzOUMxODYuMDQzIDMwLjIyNiAxODUuMjM3IDMwLjQyNSAxODQuMjAxIDMwLjQyNUMxODMuMTY2IDMwLjQyNSAxODIuMzk0IDMwLjE3NCAxODEuNzQ5IDI5LjY3NEMxODEuMTEzIDI5LjE4MSAxODAuNzcyIDI4LjU4OSAxODAuNzEgMjcuODY0TDE4MC42ODUgMjcuNTgySDE3Ni4wMTNMMTc2LjAyNSAyNy45MDFDMTc2LjA2NyAyOS4wOTU1IDE3Ni40NzIgMzAuMjQ4NyAxNzcuMTg4IDMxLjIwNkMxNzcuOTA3IDMyLjE4IDE3OC44OTMgMzIuOTU4IDE4MC4xMTggMzMuNTE5QzE4MS4zMzYgMzQuMDc3IDE4Mi43MzIgMzQuMzYyIDE4NC4yNjYgMzQuMzYyQzE4NS44MDEgMzQuMzYyIDE4Ny4xMDkgMzQuMTA4IDE4OC4yMzggMzMuNjA5QzE4OS4zNzYgMzMuMTA0IDE5MC4yNzIgMzIuMzk0IDE5MC45MDEgMzEuNDk0QzE5MS41MzQgMzAuNTkyIDE5MS44NTMgMjkuNTU0IDE5MS44NTMgMjguNDAzQzE5MS44MjggMjcuMTEgMTkxLjQ2NiAyNi4wNTMgMTkwLjc3NyAyNS4yNjJIMTkwLjc4N1oiIGZpbGw9IiM5QjlCOUIiLz4KPHBhdGggZD0iTTI0MS45ODIgMjUuNjU4MlYxNy43MTE3SDIyOC40NDFMMjIwLjQ5NCAyNS42NTgySDI0MS45ODJaIiBmaWxsPSIjOUI5QjlCIi8+CjxwYXRoIGQ9Ik0yNTcuMjM5IDUuOTUwODFIMjQwLjI2NUwyMzIuMjU1IDEzLjg5NzNIMjU3LjIzOVY1Ljk1MDgxWiIgZmlsbD0iIzlCOUI5QiIvPgo8cGF0aCBkPSJNMjEyLjYxMSAzMy42MDQ4TDIxNi42OCAyOS41MzYxSDIzMC40MTJWMzcuNDgyN0gyMTIuNjExVjMzLjYwNDhaIiBmaWxsPSIjOUI5QjlCIi8+CjxwYXRoIGQ9Ik0yMTUuNTk5IDIxLjc4MDNIMjI0LjM3MkwyMzIuMzgyIDEzLjgzMzdIMjE1LjU5OVYyMS43ODAzWiIgZmlsbD0iIzlCOUI5QiIvPgo8cGF0aCBkPSJNMjA2IDMzLjYwNDdIMjEyLjYxMUwyMjAuNDk0IDI1LjY1ODJIMjA2VjMzLjYwNDdaIiBmaWxsPSIjOUI5QjlCIi8+CjxwYXRoIGQ9Ik0yNDAuMjY1IDUuOTUwODFMMjM2LjE5NyAxMC4wMTk0SDIxMC4yNTlWMi4wNzI4OEgyNDAuMjY1VjUuOTUwODFaIiBmaWxsPSIjOUI5QjlCIi8+Cjwvc3ZnPgo=);background-repeat:no-repeat;background-size:170px 40px}>span{padding-left:.7rem}}@keyframes ag-watermark-fadeout{0%{opacity:.5}to{opacity:0}}.ag-charts-dialog{display:flex;flex-direction:column;font-size:var(--ag-charts-chrome-font-size-large)}.ag-charts-dialog__tabs{display:flex;flex-direction:column}.ag-charts-dialog__header{border-bottom:1px solid var(--ag-charts-border-color);display:flex}.ag-charts-dialog__tab-list{display:flex;gap:calc(var(--ag-charts-spacing) * 2)}.ag-charts-dialog__drag-handle{align-items:center;color:inherit;cursor:grab;display:flex;padding:1px 6px;text-align:center}.ag-charts-dialog__drag-handle--dragging{cursor:grabbing}.ag-charts-dialog__tab-button{background:none;border:0;border-bottom:2px solid transparent;border-radius:0;color:var(--ag-charts-panel-subtle-text-color);margin-bottom:-1px;padding:var(--input-padding) calc(var(--input-padding) / 2)}.ag-charts-dialog__tab-button:hover{background:none}.ag-charts-dialog__tab-button--active{border-color:var(--ag-charts-accent-color);color:inherit}.ag-charts-dialog__drag-handle+.ag-charts-dialog__tab-button{margin-left:calc(var(--ag-charts-spacing) * -2)}.ag-charts-button.ag-charts-dialog__close-button{background:none;border:0;margin-left:auto;padding:1px 6px}.ag-charts-dialog__close-button:focus-visible{outline:var(--ag-charts-focus-border);box-shadow:var(--ag-charts-focus-border-shadow);z-index:calc(var(--ag-charts-layer-ui-overlay) + 1)}.ag-charts-dialog__tab-panel{display:none;flex-direction:column;gap:calc(var(--ag-charts-spacing) * 4);margin:0 calc(var(--ag-charts-spacing) * 4);padding:calc(var(--ag-charts-spacing) * 4) 0}.ag-charts-dialog__tab-panel--active{display:flex}.ag-charts-dialog__input-group-line{display:flex;gap:16px 18px;flex-wrap:wrap}.ag-charts-dialog__input-group{align-items:center;display:flex;font-size:var(--ag-charts-chrome-font-size)}.ag-charts-dialog__input-group-label{color:var(--ag-charts-panel-subtle-text-color);margin-right:5px}.ag-charts-dialog__input-group-label[for]{cursor:pointer}.ag-charts-dialog__button{border-radius:0;margin-right:-1px}.ag-charts-dialog__button.ag-charts-dialog__button--active{background:var(--ag-charts-button-focus-background-color);border-color:var(--ag-charts-input-focus-border-color);color:var(--ag-charts-input-focus-text-color);z-index:var(--input-layer-active)}.ag-charts-dialog__button:first-child,.ag-charts-dialog__input-group-label+.ag-charts-dialog__button{border-bottom-left-radius:var(--ag-charts-input-border-radius);border-top-left-radius:var(--ag-charts-input-border-radius)}.ag-charts-dialog__button:last-child{border-bottom-right-radius:var(--ag-charts-input-border-radius);border-top-right-radius:var(--ag-charts-input-border-radius)}.ag-charts-dialog__color-picker-button{--color: #000;background:var(--color);border:none;color:transparent;height:26px;width:26px}.ag-charts-dialog__color-picker-button:hover{background:var(--color)}.ag-charts-dialog__color-picker-button--multi-color,.ag-charts-dialog__color-picker-button--multi-color:hover{background:linear-gradient(135deg,red 0%,#ff0 calc(100% * 1 / 6),#0f0 calc(100% * 2 / 6),#0ff 50%,#00f calc(100% * 4 / 6),#f0f calc(100% * 5 / 6),red 100%)}.ag-charts-color-picker{width:190px;padding:8px;cursor:default;--h: 0;--s: 0;--v: 0;--a: 0;--color: #000;--color-a: #000;--thumb-size: 18px;--inner-width: 172px;--track-height: 12px;--palette-height: 136px;--checker: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="4" height="4"><rect x="0" y="0" width="4" height="4" fill="%23fff"/><path d="M0 0H2V4H4V2H0Z" fill="%23b2b2b2"/></svg>');--multi-color: linear-gradient( 135deg, #f00 0% , #ff0 calc(100% * 1 / 6), #0f0 calc(100% * 2 / 6), #0ff 50% , #00f calc(100% * 4 / 6), #f0f calc(100% * 5 / 6), #f00 100% )}.ag-charts-color-picker__content{display:flex;flex-direction:column}.ag-charts-color-picker__palette{position:relative;width:100%;height:var(--palette-height);margin-bottom:8px;background:linear-gradient(to bottom,#0000,#000),linear-gradient(to right,#fff,#fff0) hsl(var(--h),100%,50%);border-radius:calc(var(--ag-charts-border-radius) * 1.5);box-shadow:inset 0 0 0 1px #0003}.ag-charts-color-picker__palette:after{content:"";position:absolute;display:block;top:calc(var(--thumb-size) * -.5 + (1 - var(--v)) * 100%);left:calc(var(--thumb-size) * -.5 + var(--s) * 100%);background:var(--color);width:var(--thumb-size);height:var(--thumb-size);border-radius:calc(var(--ag-charts-border-radius) * 99);box-shadow:var(--box-shadow);--box-shadow: inset 0 0 0 3px white, inset 0 0 1px 3px #0006, 0 0 5px #00000038}.ag-charts-color-picker__palette:focus-visible:after{outline:var(--ag-charts-focus-border);box-shadow:var(--box-shadow),0 0 0 2px #fff8,var(--ag-charts-focus-border-shadow)}.ag-charts-color-picker__color-row{display:flex;gap:8px;align-items:center;margin-bottom:4px;--inset: calc((var(--thumb-size) - var(--track-height)) / 2)}.ag-charts-color-picker__hue-input,.ag-charts-color-picker__alpha-input{-webkit-appearance:none;display:block;position:relative;padding:0;margin:0 calc(var(--inset) * -1);border:0;height:var(--thumb-size);width:auto;background:transparent;--inset: calc((var(--thumb-size) - var(--track-height)) / 2)}.ag-charts-color-picker__hue-input::-moz-range-thumb,.ag-charts-color-picker__alpha-input::-moz-range-thumb{appearance:none;width:var(--thumb-size);height:var(--thumb-size);border-radius:calc(var(--ag-charts-border-radius) * 99);box-shadow:var(--box-shadow);--box-shadow: inset 0 0 0 3px white, inset 0 0 1px 3px #0006, 0 0 5px #00000038}.ag-charts-color-picker__hue-input::-webkit-slider-thumb,.ag-charts-color-picker__alpha-input::-webkit-slider-thumb{-webkit-appearance:none;width:var(--thumb-size);height:var(--thumb-size);border-radius:calc(var(--ag-charts-border-radius) * 99);box-shadow:var(--box-shadow);--box-shadow: inset 0 0 0 3px white, inset 0 0 1px 3px #0006, 0 0 5px #00000038;transform:translateZ(0)}.ag-charts-color-picker__hue-input::-moz-range-thumb{background:hsl(var(--h),100%,50%)}.ag-charts-color-picker__hue-input::-webkit-slider-thumb{background:hsl(var(--h),100%,50%)}.ag-charts-color-picker__alpha-input::-moz-range-thumb{background:transparent}.ag-charts-color-picker__alpha-input::-webkit-slider-thumb{background:transparent}.ag-charts-color-picker__alpha-input--opaque::-moz-range-thumb{background:var(--color)}.ag-charts-color-picker__alpha-input--opaque::-webkit-slider-thumb{background:var(--color)}.ag-charts-color-picker__hue-input:focus-visible::-moz-range-thumb,.ag-charts-color-picker__alpha-input:focus-visible::-moz-range-thumb{outline:var(--ag-charts-focus-border);box-shadow:var(--box-shadow),var(--ag-charts-focus-border-shadow)}.ag-charts-color-picker__hue-input:focus-visible::-webkit-slider-thumb,.ag-charts-color-picker__alpha-input:focus-visible::-webkit-slider-thumb{outline:var(--ag-charts-focus-border);box-shadow:var(--box-shadow),var(--ag-charts-focus-border-shadow)}.ag-charts-color-picker__hue-input::-moz-range-track,.ag-charts-color-picker__alpha-input::-moz-range-track{position:absolute;content:"";display:block;top:calc(50% - var(--track-height) / 2);left:var(--inset);right:var(--inset);height:var(--track-height);border-radius:calc(var(--ag-charts-border-radius) * 99);box-shadow:inset 0 0 0 1px #0003}.ag-charts-color-picker__hue-input:before,.ag-charts-color-picker__alpha-input:before{position:absolute;content:"";display:block;top:calc(50% - var(--track-height) / 2);left:var(--inset);right:var(--inset);height:var(--track-height);border-radius:calc(var(--ag-charts-border-radius) * 99);box-shadow:inset 0 0 0 1px #0003}.ag-charts-color-picker__multi-color-button{width:36px;margin-left:var(--inset);height:var(--track-height);border-radius:calc(var(--ag-charts-border-radius) * 99);border:0;background:var(--multi-color);box-shadow:inset 0 0 0 1px #0003}.ag-charts-color-picker__multi-color-button--hidden{display:none}.ag-charts-color-picker__multi-color-button--active{box-shadow:inset 0 0 0 1px #0003;outline-offset:1px;outline:2px solid #2196f3}.ag-charts-color-picker__hue-input{flex:1 0 0}.ag-charts-color-picker__hue-input::-moz-range-track{background:linear-gradient(to right,red,red calc((100% - var(--track-height)) * 0 / 6 + var(--track-height) / 2),#ff0 calc((100% - var(--track-height)) * 1 / 6 + var(--track-height) / 2),#0f0 calc((100% - var(--track-height)) * 2 / 6 + var(--track-height) / 2),#0ff calc((100% - var(--track-height)) * 3 / 6 + var(--track-height) / 2),#00f calc((100% - var(--track-height)) * 4 / 6 + var(--track-height) / 2),#f0f calc((100% - var(--track-height)) * 5 / 6 + var(--track-height) / 2),red calc((100% - var(--track-height)) * 6 / 6 + var(--track-height) / 2))}.ag-charts-color-picker__hue-input:before{background:linear-gradient(to right,red,red calc((100% - var(--track-height)) * 0 / 6 + var(--track-height) / 2),#ff0 calc((100% - var(--track-height)) * 1 / 6 + var(--track-height) / 2),#0f0 calc((100% - var(--track-height)) * 2 / 6 + var(--track-height) / 2),#0ff calc((100% - var(--track-height)) * 3 / 6 + var(--track-height) / 2),#00f calc((100% - var(--track-height)) * 4 / 6 + var(--track-height) / 2),#f0f calc((100% - var(--track-height)) * 5 / 6 + var(--track-height) / 2),red calc((100% - var(--track-height)) * 6 / 6 + var(--track-height) / 2))}.ag-charts-color-picker__alpha-input{margin-bottom:7px}.ag-charts-color-picker__alpha-input::-moz-range-track{background:linear-gradient(to right,transparent,var(--color)),var(--checker) top left / 4px 4px}.ag-charts-color-picker__alpha-input:before{background:linear-gradient(to right,transparent,var(--color)),var(--checker) top left / 4px 4px}.ag-charts-color-picker__color-field{display:flex;border:var(--ag-charts-border);background:var(--ag-charts-background-color);border-radius:var(--ag-charts-border-radius);overflow:hidden}.ag-charts-color-picker__color-field:has(:focus-visible){border-color:var(--ag-charts-accent-color);box-shadow:var(--ag-charts-focus-border-shadow)}.ag-charts-color-picker__color-label{width:16px;height:16px;margin:7px 0 7px 7px;color:transparent;background:linear-gradient(to right,var(--color-a),var(--color-a)),var(--checker) top left / 4px 4px;border-radius:calc(var(--ag-charts-border-radius) / 2);box-shadow:inset 0 0 0 1px #0003}.ag-charts-color-picker__color-label--multi-color{background:var(--multi-color)}.ag-charts-color-picker__color-input{flex:1;min-width:0;padding:7px 7px 7px 8px;border:0;margin:0;color:inherit;background:transparent;font-variant:tabular-nums}.ag-charts-color-picker__color-input:focus-visible{border:none;outline:none}.ag-charts-annotations__line-stroke-width-menu,.ag-charts-annotations__line-style-type-menu,.ag-charts-annotations__text-size-menu{border-top-left-radius:0;border-top-right-radius:0;.ag-charts-menu__row:first-child{border-radius:0}}.ag-charts-annotations__text-size-menu{--item-padding: 4px 8px;min-width:34px;text-align:center}.ag-charts-annotations__line-stroke-width-menu{--item-padding: 6px;column-gap:6px}.ag-charts-annotations__line-style-type-menu{--item-padding: 6px;column-gap:0}.ag-charts-annotations__stroke-width-button:before{background:var(--ag-charts-foreground-color);content:"";margin-right:var(--toolbar-button-padding);height:min(var(--stroke-width),20px);width:12px}.ag-charts-annotations__stroke-width-button[aria-disabled=true]:before{filter:grayscale(1);opacity:.5}.ag-charts-annotations__color-picker-button{--emblem: var(--color)}.ag-charts-annotations__color-picker-button--multi-color{--emblem: linear-gradient( to right, #f00 0% , #ff0 calc(100% * 1 / 6), #0f0 calc(100% * 2 / 6), #0ff 50% , #00f calc(100% * 4 / 6), #f0f calc(100% * 5 / 6), #f00 100% )}.ag-charts-annotations__color-picker-button:after{content:"";display:block;position:absolute;bottom:3px;left:5px;right:5px;height:4px;border-radius:99px;box-shadow:inset 0 0 0 1px color-mix(in srgb,var(--ag-charts-foreground-color) 10%,transparent);background:var(--emblem)}.ag-charts-annotations__color-picker-button[aria-disabled=true]:after{filter:grayscale(1);opacity:.5}.ag-charts-annotations__toolbar-menu{min-width:200px}.ag-charts-annotations__axis-button--hidden{display:none}.ag-charts-annotations__axis-button{background-color:var(--ag-charts-crosshair-label-background-color);border-radius:calc(var(--ag-charts-border-radius) / 2);border:none;box-sizing:border-box;color:var(--ag-charts-crosshair-label-text-color);cursor:pointer;font-family:var(--ag-charts-button-font-family);font-size:var(--ag-charts-button-font-size);font-weight:var(--ag-charts-button-font-weight);left:0;line-height:16px;overflow:hidden;padding:0;position:absolute;top:0;user-select:none;white-space:nowrap;z-index:var(--ag-charts-layer-annotations)}.ag-charts-annotations__axis-button:hover{opacity:.8;color:var(--ag-charts-background-color)}.ag-charts-dialog--annotation-settings{min-height:233px;width:289px}.ag-charts-dialog--annotation-settings .ag-charts-textarea{height:calc(10px * 2 + var(--textarea-line-height) * 1em * 3 + 2px);overflow-y:auto;resize:vertical}.ag-charts-context-menu{font-family:var(--ag-charts-chrome-font-family);font-size:var(--ag-charts-chrome-font-size);font-weight:var(--ag-charts-chrome-font-weight);z-index:var(--ag-charts-layer-ui-overlay)}.ag-charts-context-menu__cover{position:fixed;left:0;top:0}.ag-charts-context-menu__menu{background:var(--ag-charts-menu-background-color);border-radius:var(--ag-charts-border-radius);border:var(--ag-charts-menu-border);box-shadow:var(--ag-charts-popup-shadow);color:var(--ag-charts-menu-text-color);display:flex;flex-direction:column;padding:.5em 0;transition:transform .1s ease;white-space:nowrap}.ag-charts-context-menu__menu:focus{outline:none}.ag-charts-context-menu__item{align-items:center;background:none;border:none;box-sizing:border-box;color:inherit;cursor:pointer;display:flex;font:inherit;justify-content:space-between;text-align:left;width:100%;-webkit-appearance:none;-moz-appearance:none}.ag-charts-context-menu__icon>img{width:var(--ag-charts-icon-size);height:var(--ag-charts-icon-size)}.ag-charts-context-menu__icon,.ag-charts-context-menu__cell{display:flex;align-items:center;flex-shrink:0}.ag-charts-context-menu__cell{flex-grow:1}.ag-charts-context-menu__cellpadding{padding:.5em 1em}.ag-charts-context-menu__icon{padding-right:0}.ag-charts-context-menu__item[data-focus-override=true],.ag-charts-context-menu__item:focus,.ag-charts-context-menu__item:active{background:var(--ag-charts-focus-color)}.ag-charts-context-menu__item[data-focus-override=false]{background:inherit}.ag-charts-context-menu__item[data-focus-visible-override=true]:focus,.ag-charts-context-menu__item:focus-visible{outline:var(--ag-charts-focus-border);box-shadow:var(--ag-charts-focus-border-shadow);z-index:calc(var(--ag-charts-layer-ui-overlay) + 1)}.ag-charts-context-menu__item[data-focus-visible-override=false]{outline:inherit;box-shadow:inherit;z-index:inherit}.ag-charts-context-menu__item[aria-disabled=true]{border:none;color:color-mix(in srgb,var(--ag-charts-input-text-color) 50%,transparent)}.ag-charts-context-menu__item[aria-disabled=true]:focus{background:inherit;cursor:inherit}.ag-charts-context-menu__divider{padding:5px 0}.ag-charts-context-menu__divider:after{content:"";display:block;border-top:1px solid var(--ag-charts-border-color)}.ag-charts-crosshair-label{position:absolute;left:0;top:0;user-select:none;pointer-events:none;font-family:var(--ag-charts-font-family);font-size:var(--ag-charts-font-size);font-weight:var(--ag-charts-font-weight);overflow:hidden;white-space:nowrap;z-index:var(--ag-charts-layer-crosshair);box-sizing:border-box}.ag-charts-crosshair-label-content{padding:0 8px;border-radius:calc(var(--ag-charts-border-radius) / 2);line-height:calc(var(--ag-charts-font-size) + 8px);background-color:var(--ag-charts-crosshair-label-background-color);color:var(--ag-charts-crosshair-label-text-color)}.ag-charts-crosshair-label--hidden{visibility:hidden!important}.ag-charts-text-input{position:absolute}.ag-charts-text-input__textarea{--placeholder-text-color: var(--ag-charts-input-placeholder-text-color);display:block;height:100%;width:100%;border:0;background:none;line-height:1.38;outline:none;transform:translateY(.09em)}.ag-charts-text-input__textarea[placeholder]:empty:before{content:attr(placeholder);color:var(--placeholder-text-color);font-weight:400}.ag-charts-text-input__textarea[placeholder]:not(:empty):before{content:""}.ag-charts-chart-toolbar__menu{min-width:200px}.ag-charts-range-buttons .ag-charts-toolbar__button{padding:var(--toolbar-button-padding) calc(var(--toolbar-button-padding) * 1.5)}.ag-charts-zoom-buttons{align-items:center;display:flex;height:44px;justify-content:center;overflow:hidden;padding-bottom:10px;pointer-events:none;width:100%;.ag-charts-toolbar{--toolbar-size: 24px;--toolbar-button-padding: 1px;display:flex;font-size:var(--ag-charts-chrome-font-size);height:var(--toolbar-size);justify-content:center;opacity:1;pointer-events:auto;transition:opacity .2s ease-in-out,transform .4s ease-in-out;.ag-charts-toolbar__button--first{border-bottom-left-radius:var(--ag-charts-border-radius);border-top-left-radius:var(--ag-charts-border-radius)}.ag-charts-toolbar__button--last{border-bottom-right-radius:var(--ag-charts-border-radius);border-top-right-radius:var(--ag-charts-border-radius)}.ag-charts-toolbar__label{padding-left:var(--ag-charts-spacing);padding-right:var(--ag-charts-spacing)}.ag-charts-toolbar__icon+.ag-charts-toolbar__label{padding-left:0}.ag-charts-toolbar__button--gap{margin-left:var(--toolbar-gap)}&.ag-charts-zoom-buttons__toolbar--hidden{opacity:0;transition:opacity .4s ease-in-out,transform .4s ease-in-out}}}.ag-charts-shared-toolbar{gap:var(--toolbar-gap);.ag-charts-toolbar__button{border-radius:var(--ag-charts-border-radius);margin:0}}
`;ea.ModuleRegistry.registerMany(PK,OM);function vM(){ea.moduleRegistry.register(lD,fD,XD,mL,AL,LI,HC,HT,zO,TR,ZR,Tw,GL,XL,nI,RL,rI,DI,wB,gz,wz,fF,HF,sV,M1,W1,p_,xw,ZV,kD,rG,yG,aW,kW,KD,s4,UD,kP,wN,w1,SH,R4,P1,oK,eE,LK,h1,OE),ea.enterpriseModule.isEnterprise=!0,ea.enterpriseModule.styles=EK,ea.enterpriseModule.licenseManager=t=>new ta(t.container?.ownerDocument??(typeof document>"u"?void 0:document)),ea.enterpriseModule.injectWatermark=u_}export*from"ag-charts-community";vM();var _K={setLicenseKey(t){ta.setLicenseKey(t)}};function MM(){vM(),EM()}var OK={VERSION:TM,_Scene:wM,_Theme:NM,_Util:PM,create:rr.create.bind(rr),createSparkline:rr.__createSparkline.bind(rr),setup:MM,setGridContext:ta.setGridContext.bind(ta),setLicenseKey:ta.setLicenseKey.bind(ta),isEnterprise:!0};export{OK as AgChartsEnterpriseModule,_K as LicenseManager,MM as setupEnterpriseModules};
